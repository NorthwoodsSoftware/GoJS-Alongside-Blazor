!function () { var t; function n(t) { var i, e, n = "undefined" != typeof Symbol && Symbol.iterator && t[Symbol.iterator]; return n ? n.call(t) : { next: (i = t, e = 0, function () { return e < i.length ? { done: !1, value: i[e++] } : { done: !0 } }) } } function o(t) { for (var i, e = []; !(i = t.next()).done;)e.push(i.value); return e } var i, e, r = "function" == typeof Object.create ? Object.create : function (t) { function i() { } return i.prototype = t, new i }; if ("function" == typeof Object.setPrototypeOf) i = Object.setPrototypeOf; else { t: { var s = {}; try { s.__proto__ = { a: !0 }, e = s.a; break t } catch (t) { } e = !1 } i = e ? function (t, i) { if (t.__proto__ = i, t.__proto__ !== i) throw new TypeError(t + " is not extensible"); return t } : null } var a = i; function h(t, i) { if (t.prototype = r(i.prototype), t.prototype.constructor = t, a) a(t, i); else for (var e in i) { var n; "prototype" != e && (Object.defineProperties ? (n = Object.getOwnPropertyDescriptor(i, e)) && Object.defineProperty(t, e, n) : t[e] = i[e]) } t.MA = i.prototype } var l = ("undefined" == typeof window || window !== self) && "undefined" != typeof global && null != global ? global : self, u = "function" == typeof Object.defineProperties ? Object.defineProperty : function (t, i, e) { t != Array.prototype && t != Object.prototype && (t[i] = e.value) }; !function (t) { if (t) { for (var i = l, e = ["Array", "prototype", "fill"], n = 0; n < e.length - 1; n++) { var o = e[n]; o in i || (i[o] = {}), i = i[o] } (t = t(n = i[e = e[e.length - 1]])) != n && null != t && u(i, e, { writable: !0, value: t }) } }(function (t) { return t || function (t, i, e) { var n = this.length || 0; for (i < 0 && (i = Math.max(0, n + i)), (null == e || n < e) && (e = n), (e = Number(e)) < 0 && (e = Math.max(0, n + e)), i = Number(i || 0); i < e; i++)this[i] = t; return this } }); var c = "object" == typeof self && self.self === self && self || "object" == typeof global && global.global === global && global || "object" == typeof window && window.window === window && window || {}; function f() { } function d(e, n) { var o = -1; return function () { var t = this, i = arguments; -1 !== o && c.clearTimeout(o), o = m(function () { o = -1, e.apply(t, i) }, n) } } function m(t, i) { return c.setTimeout(t, i) } function p(t) { return c.document.createElement(t) } function B(t) { throw Error(t) } function g(t, i) { t = "The object is frozen, so its properties cannot be set: " + t.toString(), void 0 !== i && (t += "  to value: " + i), B(t) } function y(t, i, e, n) { e = null === e ? "*" : "string" == typeof e ? e : "function" == typeof e && "string" == typeof e.className ? e.className : "", void 0 !== n && (e += "." + n), B(e + " is not in the range " + i + ": " + t) } function v(t) { c.console && c.console.log(t) } function x() { c.console && c.console.log("Warning: List/Map/Set constructors no longer take an argument that enforces type.Instead they take an optional collection of Values to add to the collection. See 2.0 changelog for details.") } function b(t) { return "object" == typeof t && null !== t } function w(t) { return Array.isArray(t) || c.NodeList && t instanceof c.NodeList || c.HTMLCollection && t instanceof c.HTMLCollection } function k(t) { return Array.prototype.slice.call(t) } function M(t, i, e) { Array.isArray(t) ? i >= t.length ? t.push(e) : t.splice(i, 0, e) : B("Cannot insert an object into an HTMLCollection or NodeList: " + e + " at " + i) } function S(t, i) { Array.isArray(t) ? i >= t.length ? t.pop() : t.splice(i, 1) : B("Cannot remove an object from an HTMLCollection or NodeList at " + i) } function zi() { var t = E.pop(); return void 0 === t ? [] : t } function Vi(t) { t.length = 0, E.push(t) } function P(t) { if ("function" == typeof t) { if (t.className) return t.className; if (t.name) return t.name; var i = t.toString(); if ("" !== (i = i.substring(9, i.indexOf("(")).trim())) return t._className = i } else if (b(t) && t.constructor) return P(t.constructor); return typeof t } function N(t) { var i = t; return b(t) && (t.text ? i = t.text : t.name ? i = t.name : void 0 !== t.key ? i = t.key : void 0 !== t.id ? i = t.id : t.constructor === Object && (t.Text ? i = t.Text : t.Name ? i = t.Name : void 0 !== t.Key ? i = t.Key : void 0 !== t.Id ? i = t.Id : void 0 !== t.ID && (i = t.ID))), void 0 === i ? "undefined" : null === i ? "null" : i.toString() } function C(t, i) { if (t.hasOwnProperty(i)) return 1; for (t = Object.getPrototypeOf(t); t && t !== Function;) { if (t.hasOwnProperty(i)) return 1; var e = t.GA; if (e && e[i]) return 1; t = Object.getPrototypeOf(t) } } function T(t, i, e) { Object.defineProperty(Ce.prototype, t, { get: i, set: e }) } function L() { var t = z; if (0 === t.length) for (var i = c.document.getElementsByTagName("canvas"), e = i.length, n = 0; n < e; n++) { var o = i[n]; o.parentElement && o.parentElement.B && t.push(o.parentElement.B) } return t } function A(t) { for (var i = [], e = 0; e < 256; e++)i["0123456789abcdef".charAt(e >> 4) + "0123456789abcdef".charAt(15 & e)] = String.fromCharCode(e); t.length % 2 && (t = "0" + t), e = []; for (var n = 0, o = 0; o < t.length; o += 2)e[n++] = i[t.substr(o, 2)]; for (t = "" === (t = e.join("")) ? "0" : t, i = [], e = 0; e < 256; e++)i[e] = e; for (e = n = 0; e < 256; e++)n = (n + i[e] + 119) % 256, o = i[e], i[e] = i[n], i[n] = o; n = e = 0; for (var r = "", s = 0; s < t.length; s++)n = (n + i[e = (e + 1) % 256]) % 256, o = i[e], i[e] = i[n], i[n] = o, r += String.fromCharCode(t.charCodeAt(s) ^ i[(i[e] + i[n]) % 256]); return r } void 0 === c.requestAnimationFrame && (c.requestAnimationFrame = c.setImmediate); var j = void 0 !== c.navigator && 0 < c.navigator.userAgent.indexOf("MSIE 9.0"), D = void 0 !== c.navigator && 0 < c.navigator.userAgent.indexOf("MSIE 10.0"), F = void 0 !== c.navigator && 0 < c.navigator.userAgent.indexOf("Trident/7"), O = void 0 !== c.navigator && 0 < c.navigator.userAgent.indexOf("Edge/"), I = void 0 !== c.navigator && void 0 !== c.navigator.platform && 0 <= c.navigator.platform.toUpperCase().indexOf("MAC"), R = void 0 !== c.navigator && void 0 !== c.navigator.platform && null !== c.navigator.platform.match(/(iPhone|iPod|iPad)/i), E = []; Object.freeze([]); var z = []; function V(t, i, e) { Q(this), this.l = t, this.Qa = i, this.u = e } function Y(t, i) { return null == i || "" === i ? null : t[i] } function G() { this.Qw = [] } function X() { } function q() { } f.className = "Util", f.Dx = "32ab5ff3b26f42dc0ed90f21442913b5", f.adym = "gojs.net", f.vfo = "28e647fdb26e", f.className = "Util", V.prototype.toString = function () { return "EnumValue." + this.Qa }, l.Object.defineProperties(V.prototype, { classType: { get: function () { return this.l } }, name: { get: function () { return this.Qa } }, value: { get: function () { return this.u } } }), V.className = "EnumValue", G.prototype.toString = function () { return this.Qw.join("") }, G.prototype.add = function (t) { "" !== t && this.Qw.push(t) }, G.className = "StringBuilder", X.className = "PropertyCollection", q.prototype.reset = function () { }, q.prototype.next = function () { return !1 }, q.prototype.ed = function () { return !1 }, q.prototype.first = function () { return null }, q.prototype.any = function () { return !1 }, q.prototype.all = function () { return !0 }, q.prototype.each = function () { return this }, q.prototype.map = function () { return this }, q.prototype.filter = function () { return this }, q.prototype.Dd = function () { }, q.prototype.toString = function () { return "EmptyIterator" }, l.Object.defineProperties(q.prototype, { iterator: { get: function () { return this } }, count: { get: function () { return 0 } } }), q.prototype.first = q.prototype.first, q.prototype.hasNext = q.prototype.ed, q.prototype.next = q.prototype.next, q.prototype.reset = q.prototype.reset; var U; function K(t) { this.key = -1, this.value = t } function H(t) { this.pb = t, this.$e = null, t.Fa = null, this.ia = t.Aa, this.Oa = -1 } function W(t) { (this.pb = t).Zg = null, this.ia = t.Aa, this.Oa = t.j.length } function J(t) { Q(this), this.s = !1, this.j = [], this.Aa = 0, this.Zg = this.Fa = null, void 0 !== t && ("function" == typeof t || "string" == typeof t ? x() : this.addAll(t)) } function Z(t) { (this.og = t).Fa = null, this.ia = t.Aa, this.la = null } function $(t) { Q(this), this.s = !1, this.Fb = {}, this.Db = 0, this.Fa = null, this.Aa = 0, this.Ue = this.ba = null, void 0 !== t && ("function" == typeof t || "string" == typeof t ? x() : this.addAll(t)) } function Q(t) { t.__gohashid = it++ } function _(t) { var i = t.__gohashid; return void 0 === i && (i = it++, t.__gohashid = i), i } function tt(t) { return t.__gohashid } q.className = "EmptyIterator", U = new q, K.prototype.reset = function () { this.key = -1 }, K.prototype.next = function () { return -1 === this.key && !(this.key = 0) }, K.prototype.ed = function () { return this.next() }, K.prototype.first = function () { return this.key = 0, this.value }, K.prototype.any = function (t) { return this.key = -1, t(this.value) }, K.prototype.all = function (t) { return this.key = -1, t(this.value) }, K.prototype.each = function (t) { return this.key = -1, t(this.value), this }, K.prototype.map = function (t) { return new K(t(this.value)) }, K.prototype.filter = function (t) { return t(this.value) ? new K(this.value) : U }, K.prototype.Dd = function () { this.value = null }, K.prototype.toString = function () { return "SingletonIterator(" + this.value + ")" }, l.Object.defineProperties(K.prototype, { iterator: { get: function () { return this } }, count: { get: function () { return 1 } } }), K.prototype.first = K.prototype.first, K.prototype.hasNext = K.prototype.ed, K.prototype.next = K.prototype.next, K.prototype.reset = K.prototype.reset, K.className = "SingletonIterator", H.prototype.reset = function () { var t = this.pb; t.Fa = null, this.ia = t.Aa, this.Oa = -1 }, H.prototype.next = function () { var t = this.pb; if (t.Aa !== this.ia && this.key < 0) return !1; var i = (t = t.j).length, e = ++this.Oa, n = this.$e; if (null !== n) for (; e < i;) { var o = t[e]; if (n(o)) return this.key = this.Oa = e, this.value = o, !0; e++ } else { if (e < i) return this.key = e, this.value = t[e], !0; this.Dd() } return !1 }, H.prototype.ed = function () { return this.next() }, H.prototype.first = function () { var t = this.pb; this.ia = t.Aa, this.Oa = 0; var i = (t = t.j).length, e = this.$e; if (null === e) return 0 < i ? (t = t[0], this.key = 0, this.value = t) : null; for (var n = 0; n < i;) { var o = t[n]; if (e(o)) return this.key = this.Oa = n, this.value = o; n++ } return null }, H.prototype.any = function (t) { var i = this.pb; i.Fa = null, this.Oa = -1; for (var e = (i = i.j).length, n = this.$e, o = 0; o < e; o++) { var r = i[o]; if ((null === n || n(r)) && t(r)) return !0 } return !1 }, H.prototype.all = function (t) { var i = this.pb; i.Fa = null, this.Oa = -1; for (var e = (i = i.j).length, n = this.$e, o = 0; o < e; o++) { var r = i[o]; if ((null === n || n(r)) && !t(r)) return !1 } return !0 }, H.prototype.each = function (t) { var i = this.pb; i.Fa = null, this.Oa = -1; for (var e = (i = i.j).length, n = this.$e, o = 0; o < e; o++) { var r = i[o]; null !== n && !n(r) || t(r) } return this }, H.prototype.map = function (t) { var i = this.pb; i.Fa = null, this.Oa = -1; for (var e = [], n = (i = i.j).length, o = this.$e, r = 0; r < n; r++) { var s = i[r]; null !== o && !o(s) || e.push(t(s)) } return (t = new J).j = e, t.kb(), t.iterator }, H.prototype.filter = function (t) { var i = this.pb; i.Fa = null, this.Oa = -1; for (var e = [], n = (i = i.j).length, o = this.$e, r = 0; r < n; r++) { var s = i[r]; (null === o || o(s)) && t(s) && e.push(s) } return (t = new J).j = e, t.kb(), t.iterator }, H.prototype.Dd = function () { this.key = -1, this.value = null, this.ia = -1, this.$e = null, this.pb.Fa = this }, H.prototype.toString = function () { return "ListIterator@" + this.Oa + "/" + this.pb.count }, l.Object.defineProperties(H.prototype, { iterator: { get: function () { return this } }, predicate: { get: function () { return this.$e }, set: function (t) { this.$e = t } }, count: { get: function () { var t = this.$e; if (null === t) return this.pb.j.length; for (var i = 0, e = this.pb.j, n = e.length, o = 0; o < n; o++)t(e[o]) && i++; return i } } }), H.prototype.first = H.prototype.first, H.prototype.hasNext = H.prototype.ed, H.prototype.next = H.prototype.next, H.prototype.reset = H.prototype.reset, H.className = "ListIterator", W.prototype.reset = function () { var t = this.pb; t.Zg = null, this.ia = t.Aa, this.Oa = t.j.length }, W.prototype.next = function () { var t = this.pb; if (t.Aa !== this.ia && this.key < 0) return !1; var i = --this.Oa; return 0 <= i ? (this.key = i, this.value = t.j[i], !0) : (this.Dd(), !1) }, W.prototype.ed = function () { return this.next() }, W.prototype.first = function () { var t = this.pb; this.ia = t.Aa; var i = t.j; return this.Oa = t = i.length - 1, 0 <= t ? (i = i[t], this.key = t, this.value = i) : null }, W.prototype.any = function (t) { var i = this.pb; i.Zg = null; var e = (i = i.j).length; for (this.Oa = e, --e; 0 <= e; e--)if (t(i[e])) return !0; return !1 }, W.prototype.all = function (t) { var i = this.pb; i.Zg = null; var e = (i = i.j).length; for (this.Oa = e, --e; 0 <= e; e--)if (!t(i[e])) return !1; return !0 }, W.prototype.each = function (t) { var i = this.pb; i.Zg = null; var e = (i = i.j).length; for (this.Oa = e, --e; 0 <= e; e--)t(i[e]); return this }, W.prototype.map = function (t) { var i = this.pb; i.Zg = null; var e = [], n = (i = i.j).length; for (this.Oa = n, --n; 0 <= n; n--)e.push(t(i[n])); return (t = new J).j = e, t.kb(), t.iterator }, W.prototype.filter = function (t) { var i = this.pb; i.Zg = null; var e = [], n = (i = i.j).length; for (this.Oa = n, --n; 0 <= n; n--) { var o = i[n]; t(o) && e.push(o) } return (t = new J).j = e, t.kb(), t.iterator }, W.prototype.Dd = function () { this.key = -1, this.value = null, this.ia = -1, this.pb.Zg = this }, W.prototype.toString = function () { return "ListIteratorBackwards(" + this.Oa + "/" + this.pb.count + ")" }, l.Object.defineProperties(W.prototype, { iterator: { get: function () { return this } }, count: { get: function () { return this.pb.j.length } } }), W.prototype.first = W.prototype.first, W.prototype.hasNext = W.prototype.ed, W.prototype.next = W.prototype.next, W.prototype.reset = W.prototype.reset, W.className = "ListIteratorBackwards", (t = J.prototype).kb = function () { var t = this.Aa; 999999999 < ++t && (t = 0), this.Aa = t }, t.freeze = function () { return this.s = !0, this }, t.ea = function () { return this.s = !1, this }, t.toString = function () { return "List()#" + tt(this) }, t.add = function (t) { return null === t || (this.s && g(this, t), this.j.push(t), this.kb()), this }, t.push = function (t) { this.add(t) }, t.addAll = function (t) { if (null === t) return this; this.s && g(this); var i = this.j; if (w(t)) for (var e = t.length, n = 0; n < e; n++)i.push(t[n]); else for (t = t.iterator; t.next();)i.push(t.value); return this.kb(), this }, t.clear = function () { this.s && g(this), this.j.length = 0, this.kb() }, t.contains = function (t) { return null !== t && -1 !== this.j.indexOf(t) }, t.has = function (t) { return this.contains(t) }, t.indexOf = function (t) { return null === t ? -1 : this.j.indexOf(t) }, t.L = function (t) { var i = this.j; return (t < 0 || t >= i.length) && y(t, "0 <= i < length", J, "elt:i"), i[t] }, t.get = function (t) { return this.L(t) }, t.hd = function (t, i) { var e = this.j; (t < 0 || t >= e.length) && y(t, "0 <= i < length", J, "setElt:i"), this.s && g(this, t), e[t] = i }, t.set = function (t, i) { this.hd(t, i) }, t.first = function () { var t = this.j; return 0 === t.length ? null : t[0] }, t.Xb = function () { var t = this.j, i = t.length; return 0 < i ? t[i - 1] : null }, t.pop = function () { this.s && g(this); var t = this.j; return 0 < t.length ? t.pop() : null }, J.prototype.any = function (t) { for (var i = this.j, e = i.length, n = 0; n < e; n++)if (t(i[n])) return !0; return !1 }, J.prototype.all = function (t) { for (var i = this.j, e = i.length, n = 0; n < e; n++)if (!t(i[n])) return !1; return !0 }, J.prototype.each = function (t) { for (var i = this.j, e = i.length, n = 0; n < e; n++)t(i[n]); return this }, J.prototype.map = function (t) { for (var i = new J, e = [], n = this.j, o = n.length, r = 0; r < o; r++)e.push(t(n[r])); return i.j = e, i.kb(), i }, J.prototype.filter = function (t) { for (var i = new J, e = [], n = this.j, o = n.length, r = 0; r < o; r++) { var s = n[r]; t(s) && e.push(s) } return i.j = e, i.kb(), i }, (t = J.prototype).tb = function (t, i) { t < 0 && y(t, ">= 0", J, "insertAt:i"), this.s && g(this, t); var e = this.j; t >= e.length ? e.push(i) : e.splice(t, 0, i), this.kb() }, t.remove = function (t) { if (null === t) return !1; this.s && g(this, t); var i = this.j; return -1 !== (t = i.indexOf(t)) && (t === i.length - 1 ? i.pop() : i.splice(t, 1), this.kb(), !0) }, t.delete = function (t) { return this.remove(t) }, t.$a = function (t) { var i = this.j; (t < 0 || t >= i.length) && y(t, "0 <= i < length", J, "removeAt:i"), this.s && g(this, t), t === i.length - 1 ? i.pop() : i.splice(t, 1), this.kb() }, t.removeRange = function (t, i) { var e = this.j, n = e.length; if (t < 0) t = 0; else if (n <= t) return this; if (i < 0) return this; if (n <= i && (i = n - 1), i < t) return this; this.s && g(this); for (var o = t, r = i + 1; r < n;)e[o++] = e[r++]; return e.length = n - (i - t + 1), this.kb(), this }, J.prototype.copy = function () { var t = new J, i = this.j; return 0 < i.length && (t.j = Array.prototype.slice.call(i)), t }, (t = J.prototype).na = function () { for (var t = this.j, i = this.count, e = Array(i), n = 0; n < i; n++)e[n] = t[n]; return e }, t.pw = function () { for (var t = new $, i = this.j, e = this.count, n = 0; n < e; n++)t.add(i[n]); return t }, t.sort = function (t) { return this.s && g(this), this.j.sort(t), this.kb(), this }, t.ej = function (t, i, e) { var n = this.j, o = n.length; void 0 === i && (i = 0), void 0 === e && (e = o), this.s && g(this); var r = e - i; if (r <= 1) return this; if ((i < 0 || o - 1 <= i) && y(i, "0 <= from < length", J, "sortRange:from"), 2 == r) return 0 < t(e = n[i], o = n[i + 1]) && (n[i] = o, n[i + 1] = e, this.kb()), this; if (0 === i) if (o <= e) n.sort(t); else for ((i = n.slice(0, e)).sort(t), t = 0; t < e; t++)n[t] = i[t]; else if (o <= e) for ((e = n.slice(i)).sort(t), t = i; t < o; t++)n[t] = e[t - i]; else for ((o = n.slice(i, e)).sort(t), t = i; t < e; t++)n[t] = o[t - i]; return this.kb(), this }, t.reverse = function () { return this.s && g(this), this.j.reverse(), this.kb(), this }, l.Object.defineProperties(J.prototype, { _dataArray: { get: function () { return this.j } }, count: { get: function () { return this.j.length } }, size: { get: function () { return this.j.length } }, length: { get: function () { return this.j.length } }, iterator: { get: function () { if (this.j.length <= 0) return U; var t = this.Fa; return null !== t ? (t.reset(), t) : new H(this) } }, iteratorBackwards: { get: function () { if (this.j.length <= 0) return U; var t = this.Zg; return null !== t ? (t.reset(), t) : new W(this) } } }), J.prototype.reverse = J.prototype.reverse, J.prototype.sortRange = J.prototype.ej, J.prototype.sort = J.prototype.sort, J.prototype.toSet = J.prototype.pw, J.prototype.toArray = J.prototype.na, J.prototype.removeRange = J.prototype.removeRange, J.prototype.removeAt = J.prototype.$a, J.prototype.delete = J.prototype.delete, J.prototype.remove = J.prototype.remove, J.prototype.insertAt = J.prototype.tb, J.prototype.pop = J.prototype.pop, J.prototype.last = J.prototype.Xb, J.prototype.first = J.prototype.first, J.prototype.set = J.prototype.set, J.prototype.setElt = J.prototype.hd, J.prototype.get = J.prototype.get, J.prototype.elt = J.prototype.L, J.prototype.indexOf = J.prototype.indexOf, J.prototype.has = J.prototype.has, J.prototype.contains = J.prototype.contains, J.prototype.clear = J.prototype.clear, J.prototype.addAll = J.prototype.addAll, J.prototype.push = J.prototype.push, J.prototype.add = J.prototype.add, J.prototype.thaw = J.prototype.ea, J.prototype.freeze = J.prototype.freeze, J.className = "List", Z.prototype.reset = function () { var t = this.og; t.Fa = null, this.ia = t.Aa, this.la = null }, Z.prototype.next = function () { var t = this.og; if (t.Aa !== this.ia && null === this.key) return !1; var i = this.la; return null !== (i = null === i ? t.ba : i.oa) ? (this.la = i, this.value = i.value, this.key = i.key, !0) : (this.Dd(), !1) }, Z.prototype.ed = function () { return this.next() }, Z.prototype.first = function () { var t = this.og; if (this.ia = t.Aa, null === (t = t.ba)) return null; var i = (this.la = t).value; return this.key = t.key, this.value = i }, Z.prototype.any = function (t) { var i = this.og; for (this.la = i.Fa = null, i = i.ba; null !== i;) { if (t(i.value)) return !0; i = i.oa } return !1 }, Z.prototype.all = function (t) { var i = this.og; for (this.la = i.Fa = null, i = i.ba; null !== i;) { if (!t(i.value)) return !1; i = i.oa } return !0 }, Z.prototype.each = function (t) { var i = this.og; for (this.la = i.Fa = null, i = i.ba; null !== i;)t(i.value), i = i.oa; return this }, Z.prototype.map = function (t) { (e = this.og).Fa = null; for (var i = new J, e = e.ba; null !== e;)i.add(t(e.value)), e = e.oa; return i.iterator }, Z.prototype.filter = function (t) { (e = this.og).Fa = null; for (var i = new J, e = e.ba; null !== e;) { var n = e.value; t(n) && i.add(n), e = e.oa } return i.iterator }, Z.prototype.Dd = function () { this.value = this.key = null, this.ia = -1, this.og.Fa = this }, Z.prototype.toString = function () { return null !== this.la ? "SetIterator@" + this.la.value : "SetIterator" }, l.Object.defineProperties(Z.prototype, { iterator: { get: function () { return this } }, count: { get: function () { return this.og.Db } } }), Z.prototype.first = Z.prototype.first, Z.prototype.hasNext = Z.prototype.ed, Z.prototype.next = Z.prototype.next, Z.prototype.reset = Z.prototype.reset, Z.className = "SetIterator", (t = $.prototype).kb = function () { var t = this.Aa; 999999999 < ++t && (t = 0), this.Aa = t }, t.freeze = function () { return this.s = !0, this }, t.ea = function () { return this.s = !1, this }, t.toString = function () { return "Set()#" + tt(this) }, t.add = function (t) { if (null === t) return this; this.s && g(this, t); var i = t; return b(t) && (i = _(t)), void 0 === this.Fb[i] && (this.Db++, t = new rt(t, t), this.Fb[i] = t, null === (i = this.Ue) ? this.ba = t : (t.Cl = i).oa = t, this.Ue = t, this.kb()), this }, t.addAll = function (t) { if (null === t) return this; if (this.s && g(this), w(t)) for (var i = t.length, e = 0; e < i; e++)this.add(t[e]); else for (t = t.iterator; t.next();)this.add(t.value); return this }, t.contains = function (t) { if (null === t) return !1; var i = t; return (!b(t) || void 0 !== (i = tt(t))) && void 0 !== this.Fb[i] }, t.has = function (t) { return this.contains(t) }, t.Wy = function (t) { if (null === t) return !0; for (t = t.iterator; t.next();)if (!this.contains(t.value)) return !1; return !0 }, t.Xy = function (t) { if (null === t) return !0; for (t = t.iterator; t.next();)if (this.contains(t.value)) return !0; return !1 }, t.first = function () { var t = this.ba; return null === t ? null : t.value }, $.prototype.any = function (t) { for (var i = this.ba; null !== i;) { if (t(i.value)) return !0; i = i.oa } return !1 }, $.prototype.all = function (t) { for (var i = this.ba; null !== i;) { if (!t(i.value)) return !1; i = i.oa } return !0 }, $.prototype.each = function (t) { for (var i = this.ba; null !== i;)t(i.value), i = i.oa; return this }, $.prototype.map = function (t) { for (var i = new $, e = this.ba; null !== e;)i.add(t(e.value)), e = e.oa; return i }, $.prototype.filter = function (t) { for (var i = new $, e = this.ba; null !== e;) { var n = e.value; t(n) && i.add(n), e = e.oa } return i }, (t = $.prototype).remove = function (t) { if (null === t) return !1; this.s && g(this, t); var i = t; if (b(t) && void 0 === (i = tt(t))) return !1; if (void 0 === (t = this.Fb[i])) return !1; var e = t.oa, n = t.Cl; return null !== e && (e.Cl = n), null !== n && (n.oa = e), this.ba === t && (this.ba = e), this.Ue === t && (this.Ue = n), delete this.Fb[i], this.Db--, this.kb(), !0 }, t.delete = function (t) { return this.remove(t) }, t.Gq = function (t) { if (null === t) return this; if (this.s && g(this), w(t)) for (var i = t.length, e = 0; e < i; e++)this.remove(t[e]); else for (t = t.iterator; t.next();)this.remove(t.value); return this }, t.rA = function (t) { if (null === t || 0 === this.count) return this; this.s && g(this); var i = new $; i.addAll(t), t = []; for (var e = this.iterator; e.next();) { var n = e.value; i.contains(n) || t.push(n) } return this.Gq(t), this }, t.clear = function () { this.s && g(this), this.Fb = {}, this.Db = 0, null !== this.Fa && this.Fa.reset(), this.Ue = this.ba = null, this.kb() }, $.prototype.copy = function () { var t, i = new $, e = this.Fb; for (t in e) i.add(e[t].value); return i }, $.prototype.na = function () { var t, i = Array(this.Db), e = this.Fb, n = 0; for (t in e) i[n] = e[t].value, n++; return i }, $.prototype.ow = function () { var t, i = new J, e = this.Fb; for (t in e) i.add(e[t].value); return i }, l.Object.defineProperties($.prototype, { count: { get: function () { return this.Db } }, size: { get: function () { return this.Db } }, iterator: { get: function () { if (this.Db <= 0) return U; var t = this.Fa; return null !== t ? (t.reset(), t) : new Z(this) } } }), $.prototype.toList = $.prototype.ow, $.prototype.toArray = $.prototype.na, $.prototype.clear = $.prototype.clear, $.prototype.retainAll = $.prototype.rA, $.prototype.removeAll = $.prototype.Gq, $.prototype.delete = $.prototype.delete, $.prototype.remove = $.prototype.remove, $.prototype.first = $.prototype.first, $.prototype.containsAny = $.prototype.Xy, $.prototype.containsAll = $.prototype.Wy, $.prototype.has = $.prototype.has, $.prototype.contains = $.prototype.contains, $.prototype.addAll = $.prototype.addAll, $.prototype.add = $.prototype.add, $.prototype.thaw = $.prototype.ea, $.prototype.freeze = $.prototype.freeze; var it = 1; function et(t) { this.fa = t, this.ia = t.Aa, this.la = null } function nt(t) { $.call(this), Q(this), this.s = !0, this.fa = t } function ot(t) { (this.fa = t).Te = null, this.ia = t.Aa, this.la = null } function rt(t, i) { this.key = t, this.value = i, this.Cl = this.oa = null } function st(t) { (this.fa = t).Fa = null, this.ia = t.Aa, this.la = null } function at(t) { Q(this), this.s = !1, this.Fb = {}, this.Db = 0, this.Te = this.Fa = null, this.Aa = 0, this.Ue = this.ba = null, void 0 !== t && ("function" == typeof t || "string" == typeof t ? x() : this.addAll(t)) } function gi(t, i) { void 0 === t ? this.y = this.x = 0 : "number" == typeof t && "number" == typeof i ? (this.x = t, this.y = i) : B("Invalid arguments to Point constructor: " + t + ", " + i), this.s = !1 } function ht(t) { if ("string" != typeof t) return new gi; t = t.split(" "); for (var i = 0, e = 0; "" === t[i];)i++; var n = t[i++]; n && (e = parseFloat(n)); for (var o = 0; "" === t[i];)i++; return (n = t[i++]) && (o = parseFloat(n)), new gi(e, o) } function lt(t) { return t.x.toString() + " " + t.y.toString() } function ut(t, i) { if (0 === t) return 0 < i ? 90 : i < 0 ? 270 : 0; if (0 === i) return 0 < t ? 0 : 180; if (isNaN(t) || isNaN(i)) return 0; var e = 180 * Math.atan(Math.abs(i / t)) / Math.PI; return t < 0 ? e = i < 0 ? e + 180 : 180 - e : i < 0 && (e = 360 - e), e } function ct(t, i) { return i.Wd(t), t } function ft(t, i, e, n, o, r) { var s = o - e, a = r - n, h = s * s + a * a, l = -(e -= t) * s - (n -= i) * a; return l <= 0 || h <= l ? (s = o - t, a = r - i, Math.min(e * e + n * n, s * s + a * a)) : (t = s * n - a * e) * t / h } function dt(t, i, e, n) { return (t = e - t) * t + (i = n - i) * i } function pt(t, i, e, n) { return i = n - i, 0 === (t = e - t) ? 0 < i ? 90 : i < 0 ? 270 : 0 : 0 === i ? 0 < t ? 0 : 180 : isNaN(t) || isNaN(i) ? 0 : (n = 180 * Math.atan(Math.abs(i / t)) / Math.PI, t < 0 ? n = i < 0 ? n + 180 : 180 - n : i < 0 && (n = 360 - n), n) } $.className = "Set", $.uniqueHash = Q, $.hashIdUnique = _, $.hashId = tt, et.prototype.reset = function () { this.ia = this.fa.Aa, this.la = null }, et.prototype.next = function () { var t = this.fa; if (t.Aa !== this.ia && null === this.key) return !1; var i = this.la; return null !== (i = null === i ? t.ba : i.oa) ? (this.la = i, this.value = this.key = t = i.key, !0) : (this.Dd(), !1) }, et.prototype.ed = function () { return this.next() }, et.prototype.first = function () { var t = this.fa; return this.ia = t.Aa, null !== (t = t.ba) ? (this.la = t, this.value = this.key = t = t.key) : null }, et.prototype.any = function (t) { var i = this.fa; for (this.la = null, i = i.ba; null !== i;) { if (t(i.key)) return !0; i = i.oa } return !1 }, et.prototype.all = function (t) { var i = this.fa; for (this.la = null, i = i.ba; null !== i;) { if (!t(i.key)) return !1; i = i.oa } return !0 }, et.prototype.each = function (t) { var i = this.fa; for (this.la = null, i = i.ba; null !== i;)t(i.key), i = i.oa; return this }, et.prototype.map = function (t) { var i = this.fa; this.la = null; for (var e = new J, i = i.ba; null !== i;)e.add(t(i.key)), i = i.oa; return e.iterator }, et.prototype.filter = function (t) { var i = this.fa; this.la = null; for (var e = new J, i = i.ba; null !== i;) { var n = i.key; t(n) && e.add(n), i = i.oa } return e.iterator }, et.prototype.Dd = function () { this.value = this.key = null, this.ia = -1 }, et.prototype.toString = function () { return null !== this.la ? "MapKeySetIterator@" + this.la.value : "MapKeySetIterator" }, l.Object.defineProperties(et.prototype, { iterator: { get: function () { return this } }, count: { get: function () { return this.fa.Db } } }), et.prototype.first = et.prototype.first, et.prototype.hasNext = et.prototype.ed, et.prototype.next = et.prototype.next, et.prototype.reset = et.prototype.reset, et.className = "MapKeySetIterator", h(nt, $), (t = nt.prototype).freeze = function () { return this }, t.ea = function () { return this }, t.toString = function () { return "MapKeySet(" + this.fa.toString() + ")" }, t.add = function () { return B("This Set is read-only: " + this.toString()), this }, t.contains = function (t) { return this.fa.contains(t) }, t.has = function (t) { return this.contains(t) }, t.remove = function () { return B("This Set is read-only: " + this.toString()), !1 }, t.delete = function (t) { return this.remove(t) }, t.clear = function () { B("This Set is read-only: " + this.toString()) }, t.first = function () { var t = this.fa.ba; return null !== t ? t.key : null }, nt.prototype.any = function (t) { for (var i = this.fa.ba; null !== i;) { if (t(i.key)) return !0; i = i.oa } return !1 }, nt.prototype.all = function (t) { for (var i = this.fa.ba; null !== i;) { if (!t(i.key)) return !1; i = i.oa } return !0 }, nt.prototype.each = function (t) { for (var i = this.fa.ba; null !== i;)t(i.key), i = i.oa; return this }, nt.prototype.map = function (t) { for (var i = new $, e = this.fa.ba; null !== e;)i.add(t(e.key)), e = e.oa; return i }, nt.prototype.filter = function (t) { for (var i = new $, e = this.fa.ba; null !== e;) { var n = e.key; t(n) && i.add(n), e = e.oa } return i }, nt.prototype.copy = function () { return new nt(this.fa) }, nt.prototype.pw = function () { var t, i = new $, e = this.fa.Fb; for (t in e) i.add(e[t].key); return i }, nt.prototype.na = function () { var t, i = this.fa.Fb, e = Array(this.fa.Db), n = 0; for (t in i) e[n] = i[t].key, n++; return e }, nt.prototype.ow = function () { var t, i = new J, e = this.fa.Fb; for (t in e) i.add(e[t].key); return i }, l.Object.defineProperties(nt.prototype, { count: { get: function () { return this.fa.Db } }, size: { get: function () { return this.fa.Db } }, iterator: { get: function () { return this.fa.Db <= 0 ? U : new et(this.fa) } } }), nt.prototype.toList = nt.prototype.ow, nt.prototype.toArray = nt.prototype.na, nt.prototype.toSet = nt.prototype.pw, nt.prototype.first = nt.prototype.first, nt.prototype.clear = nt.prototype.clear, nt.prototype.delete = nt.prototype.delete, nt.prototype.remove = nt.prototype.remove, nt.prototype.has = nt.prototype.has, nt.prototype.contains = nt.prototype.contains, nt.prototype.add = nt.prototype.add, nt.prototype.thaw = nt.prototype.ea, nt.prototype.freeze = nt.prototype.freeze, nt.className = "MapKeySet", ot.prototype.reset = function () { var t = this.fa; t.Te = null, this.ia = t.Aa, this.la = null }, ot.prototype.next = function () { var t = this.fa; if (t.Aa !== this.ia && null === this.key) return !1; var i = this.la; return null !== (i = null === i ? t.ba : i.oa) ? (this.la = i, this.value = i.value, this.key = i.key, !0) : (this.Dd(), !1) }, ot.prototype.ed = function () { return this.next() }, ot.prototype.first = function () { var t = this.fa; if (this.ia = t.Aa, null === (t = t.ba)) return null; var i = (this.la = t).value; return this.key = t.key, this.value = i }, ot.prototype.any = function (t) { var i = this.fa; for (this.la = i.Te = null, i = i.ba; null !== i;) { if (t(i.value)) return !0; i = i.oa } return !1 }, ot.prototype.all = function (t) { var i = this.fa; for (this.la = i.Te = null, i = i.ba; null !== i;) { if (!t(i.value)) return !1; i = i.oa } return !0 }, ot.prototype.each = function (t) { var i = this.fa; for (this.la = i.Te = null, i = i.ba; null !== i;)t(i.value), i = i.oa; return this }, ot.prototype.map = function (t) { var i = this.fa; this.la = i.Te = null; for (var e = new J, i = i.ba; null !== i;)e.add(t(i.value)), i = i.oa; return e.iterator }, ot.prototype.filter = function (t) { var i = this.fa; this.la = i.Te = null; for (var e = new J, i = i.ba; null !== i;) { var n = i.value; t(n) && e.add(n), i = i.oa } return e.iterator }, ot.prototype.Dd = function () { this.value = this.key = null, this.ia = -1, this.fa.Te = this }, ot.prototype.toString = function () { return null !== this.la ? "MapValueSetIterator@" + this.la.value : "MapValueSetIterator" }, l.Object.defineProperties(ot.prototype, { iterator: { get: function () { return this } }, count: { get: function () { return this.fa.Db } } }), ot.prototype.first = ot.prototype.first, ot.prototype.hasNext = ot.prototype.ed, ot.prototype.next = ot.prototype.next, ot.prototype.reset = ot.prototype.reset, ot.className = "MapValueSetIterator", rt.prototype.toString = function () { return "{" + this.key + ":" + this.value + "}" }, rt.className = "KeyValuePair", st.prototype.reset = function () { var t = this.fa; t.Fa = null, this.ia = t.Aa, this.la = null }, st.prototype.next = function () { var t = this.fa; if (t.Aa !== this.ia && null === this.key) return !1; var i = this.la; return null !== (i = null === i ? t.ba : i.oa) ? (this.la = i, this.key = i.key, this.value = i.value, !0) : (this.Dd(), !1) }, st.prototype.ed = function () { return this.next() }, st.prototype.first = function () { var t = this.fa; return this.ia = t.Aa, null !== (t = t.ba) ? (this.la = t, this.key = t.key, this.value = t.value, t) : null }, st.prototype.any = function (t) { var i = this.fa; for (this.la = i.Fa = null, i = i.ba; null !== i;) { if (t(i)) return !0; i = i.oa } return !1 }, st.prototype.all = function (t) { var i = this.fa; for (this.la = i.Fa = null, i = i.ba; null !== i;) { if (!t(i)) return !1; i = i.oa } return !0 }, st.prototype.each = function (t) { var i = this.fa; for (this.la = i.Fa = null, i = i.ba; null !== i;)t(i), i = i.oa; return this }, st.prototype.map = function (t) { var i = this.fa; this.la = i.Fa = null; for (var e = new J, i = i.ba; null !== i;)e.add(t(i)), i = i.oa; return e.iterator }, st.prototype.filter = function (t) { var i = this.fa; this.la = i.Fa = null; for (var e = new J, i = i.ba; null !== i;)t(i) && e.add(i), i = i.oa; return e.iterator }, st.prototype.Dd = function () { this.value = this.key = null, this.ia = -1, this.fa.Fa = this }, st.prototype.toString = function () { return null !== this.la ? "MapIterator@" + this.la : "MapIterator" }, l.Object.defineProperties(st.prototype, { iterator: { get: function () { return this } }, count: { get: function () { return this.fa.Db } } }), st.prototype.first = st.prototype.first, st.prototype.hasNext = st.prototype.ed, st.prototype.next = st.prototype.next, st.prototype.reset = st.prototype.reset, st.className = "MapIterator", (t = at.prototype).kb = function () { var t = this.Aa; 999999999 < ++t && (t = 0), this.Aa = t }, t.freeze = function () { return this.s = !0, this }, t.ea = function () { return this.s = !1, this }, t.toString = function () { return "Map()#" + tt(this) }, t.add = function (t, i) { this.s && g(this, t); var e = t; b(t) && (e = _(t)); var n = this.Fb[e]; return void 0 === n ? (this.Db++, t = new rt(t, i), this.Fb[e] = t, null === (e = this.Ue) ? this.ba = t : (t.Cl = e).oa = t, this.Ue = t, this.kb()) : n.value = i, this }, t.set = function (t, i) { return this.add(t, i) }, t.addAll = function (t) { if (null === t) return this; if (w(t)) for (var i = t.length, e = 0; e < i; e++) { var n = t[e]; this.add(n.key, n.value) } else if (t instanceof at) for (t = t.iterator; t.next();)this.add(t.key, t.value); else for (t = t.iterator; t.next();)i = t.value, this.add(i.key, i.value); return this }, t.first = function () { return this.ba }, at.prototype.any = function (t) { for (var i = this.ba; null !== i;) { if (t(i)) return !0; i = i.oa } return !1 }, at.prototype.all = function (t) { for (var i = this.ba; null !== i;) { if (!t(i)) return !1; i = i.oa } return !0 }, at.prototype.each = function (t) { for (var i = this.ba; null !== i;)t(i), i = i.oa; return this }, at.prototype.map = function (t) { for (var i = new at, e = this.ba; null !== e;)i.add(e.key, t(e)), e = e.oa; return i }, at.prototype.filter = function (t) { for (var i = new at, e = this.ba; null !== e;)t(e) && i.add(e.key, e.value), e = e.oa; return i }, (t = at.prototype).contains = function (t) { var i = t; return (!b(t) || void 0 !== (i = tt(t))) && void 0 !== this.Fb[i] }, t.has = function (t) { return this.contains(t) }, t.H = function (t) { var i = t; return b(t) && void 0 === (i = tt(t)) || void 0 === (t = this.Fb[i]) ? null : t.value }, t.get = function (t) { return this.H(t) }, t.remove = function (t) { if (null === t) return !1; this.s && g(this, t); var i = t; if (b(t) && void 0 === (i = tt(t))) return !1; if (void 0 === (t = this.Fb[i])) return !1; var e = t.oa, n = t.Cl; return null !== e && (e.Cl = n), null !== n && (n.oa = e), this.ba === t && (this.ba = e), this.Ue === t && (this.Ue = n), delete this.Fb[i], this.Db--, this.kb(), !0 }, t.delete = function (t) { return this.remove(t) }, t.clear = function () { this.s && g(this), this.Fb = {}, this.Db = 0, null !== this.Fa && this.Fa.reset(), null !== this.Te && this.Te.reset(), this.Ue = this.ba = null, this.kb() }, at.prototype.copy = function () { var t, i = new at, e = this.Fb; for (t in e) { var n = e[t]; i.add(n.key, n.value) } return i }, at.prototype.na = function () { var t, i = this.Fb, e = Array(this.Db), n = 0; for (t in i) { var o = i[t]; e[n] = new rt(o.key, o.value), n++ } return e }, at.prototype.Cf = function () { return new nt(this) }, l.Object.defineProperties(at.prototype, { count: { get: function () { return this.Db } }, size: { get: function () { return this.Db } }, iterator: { get: function () { if (this.count <= 0) return U; var t = this.Fa; return null !== t ? (t.reset(), t) : new st(this) } }, iteratorKeys: { get: function () { return this.count <= 0 ? U : new et(this) } }, iteratorValues: { get: function () { if (this.count <= 0) return U; var t = this.Te; return null !== t ? (t.reset(), t) : new ot(this) } } }), at.prototype.toKeySet = at.prototype.Cf, at.prototype.toArray = at.prototype.na, at.prototype.clear = at.prototype.clear, at.prototype.delete = at.prototype.delete, at.prototype.remove = at.prototype.remove, at.prototype.get = at.prototype.get, at.prototype.getValue = at.prototype.H, at.prototype.has = at.prototype.has, at.prototype.contains = at.prototype.contains, at.prototype.first = at.prototype.first, at.prototype.addAll = at.prototype.addAll, at.prototype.set = at.prototype.set, at.prototype.add = at.prototype.add, at.prototype.thaw = at.prototype.ea, at.prototype.freeze = at.prototype.freeze, at.className = "Map", gi.prototype.assign = function (t) { return this.x = t.x, this.y = t.y, this }, gi.prototype.h = function (t, i) { return this.x = t, this.y = i, this }, gi.prototype.Cg = function (t, i) { return this.x = t, this.y = i, this }, gi.prototype.set = function (t) { return this.x = t.x, this.y = t.y, this }, gi.prototype.copy = function () { var t = new gi; return t.x = this.x, t.y = this.y, t }, (t = gi.prototype).ca = function () { return this.s = !0, Object.freeze(this), this }, t.G = function () { return this.s || Object.isFrozen(this) ? this : this.copy().freeze() }, t.freeze = function () { return this.s = !0, this }, t.ea = function () { return Object.isFrozen(this) && B("cannot thaw constant: " + this), this.s = !1, this }, t.toString = function () { return "Point(" + this.x + "," + this.y + ")" }, t.w = function (t) { return t instanceof gi && (this.x === t.x && this.y === t.y) }, t.Ri = function (t, i) { return this.x === t && this.y === i }, t.Ma = function (t) { return qi.A(this.x, t.x) && qi.A(this.y, t.y) }, t.add = function (t) { return this.x += t.x, this.y += t.y, this }, t.ae = function (t) { return this.x -= t.x, this.y -= t.y, this }, t.offset = function (t, i) { return this.x += t, this.y += i, this }, gi.prototype.rotate = function (t) { if (0 === t) return this; var i, e = this.x, n = this.y; return 0 === e && 0 === n || (360 <= t ? t -= 360 : t < 0 && (t += 360), i = 90 === t ? (t = 0, 1) : 180 === t ? (t = -1, 0) : 270 === t ? (t = 0, -1) : (i = t * Math.PI / 180, t = Math.cos(i), Math.sin(i)), this.x = t * e - i * n, this.y = i * e + t * n), this }, (t = gi.prototype).scale = function (t, i) { return this.x *= t, this.y *= i, this }, t.Ce = function (t) { var i = t.x - this.x; return i * i + (t = t.y - this.y) * t }, t.dd = function (t, i) { return (t -= this.x) * t + (i -= this.y) * i }, t.normalize = function () { var t = this.x, i = this.y, e = Math.sqrt(t * t + i * i); return 0 < e && (this.x = t / e, this.y = i / e), this }, t.Sa = function (t) { return ut(t.x - this.x, t.y - this.y) }, t.direction = function (t, i) { return ut(t - this.x, i - this.y) }, t.kA = function (t, i, e, n) { return qi.Ih(t, i, e, n, this.x, this.y, this), this }, t.lA = function (t, i) { return qi.Ih(t.x, t.y, i.x, i.y, this.x, this.y, this), this }, t.xA = function (t, i, e, n) { return qi.nq(this.x, this.y, t, i, e, n, this), this }, t.yA = function (t, i) { return qi.nq(this.x, this.y, t.x, t.y, i.width, i.height, this), this }, t.dj = function (t, i) { return this.x = t.x + i.x * t.width + i.offsetX, this.y = t.y + i.y * t.height + i.offsetY, this }, t.xk = function (t, i, e, n, o) { return this.x = t + o.x * e + o.offsetX, this.y = i + o.y * n + o.offsetY, this }, t.transform = function (t) { return t.ra(this), this }, t.v = function () { return isFinite(this.x) && isFinite(this.y) }, gi.alloc = function () { var t = Ct.pop(); return void 0 === t ? new gi : t }, gi.allocAt = function (t, i) { var e = Ct.pop(); return void 0 === e ? new gi(t, i) : (e.x = t, e.y = i, e) }, gi.free = function (t) { Ct.push(t) }, gi.prototype.isReal = gi.prototype.v, gi.prototype.setSpot = gi.prototype.xk, gi.prototype.setRectSpot = gi.prototype.dj, gi.prototype.snapToGridPoint = gi.prototype.yA, gi.prototype.snapToGrid = gi.prototype.xA, gi.prototype.projectOntoLineSegmentPoint = gi.prototype.lA, gi.prototype.projectOntoLineSegment = gi.prototype.kA, gi.intersectingLineSegments = function (t, i, e, n, o, r, s, a) { return qi.tq(t, i, e, n, o, r, s, a) }, gi.prototype.direction = gi.prototype.direction, gi.prototype.directionPoint = gi.prototype.Sa, gi.prototype.normalize = gi.prototype.normalize, gi.prototype.distanceSquared = gi.prototype.dd, gi.prototype.distanceSquaredPoint = gi.prototype.Ce, gi.prototype.scale = gi.prototype.scale, gi.prototype.rotate = gi.prototype.rotate, gi.prototype.offset = gi.prototype.offset, gi.prototype.subtract = gi.prototype.ae, gi.prototype.add = gi.prototype.add, gi.prototype.equalsApprox = gi.prototype.Ma, gi.prototype.equalTo = gi.prototype.Ri, gi.prototype.equals = gi.prototype.w, gi.prototype.set = gi.prototype.set, gi.prototype.setTo = gi.prototype.Cg; var gt, yt, mt, vt, xt, bt, wt, kt = null, Mt = null, St = null, Pt = null, Nt = null, Ct = []; function Yi(t, i) { void 0 === t ? this.height = this.width = 0 : "number" == typeof t && (0 <= t || isNaN(t)) && "number" == typeof i && (0 <= i || isNaN(i)) ? (this.width = t, this.height = i) : B("Invalid arguments to Size constructor: " + t + ", " + i), this.s = !1 } function Tt(t) { if ("string" != typeof t) return new Yi; t = t.split(" "); for (var i = 0, e = 0; "" === t[i];)i++; var n = t[i++]; n && (e = parseFloat(n)); for (var o = 0; "" === t[i];)i++; return (n = t[i++]) && (o = parseFloat(n)), new Yi(e, o) } function Lt(t) { return t.width.toString() + " " + t.height.toString() } gi.className = "Point", gi.parse = ht, gi.stringify = lt, gi.distanceLineSegmentSquared = ft, gi.distanceSquared = dt, gi.direction = pt, gi.Origin = kt = new gi(0, 0).ca(), gi.InfiniteTopLeft = Mt = new gi(-1 / 0, -1 / 0).ca(), gi.InfiniteBottomRight = St = new gi(1 / 0, 1 / 0).ca(), gi.SixPoint = Pt = new gi(6, 6).ca(), gi.NoPoint = Nt = new gi(NaN, NaN).ca(), gi.parse = ht, gi.stringify = lt, gi.distanceLineSegmentSquared = ft, gi.distanceSquared = dt, gi.direction = pt, Yi.prototype.assign = function (t) { return this.width = t.width, this.height = t.height, this }, Yi.prototype.h = function (t, i) { return this.width = t, this.height = i, this }, Yi.prototype.Cg = function (t, i) { return this.width = t, this.height = i, this }, Yi.prototype.set = function (t) { return this.width = t.width, this.height = t.height, this }, Yi.prototype.copy = function () { var t = new Yi; return t.width = this.width, t.height = this.height, t }, (t = Yi.prototype).ca = function () { return this.s = !0, Object.freeze(this), this }, t.G = function () { return this.s || Object.isFrozen(this) ? this : this.copy().freeze() }, t.freeze = function () { return this.s = !0, this }, t.ea = function () { return Object.isFrozen(this) && B("cannot thaw constant: " + this), this.s = !1, this }, t.toString = function () { return "Size(" + this.width + "," + this.height + ")" }, t.w = function (t) { return t instanceof Yi && (this.width === t.width && this.height === t.height) }, t.Ri = function (t, i) { return this.width === t && this.height === i }, t.Ma = function (t) { return qi.A(this.width, t.width) && qi.A(this.height, t.height) }, t.v = function () { return isFinite(this.width) && isFinite(this.height) }, Yi.alloc = function () { var t = At.pop(); return void 0 === t ? new Yi : t }, Yi.free = function (t) { At.push(t) }, Yi.prototype.isReal = Yi.prototype.v, Yi.prototype.equalsApprox = Yi.prototype.Ma, Yi.prototype.equalTo = Yi.prototype.Ri, Yi.prototype.equals = Yi.prototype.w, Yi.prototype.set = Yi.prototype.set, Yi.prototype.setTo = Yi.prototype.Cg; var At = []; function yi(t, i, e, n) { void 0 === t ? this.height = this.width = this.y = this.x = 0 : t instanceof gi ? (e = t.x, t = t.y, i instanceof gi ? (n = i.x, i = i.y, this.x = Math.min(e, n), this.y = Math.min(t, i), this.width = Math.abs(e - n), this.height = Math.abs(t - i)) : i instanceof Yi ? (this.x = e, this.y = t, this.width = i.width, this.height = i.height) : B("Incorrect arguments supplied to Rect constructor")) : "number" == typeof t && "number" == typeof i && "number" == typeof e && (0 <= e || isNaN(e)) && "number" == typeof n && (0 <= n || isNaN(n)) ? (this.x = t, this.y = i, this.width = e, this.height = n) : B("Invalid arguments to Rect constructor: " + t + ", " + i + ", " + e + ", " + n), this.s = !1 } function jt(t, i, e) { t.width = i, t.height = e } function Dt(t) { if ("string" != typeof t) return new yi; t = t.split(" "); for (var i = 0, e = 0; "" === t[i];)i++; var n = t[i++]; n && (e = parseFloat(n)); for (var o = 0; "" === t[i];)i++; (n = t[i++]) && (o = parseFloat(n)); for (var r = 0; "" === t[i];)i++; (n = t[i++]) && (r = parseFloat(n)); for (var s = 0; "" === t[i];)i++; return (n = t[i++]) && (s = parseFloat(n)), new yi(e, o, r, s) } function Ft(t) { return t.x.toString() + " " + t.y.toString() + " " + t.width.toString() + " " + t.height.toString() } function Ot(t, i) { return qi.$(t.x, i.x) && qi.$(t.y, i.y) && qi.$(t.width, i.width) && qi.$(t.height, i.height) } function Bt(t, i, e, n, o) { var r = t.width; return e + o <= -r ? (t.x += r / 2, t.width = 0) : (t.x -= o, t.width += e + o), i + n <= -(e = t.height) ? (t.y += e / 2, t.height = 0) : (t.y -= i, t.height += i + n), t } function It(t, i, e, n, o) { var r = Math.max(t.x, i), s = Math.max(t.y, e); return i = Math.min(t.x + t.width, i + n), e = Math.min(t.y + t.height, e + o), t.x = r, t.y = s, t.width = Math.max(0, i - r), t.height = Math.max(0, e - s), t } function Rt(t, i) { var e = t.width, n = t.x, o = i.x - 10; return !(n > i.width + 10 + 10 + o || e + n < o) && (e = t.height, t = t.y, n = i.y - 10, !(t > i.height + 10 + 10 + n || e + t < n)) } function mi(t, i, e, n, o) { var r = Math.min(t.x, i), s = Math.min(t.y, e); return i = Math.max(t.x + t.width, i + n), e = Math.max(t.y + t.height, e + o), t.x = r, t.y = s, t.width = i - r, t.height = e - s, t } function Et(t, i, e, n, o, r, s, a) { return void 0 === s && (s = 0), void 0 === a && (a = 0), t <= o && o + s <= t + e && i <= r && r + a <= i + n } function zt(t, i, e, n, o, r, s, a) { return !(s + o < t || e + t < o) && !(a + r < i || n + i < r) } Yi.className = "Size", Yi.parse = Tt, Yi.stringify = Lt, Yi.ZeroSize = gt = new Yi(0, 0).ca(), Yi.OneSize = yt = new Yi(1, 1).ca(), Yi.SixSize = mt = new Yi(6, 6).ca(), Yi.EightSize = vt = new Yi(8, 8).ca(), Yi.TenSize = xt = new Yi(10, 10).ca(), Yi.InfiniteSize = bt = new Yi(1 / 0, 1 / 0).ca(), Yi.NoSize = wt = new Yi(NaN, NaN).ca(), Yi.parse = Tt, Yi.stringify = Lt, (t = yi.prototype).assign = function (t) { return this.x = t.x, this.y = t.y, this.width = t.width, this.height = t.height, this }, t.h = function (t, i, e, n) { return this.x = t, this.y = i, this.width = e, this.height = n, this }, t.Cg = function (t, i, e, n) { return this.x = t, this.y = i, this.width = e, this.height = n, this }, t.set = function (t) { return this.x = t.x, this.y = t.y, this.width = t.width, this.height = t.height, this }, t.jd = function (t) { return this.x = t.x, this.y = t.y, this }, t.vA = function (t) { return this.width = t.width, this.height = t.height, this }, yi.prototype.copy = function () { var t = new yi; return t.x = this.x, t.y = this.y, t.width = this.width, t.height = this.height, t }, (t = yi.prototype).ca = function () { return this.s = !0, Object.freeze(this), this }, t.G = function () { return this.s || Object.isFrozen(this) ? this : this.copy().freeze() }, t.freeze = function () { return this.s = !0, this }, t.ea = function () { return Object.isFrozen(this) && B("cannot thaw constant: " + this), this.s = !1, this }, t.toString = function () { return "Rect(" + this.x + "," + this.y + "," + this.width + "," + this.height + ")" }, t.w = function (t) { return t instanceof yi && (this.x === t.x && this.y === t.y && this.width === t.width && this.height === t.height) }, t.Ri = function (t, i, e, n) { return this.x === t && this.y === i && this.width === e && this.height === n }, t.Ma = function (t) { return qi.A(this.x, t.x) && qi.A(this.y, t.y) && qi.A(this.width, t.width) && qi.A(this.height, t.height) }, t.aa = function (t) { return this.x <= t.x && this.x + this.width >= t.x && this.y <= t.y && this.y + this.height >= t.y }, t.Be = function (t) { return this.x <= t.x && t.x + t.width <= this.x + this.width && this.y <= t.y && t.y + t.height <= this.y + this.height }, t.contains = function (t, i, e, n) { return void 0 === e && (e = 0), void 0 === n && (n = 0), this.x <= t && t + e <= this.x + this.width && this.y <= i && i + n <= this.y + this.height }, t.offset = function (t, i) { return this.x += t, this.y += i, this }, t.Wc = function (t, i) { return Bt(this, i, t, i, t) }, t.eq = function (t) { return Bt(this, t.top, t.right, t.bottom, t.left) }, t.nw = function (t) { return Bt(this, -t.top, -t.right, -t.bottom, -t.left) }, t.Oz = function (t, i, e, n) { return Bt(this, t, i, e, n) }, t.Sz = function (t) { return It(this, t.x, t.y, t.width, t.height) }, t.Hv = function (t, i, e, n) { return It(this, t, i, e, n) }, t.Gc = function (t) { return this.Iv(t.x, t.y, t.width, t.height) }, t.Iv = function (t, i, e, n) { var o = this.width, r = this.x; return !(1 / 0 !== o && 1 / 0 !== e && (o += r, e += t, isNaN(e) || isNaN(o) || e < r || o < t)) && (t = this.height, e = this.y, !(1 / 0 !== t && 1 / 0 !== n && (t += e, n += i, isNaN(n) || isNaN(t) || n < e || t < i))) }, t.Ie = function (t) { return mi(this, t.x, t.y, 0, 0) }, t.Hc = function (t) { return mi(this, t.x, t.y, t.width, t.height) }, t.uw = function (t, i, e, n) { return void 0 === e && (e = 0), void 0 === n && (n = 0), mi(this, t, i, e, n) }, t.xk = function (t, i, e) { return this.x = t - e.offsetX - e.x * this.width, this.y = i - e.offsetY - e.y * this.height, this }, t.v = function () { return isFinite(this.x) && isFinite(this.y) && isFinite(this.width) && isFinite(this.height) }, t.Uz = function () { return 0 === this.width && 0 === this.height }, yi.alloc = function () { var t = Gt.pop(); return void 0 === t ? new yi : t }, yi.allocAt = function (t, i, e, n) { var o = Gt.pop(); return void 0 === o ? new yi(t, i, e, n) : o.h(t, i, e, n) }, yi.free = function (t) { Gt.push(t) }, l.Object.defineProperties(yi.prototype, { left: { get: function () { return this.x }, set: function (t) { this.x = t } }, top: { get: function () { return this.y }, set: function (t) { this.y = t } }, right: { get: function () { return this.x + this.width }, set: function (t) { this.x += t - (this.x + this.width) } }, bottom: { get: function () { return this.y + this.height }, set: function (t) { this.y += t - (this.y + this.height) } }, position: { get: function () { return new gi(this.x, this.y) }, set: function (t) { this.x = t.x, this.y = t.y } }, size: { get: function () { return new Yi(this.width, this.height) }, set: function (t) { this.width = t.width, this.height = t.height } }, center: { get: function () { return new gi(this.x + this.width / 2, this.y + this.height / 2) }, set: function (t) { this.x = t.x - this.width / 2, this.y = t.y - this.height / 2 } }, centerX: { get: function () { return this.x + this.width / 2 }, set: function (t) { this.x = t - this.width / 2 } }, centerY: { get: function () { return this.y + this.height / 2 }, set: function (t) { this.y = t - this.height / 2 } } }), yi.prototype.isEmpty = yi.prototype.Uz, yi.prototype.isReal = yi.prototype.v, yi.intersectsLineSegment = function (t, i, e, n, o, r, s, a) { return qi.Tx(t, i, e, n, o, r, s, a) }, yi.prototype.setSpot = yi.prototype.xk, yi.prototype.union = yi.prototype.uw, yi.prototype.unionRect = yi.prototype.Hc, yi.prototype.unionPoint = yi.prototype.Ie, yi.prototype.intersects = yi.prototype.Iv, yi.prototype.intersectsRect = yi.prototype.Gc, yi.prototype.intersect = yi.prototype.Hv, yi.prototype.intersectRect = yi.prototype.Sz, yi.prototype.grow = yi.prototype.Oz, yi.prototype.subtractMargin = yi.prototype.nw, yi.prototype.addMargin = yi.prototype.eq, yi.prototype.inflate = yi.prototype.Wc, yi.prototype.offset = yi.prototype.offset, yi.prototype.contains = yi.prototype.contains, yi.prototype.containsRect = yi.prototype.Be, yi.prototype.containsPoint = yi.prototype.aa, yi.prototype.equalsApprox = yi.prototype.Ma, yi.prototype.equalTo = yi.prototype.Ri, yi.prototype.equals = yi.prototype.w, yi.prototype.setSize = yi.prototype.vA, yi.prototype.setPoint = yi.prototype.jd, yi.prototype.set = yi.prototype.set, yi.prototype.setTo = yi.prototype.Cg; var Vt, Yt = null, Gt = []; function Xt(t, i, e, n) { void 0 === t ? this.left = this.bottom = this.right = this.top = 0 : void 0 === i ? this.left = this.bottom = this.right = this.top = t : void 0 === e ? (this.top = t, this.right = i, this.bottom = t, this.left = i) : void 0 !== n ? (this.top = t, this.right = i, this.bottom = e, this.left = n) : B("Invalid arguments to Margin constructor: " + t + ", " + i + ", " + e + ", " + n), this.s = !1 } function qt(t) { if ("string" != typeof t) return new Xt; t = t.split(" "); for (var i = 0, e = NaN; "" === t[i];)i++; var n = t[i++]; if (n && (e = parseFloat(n)), isNaN(e)) return new Xt; for (var o = NaN; "" === t[i];)i++; if ((n = t[i++]) && (o = parseFloat(n)), isNaN(o)) return new Xt(e); for (var r = NaN; "" === t[i];)i++; if ((n = t[i++]) && (r = parseFloat(n)), isNaN(r)) return new Xt(e, o); for (var s = NaN; "" === t[i];)i++; return (n = t[i++]) && (s = parseFloat(n)), isNaN(s) ? new Xt(e, o) : new Xt(e, o, r, s) } function Ut(t) { return t.top.toString() + " " + t.right.toString() + " " + t.bottom.toString() + " " + t.left.toString() } yi.className = "Rect", yi.parse = Dt, yi.stringify = Ft, yi.contains = Et, yi.intersects = zt, yi.ZeroRect = Vt = new yi(0, 0, 0, 0).ca(), yi.NoRect = Yt = new yi(NaN, NaN, NaN, NaN).ca(), yi.parse = Dt, yi.stringify = Ft, yi.contains = Et, yi.intersects = zt, Xt.prototype.assign = function (t) { return this.top = t.top, this.right = t.right, this.bottom = t.bottom, this.left = t.left, this }, Xt.prototype.Cg = function (t, i, e, n) { return this.top = t, this.right = i, this.bottom = e, this.left = n, this }, Xt.prototype.set = function (t) { return this.top = t.top, this.right = t.right, this.bottom = t.bottom, this.left = t.left, this }, Xt.prototype.copy = function () { var t = new Xt; return t.top = this.top, t.right = this.right, t.bottom = this.bottom, t.left = this.left, t }, (t = Xt.prototype).ca = function () { return this.s = !0, Object.freeze(this), this }, t.G = function () { return this.s || Object.isFrozen(this) ? this : this.copy().freeze() }, t.freeze = function () { return this.s = !0, this }, t.ea = function () { return Object.isFrozen(this) && B("cannot thaw constant: " + this), this.s = !1, this }, t.toString = function () { return "Margin(" + this.top + "," + this.right + "," + this.bottom + "," + this.left + ")" }, t.w = function (t) { return t instanceof Xt && (this.top === t.top && this.right === t.right && this.bottom === t.bottom && this.left === t.left) }, t.Ri = function (t, i, e, n) { return this.top === t && this.right === i && this.bottom === e && this.left === n }, t.Ma = function (t) { return qi.A(this.top, t.top) && qi.A(this.right, t.right) && qi.A(this.bottom, t.bottom) && qi.A(this.left, t.left) }, t.v = function () { return isFinite(this.top) && isFinite(this.right) && isFinite(this.bottom) && isFinite(this.left) }, Xt.alloc = function () { var t = Fi.pop(); return void 0 === t ? new Xt : t }, Xt.free = function (t) { Fi.push(t) }, Xt.prototype.isReal = Xt.prototype.v, Xt.prototype.equalsApprox = Xt.prototype.Ma, Xt.prototype.equalTo = Xt.prototype.Ri, Xt.prototype.equals = Xt.prototype.w, Xt.prototype.set = Xt.prototype.set, Xt.prototype.setTo = Xt.prototype.Cg; var Kt, Ht, vi, Wt, Jt, Zt, $t, Qt, _t, ti, ii, ei, ni, oi, ri, si, ai, hi, li, ui, ci, fi, di, pi, xi, bi, wi, ki, Mi, Si, Pi, Ni, Ci, Ti, Li, Ai, ji = null, Di = null, Fi = []; function Oi(t, i, e, n) { void 0 === t ? this.offsetY = this.offsetX = this.y = this.x = 0 : (void 0 === i && (i = 0), void 0 === e && (e = 0), void 0 === n && (n = 0), this.x = t, this.y = i, this.offsetX = e, this.offsetY = n), this.s = !1 } function Bi(t, i) { return t.x = NaN, t.y = NaN, t.offsetX = i, t } function Ii(t) { if ("string" != typeof t) return new Oi; if ("None" === (t = t.trim())) return Kt; if ("TopLeft" === t) return Ht; if ("Top" === t || "TopCenter" === t || "MiddleTop" === t) return vi; if ("TopRight" === t) return Wt; if ("Left" === t || "LeftCenter" === t || "MiddleLeft" === t) return Jt; if ("Center" === t) return Zt; if ("Right" === t || "RightCenter" === t || "MiddleRight" === t) return $t; if ("BottomLeft" === t) return Qt; if ("Bottom" === t || "BottomCenter" === t || "MiddleBottom" === t) return _t; if ("BottomRight" === t) return ti; if ("TopSide" === t) return ii; if ("LeftSide" === t) return ei; if ("RightSide" === t) return ni; if ("BottomSide" === t) return oi; if ("TopBottomSides" === t) return ri; if ("LeftRightSides" === t) return si; if ("TopLeftSides" === t) return ai; if ("TopRightSides" === t) return hi; if ("BottomLeftSides" === t) return li; if ("BottomRightSides" === t) return ui; if ("NotTopSide" === t) return ci; if ("NotLeftSide" === t) return fi; if ("NotRightSide" === t) return di; if ("NotBottomSide" === t) return pi; if ("AllSides" === t) return xi; if ("Default" === t) return bi; t = t.split(" "); for (var i = 0, e = 0; "" === t[i];)i++; var n = t[i++]; void 0 !== n && 0 < n.length && (e = parseFloat(n)); for (var o = 0; "" === t[i];)i++; void 0 !== (n = t[i++]) && 0 < n.length && (o = parseFloat(n)); for (var r = 0; "" === t[i];)i++; void 0 !== (n = t[i++]) && 0 < n.length && (r = parseFloat(n)); for (var s = 0; "" === t[i];)i++; return void 0 !== (n = t[i++]) && 0 < n.length && (s = parseFloat(n)), new Oi(e, o, r, s) } function Ri(t) { return t.gb() ? t.x.toString() + " " + t.y.toString() + " " + t.offsetX.toString() + " " + t.offsetY.toString() : t.toString() } Xt.className = "Margin", Xt.parse = qt, Xt.stringify = Ut, Xt.ZeroMargin = ji = new Xt(0, 0, 0, 0).ca(), Xt.TwoMargin = Di = new Xt(2, 2, 2, 2).ca(), Xt.parse = qt, Xt.stringify = Ut, Oi.prototype.assign = function (t) { return this.x = t.x, this.y = t.y, this.offsetX = t.offsetX, this.offsetY = t.offsetY, this }, Oi.prototype.Cg = function (t, i, e, n) { return this.x = t, this.y = i, this.offsetX = e, this.offsetY = n, this }, Oi.prototype.set = function (t) { return this.x = t.x, this.y = t.y, this.offsetX = t.offsetX, this.offsetY = t.offsetY, this }, Oi.prototype.copy = function () { var t = new Oi; return t.x = this.x, t.y = this.y, t.offsetX = this.offsetX, t.offsetY = this.offsetY, t }, (t = Oi.prototype).ca = function () { return this.s = !0, Object.freeze(this), this }, t.G = function () { return this.s || Object.isFrozen(this) ? this : this.copy().freeze() }, t.freeze = function () { return this.s = !0, this }, t.ea = function () { return Object.isFrozen(this) && B("cannot thaw constant: " + this), this.s = !1, this }, t.toString = function () { return this.gb() ? 0 === this.offsetX && 0 === this.offsetY ? "Spot(" + this.x + "," + this.y + ")" : "Spot(" + this.x + "," + this.y + "," + this.offsetX + "," + this.offsetY + ")" : this.w(Kt) ? "None" : this.w(Ht) ? "TopLeft" : this.w(vi) ? "Top" : this.w(Wt) ? "TopRight" : this.w(Jt) ? "Left" : this.w(Zt) ? "Center" : this.w($t) ? "Right" : this.w(Qt) ? "BottomLeft" : this.w(_t) ? "Bottom" : this.w(ti) ? "BottomRight" : this.w(ii) ? "TopSide" : this.w(ei) ? "LeftSide" : this.w(ni) ? "RightSide" : this.w(oi) ? "BottomSide" : this.w(ri) ? "TopBottomSides" : this.w(si) ? "LeftRightSides" : this.w(ai) ? "TopLeftSides" : this.w(hi) ? "TopRightSides" : this.w(li) ? "BottomLeftSides" : this.w(ui) ? "BottomRightSides" : this.w(ci) ? "NotTopSide" : this.w(fi) ? "NotLeftSide" : this.w(di) ? "NotRightSide" : this.w(pi) ? "NotBottomSide" : this.w(xi) ? "AllSides" : this.w(bi) ? "Default" : "None" }, t.w = function (t) { return t instanceof Oi && ((this.x === t.x || isNaN(this.x) && isNaN(t.x)) && (this.y === t.y || isNaN(this.y) && isNaN(t.y)) && this.offsetX === t.offsetX && this.offsetY === t.offsetY) }, t.Tv = function () { return new Oi(.5 - (this.x - .5), .5 - (this.y - .5), -this.offsetX, -this.offsetY) }, t.wf = function (t) { if (!this.gd()) return !1; if (!t.gd()) if (t.w(wi)) t = ei; else if (t.w(ki)) t = ni; else if (t.w(Mi)) t = ii; else { if (!t.w(Si)) return !1; t = oi } return t = t.offsetY, (this.offsetY & t) === t }, t.gb = function () { return !isNaN(this.x) && !isNaN(this.y) }, t.jc = function () { return isNaN(this.x) || isNaN(this.y) }, t.gd = function () { return isNaN(this.x) && isNaN(this.y) && 1 === this.offsetX && 0 !== this.offsetY }, t.yt = function () { return isNaN(this.x) && isNaN(this.y) && 0 === this.offsetX && 0 === this.offsetY }, t.Mb = function () { return isNaN(this.x) && isNaN(this.y) && -1 === this.offsetX && 0 === this.offsetY }, Oi.alloc = function () { var t = Ei.pop(); return void 0 === t ? new Oi : t }, Oi.free = function (t) { Ei.push(t) }, Oi.prototype.isDefault = Oi.prototype.Mb, Oi.prototype.isNone = Oi.prototype.yt, Oi.prototype.isSide = Oi.prototype.gd, Oi.prototype.isNoSpot = Oi.prototype.jc, Oi.prototype.isSpot = Oi.prototype.gb, Oi.prototype.includesSide = Oi.prototype.wf, Oi.prototype.opposite = Oi.prototype.Tv, Oi.prototype.equals = Oi.prototype.w, Oi.prototype.set = Oi.prototype.set, Oi.prototype.setTo = Oi.prototype.Cg; var Ei = []; function Gi() { this.m11 = 1, this.m21 = this.m12 = 0, this.m22 = 1, this.dy = this.dx = 0 } Oi.className = "Spot", Oi.parse = Ii, Oi.stringify = Ri, Oi.None = Kt = Bi(new Oi(0, 0, 0, 0), 0).ca(), Oi.Default = bi = Bi(new Oi(0, 0, -1, 0), -1).ca(), Oi.TopLeft = Ht = new Oi(0, 0, 0, 0).ca(), Oi.TopCenter = vi = new Oi(.5, 0, 0, 0).ca(), Oi.TopRight = Wt = new Oi(1, 0, 0, 0).ca(), Oi.LeftCenter = Jt = new Oi(0, .5, 0, 0).ca(), Oi.Center = Zt = new Oi(.5, .5, 0, 0).ca(), Oi.RightCenter = $t = new Oi(1, .5, 0, 0).ca(), Oi.BottomLeft = Qt = new Oi(0, 1, 0, 0).ca(), Oi.BottomCenter = _t = new Oi(.5, 1, 0, 0).ca(), Oi.BottomRight = ti = new Oi(1, 1, 0, 0).ca(), Oi.MiddleTop = Pi = vi, Oi.MiddleLeft = Ni = Jt, Oi.MiddleRight = Ci = $t, Oi.MiddleBottom = Ti = _t, Oi.Top = Mi = vi, Oi.Left = wi = Jt, Oi.Right = ki = $t, Oi.Bottom = Si = _t, Oi.TopSide = ii = Bi(new Oi(0, 0, 1, 1), 1).ca(), Oi.LeftSide = ei = Bi(new Oi(0, 0, 1, 2), 1).ca(), Oi.RightSide = ni = Bi(new Oi(0, 0, 1, 4), 1).ca(), Oi.BottomSide = oi = Bi(new Oi(0, 0, 1, 8), 1).ca(), Oi.TopBottomSides = ri = Bi(new Oi(0, 0, 1, 9), 1).ca(), Oi.LeftRightSides = si = Bi(new Oi(0, 0, 1, 6), 1).ca(), Oi.TopLeftSides = ai = Bi(new Oi(0, 0, 1, 3), 1).ca(), Oi.TopRightSides = hi = Bi(new Oi(0, 0, 1, 5), 1).ca(), Oi.BottomLeftSides = li = Bi(new Oi(0, 0, 1, 10), 1).ca(), Oi.BottomRightSides = ui = Bi(new Oi(0, 0, 1, 12), 1).ca(), Oi.NotTopSide = ci = Bi(new Oi(0, 0, 1, 14), 1).ca(), Oi.NotLeftSide = fi = Bi(new Oi(0, 0, 1, 13), 1).ca(), Oi.NotRightSide = di = Bi(new Oi(0, 0, 1, 11), 1).ca(), Oi.NotBottomSide = pi = Bi(new Oi(0, 0, 1, 7), 1).ca(), Oi.AllSides = xi = Bi(new Oi(0, 0, 1, 15), 1).ca(), Li = new Oi(.156, .156).ca(), Ai = new Oi(.844, .844).ca(), Oi.parse = Ii, Oi.stringify = Ri, Gi.prototype.set = function (t) { return this.m11 = t.m11, this.m12 = t.m12, this.m21 = t.m21, this.m22 = t.m22, this.dx = t.dx, this.dy = t.dy, this }, Gi.prototype.copy = function () { var t = new Gi; return t.m11 = this.m11, t.m12 = this.m12, t.m21 = this.m21, t.m22 = this.m22, t.dx = this.dx, t.dy = this.dy, t }, (t = Gi.prototype).toString = function () { return "Transform(" + this.m11 + "," + this.m12 + "," + this.m21 + "," + this.m22 + "," + this.dx + "," + this.dy + ")" }, t.w = function (t) { return this.m11 === t.m11 && this.m12 === t.m12 && this.m21 === t.m21 && this.m22 === t.m22 && this.dx === t.dx && this.dy === t.dy }, t.wt = function () { return 0 === this.dx && 0 === this.dy && 1 === this.m11 && 0 === this.m12 && 0 === this.m21 && 1 === this.m22 }, t.reset = function () { return this.m11 = 1, this.m21 = this.m12 = 0, this.m22 = 1, this.dy = this.dx = 0, this }, t.multiply = function (t) { var i = this.m11 * t.m11 + this.m21 * t.m12, e = this.m12 * t.m11 + this.m22 * t.m12, n = this.m11 * t.m21 + this.m21 * t.m22, o = this.m12 * t.m21 + this.m22 * t.m22; return this.dx = this.m11 * t.dx + this.m21 * t.dy + this.dx, this.dy = this.m12 * t.dx + this.m22 * t.dy + this.dy, this.m11 = i, this.m12 = e, this.m21 = n, this.m22 = o, this }, t.Pv = function (t) { var i = 1 / (t.m11 * t.m22 - t.m12 * t.m21), e = t.m22 * i, n = -t.m12 * i, o = -t.m21 * i, r = t.m11 * i, s = i * (t.m21 * t.dy - t.m22 * t.dx); return t = i * (t.m12 * t.dx - t.m11 * t.dy), i = this.m11 * e + this.m21 * n, e = this.m12 * e + this.m22 * n, n = this.m11 * o + this.m21 * r, o = this.m12 * o + this.m22 * r, this.dx = this.m11 * s + this.m21 * t + this.dx, this.dy = this.m12 * s + this.m22 * t + this.dy, this.m11 = i, this.m12 = e, this.m21 = n, this.m22 = o, this }, t.vt = function () { var t = 1 / (this.m11 * this.m22 - this.m12 * this.m21), i = -this.m12 * t, e = -this.m21 * t, n = this.m11 * t, o = t * (this.m21 * this.dy - this.m22 * this.dx), r = t * (this.m12 * this.dx - this.m11 * this.dy); return this.m11 = this.m22 * t, this.m12 = i, this.m21 = e, this.m22 = n, this.dx = o, this.dy = r, this }, Gi.prototype.rotate = function (t, i, e) { if (360 <= t ? t -= 360 : t < 0 && (t += 360), 0 === t) return this; var n; this.translate(i, e), n = 90 === t ? (t = 0, 1) : 180 === t ? (t = -1, 0) : 270 === t ? (t = 0, -1) : (n = t * Math.PI / 180, t = Math.cos(n), Math.sin(n)); var o = this.m12 * t + this.m22 * n, r = this.m11 * -n + this.m21 * t, s = this.m12 * -n + this.m22 * t; return this.m11 = this.m11 * t + this.m21 * n, this.m12 = o, this.m21 = r, this.m22 = s, this.translate(-i, -e), this }, (t = Gi.prototype).translate = function (t, i) { return this.dx += this.m11 * t + this.m21 * i, this.dy += this.m12 * t + this.m22 * i, this }, t.scale = function (t, i) { return void 0 === i && (i = t), this.m11 *= t, this.m12 *= t, this.m21 *= i, this.m22 *= i, this }, t.ra = function (t) { var i = t.x, e = t.y; return t.h(i * this.m11 + e * this.m21 + this.dx, i * this.m12 + e * this.m22 + this.dy) }, t.Wd = function (t) { var i = 1 / (this.m11 * this.m22 - this.m12 * this.m21), e = t.x, n = t.y; return t.h(e * this.m22 * i + n * -this.m21 * i + i * (this.m21 * this.dy - this.m22 * this.dx), e * -this.m12 * i + n * this.m11 * i + i * (this.m12 * this.dx - this.m11 * this.dy)) }, t.tw = function (t) { var i = t.x, e = t.y, n = i + t.width, o = e + t.height, r = this.m11, s = this.m12, a = this.m21, h = this.m22, l = this.dx, u = this.dy, c = i * r + e * a + l, f = i * s + e * h + u, d = n * r + e * a + l, p = n * s + e * h + u, e = i * r + o * a + l, i = i * s + o * h + u, r = n * r + o * a + l, n = n * s + o * h + u, o = Math.min(c, d), c = Math.max(c, d), d = Math.min(f, p), f = Math.max(f, p); return o = Math.min(o, e), c = Math.max(c, e), d = Math.min(d, i), f = Math.max(f, i), o = Math.min(o, r), c = Math.max(c, r), d = Math.min(d, n), f = Math.max(f, n), t.h(o, d, c - o, f - d), t }, Gi.alloc = function () { var t = Xi.pop(); return void 0 === t ? new Gi : t }, Gi.free = function (t) { Xi.push(t) }, Gi.prototype.transformRect = Gi.prototype.tw, Gi.prototype.invertedTransformPoint = Gi.prototype.Wd, Gi.prototype.transformPoint = Gi.prototype.ra, Gi.prototype.scale = Gi.prototype.scale, Gi.prototype.translate = Gi.prototype.translate, Gi.prototype.rotate = Gi.prototype.rotate, Gi.prototype.invert = Gi.prototype.vt, Gi.prototype.multiplyInverted = Gi.prototype.Pv, Gi.prototype.multiply = Gi.prototype.multiply, Gi.prototype.reset = Gi.prototype.reset, Gi.prototype.isIdentity = Gi.prototype.wt, Gi.prototype.equals = Gi.prototype.w, Gi.prototype.set = Gi.prototype.set; var Xi = []; Gi.className = "Transform", Gi.xF = "54a702f3e53909c447824c6706603faf4c"; var qi = { EA: "7da71ca0ad381e90", Fg: (Math.sqrt(2) - 1) / 3 * 4, Jw: null, sqrt: function (t) { if (t <= 0) return 0; var i = qi.Jw; if (null === i) { i = []; for (var e = 0; e <= 2e3; e++)i[e] = Math.sqrt(e); qi.Jw = i } return t < 1 ? (e = 1 / t) <= 2e3 ? 1 / i[0 | e] : Math.sqrt(t) : t <= 2e3 ? i[0 | t] : Math.sqrt(t) }, A: function (t, i) { return (t -= i) < .5 && -.5 < t }, $: function (t, i) { return (t -= i) < 5e-8 && -5e-8 < t }, Nb: function (t, i, e, n, o, r, s) { var a, h, l, u; if (o <= 0 && (o = 1e-6), h = t < e ? (a = t, e) : (a = e, t), u = i < n ? (l = i, n) : (l = n, i), t === e) return l <= s && s <= u && t - o <= r && r <= t + o; if (i === n) return a <= r && r <= h && i - o <= s && s <= i + o; if (h += o, (a -= o) <= r && r <= h && (u += o, (l -= o) <= s && s <= u)) if (u - l < h - a) { if (!(o < t - e || o < e - t)) return !0; if ((r = (n - i) / (e - t) * (r - t) + i) - o <= s && s <= r + o) return !0 } else { if (!(o < i - n || o < n - i)) return !0; if ((s = (e - t) / (n - i) * (s - i) + t) - o <= r && r <= s + o) return !0 } return !1 }, ct: function (t, i, e, n, o, r, s, a, h, l, u, c) { if (qi.Nb(t, i, s, a, c, e, n) && qi.Nb(t, i, s, a, c, o, r)) return qi.Nb(t, i, s, a, c, l, u); var f = (t + e) / 2, d = (i + n) / 2, p = (e + o) / 2, g = (n + r) / 2, y = ((n = (f + p) / 2) + (p = (p + (o = (o + s) / 2)) / 2)) / 2, m = ((e = (d + g) / 2) + (g = (g + (r = (r + a) / 2)) / 2)) / 2; return qi.ct(t, i, f, d, n, e, y, m, h, l, u, c) || qi.ct(y, m, p, g, o, r, s, a, h, l, u, c) }, Sy: function (t, i, e, n, o, r, s, a, h) { var l = (e + o) / 2, u = (n + r) / 2; return h.h((((t + e) / 2 + l) / 2 + (l + (o + s) / 2) / 2) / 2, (((i + n) / 2 + u) / 2 + (u + (r + a) / 2) / 2) / 2), h }, Ry: function (t, i, e, n, o, r, s, a) { var h = (e + o) / 2, l = (n + r) / 2; return pt(((t + e) / 2 + h) / 2, ((i + n) / 2 + l) / 2, (h + (o + s) / 2) / 2, (l + (r + a) / 2) / 2) }, am: function (t, i, e, n, o, r, s, a, h, l) { var u, c, f, d, p, g; return qi.Nb(t, i, s, a, h, e, n) && qi.Nb(t, i, s, a, h, o, r) ? (mi(l, t, i, 0, 0), mi(l, s, a, 0, 0)) : (c = (i + n) / 2, d = (n + r) / 2, p = ((n = ((u = (t + e) / 2) + (f = (e + o) / 2)) / 2) + (f = (f + (o = (o + s) / 2)) / 2)) / 2, g = ((e = (c + d) / 2) + (d = (d + (r = (r + a) / 2)) / 2)) / 2, qi.am(t, i, u, c, n, e, p, g, h, l), qi.am(p, g, f, d, o, r, s, a, h, l)), l }, Ae: function (t, i, e, n, o, r, s, a, h, l) { var u, c, f, d, p, g; return qi.Nb(t, i, s, a, h, e, n) && qi.Nb(t, i, s, a, h, o, r) ? (0 === l.length && (l.push(t), l.push(i)), l.push(s), l.push(a)) : (c = (i + n) / 2, d = (n + r) / 2, p = ((n = ((u = (t + e) / 2) + (f = (e + o) / 2)) / 2) + (f = (f + (o = (o + s) / 2)) / 2)) / 2, g = ((e = (c + d) / 2) + (d = (d + (r = (r + a) / 2)) / 2)) / 2, qi.Ae(t, i, u, c, n, e, p, g, h, l), qi.Ae(p, g, f, d, o, r, s, a, h, l)), l }, Wv: function (t, i, e, n, o, r, s, a, h, l) { if (qi.Nb(t, i, o, r, l, e, n)) return qi.Nb(t, i, o, r, l, a, h); var u = (t + e) / 2, c = (i + n) / 2, f = (u + (e = (e + o) / 2)) / 2, d = (c + (n = (n + r) / 2)) / 2; return qi.Wv(t, i, u, c, f, d, s, a, h, l) || qi.Wv(f, d, e, n, o, r, s, a, h, l) }, KA: function (t, i, e, n, o, r, s) { return s.h(((t + e) / 2 + (e + o) / 2) / 2, ((i + n) / 2 + (n + r) / 2) / 2), s }, Vv: function (t, i, e, n, o, r, s, a) { var h, l, u, c; return qi.Nb(t, i, o, r, s, e, n) ? (mi(a, t, i, 0, 0), mi(a, o, r, 0, 0)) : (u = ((h = (t + e) / 2) + (e = (e + o) / 2)) / 2, c = ((l = (i + n) / 2) + (n = (n + r) / 2)) / 2, qi.Vv(t, i, h, l, u, c, s, a), qi.Vv(u, c, e, n, o, r, s, a)), a }, Dq: function (t, i, e, n, o, r, s, a) { var h, l, u, c; return qi.Nb(t, i, o, r, s, e, n) ? (0 === a.length && (a.push(t), a.push(i)), a.push(o), a.push(r)) : (u = ((h = (t + e) / 2) + (e = (e + o) / 2)) / 2, c = ((l = (i + n) / 2) + (n = (n + r) / 2)) / 2, qi.Dq(t, i, h, l, u, c, s, a), qi.Dq(u, c, e, n, o, r, s, a)), a }, fq: function (t, i, e, n, o, r, s, a, h, l, u, c, f, d) { if (qi.Nb(t, i, s, a, f, e, n) && qi.Nb(t, i, s, a, f, o, r)) { var p = (t - s) * (l - c) - (i - a) * (h - u); if (0 === p) return !1; if (f = ((t * a - i * s) * (h - u) - (t - s) * (h * c - l * u)) / p, p = ((t * a - i * s) * (l - c) - (i - a) * (h * c - l * u)) / p, (u < h ? h - u : u - h) < (c < l ? l - c : c - l)) { if (i < a ? s = i : (s = a, a = i), p < s || a < p) return !1 } else if (t < s ? a = t : (a = s, s = t), f < a || s < f) return !1; return d.h(f, p), !0 } var g = (i + n) / 2, y = ((p = (t + e) / 2) + (e = (e + o) / 2)) / 2, m = (g + (n = (n + r) / 2)) / 2, v = (y + (e = (e + (o = (o + s) / 2)) / 2)) / 2, x = (m + (n = (n + (r = (r + a) / 2)) / 2)) / 2, b = (u - h) * (u - h) + (c - l) * (c - l), w = !1; return qi.fq(t, i, p, g, y, m, v, x, h, l, u, c, f, d) && ((t = (d.x - h) * (d.x - h) + (d.y - l) * (d.y - l)) < b && (b = t, w = !0)), t = d.x, i = d.y, qi.fq(v, x, e, n, o, r, s, a, h, l, u, c, f, d) && ((d.x - h) * (d.x - h) + (d.y - l) * (d.y - l) < b ? w = !0 : d.h(t, i)), w }, gq: function (t, i, e, n, o, r, s, a, h, l, u, c, f) { var d = 0; if (qi.Nb(t, i, s, a, f, e, n) && qi.Nb(t, i, s, a, f, o, r)) { if (0 === (f = (t - s) * (l - c) - (i - a) * (h - u))) return d; var p = ((t * a - i * s) * (h - u) - (t - s) * (h * c - l * u)) / f, g = ((t * a - i * s) * (l - c) - (i - a) * (h * c - l * u)) / f; if (u <= p) return d; if ((u < h ? h - u : u - h) < (c < l ? l - c : c - l)) { if (i < a ? (t = i, i = a) : t = a, g < t || i < g) return d } else if (t < s ? (i = t, t = s) : i = s, p < i || t < p) return d; 0 < f ? d++ : f < 0 && d-- } else { g = (i + n) / 2; var y = (e + o) / 2, m = (n + r) / 2, v = ((n = ((p = (t + e) / 2) + y) / 2) + (y = (y + (o = (o + s) / 2)) / 2)) / 2, x = ((e = (g + m) / 2) + (m = (m + (r = (r + a) / 2)) / 2)) / 2; d += qi.gq(t, i, p, g, n, e, v, x, h, l, u, c, f), d += qi.gq(v, x, y, m, o, r, s, a, h, l, u, c, f) } return d }, Ih: function (t, i, e, n, o, r, s) { return qi.$(t, e) ? (i < n ? (e = i, i = n) : e = n, r < e ? (s.h(t, e), !1) : i < r ? (s.h(t, i), !1) : (s.h(t, r), !0)) : qi.$(i, n) ? (t < e ? (n = t, t = e) : n = e, o < n ? (s.h(n, i), !1) : t < o ? (s.h(t, i), !1) : (s.h(o, i), !0)) : (o = ((t - o) * (t - e) + (i - r) * (i - n)) / ((e - t) * (e - t) + (n - i) * (n - i))) < -5e-6 ? (s.h(t, i), !1) : 1.000005 < o ? (s.h(e, n), !1) : (s.h(t + o * (e - t), i + o * (n - i)), !0) }, Fe: function (t, i, e, n, o, r, s, a, h) { return qi.A(t, e) && qi.A(i, n) ? (h.h(t, i), !1) : qi.$(o, s) ? qi.$(t, e) ? (qi.Ih(t, i, e, n, o, r, h), !1) : qi.Ih(t, i, e, n, o, (n - i) / (e - t) * (o - t) + i, h) : (a = (a - r) / (s - o), qi.$(t, e) ? (e = a * (t - o) + r, i < n ? (o = i, i = n) : o = n, e < o ? (h.h(t, o), !1) : i < e ? (h.h(t, i), !1) : (h.h(t, e), !0)) : (s = (n - i) / (e - t), qi.$(a, s) ? (qi.Ih(t, i, e, n, o, r, h), !1) : (o = (s * t - a * o + r - i) / (s - a), qi.$(s, 0) ? (t < e ? (n = t, t = e) : n = e, o < n ? (h.h(n, i), !1) : t < o ? (h.h(t, i), !1) : (h.h(o, i), !0)) : qi.Ih(t, i, e, n, o, s * (o - t) + i, h)))) }, JA: function (t, i, e, n, o) { return qi.Fe(e.x, e.y, n.x, n.y, t.x, t.y, i.x, i.y, o) }, IA: function (n, o, t, i, e, r, s, a, h, l) { function u(t, i) { var e = (t - n) * (t - n) + (i - o) * (i - o); e < c && (c = e, h.h(t, i)) } var c = 1 / 0; u(h.x, h.y); var f = 0, d = 0, f = ((e < s ? (f = e, s) : (f = s, e)) - f) / 2 + l; if (l = ((r < a ? (d = e, s) : (d = s, e)) - d) / 2 + l, e = (e + s) / 2, r = (r + a) / 2, 0 === f || 0 === l) return h; if ((n < t ? t - n : n - t) < .5) { if ((f = 1 - (t - e) * (t - e) / (f * f)) < 0) return h; i = -l * (f = Math.sqrt(f)) + r, u(t, l * f + r), u(t, i) } else { if ((f = (a = 2 * (t = (i - o) / (t - n)) * (o - t * n) / (l * l) - 2 * t * r / (l * l) - 2 * e / (f * f)) * a - 4 * (i = 1 / (f * f) + t * t / (l * l)) * (2 * t * n * r / (l * l) - 2 * o * r / (l * l) + r * r / (l * l) + e * e / (f * f) - 1 + (o - t * n) * (o - t * n) / (l * l))) < 0) return h; u(l = (-a + (f = Math.sqrt(f))) / (2 * i), t * l - t * n + o), u(f = (-a - f) / (2 * i), t * f - t * n + o) } return h }, Vc: function (t, i, e, n, o, r, s, a, h) { var l, u = 1e21, c = t, f = i; return !qi.Fe(t, i, t, n, o, r, s, a, h) || (l = (h.x - o) * (h.x - o) + (h.y - r) * (h.y - r)) < u && (u = l, c = h.x, f = h.y), qi.Fe(e, i, e, n, o, r, s, a, h) && ((l = (h.x - o) * (h.x - o) + (h.y - r) * (h.y - r)) < u && (u = l, c = h.x, f = h.y)), qi.Fe(t, i, e, i, o, r, s, a, h) && ((i = (h.x - o) * (h.x - o) + (h.y - r) * (h.y - r)) < u && (u = i, c = h.x, f = h.y)), qi.Fe(t, n, e, n, o, r, s, a, h) && ((t = (h.x - o) * (h.x - o) + (h.y - r) * (h.y - r)) < u && (u = t, c = h.x, f = h.y)), h.h(c, f), u < 1e21 }, HA: function (t, i, e, n, o, r, s, a, h) { return s = o - s, o = 0 === (e = t - e) || 0 === s ? 0 === e ? (i = (r - a) / s) * (a = t) + (r - i * o) : (r = (i - n) / e) * (a = o) + (i - r * t) : (n = (i - n) / e) * (a = (r - (a = (r - a) / s) * o - (t = i - n * t)) / (n - a)) + t, h.h(a, o), h }, tt: function (t, i, e) { return qi.Tx(t.x, t.y, t.width, t.height, i.x, i.y, e.x, e.y) }, Tx: function (t, i, e, n, o, r, s, a) { var h = t + e, l = i + n; return o === s ? (r < a ? (s = r, r = a) : s = a, t <= o && o <= h && s <= l && i <= r) : r === a ? (o < s ? (a = o, o = s) : a = s, i <= r && r <= l && a <= h && t <= o) : !!(Et(t, i, e, n, o, r) || Et(t, i, e, n, s, a) || qi.tq(t, i, h, i, o, r, s, a) || qi.tq(h, i, h, l, o, r, s, a) || qi.tq(h, l, t, l, o, r, s, a) || qi.tq(t, l, t, i, o, r, s, a)) }, tq: function (t, i, e, n, o, r, s, a) { return qi.ft(t, i, e, n, o, r) * qi.ft(t, i, e, n, s, a) <= 0 && qi.ft(o, r, s, a, t, i) * qi.ft(o, r, s, a, e, n) <= 0 }, ft: function (t, i, e, n, o, r) { return e -= t, 0 === (r = (t = o - t) * (n -= i) - (i = r - i) * e) && (0 < (r = t * e + i * n) && ((r = (t - e) * e + (i - n) * n) < 0 && (r = 0))), r < 0 ? -1 : 0 < r ? 1 : 0 }, Aq: function (t) { return t < 0 && (t += 360), 360 <= t && (t -= 360), t }, Fx: function (t, i, e, n, o, r) { var s = Math.PI; r || (n *= s / 180, o *= s / 180); var a = o < n ? -1 : 1; r = []; var h = s / 2, l = n; if ((n = Math.min(2 * s, Math.abs(o - n))) < 1e-5) return h = l + a * Math.min(n, h), a = t + e * Math.cos(l), l = i + e * Math.sin(l), t += e * Math.cos(h), i += e * Math.sin(h), e = (a + t) / 2, h = (l + i) / 2, r.push([a, l, e, h, e, h, t, i]), r; for (; 1e-5 < n;)o = l + a * Math.min(n, h), r.push(qi.Zy(e, l, o, t, i)), n -= Math.abs(o - l), l = o; return r }, Zy: function (t, i, e, n, o) { var r = (e - i) / 2, s = t * Math.cos(r), a = s * s + (u = -(l = t * Math.sin(r))) * u, h = a + s * s + u * l, l = s - (a = 4 / 3 * (Math.sqrt(2 * a * h) - h) / (s * l - u * s)) * u, u = -(s = u + a * s); return a = r + i, r = Math.cos(a), a = Math.sin(a), [n + t * Math.cos(i), o + t * Math.sin(i), n + l * r - s * a, o + l * a + s * r, n + l * r - u * a, o + l * a + u * r, n + t * Math.cos(e), o + t * Math.sin(e)] }, nq: function (t, i, e, n, o, r, s) { var a = (e = Math.floor((t - e) / o) * o + e) + o - t < o / 2 ? e + o : e; return t = (n = Math.floor((i - n) / r) * r + n) + r - i < r / 2 ? n + r : n, s.h(a, t), s }, Px: function (t, i) { var e, n = Math.max(t, i); for (t = Math.min(t, i); i = n % t, n = e = t, 0 < (t = i);); return e }, dz: function (t, i, e, n) { var o, r = e < 0, s = n < 0, a = t < i ? (o = 1, 0) : (o = 0, 1), h = 0 === o ? t : i, l = 0 === o ? e : n; return (0 === o ? r : s) && (l = -l), e = 0 === (o = a) ? e : n, (0 === o ? r : s) && (e = -e), qi.ez(h, 0 === o ? t : i, l, e, 0, 0) }, ez: function (t, i, e, n, o, r) { if (0 < n) if (0 < e) { o = t * t, t *= e; var s = i * n, a = s - (r = i * i), h = -r + Math.sqrt(t * t + s * s); i = a; for (var l = 0; l < 9999999999 && ((i = .5 * (a + h)) !== a && i !== h); ++l) { var u = t / (i + o), c = s / (i + r); if (0 < (u = u * u + c * c - 1)) a = i; else { if (!(u < 0)) break; h = i } } e = o * e / (i + o) - e, n = r * n / (i + r) - n, e = Math.sqrt(e * e + n * n) } else e = Math.abs(n - i); else e = (r = t * e) < (n = t * t - i * i) ? (n = r / n, r = i * Math.sqrt(Math.abs(1 - n * n)), e = t * n - e, Math.sqrt(e * e + r * r)) : Math.abs(e - t); return e }, Je: new X, Mm: new X, Mh: new X, Nh: 0 }; function Ui(t) { Q(this), this.s = !1, void 0 === t && (t = re), this.pa = t, this.mc = this.ec = this.Sc = this.Rc = 0, this.rj = new J, this.Er = this.rj.Aa, this.lr = (new yi).freeze(), this.qa = !0, this.Tm = this.Gk = null, this.Um = NaN, this.hf = Ht, this.jf = ti, this.il = this.jl = NaN, this.Nf = Gr } function Ki(t, i) { return t.type === ee && i.type === re && !!(1 === i.figures.count && (1 === (i = i.figures.L(0)).segments.count && qi.A(t.startX, i.startX) && qi.A(t.startY, i.startY) && ((i = i.segments.L(0)).type === ce && qi.A(t.endX, i.endX) && qi.A(t.endY, i.endY)))) } function Hi(t) { return t.toString() } function Wi(t, i) { function e() { return k - 1 <= m || null !== h[m + 1].match(/[UuBbMmZzLlHhVvCcSsQqTtAaFfXx]/) } function n() { return h[++m] } function o() { var t = new gi(parseFloat(n()), parseFloat(n())); return v === v.toLowerCase() && (t.x = w.x + t.x, t.y = w.y + t.y), t } function r() { return w = o() } function s() { return b = o() } function a() { var t = x.toLowerCase(); return "c" !== t && "s" !== t && "q" !== t && "t" !== t ? w : new gi(2 * w.x - b.x, 2 * w.y - b.y) } void 0 === i && (i = !1); var h = (t = (t = (t = (t = (t = (t = (t = (t = (t = t.replace(/,/gm, " ")).replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm, "$1 $2")).replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm, "$1 $2")).replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([^\s])/gm, "$1 $2")).replace(/([^\s])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm, "$1 $2")).replace(/([0-9])([+\-])/gm, "$1 $2")).replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm, "$1 $3 $4 ")).replace(/[\s\r\t\n]+/gm, " ")).replace(/^\s+|\s+$/g, "")).split(" "); for (t = 0; t < h.length; t++) { var l = h[t]; if (null !== l.match(/(\.[0-9]*)(\.)/gm)) { for (var u = zi(), c = "", f = !1, d = 0; d < l.length; d++) { var p = l[d]; "." !== p || f ? "." === p ? (u.push(c), c = ".") : c += p : (f = !0, c += p) } for (u.push(c), h.splice(t, 1), l = 0; l < u.length; l++)h.splice(t + l, 0, u[l]); t += u.length - 1, Vi(u) } } var g, y, m = -1, v = "", x = "", u = new gi(0, 0), b = new gi(0, 0), w = new gi(0, 0), k = h.length; for (t = ql(null), c = l = !1, f = !0, d = null; !(k - 1 <= m);)if (x = v, "" !== (v = n())) switch (v.toUpperCase()) { case "X": c = l = !(f = !0); break; case "M": for (d = r(), null === t.fc || !0 === f ? (Vl(t, d.x, d.y, l, !c), f = !1) : t.moveTo(d.x, d.y), u = w; !e();)d = r(), t.lineTo(d.x, d.y); break; case "L": for (; !e();)d = r(), t.lineTo(d.x, d.y); break; case "H": for (; !e();)w = new gi((v === v.toLowerCase() ? w.x : 0) + parseFloat(n()), w.y), t.lineTo(w.x, w.y); break; case "V": for (; !e();)w = new gi(w.x, (v === v.toLowerCase() ? w.y : 0) + parseFloat(n())), t.lineTo(w.x, w.y); break; case "C": for (; !e();) { d = o(), p = s(); var M = r(); Yl(t, d.x, d.y, p.x, p.y, M.x, M.y) } break; case "S": for (; !e();)d = a(), p = s(), M = r(), Yl(t, d.x, d.y, p.x, p.y, M.x, M.y); break; case "Q": for (; !e();)d = s(), p = r(), Gl(t, d.x, d.y, p.x, p.y); break; case "T": for (; !e();)b = d = a(), p = r(), Gl(t, d.x, d.y, p.x, p.y); break; case "B": for (; !e();) { d = parseFloat(n()), p = parseFloat(n()), M = parseFloat(n()); var S = parseFloat(n()), P = parseFloat(n()), N = P, C = !1; e() || (N = parseFloat(n()), e() || (C = 0 !== parseFloat(n()))), v === v.toLowerCase() && (M += w.x, S += w.y), t.arcTo(d, p, M, S, P, N, C) } break; case "A": for (; !e();)Xl(t, d = Math.abs(parseFloat(n())), p = Math.abs(parseFloat(n())), M = parseFloat(n()), S = !!parseFloat(n()), P = !!parseFloat(n()), (N = r()).x, N.y); break; case "Z": 0 < (y = (g = t).fc.segments.length) && g.fc.segments.L(y - 1).close(), w = u; break; case "F": for (d = "", p = 1; h[m + p];)if (null !== h[m + p].match(/[Uu]/)) p++; else { if (null !== h[m + p].match(/[UuBbMmZzLlHhVvCcSsQqTtAaFfXx]/)) { d = h[m + p]; break } p++ } d.match(/[Mm]/) ? l = !0 : 0 < t.fc.segments.length && (t.fc.isFilled = !0); break; case "U": for (d = "", p = 1; h[m + p];)if (null !== h[m + p].match(/[Ff]/)) p++; else { if (null !== h[m + p].match(/[UuBbMmZzLlHhVvCcSsQqTtAaFfXx]/)) { d = h[m + p]; break } p++ } d.match(/[Mm]/) ? c = !0 : t.Mq(!1) }if (u = t.ot, Ul = t, i) for (i = u.figures.iterator; i.next();)i.value.isFilled = !0; return u } function Ji(t, i) { for (var e = t.length, n = gi.alloc(), o = 0; o < e; o++) { var r = t[o]; n.x = r[0], n.y = r[1], i.ra(n), r[0] = n.x, r[1] = n.y, n.x = r[2], n.y = r[3], i.ra(n), r[2] = n.x, r[3] = n.y, n.x = r[4], n.y = r[5], i.ra(n), r[4] = n.x, r[5] = n.y, n.x = r[6], n.y = r[7], i.ra(n), r[6] = n.x, r[7] = n.y } gi.free(n) } function Zi(t, i, e) { switch (t.type) { case ee: case ne: case oe: e ? i.h(t.Rc, t.Sc, 0, 0) : mi(i, t.Rc, t.Sc, 0, 0), mi(i, t.ec, t.mc, 0, 0); break; case re: var n = t.figures; t = n.j, n = n.length; for (var o = 0; o < n; o++) { var r = t[o]; e && 0 === o ? i.h(r.startX, r.startY, 0, 0) : mi(i, r.startX, r.startY, 0, 0); for (var s = r.segments.j, a = s.length, h = r.startX, l = r.startY, u = 0; u < a; u++) { var c = s[u]; switch (c.type) { case ce: case ue: mi(i, h = c.endX, l = c.endY, 0, 0); break; case fe: qi.am(h, l, c.point1X, c.point1Y, c.point2X, c.point2Y, c.endX, c.endY, .5, i), h = c.endX, l = c.endY; break; case de: qi.Vv(h, l, c.point1X, c.point1Y, c.endX, c.endY, .5, i), h = c.endX, l = c.endY; break; case pe: case ge: var f = c.type === pe ? he(c, r) : le(c, r, h, l), d = f.length; if (0 === d) { mi(i, h = c.centerX, l = c.centerY, 0, 0); break } c = null; for (var p = 0; p < d; p++)c = f[p], qi.am(c[0], c[1], c[2], c[3], c[4], c[5], c[6], c[7], .5, i); null !== c && (h = c[6], l = c[7]); break; default: B("Unknown Segment type: " + c.type) } } } break; default: B("Unknown Geometry type: " + t.type) } } function $i(t, i, e, n, o) { var r = i.x; i = i.y; for (var s, a = t.bounds.x - 20, h = 0, l = t.figures.j, u = l.length, c = 0; c < u; c++) { var f = l[c]; if (f.isFilled) { if (n && f.aa(r, i, e)) return !0; for (var d, p, g = f.segments, y = d = f.startX, m = p = f.startY, v = g.j, x = 0; x <= g.length; x++) { var b, w = void 0, k = x !== g.length ? (b = (w = v[x]).type, t = w.endX, w.endY) : (b = ce, t = y, m); switch (b) { case ue: if (y = Qi(r, i, a, i, d, p, y, m), isNaN(y)) return !0; h += y, y = t, m = k; break; case ce: if (d = Qi(r, i, a, i, d, p, t, k), isNaN(d)) return !0; h += d; break; case fe: h += s = qi.gq(d, p, w.point1X, w.point1Y, w.point2X, w.point2Y, t, k, a, i, r, i, .5); break; case de: h += s = qi.gq(d, p, (d + 2 * w.point1X) / 3, (p + 2 * w.point1Y) / 3, (2 * w.point1X + t) / 3, (2 * w.point1Y + k) / 3, t, k, a, i, r, i, .5); break; case pe: case ge: var M = (b = w.type === pe ? he(w, f) : le(w, f, d, p)).length; if (0 === M) { if (d = Qi(r, i, a, i, d, p, w.centerX, w.centerY), isNaN(d)) return !0; h += d; break } w = null; for (var S = 0; S < M; S++) { if (w = b[S], 0 === S) { if (s = Qi(r, i, a, i, d, p, w[0], w[1]), isNaN(s)) return !0; h += s } h += s = qi.gq(w[0], w[1], w[2], w[3], w[4], w[5], w[6], w[7], a, i, r, i, .5) } null !== w && (t = w[6], k = w[7]); break; default: B("Unknown Segment type: " + w.type) }d = t, p = k } if (0 !== h) return !0; h = 0 } else if (f.aa(r, i, o ? e : e + 2)) return !0 } return 0 !== h } function Qi(t, i, e, n, o, r, s, a) { if (qi.Nb(o, r, s, a, .05, t, i)) return NaN; var h = (t - e) * (r - a); if (0 == h) return 0; var l = ((t * n - i * e) * (o - s) - (t - e) * (o * a - r * s)) / h; if (i = (t * n - i * e) * (r - a) / h, t <= l) return 0; if ((s < o ? o - s : s - o) < (a < r ? r - a : a - r)) { if (r < a) { if (i < r || a < i) return 0 } else if (i < a || r < i) return 0 } else if (o < s) { if (l < o || s < l) return 0 } else if (l < s || o < l) return 0; return 0 < h ? 1 : -1 } function _i(t, i, e, n) { for (var o = (t = t.figures.j).length, r = 0; r < o; r++)if (t[r].aa(i, e, n)) return !0; return !1 } function te(t) { if (null === t.Gk) { var i = t.Gk = [], e = t.Tm = [], n = [], o = []; if (t.type === ee) n.push(t.startX), n.push(t.startY), n.push(t.endX), n.push(t.endY), i.push(n), o.push(Math.sqrt((t.startX - t.endX) * (t.startX - t.endX) + (t.startY - t.endY) * (t.startY - t.endY))), e.push(o); else if (t.type === ne) n.push(t.startX), n.push(t.startY), n.push(t.endX), n.push(t.startY), n.push(t.endX), n.push(t.endY), n.push(t.startX), n.push(t.endY), n.push(t.startX), n.push(t.startY), i.push(n), o.push(Math.abs(t.startX - t.endX)), o.push(Math.abs(t.startY - t.endY)), o.push(Math.abs(t.startX - t.endX)), o.push(Math.abs(t.startY - t.endY)), e.push(o); else if (t.type === oe) { var r = new se; r.startX = t.endX, r.startY = (t.startY + t.endY) / 2; var s = new ae(pe); if (s.startAngle = 0, s.sweepAngle = 360, s.centerX = (t.startX + t.endX) / 2, s.centerY = (t.startY + t.endY) / 2, s.radiusX = Math.abs(t.startX - t.endX) / 2, s.radiusY = Math.abs(t.startY - t.endY) / 2, r.add(s), 0 === (o = (t = he(s, r)).length)) n.push(s.centerX), n.push(s.centerY); else { s = r.startX, r = r.startY; for (var a = 0; a < o; a++) { var h = t[a]; qi.Ae(s, r, h[2], h[3], h[4], h[5], h[6], h[7], .5, n), s = h[6], r = h[7] } } i.push(n), e.push(ie(n)) } else for (t = t.figures.iterator; t.next();) { o = t.value, (n = []).push(o.startX), n.push(o.startY), a = s = o.startX, h = r = o.startY; for (var l = o.segments.j, u = l.length, c = 0; c < u; c++) { var f = l[c]; switch (f.type) { case ue: 4 <= n.length && (i.push(n), e.push(ie(n))), (n = []).push(f.endX), n.push(f.endY), a = s = f.endX, h = r = f.endY; break; case ce: n.push(f.endX), n.push(f.endY), s = f.endX, r = f.endY; break; case fe: qi.Ae(s, r, f.point1X, f.point1Y, f.point2X, f.point2Y, f.endX, f.endY, .5, n), s = f.endX, r = f.endY; break; case de: qi.Dq(s, r, f.point1X, f.point1Y, f.endX, f.endY, .5, n), s = f.endX, r = f.endY; break; case pe: var d = he(f, o), p = d.length; if (0 === p) { n.push(f.centerX), n.push(f.centerY), s = f.centerX, r = f.centerY; break } for (var g = 0; g < p; g++) { var y = d[g]; qi.Ae(s, r, y[2], y[3], y[4], y[5], y[6], y[7], .5, n), s = y[6], r = y[7] } break; case ge: if (0 === (p = (d = le(f, o, s, r)).length)) { n.push(f.centerX), n.push(f.centerY), s = f.centerX, r = f.centerY; break } for (g = 0; g < p; g++)y = d[g], qi.Ae(s, r, y[2], y[3], y[4], y[5], y[6], y[7], .5, n), s = y[6], r = y[7]; break; default: B("Segment not of valid type: " + f.type) }f.isClosed && (n.push(a), n.push(h)) } 4 <= n.length && (i.push(n), e.push(ie(n))) } } } function ie(t) { for (var i = [], e = 0, n = 0, o = t.length, r = 0; r < o; r += 2) { var s = t[r], a = t[r + 1]; 0 !== r && i.push(Math.sqrt(dt(e, n, s, a))), e = s, n = a } return i } qi.za = qi.EA, Ui.prototype.copy = function () { var t = new Ui; t.pa = this.pa, t.Rc = this.Rc, t.Sc = this.Sc, t.ec = this.ec, t.mc = this.mc; for (var i = this.rj.j, e = i.length, n = t.rj, o = 0; o < e; o++) { var r = i[o].copy(); n.add(r) } return t.Er = this.Er, t.lr.assign(this.lr), t.qa = this.qa, t.Gk = this.Gk, t.Tm = this.Tm, t.Um = this.Um, t.hf = this.hf.G(), t.jf = this.jf.G(), t.jl = this.jl, t.il = this.il, t.Nf = this.Nf, t }, (t = Ui.prototype).ca = function () { return this.freeze(), Object.freeze(this), this }, t.freeze = function () { this.s = !0; var t = this.figures; t.freeze(); for (var i = (t = t.j).length, e = 0; e < i; e++)t[e].freeze(); return this }, t.ea = function () { Object.isFrozen(this) && B("cannot thaw constant: " + this), this.s = !1; var t = this.figures; t.ea(); for (var i = (t = t.j).length, e = 0; e < i; e++)t[e].ea(); return this }, t.Ma = function (t) { if (!(t instanceof Ui)) return !1; if (this.type !== t.type) return this.type === ee && t.type === re ? Ki(this, t) : t.type === ee && this.type === re && Ki(t, this); if (this.type !== re) return qi.A(this.startX, t.startX) && qi.A(this.startY, t.startY) && qi.A(this.endX, t.endX) && qi.A(this.endY, t.endY); var i = this.figures.j; t = t.figures.j; var e = i.length; if (e !== t.length) return !1; for (var n = 0; n < e; n++)if (!i[n].Ma(t[n])) return !1; return !0 }, t.fb = function (t) { t.classType === Ui && (this.type = t) }, t.toString = function (t) { switch (void 0 === t && (t = -1), this.type) { case ee: return t < 0 ? "M" + this.startX.toString() + " " + this.startY.toString() + "L" + this.endX.toString() + " " + this.endY.toString() : "M" + this.startX.toFixed(t) + " " + this.startY.toFixed(t) + "L" + this.endX.toFixed(t) + " " + this.endY.toFixed(t); case ne: var i = new yi(this.startX, this.startY, 0, 0); return i.uw(this.endX, this.endY, 0, 0), t < 0 ? "M" + i.x.toString() + " " + i.y.toString() + "H" + i.right.toString() + "V" + i.bottom.toString() + "H" + i.left.toString() + "z" : "M" + i.x.toFixed(t) + " " + i.y.toFixed(t) + "H" + i.right.toFixed(t) + "V" + i.bottom.toFixed(t) + "H" + i.left.toFixed(t) + "z"; case oe: if ((i = new yi(this.startX, this.startY, 0, 0)).uw(this.endX, this.endY, 0, 0), t < 0) return "M" + (t = i.left.toString() + " " + (i.y + i.height / 2).toString()) + "A" + (i.width / 2).toString() + " " + (i.height / 2).toString() + " 0 0 1 " + i.right.toString() + " " + (i.y + i.height / 2).toString() + "A" + (i.width / 2).toString() + " " + (i.height / 2).toString() + " 0 0 1 " + t; var e = i.left.toFixed(t) + " " + (i.y + i.height / 2).toFixed(t); return "M" + e + "A" + (i.width / 2).toFixed(t) + " " + (i.height / 2).toFixed(t) + " 0 0 1 " + i.right.toFixed(t) + " " + (i.y + i.height / 2).toFixed(t) + "A" + (i.width / 2).toFixed(t) + " " + (i.height / 2).toFixed(t) + " 0 0 1 " + e; case re: i = ""; for (var n = (e = this.figures.j).length, o = 0; o < n; o++) { var r = e[o]; 0 < o && (i += " x "), r.isFilled && (i += "F "), i += r.toString(t) } return i; default: return this.type.toString() } }, t.Mv = function () { if (this.qa || this.Er !== this.figures.Aa) return !0; for (var t = this.figures.j, i = t.length, e = 0; e < i; e++)if (t[e].Mv()) return !0; return !1 }, Ui.prototype.computeBounds = function () { this.qa = !1, this.Tm = this.Gk = null, this.Um = NaN, this.Er = this.figures.Aa; for (var t = this.figures.j, i = t.length, e = 0; e < i; e++) { var n = t[e]; n.qa = !1; var o = n.segments; n.Ks = o.Aa, o = (n = o.j).length; for (var r = 0; r < o; r++) { var s = n[r]; s.qa = !1, s.Le = null } } (t = this.lr).ea(), isNaN(this.jl) || isNaN(this.il) ? t.h(0, 0, 0, 0) : t.h(0, 0, this.jl, this.il), Zi(this, t, !1), mi(t, 0, 0, 0, 0), t.freeze() }, Ui.prototype.Ex = function () { var t = new yi; return Zi(this, t, !0), t }, Ui.prototype.normalize = function () { this.s && g(this); var t = this.Ex(); return this.offset(-t.x, -t.y), new gi(-t.x, -t.y) }, Ui.prototype.offset = function (t, i) { return this.s && g(this), this.transform(1, 0, 0, 1, t, i), this }, Ui.prototype.scale = function (t, i) { return this.s && g(this), this.transform(t, 0, 0, i, 0, 0), this }, Ui.prototype.rotate = function (t, i, e) { this.s && g(this), void 0 === i && (i = 0), void 0 === e && (e = 0); var n = Gi.alloc(); return n.reset(), n.rotate(t, i, e), this.transform(n.m11, n.m12, n.m21, n.m22, n.dx, n.dy), Gi.free(n), this }, (t = Ui.prototype).transform = function (t, i, e, n, o, r) { switch (this.type) { case ee: case ne: case oe: var s = this.Rc, a = this.Sc; this.Rc = s * t + a * e + o, this.Sc = s * i + a * n + r, s = this.ec, a = this.mc, this.ec = s * t + a * e + o, this.mc = s * i + a * n + r; break; case re: for (var h = this.figures.j, l = h.length, u = 0; u < l; u++) { var c = h[u], s = c.startX, a = c.startY; c.startX = s * t + a * e + o, c.startY = s * i + a * n + r; for (var f = (c = c.segments.j).length, d = 0; d < f; d++) { var p = c[d]; switch (p.type) { case ce: case ue: s = p.endX, a = p.endY, p.endX = s * t + a * e + o, p.endY = s * i + a * n + r; break; case fe: s = p.point1X, a = p.point1Y, p.point1X = s * t + a * e + o, p.point1Y = s * i + a * n + r, s = p.point2X, a = p.point2Y, p.point2X = s * t + a * e + o, p.point2Y = s * i + a * n + r, s = p.endX, a = p.endY, p.endX = s * t + a * e + o, p.endY = s * i + a * n + r; break; case de: s = p.point1X, a = p.point1Y, p.point1X = s * t + a * e + o, p.point1Y = s * i + a * n + r, s = p.endX, a = p.endY, p.endX = s * t + a * e + o, p.endY = s * i + a * n + r; break; case pe: s = p.centerX, a = p.centerY, p.centerX = s * t + a * e + o, p.centerY = s * i + a * n + r, 0 !== i && ((s = 180 * Math.atan2(i, t) / Math.PI) < 0 && (s += 360), p.startAngle += s), t < 0 && (p.startAngle = 180 - p.startAngle, p.sweepAngle = -p.sweepAngle), n < 0 && (p.startAngle = -p.startAngle, p.sweepAngle = -p.sweepAngle), p.radiusX *= Math.sqrt(t * t + e * e), void 0 !== p.radiusY && (p.radiusY *= Math.sqrt(i * i + n * n)); break; case ge: s = p.endX, a = p.endY, p.endX = s * t + a * e + o, p.endY = s * i + a * n + r, 0 !== i && ((s = 180 * Math.atan2(i, t) / Math.PI) < 0 && (s += 360), p.xAxisRotation += s), t < 0 && (p.xAxisRotation = 180 - p.xAxisRotation, p.isClockwiseArc = !p.isClockwiseArc), n < 0 && (p.xAxisRotation = -p.xAxisRotation, p.isClockwiseArc = !p.isClockwiseArc), p.radiusX *= Math.sqrt(t * t + e * e), p.radiusY *= Math.sqrt(i * i + n * n); break; default: B("Unknown Segment type: " + p.type) } } } }return this.qa = !0, this }, t.aa = function (t, i) { void 0 === i && (i = 0); var e = this.Rc, n = this.Sc, o = this.ec, r = this.mc; switch (this.type) { case ee: return qi.Nb(e, n, o, r, i, t.x, t.y); case ne: var s = yi.allocAt(Math.min(e, o) - i, Math.min(n, r) - i, Math.abs(o - e) + 2 * i, Math.abs(r - n) + 2 * i); return t = s.aa(t), yi.free(s), t; case oe: s = Math.min(e, o) - i; var a = Math.min(n, r) - i, e = (Math.abs(o - e) + 2 * i) / 2; return (i = (Math.abs(r - n) + 2 * i) / 2, e <= 0 || i <= 0) ? !1 : (s = t.x - (s + e)) * s / (e * e) + (a = t.y - (a + i)) * a / (i * i) <= 1; case re: return $i(this, t, i, !0, !1); default: return !1 } }, t.Cv = function (t, i) { if (t < 0 ? t = 0 : 1 < t && (t = 1), void 0 === i && (i = new gi), this.type === ee) return i.h(this.startX + t * (this.endX - this.startX), this.startY + t * (this.endY - this.startY)), i; for (var e = this.flattenedSegments, n = this.flattenedLengths, o = e.length, r = this.flattenedTotalLength * t, s = 0, a = 0; a < o; a++) { var h = n[a], l = h.length; for (t = 0; t < l; t++) { var u = h[t]; if (r <= s + u) return n = r - s, n = 0 === u ? 0 : n / u, a = (e = e[a])[2 * t], o = e[2 * t + 1], i.h(a + (e[2 * t + 2] - a) * n, o + (e[2 * t + 3] - o) * n), i; s += u } } return i }, t.Qx = function (t) { if (t < 0 ? t = 0 : 1 < t && (t = 1), this.type === ee) return 180 * Math.atan2(this.endY - this.startY, this.endX - this.startX) / Math.PI; for (var i = this.flattenedSegments, e = this.flattenedLengths, n = i.length, o = this.flattenedTotalLength * t, r = 0, s = 0; s < n; s++) { var a = e[s], h = a.length; for (t = 0; t < h; t++) { var l = a[t]; if (o <= r + l) return i = (o = i[s])[2 * t], e = o[2 * t + 1], n = o[2 * t + 2], t = o[2 * t + 3], Math.abs(n - i) < 1 && Math.abs(t - e) < 1 ? 0 : Math.abs(n - i) < 1 ? 0 <= t - e ? 90 : 270 : Math.abs(t - e) < 1 ? 0 <= n - i ? 0 : 180 : 180 * Math.atan2(t - e, n - i) / Math.PI; r += l } } return NaN }, t.Dv = function (t, i) { if (t < 0 ? t = 0 : 1 < t && (t = 1), void 0 === i && (i = []), i.length = 3, this.type === ee) return i[0] = this.startX + t * (this.endX - this.startX), i[1] = this.startY + t * (this.endY - this.startY), i[2] = 180 * Math.atan2(this.endY - this.startY, this.endX - this.startX) / Math.PI, i; for (var e = this.flattenedSegments, n = this.flattenedLengths, o = e.length, r = this.flattenedTotalLength * t, s = 0, a = 0; a < o; a++) { var h = n[a], l = h.length; for (t = 0; t < l; t++) { var u = h[t]; if (r <= s + u) return n = r - s, n = 0 === u ? 0 : n / u, e = (u = e[a])[2 * t], a = u[2 * t + 1], o = u[2 * t + 2], t = u[2 * t + 3], i[0] = e + (o - e) * n, i[1] = a + (t - a) * n, i[2] = Math.abs(o - e) < 1 && Math.abs(t - a) < 1 ? 0 : Math.abs(o - e) < 1 ? 0 <= t - a ? 90 : 270 : Math.abs(t - a) < 1 ? 0 <= o - e ? 0 : 180 : 180 * Math.atan2(t - a, o - e) / Math.PI, i; s += u } } return i }, t.Rx = function (t) { if (this.type === ee) { var i = this.startX, e = this.startY, n = this.endX, o = this.endY; if (i !== n || e !== o) { var r, s = t.x; if (t = t.y, i === n) return n = e < o ? (r = e, o) : (r = o, e), t <= r ? r === e ? 0 : 1 : n <= t ? n === e ? 0 : 1 : Math.abs(t - e) / (n - r); if (e === o) return i < n ? r = i : (r = n, n = i), s <= r ? r === i ? 0 : 1 : n <= s ? n === i ? 0 : 1 : Math.abs(s - i) / (n - r); r = (n - i) * (n - i) + (o - e) * (o - e); var a = gi.alloc(); return qi.Ih(i, e, n, o, s, t, a), t = a.x, s = a.y, gi.free(a), Math.sqrt(((t - i) * (t - i) + (s - e) * (s - e)) / r) } } else { if (this.type !== ne) { i = this.flattenedSegments, e = this.flattenedLengths, s = this.flattenedTotalLength, n = gi.alloc(), o = 1 / 0, a = r = 0, m = i.length; for (var h = v = 0, l = 0; l < m; l++)for (var u = i[l], c = e[l], f = u.length, d = 0; d < f; d += 2) { var p, g = u[d], y = u[d + 1]; 0 !== d && (qi.Ih(v, h, g, y, t.x, t.y, n), (p = (n.x - t.x) * (n.x - t.x) + (n.y - t.y) * (n.y - t.y)) < o && (o = p, r = a, r += Math.sqrt((n.x - v) * (n.x - v) + (n.y - h) * (n.y - h))), a += c[(d - 2) / 2]), v = g, h = y } return gi.free(n), (t = r / s) < 0 ? 0 : 1 < t ? 1 : t } r = this.startX, a = this.startY; var m = this.endX, o = this.endY; if (r !== m || a !== o) { s = 2 * (i = m - r) + 2 * (e = o - a), n = t.x, t = t.y, n = Math.min(Math.max(n, r), m), t = Math.min(Math.max(t, a), o), r = Math.abs(n - r), m = Math.abs(n - m), a = Math.abs(t - a), o = Math.abs(t - o); var v = Math.min(r, m, a, o); if (v === a) return n / s; if (v === m) return (i + t) / s; if (v === o) return (2 * i + e - n) / s; if (v === r) return (2 * i + 2 * e - t) / s } } return 0 }, t.add = function (t) { return this.rj.add(t), this }, t.Im = function (t, i, e, n, o, r, s, a) { return this.s && g(this), this.hf = new Oi(t, i, o, r).freeze(), this.jf = new Oi(e, n, s, a).freeze(), this }, l.Object.defineProperties(Ui.prototype, { flattenedSegments: { get: function () { return te(this), this.Gk } }, flattenedLengths: { get: function () { return te(this), this.Tm } }, flattenedTotalLength: { get: function () { var t = this.Um; if (isNaN(t)) { if (this.type === ee) { t = Math.abs(this.endX - this.startX); var i = Math.abs(this.endY - this.startY), t = Math.sqrt(t * t + i * i) } else if (this.type === ne) t = 2 * Math.abs(this.endX - this.startX) + 2 * Math.abs(this.endY - this.startY); else for (var e = (i = this.flattenedLengths).length, n = t = 0; n < e; n++)for (var o = i[n], r = o.length, s = 0; s < r; s++)t += o[s]; this.Um = t } return t } }, type: { get: function () { return this.pa }, set: function (t) { this.pa !== t && (this.s && g(this, t), this.pa = t, this.qa = !0) } }, startX: { get: function () { return this.Rc }, set: function (t) { this.Rc !== t && (this.s && g(this, t), this.Rc = t, this.qa = !0) } }, startY: { get: function () { return this.Sc }, set: function (t) { this.Sc !== t && (this.s && g(this, t), this.Sc = t, this.qa = !0) } }, endX: { get: function () { return this.ec }, set: function (t) { this.ec !== t && (this.s && g(this, t), this.ec = t, this.qa = !0) } }, endY: { get: function () { return this.mc }, set: function (t) { this.mc !== t && (this.s && g(this, t), this.mc = t, this.qa = !0) } }, figures: { get: function () { return this.rj }, set: function (t) { this.rj !== t && (this.s && g(this, t), this.rj = t, this.qa = !0) } }, spot1: { get: function () { return this.hf }, set: function (t) { this.s && g(this, t), this.hf = t.G() } }, spot2: { get: function () { return this.jf }, set: function (t) { this.s && g(this, t), this.jf = t.G() } }, defaultStretch: { get: function () { return this.Nf }, set: function (t) { this.s && g(this, t), this.Nf = t } }, bounds: { get: function () { return this.Mv() && this.computeBounds(), this.lr } } }), Ui.prototype.setSpots = Ui.prototype.Im, Ui.prototype.add = Ui.prototype.add, Ui.prototype.getFractionForPoint = Ui.prototype.Rx, Ui.prototype.getPointAndAngleAlongPath = Ui.prototype.Dv, Ui.prototype.getAngleAlongPath = Ui.prototype.Qx, Ui.prototype.getPointAlongPath = Ui.prototype.Cv, Ui.prototype.containsPoint = Ui.prototype.aa, Ui.prototype.transform = Ui.prototype.transform, Ui.prototype.rotate = Ui.prototype.rotate, Ui.prototype.scale = Ui.prototype.scale, Ui.prototype.offset = Ui.prototype.offset, Ui.prototype.normalize = Ui.prototype.normalize, Ui.prototype.computeBoundsWithoutOrigin = Ui.prototype.Ex, Ui.prototype.equalsApprox = Ui.prototype.Ma; var ee = new V(Ui, "Line", 0), ne = new V(Ui, "Rectangle", 1), oe = new V(Ui, "Ellipse", 2), re = new V(Ui, "Path", 3); function se(t, i, e, n) { Q(this), this.s = !1, void 0 === e && (e = !0), this.Pr = e, void 0 === n && (n = !0), this.Tr = n, this.Rc = void 0 !== t ? t : 0, this.Sc = void 0 !== i ? i : 0, this.Jl = new J, this.Ks = this.Jl.Aa, this.qa = !0 } function ae(t, i, e, n, o, r, s, a) { Q(this), this.s = !1, void 0 === t && (t = ce), this.pa = t, this.ec = void 0 !== i ? i : 0, this.mc = void 0 !== e ? e : 0, void 0 === n && (n = 0), void 0 === o && (o = 0), void 0 === r && (r = 0), void 0 === s && (s = 0), t === ge ? ((t = r % 360) < 0 && (t += 360), this.we = t, this.Di = 0, this.Ei = Math.max(n, 0), this.hh = Math.max(o, 0), this.rl = "boolean" == typeof s ? s : "number" == typeof s && !!s, this.Kk = !!a) : (this.we = n, this.Di = o, t === pe && (r = Math.max(r, 0)), this.Ei = r, "number" == typeof s ? (t === pe && (s = Math.max(s, 0)), this.hh = s) : this.hh = 0, this.Kk = this.rl = !1), this.wj = !1, this.qa = !0, this.Le = null } function he(t, i) { if (null !== t.Le && !1 === i.qa) return t.Le; var e = t.radiusX, n = t.radiusY; if (void 0 === n && (n = e), 0 === e || 0 === n) return t.Le = [], t.Le; i = t.we; var o, r = t.Di, s = qi.Fx(0, 0, e < n ? e : n, t.startAngle, t.startAngle + t.sweepAngle, !1); for (e !== n && ((o = Gi.alloc()).reset(), e < n ? o.scale(1, n / e) : o.scale(e / n, 1), Ji(s, o), Gi.free(o)), e = s.length, n = 0; n < e; n++)(o = s[n])[0] += i, o[1] += r, o[2] += i, o[3] += r, o[4] += i, o[5] += r, o[6] += i, o[7] += r; return t.Le = s, t.Le } function le(t, i, e, n) { function o(t, i, e, n) { return (t * n < i * e ? -1 : 1) * Math.acos((t * e + i * n) / (Math.sqrt(t * t + i * i) * Math.sqrt(e * e + n * n))) } if (null !== t.Le && !1 === i.qa) return t.Le; i = t.Ei; var r = t.hh; 0 === i && (i = 1e-4), 0 === r && (r = 1e-4); var s = Math.PI / 180 * t.we, a = t.rl, h = t.Kk, l = t.ec, u = t.mc, c = Math.cos(s), f = Math.sin(s), d = c * (e - l) / 2 + f * (n - u) / 2, p = d * d / (i * i) + (s = -f * (e - l) / 2 + c * (n - u) / 2) * s / (r * r); return 1 < p && (i *= Math.sqrt(p), r *= Math.sqrt(p)), p = (a === h ? -1 : 1) * Math.sqrt((i * i * r * r - i * i * s * s - r * r * d * d) / (i * i * s * s + r * r * d * d)), isNaN(p) && (p = 0), a = p * i * s / r, p = p * -r * d / i, isNaN(a) && (a = 0), isNaN(p) && (p = 0), e = (e + l) / 2 + c * a - f * p, n = (n + u) / 2 + f * a + c * p, u = o(1, 0, (d - a) / i, (s - p) / r), s = o(c = (d - a) / i, l = (s - p) / r, d = (-d - a) / i, a = (-s - p) / r), (d = (c * d + l * a) / (Math.sqrt(c * c + l * l) * Math.sqrt(d * d + a * a))) <= -1 ? s = Math.PI : 1 <= d && (s = 0), !h && 0 < s && (s -= 2 * Math.PI), h && s < 0 && (s += 2 * Math.PI), h = r < i ? 1 : i / r, d = r < i ? r / i : 1, i = qi.Fx(0, 0, r < i ? i : r, u, u + s, !0), (r = Gi.alloc()).reset(), r.translate(e, n), r.rotate(t.we, 0, 0), r.scale(h, d), Ji(i, r), Gi.free(r), t.Le = i, t.Le } Ui.className = "Geometry", Ui.stringify = Hi, Ui.fillPath = function (t) { for (var i = (t = t.split(/[Xx]/)).length, e = "", n = 0; n < i; n++)var o = t[n], e = null !== o.match(/[Ff]/) ? 0 === n ? e + o : e + ("X" + (" " === o[0] ? "" : " ")) + o : e + ((0 === n ? "" : "X ") + "F" + (" " === o[0] ? "" : " ")) + o; return e }, Ui.parse = Wi, Ui.Line = ee, Ui.Rectangle = ne, Ui.Ellipse = oe, Ui.Path = re, se.prototype.copy = function () { var t = new se; t.Pr = this.Pr, t.Tr = this.Tr, t.Rc = this.Rc, t.Sc = this.Sc; for (var i = this.Jl.j, e = i.length, n = t.Jl, o = 0; o < e; o++) { var r = i[o].copy(); n.add(r) } return t.Ks = this.Ks, t.qa = this.qa, t }, (t = se.prototype).Ma = function (t) { if (!(t instanceof se && qi.A(this.startX, t.startX) && qi.A(this.startY, t.startY))) return !1; var i = this.segments.j; t = t.segments.j; var e = i.length; if (e !== t.length) return !1; for (var n = 0; n < e; n++)if (!i[n].Ma(t[n])) return !1; return !0 }, t.toString = function (t) { void 0 === t && (t = -1); for (var i = t < 0 ? "M" + this.startX.toString() + " " + this.startY.toString() : "M" + this.startX.toFixed(t) + " " + this.startY.toFixed(t), e = this.segments.j, n = e.length, o = 0; o < n; o++)i += " " + e[o].toString(t); return i }, t.freeze = function () { this.s = !0, (i = this.segments).freeze(); for (var t = i.j, i = i.length, e = 0; e < i; e++)t[e].freeze(); return this }, t.ea = function () { this.s = !1; var t = this.segments; t.ea(); for (var i = (t = t.j).length, e = 0; e < i; e++)t[e].ea(); return this }, t.Mv = function () { if (this.qa) return !0; var t = this.segments; if (this.Ks !== t.Aa) return !0; for (var i = (t = t.j).length, e = 0; e < i; e++)if (t[e].qa) return !0; return !1 }, t.add = function (t) { return this.Jl.add(t), this }, t.aa = function (t, i, e) { for (var n = this.startX, o = this.startY, r = n, s = o, a = this.segments.j, h = a.length, l = 0; l < h; l++) { var u = a[l]; switch (u.type) { case ue: r = u.endX, s = u.endY, n = u.endX, o = u.endY; break; case ce: if (qi.Nb(n, o, u.endX, u.endY, e, t, i)) return !0; n = u.endX, o = u.endY; break; case fe: if (qi.ct(n, o, u.point1X, u.point1Y, u.point2X, u.point2Y, u.endX, u.endY, .5, t, i, e)) return !0; n = u.endX, o = u.endY; break; case de: if (qi.Wv(n, o, u.point1X, u.point1Y, u.endX, u.endY, .5, t, i, e)) return !0; n = u.endX, o = u.endY; break; case pe: case ge: var c = u.type === pe ? he(u, this) : le(u, this, n, o), f = c.length; if (0 === f) { if (qi.Nb(n, o, u.centerX, u.centerY, e, t, i)) return !0; n = u.centerX, o = u.centerY; break } for (var d = null, p = 0; p < f; p++)if (d = c[p], 0 === p && qi.Nb(n, o, d[0], d[1], e, t, i) || qi.ct(d[0], d[1], d[2], d[3], d[4], d[5], d[6], d[7], .5, t, i, e)) return !0; null !== d && (n = d[6], o = d[7]); break; default: B("Unknown Segment type: " + u.type) }if (u.isClosed && (n !== r || o !== s) && qi.Nb(n, o, r, s, e, t, i)) return !0 } return !1 }, l.Object.defineProperties(se.prototype, { isFilled: { get: function () { return this.Pr }, set: function (t) { this.s && g(this, t), this.Pr = t } }, isShadowed: { get: function () { return this.Tr }, set: function (t) { this.s && g(this, t), this.Tr = t } }, startX: { get: function () { return this.Rc }, set: function (t) { this.s && g(this, t), this.Rc = t, this.qa = !0 } }, startY: { get: function () { return this.Sc }, set: function (t) { this.s && g(this, t), this.Sc = t, this.qa = !0 } }, segments: { get: function () { return this.Jl }, set: function (t) { this.s && g(this, t), this.Jl = t, this.qa = !0 } } }), se.prototype.add = se.prototype.add, se.prototype.equalsApprox = se.prototype.Ma, se.className = "PathFigure", ae.prototype.copy = function () { var t = new ae; return t.pa = this.pa, t.ec = this.ec, t.mc = this.mc, t.we = this.we, t.Di = this.Di, t.Ei = this.Ei, t.hh = this.hh, t.rl = this.rl, t.Kk = this.Kk, t.wj = this.wj, t.qa = this.qa, t }, (t = ae.prototype).Ma = function (t) { if (!(t instanceof ae) || this.type !== t.type || this.isClosed !== t.isClosed) return !1; switch (this.type) { case ue: case ce: return qi.A(this.endX, t.endX) && qi.A(this.endY, t.endY); case fe: return qi.A(this.endX, t.endX) && qi.A(this.endY, t.endY) && qi.A(this.point1X, t.point1X) && qi.A(this.point1Y, t.point1Y) && qi.A(this.point2X, t.point2X) && qi.A(this.point2Y, t.point2Y); case de: return qi.A(this.endX, t.endX) && qi.A(this.endY, t.endY) && qi.A(this.point1X, t.point1X) && qi.A(this.point1Y, t.point1Y); case pe: return qi.A(this.startAngle, t.startAngle) && qi.A(this.sweepAngle, t.sweepAngle) && qi.A(this.centerX, t.centerX) && qi.A(this.centerY, t.centerY) && qi.A(this.radiusX, t.radiusX) && qi.A(this.radiusY, t.radiusY); case ge: return this.isClockwiseArc === t.isClockwiseArc && this.isLargeArc === t.isLargeArc && qi.A(this.xAxisRotation, t.xAxisRotation) && qi.A(this.endX, t.endX) && qi.A(this.endY, t.endY) && qi.A(this.radiusX, t.radiusX) && qi.A(this.radiusY, t.radiusY); default: return !1 } }, t.fb = function (t) { t.classType === ae && (this.type = t) }, t.toString = function (t) { switch (void 0 === t && (t = -1), this.type) { case ue: t = t < 0 ? "M" + this.endX.toString() + " " + this.endY.toString() : "M" + this.endX.toFixed(t) + " " + this.endY.toFixed(t); break; case ce: t = t < 0 ? "L" + this.endX.toString() + " " + this.endY.toString() : "L" + this.endX.toFixed(t) + " " + this.endY.toFixed(t); break; case fe: t = t < 0 ? "C" + this.point1X.toString() + " " + this.point1Y.toString() + " " + this.point2X.toString() + " " + this.point2Y.toString() + " " + this.endX.toString() + " " + this.endY.toString() : "C" + this.point1X.toFixed(t) + " " + this.point1Y.toFixed(t) + " " + this.point2X.toFixed(t) + " " + this.point2Y.toFixed(t) + " " + this.endX.toFixed(t) + " " + this.endY.toFixed(t); break; case de: t = t < 0 ? "Q" + this.point1X.toString() + " " + this.point1Y.toString() + " " + this.endX.toString() + " " + this.endY.toString() : "Q" + this.point1X.toFixed(t) + " " + this.point1Y.toFixed(t) + " " + this.endX.toFixed(t) + " " + this.endY.toFixed(t); break; case pe: t = t < 0 ? "B" + this.startAngle.toString() + " " + this.sweepAngle.toString() + " " + this.centerX.toString() + " " + this.centerY.toString() + " " + this.radiusX.toString() + " " + this.radiusY.toString() : "B" + this.startAngle.toFixed(t) + " " + this.sweepAngle.toFixed(t) + " " + this.centerX.toFixed(t) + " " + this.centerY.toFixed(t) + " " + this.radiusX.toFixed(t) + " " + this.radiusY.toFixed(t); break; case ge: t = t < 0 ? "A" + this.radiusX.toString() + " " + this.radiusY.toString() + " " + this.xAxisRotation.toString() + " " + (this.isLargeArc ? 1 : 0) + " " + (this.isClockwiseArc ? 1 : 0) + " " + this.endX.toString() + " " + this.endY.toString() : "A" + this.radiusX.toFixed(t) + " " + this.radiusY.toFixed(t) + " " + this.xAxisRotation.toFixed(t) + " " + (this.isLargeArc ? 1 : 0) + " " + (this.isClockwiseArc ? 1 : 0) + " " + this.endX.toFixed(t) + " " + this.endY.toFixed(t); break; default: t = this.type.toString() }return t + (this.wj ? "z" : "") }, t.freeze = function () { return this.s = !0, this }, t.ea = function () { return this.s = !1, this }, t.close = function () { return this.wj = !0, this }, l.Object.defineProperties(ae.prototype, { isClosed: { get: function () { return this.wj }, set: function (t) { this.wj !== t && (this.wj = t, this.qa = !0) } }, type: { get: function () { return this.pa }, set: function (t) { this.s && g(this, t), this.pa = t, this.qa = !0 } }, endX: { get: function () { return this.ec }, set: function (t) { this.s && g(this, t), this.ec = t, this.qa = !0 } }, endY: { get: function () { return this.mc }, set: function (t) { this.s && g(this, t), this.mc = t, this.qa = !0 } }, point1X: { get: function () { return this.we }, set: function (t) { this.s && g(this, t), this.we = t, this.qa = !0 } }, point1Y: { get: function () { return this.Di }, set: function (t) { this.s && g(this, t), this.Di = t, this.qa = !0 } }, point2X: { get: function () { return this.Ei }, set: function (t) { this.s && g(this, t), this.Ei = t, this.qa = !0 } }, point2Y: { get: function () { return this.hh }, set: function (t) { this.s && g(this, t), this.hh = t, this.qa = !0 } }, centerX: { get: function () { return this.we }, set: function (t) { this.s && g(this, t), this.we = t, this.qa = !0 } }, centerY: { get: function () { return this.Di }, set: function (t) { this.s && g(this, t), this.Di = t, this.qa = !0 } }, radiusX: { get: function () { return this.Ei }, set: function (t) { t < 0 && y(t, ">= zero", ae, "radiusX"), this.s && g(this, t), this.Ei = t, this.qa = !0 } }, radiusY: { get: function () { return this.hh }, set: function (t) { t < 0 && y(t, ">= zero", ae, "radiusY"), this.s && g(this, t), this.hh = t, this.qa = !0 } }, startAngle: { get: function () { return this.ec }, set: function (t) { this.ec !== t && (this.s && g(this, t), (t %= 360) < 0 && (t += 360), this.ec = t, this.qa = !0) } }, sweepAngle: { get: function () { return this.mc }, set: function (t) { this.s && g(this, t), 360 < t && (t = 360), t < -360 && (t = -360), this.mc = t, this.qa = !0 } }, isClockwiseArc: { get: function () { return this.Kk }, set: function (t) { this.s && g(this, t), this.Kk = t, this.qa = !0 } }, isLargeArc: { get: function () { return this.rl }, set: function (t) { this.s && g(this, t), this.rl = t, this.qa = !0 } }, xAxisRotation: { get: function () { return this.we }, set: function (t) { (t %= 360) < 0 && (t += 360), this.s && g(this, t), this.we = t, this.qa = !0 } } }), ae.prototype.equalsApprox = ae.prototype.Ma; var ue = new V(ae, "Move", 0), ce = new V(ae, "Line", 1), fe = new V(ae, "Bezier", 2), de = new V(ae, "QuadraticBezier", 3), pe = new V(ae, "Arc", 4), ge = new V(ae, "SvgArc", 4); function ye() { this.B = null, this.bv = new gi(0, 0).freeze(), this.lu = new gi(0, 0).freeze(), this.dr = this.gs = 0, this.er = 1, this.Xr = "", this.Ys = this.yr = !1, this.vr = this.gr = 0, this.Jg = this.Ir = this.Rr = !1, this.Dr = null, this.Ts = 0, this.cd = this.Ss = null } function me() { this.B = null, this.Qa = "", this.rs = this.Rs = null } function ve() { this.dn = be, this.af = this.fs = "", this.Po = this.Qo = this.Wo = this.Xo = this.Vo = this.B = this.ac = null } ae.className = "PathSegment", ae.Move = ue, ae.Line = ce, ae.Bezier = fe, ae.QuadraticBezier = de, ae.Arc = pe, ae.SvgArc = ge, ye.prototype.copy = function () { var t = new ye; return this.clone(t) }, ye.prototype.clone = function (t) { return t.B = this.B, t.bv.assign(this.viewPoint), t.lu.assign(this.documentPoint), t.gs = this.gs, t.dr = this.dr, t.er = this.er, t.Xr = this.Xr, t.yr = this.yr, t.Ys = this.Ys, t.gr = this.gr, t.vr = this.vr, t.Rr = this.Rr, t.Ir = this.Ir, t.Jg = this.Jg, t.Dr = this.Dr, t.Ts = this.Ts, t.Ss = this.Ss, t.cd = this.cd, t }, ye.prototype.toString = function () { var t = "^"; return 0 !== this.modifiers && (t += "M:" + this.modifiers), 0 !== this.button && (t += "B:" + this.button), "" !== this.key && (t += "K:" + this.key), 0 !== this.clickCount && (t += "C:" + this.clickCount), 0 !== this.delta && (t += "D:" + this.delta), this.handled && (t += "h"), this.bubbles && (t += "b"), null !== this.documentPoint && (t += "@" + this.documentPoint.toString()), t }, ye.prototype.pq = function (t, i) { var e = this.diagram; return null === e || Qo(e, this.event, t, i), i }, ye.prototype.Gz = function (t, i) { var e = this.diagram; return null === e || (Qo(e, this.event, t, i), i.assign(e.St(i))), i }, l.Object.defineProperties(ye.prototype, { diagram: { get: function () { return this.B }, set: function (t) { this.B = t } }, viewPoint: { get: function () { return this.bv }, set: function (t) { this.bv.assign(t) } }, documentPoint: { get: function () { return this.lu }, set: function (t) { this.lu.assign(t) } }, modifiers: { get: function () { return this.gs }, set: function (t) { this.gs = t } }, button: { get: function () { return this.dr }, set: function (t) { if (this.dr = t, null === this.event) switch (t) { case 0: this.buttons = 1; break; case 1: this.buttons = 4; break; case 2: this.buttons = 2 } } }, buttons: { get: function () { return this.er }, set: function (t) { this.er = t } }, key: { get: function () { return this.Xr }, set: function (t) { this.Xr = t } }, down: { get: function () { return this.yr }, set: function (t) { this.yr = t } }, up: { get: function () { return this.Ys }, set: function (t) { this.Ys = t } }, clickCount: { get: function () { return this.gr }, set: function (t) { this.gr = t } }, delta: { get: function () { return this.vr }, set: function (t) { this.vr = t } }, isMultiTouch: { get: function () { return this.Rr }, set: function (t) { this.Rr = t } }, handled: { get: function () { return this.Ir }, set: function (t) { this.Ir = t } }, bubbles: { get: function () { return this.Jg }, set: function (t) { this.Jg = t } }, event: { get: function () { return this.Dr }, set: function (t) { this.Dr = t } }, isTouchEvent: { get: function () { var t = c.TouchEvent, i = this.event; return !!(t && i instanceof t) || (t = c.PointerEvent) && i instanceof t && ("touch" === i.pointerType || "pen" === i.pointerType) } }, timestamp: { get: function () { return this.Ts }, set: function (t) { this.Ts = t } }, targetDiagram: { get: function () { return this.Ss }, set: function (t) { this.Ss = t } }, targetObject: { get: function () { return this.cd }, set: function (t) { this.cd = t } }, control: { get: function () { return 0 != (1 & this.modifiers) }, set: function (t) { this.modifiers = t ? 1 | this.modifiers : -2 & this.modifiers } }, shift: { get: function () { return 0 != (4 & this.modifiers) }, set: function (t) { this.modifiers = t ? 4 | this.modifiers : -5 & this.modifiers } }, alt: { get: function () { return 0 != (2 & this.modifiers) }, set: function (t) { this.modifiers = t ? 2 | this.modifiers : -3 & this.modifiers } }, meta: { get: function () { return 0 != (8 & this.modifiers) }, set: function (t) { this.modifiers = t ? 8 | this.modifiers : -9 & this.modifiers } }, left: { get: function () { var t = this.event; return null === t || "mousedown" !== t.type && "mouseup" !== t.type && "pointerdown" !== t.type && "pointerup" !== t.type ? 0 != (1 & this.buttons) : 0 === this.button }, set: function (t) { this.buttons = t ? 1 | this.buttons : -2 & this.buttons } }, right: { get: function () { var t = this.event; return null === t || "mousedown" !== t.type && "mouseup" !== t.type && "pointerdown" !== t.type && "pointerup" !== t.type ? 0 != (2 & this.buttons) : 2 === this.button }, set: function (t) { this.buttons = t ? 2 | this.buttons : -3 & this.buttons } }, middle: { get: function () { var t = this.event; return null === t || "mousedown" !== t.type && "mouseup" !== t.type && "pointerdown" !== t.type && "pointerup" !== t.type ? 0 != (4 & this.buttons) : 1 === this.button }, set: function (t) { this.buttons = t ? 4 | this.buttons : -5 & this.buttons } } }), ye.prototype.getMultiTouchDocumentPoint = ye.prototype.Gz, ye.prototype.getMultiTouchViewPoint = ye.prototype.pq, ye.className = "InputEvent", me.prototype.copy = function () { var t = new me; return t.B = this.B, t.Qa = this.Qa, t.Rs = this.Rs, t.rs = this.rs, t }, me.prototype.toString = function () { var t = "*" + this.name; return null !== this.subject && (t += ":" + this.subject.toString()), null !== this.parameter && (t += "(" + this.parameter.toString() + ")"), t }, l.Object.defineProperties(me.prototype, { diagram: { get: function () { return this.B }, set: function (t) { this.B = t } }, name: { get: function () { return this.Qa }, set: function (t) { this.Qa = t } }, subject: { get: function () { return this.Rs }, set: function (t) { this.Rs = t } }, parameter: { get: function () { return this.rs }, set: function (t) { this.rs = t } } }), me.className = "DiagramEvent", ve.prototype.clear = function () { this.Po = this.Qo = this.Wo = this.Xo = this.Vo = this.B = this.ac = null }, ve.prototype.copy = function () { var t = new ve; t.dn = this.dn, t.fs = this.fs, t.af = this.af, t.ac = this.ac, t.B = this.B, t.Vo = this.Vo; var i = this.Xo; return t.Xo = b(i) && "function" == typeof i.G ? i.G() : i, i = this.Wo, t.Wo = b(i) && "function" == typeof i.G ? i.G() : i, i = this.Qo, t.Qo = b(i) && "function" == typeof i.G ? i.G() : i, i = this.Po, t.Po = b(i) && "function" == typeof i.G ? i.G() : i, t }, ve.prototype.fb = function (t) { t.classType === ve && (this.change = t) }, ve.prototype.toString = function () { var t = "", t = this.change === xe ? t + "* " : this.change === be ? t + (null !== this.model ? "!m" : "!d") : t + ((null !== this.model ? "!m" : "!d") + this.change); return this.propertyName && "string" == typeof this.propertyName && (t += " " + this.propertyName), this.modelChange && this.modelChange !== this.propertyName && (t += " " + this.modelChange), t += ": ", this.change === xe ? null !== this.oldValue && (t += " " + this.oldValue) : (null !== this.object && (t += N(this.object)), null !== this.oldValue && (t += "  old: " + N(this.oldValue)), null !== this.oldParam && (t += " " + this.oldParam), null !== this.newValue && (t += "  new: " + N(this.newValue)), null !== this.newParam && (t += " " + this.newParam)), t }, ve.prototype.H = function (t) { return t ? this.oldValue : this.newValue }, ve.prototype.Iz = function (t) { return t ? this.oldParam : this.newParam }, ve.prototype.canUndo = function () { return null !== this.model || null !== this.diagram }, ve.prototype.undo = function () { this.canUndo() && (null !== this.model ? this.model.changeState(this, !0) : null !== this.diagram && this.diagram.changeState(this, !0)) }, ve.prototype.canRedo = function () { return null !== this.model || null !== this.diagram }, ve.prototype.redo = function () { this.canRedo() && (null !== this.model ? this.model.changeState(this, !1) : null !== this.diagram && this.diagram.changeState(this, !1)) }, l.Object.defineProperties(ve.prototype, { model: { get: function () { return this.ac }, set: function (t) { this.ac = t } }, diagram: { get: function () { return this.B }, set: function (t) { this.B = t } }, change: { get: function () { return this.dn }, set: function (t) { this.dn = t } }, modelChange: { get: function () { return this.fs }, set: function (t) { this.fs = t } }, propertyName: { get: function () { return this.af }, set: function (t) { this.af = t } }, isTransactionFinished: { get: function () { return this.dn === xe && ("CommittedTransaction" === this.af || "FinishedUndo" === this.af || "FinishedRedo" === this.af) } }, object: { get: function () { return this.Vo }, set: function (t) { this.Vo = t } }, oldValue: { get: function () { return this.Xo }, set: function (t) { this.Xo = t } }, oldParam: { get: function () { return this.Wo }, set: function (t) { this.Wo = t } }, newValue: { get: function () { return this.Qo }, set: function (t) { this.Qo = t } }, newParam: { get: function () { return this.Po }, set: function (t) { this.Po = t } } }), ve.prototype.redo = ve.prototype.redo, ve.prototype.canRedo = ve.prototype.canRedo, ve.prototype.undo = ve.prototype.undo, ve.prototype.canUndo = ve.prototype.canUndo, ve.prototype.getParam = ve.prototype.Iz, ve.prototype.getValue = ve.prototype.H, ve.prototype.clear = ve.prototype.clear; var xe = new V(ve, "Transaction", -1), be = new V(ve, "Property", 0), we = new V(ve, "Insert", 1), ke = new V(ve, "Remove", 2); function Me() { this.u = (new J).freeze(), this.Qa = "", this.l = !1 } function Se() { this.Ku = new $, this.Mc = !1, this.I = (new J).freeze(), this.Jd = -1, this.u = 999, this.me = !1, this.sr = null, this.Li = 0, this.l = !1, this.se = (new J).freeze(), this.zl = new J, this.su = !0, this.Eu = this.Cu = this.Bu = !1 } function Pe(t, i, e) { if (t.isUndoingRedoing) return !1; t.checksTransactionLevel && t.transactionLevel < 1 && v("Ending transaction without having started a transaction: " + e); var n = 1 === t.transactionLevel, o = t.currentTransaction; n && i && t.yb("CommittingTransaction", e, o); var r, s = 0; if (0 < t.transactionLevel && (t.Li--, t.isEnabled) && (0 < (r = t.se.count) && ("" === e && (e = t.se.L(0)), t.se.ea(), t.se.$a(r - 1), t.se.freeze()), 0 < (r = t.zl.count) && (s = t.zl.L(r - 1), t.zl.$a(r - 1))), n) { if (i) { if (t.Eu = !1, t.isEnabled && null !== o) { for (o.isComplete = !0, o.name = e, (i = t.history).ea(), n = i.count - 1; n > t.historyIndex; n--)null !== (s = i.L(n)) && s.clear(), i.$a(n), t.Eu = !0; 0 <= (n = t.maxHistoryLength) && (0 === n ? i.clear() : i.count >= n && (null !== (s = i.L(0)) && s.clear(), i.$a(0), t.Jd--)), 0 !== n && (i.add(o), t.Jd++), i.freeze() } t.yb("CommittedTransaction", e, o) } else { t.me = !0; try { t.isEnabled && null !== o && (o.isComplete = !0, o.undo()) } finally { t.yb("RolledBackTransaction", e, o), t.me = !1 } null !== o && o.clear() } return t.sr = null, t.isPendingClear && t.clear(), t.isPendingClear = !1, !(t.isPendingUnmodified = !1) } if (t.isEnabled && !i && null !== o) { for (t = s, o = (e = o.changes).count - 1; t <= o; o--)null !== (i = e.L(o)) && i.undo(), e.ea(), e.$a(o); e.freeze() } return !1 } function Ne() { Q(this), this.B = Qr, this.Qa = "", this.Mc = !0, this.kd = !1, this.Iw = null, this.Gy = new ye, this.at = -1 } function Ce() { Ne.call(this), this.name = "ToolManager", this.Ic = new J, this.Zc = new J, this.Df = new J, this.W = this.Ha = 850, this.u = new Yi(2, 2).ca(), this.ab = 5e3, this.Ia = Le, this.I = De, this.rr = this.l = null, this.Qj = -1 } function Te(t, i) { t.standardMouseOver(), t.isBeyondDragSize() && t.standardWaitAfter(t.isActive ? t.holdDelay : t.hoverDelay, i.lastInput) } ve.className = "ChangedEvent", ve.Transaction = xe, ve.Property = be, ve.Insert = we, ve.Remove = ke, Me.prototype.toString = function (t) { var i = "Transaction: " + this.name + " " + this.changes.count.toString() + (this.isComplete ? "" : ", incomplete"); if (void 0 !== t && 0 < t) { t = this.changes.count; for (var e = 0; e < t; e++) { var n = this.changes.L(e); null !== n && (i += "\n  " + n.toString()) } } return i }, Me.prototype.clear = function () { var t = this.changes; t.ea(); for (var i = t.count - 1; 0 <= i; i--) { var e = t.L(i); null !== e && e.clear() } t.clear(), t.freeze() }, Me.prototype.canUndo = function () { return this.isComplete }, Me.prototype.undo = function () { if (this.canUndo()) for (var t = this.changes.count - 1; 0 <= t; t--) { var i = this.changes.L(t); null !== i && i.undo() } }, Me.prototype.canRedo = function () { return this.isComplete }, Me.prototype.redo = function () { if (this.canRedo()) for (var t = this.changes.count, i = 0; i < t; i++) { var e = this.changes.L(i); null !== e && e.redo() } }, l.Object.defineProperties(Me.prototype, { changes: { get: function () { return this.u } }, name: { get: function () { return this.Qa }, set: function (t) { this.Qa = t } }, isComplete: { get: function () { return this.l }, set: function (t) { this.l = t } } }), Me.prototype.redo = Me.prototype.redo, Me.prototype.canRedo = Me.prototype.canRedo, Me.prototype.undo = Me.prototype.undo, Me.prototype.canUndo = Me.prototype.canUndo, Me.prototype.clear = Me.prototype.clear, Me.className = "Transaction", Se.prototype.toString = function (t) { var i = "UndoManager " + this.historyIndex + "<" + this.history.count + "<=" + this.maxHistoryLength; i += "["; for (var e = this.nestedTransactionNames.count, n = 0; n < e; n++)0 < n && (i += " "), i += this.nestedTransactionNames.L(n); if (i += "]", void 0 !== t && 0 < t) for (e = this.history.count, n = 0; n < e; n++)i += "\n " + this.history.L(n).toString(t - 1); return i }, Se.prototype.clear = function () { var t = this.history; t.ea(); for (var i = t.count - 1; 0 <= i; i--) { var e = t.L(i); null !== e && e.clear() } t.clear(), this.Jd = -1, t.freeze(), this.me = !1, this.sr = null, this.Li = 0, this.se.ea(), this.se.clear(), this.se.freeze(), this.zl.clear(), this.Cu = this.Bu = !1 }, Se.prototype.copyProperties = function (t) { this.isEnabled = t.isEnabled, this.maxHistoryLength = t.maxHistoryLength, this.checksTransactionLevel = t.checksTransactionLevel }, (t = Se.prototype).wx = function (t) { this.Ku.add(t) }, t.gy = function (t) { this.Ku.remove(t) }, t.ua = function (t) { if (void 0 === t && (t = ""), null === t && (t = ""), this.isUndoingRedoing) return !1; !0 === this.su && (this.su = !1, this.Li++, this.yb("StartingFirstTransaction", t, this.currentTransaction), 0 < this.Li && this.Li--), this.isEnabled && (this.se.ea(), this.se.add(t), this.se.freeze(), null === this.currentTransaction ? this.zl.add(0) : this.zl.add(this.currentTransaction.changes.count)), this.Li++; var i = 1 === this.transactionLevel; return i && this.yb("StartedTransaction", t, this.currentTransaction), i }, t.Va = function (t) { return void 0 === t && (t = ""), Pe(this, !0, t) }, t.Af = function () { return Pe(this, !1, "") }, Se.prototype.canUndo = function () { if (!this.isEnabled || 0 < this.transactionLevel) return !1; var t = this.transactionToUndo; return !(null === t || !t.canUndo()) }, Se.prototype.undo = function () { if (this.canUndo()) { var t = this.transactionToUndo; try { this.me = !0, this.yb("StartingUndo", "Undo", t), this.Jd--, t.undo() } catch (t) { v("undo error: " + t.toString()) } finally { this.yb("FinishedUndo", "Undo", t), this.me = !1 } } }, Se.prototype.canRedo = function () { if (!this.isEnabled || 0 < this.transactionLevel) return !1; var t = this.transactionToRedo; return !(null === t || !t.canRedo()) }, Se.prototype.redo = function () { if (this.canRedo()) { var t = this.transactionToRedo; try { this.me = !0, this.yb("StartingRedo", "Redo", t), this.Jd++, t.redo() } catch (t) { v("redo error: " + t.toString()) } finally { this.yb("FinishedRedo", "Redo", t), this.me = !1 } } }, Se.prototype.yb = function (t, i, e) { void 0 === e && (e = null); var n = new ve; for (n.change = xe, n.propertyName = t, n.object = e, n.oldValue = i, t = this.models; t.next();)i = t.value, (n.model = i).dt(n) }, Se.prototype.Gv = function (t) { var i, e; !this.isEnabled || this.isUndoingRedoing || this.skipsEvent(t) || (null === (e = this.currentTransaction) && (this.sr = e = new Me), i = t.copy(), (e = e.changes).ea(), e.add(i), e.freeze(), this.checksTransactionLevel && this.transactionLevel <= 0 && !this.su && (null !== (t = t.diagram) && !1 === t.kk || v("Change not within a transaction: " + i.toString()))) }, Se.prototype.skipsEvent = function (t) { if (null === t || t.change.value < 0) return !0; if (null === (t = t.object)) return !1; if (void 0 !== t.layer) { if (null !== (t = t.layer) && t.isTemporary) return !0 } else if (t.isTemporary) return !0; return !1 }, l.Object.defineProperties(Se.prototype, { models: { get: function () { return this.Ku.iterator } }, isEnabled: { get: function () { return this.Mc }, set: function (t) { this.Mc = t } }, transactionToUndo: { get: function () { return 0 <= this.historyIndex && this.historyIndex <= this.history.count - 1 ? this.history.L(this.historyIndex) : null } }, transactionToRedo: { get: function () { return this.historyIndex < this.history.count - 1 ? this.history.L(this.historyIndex + 1) : null } }, isUndoingRedoing: { get: function () { return this.me } }, history: { get: function () { return this.I } }, maxHistoryLength: { get: function () { return this.u }, set: function (t) { this.u = t } }, historyIndex: { get: function () { return this.Jd } }, currentTransaction: { get: function () { return this.sr } }, transactionLevel: { get: function () { return this.Li } }, isInTransaction: { get: function () { return 0 < this.Li } }, checksTransactionLevel: { get: function () { return this.l }, set: function (t) { this.l = t } }, nestedTransactionNames: { get: function () { return this.se } }, isPendingClear: { get: function () { return this.Bu }, set: function (t) { this.Bu = t } }, isPendingUnmodified: { get: function () { return this.Cu }, set: function (t) { this.Cu = t } } }), Se.prototype.handleChanged = Se.prototype.Gv, Se.prototype.redo = Se.prototype.redo, Se.prototype.undo = Se.prototype.undo, Se.prototype.canUndo = Se.prototype.canUndo, Se.prototype.rollbackTransaction = Se.prototype.Af, Se.prototype.commitTransaction = Se.prototype.Va, Se.prototype.startTransaction = Se.prototype.ua, Se.prototype.removeModel = Se.prototype.gy, Se.prototype.addModel = Se.prototype.wx, Se.prototype.clear = Se.prototype.clear, Se.className = "UndoManager", Ne.prototype.toString = function () { return "" !== this.name ? this.name + " Tool" : P(this.constructor) }, Ne.prototype.updateAdornments = function () { }, Ne.prototype.canStart = function () { return this.isEnabled }, Ne.prototype.doStart = function () { }, Ne.prototype.doActivate = function () { this.isActive = !0 }, Ne.prototype.doDeactivate = function () { this.isActive = !1 }, Ne.prototype.doStop = function () { }, Ne.prototype.doCancel = function () { this.transactionResult = null, this.stopTool() }, Ne.prototype.stopTool = function () { var t = this.diagram; t.currentTool === this && (t.currentTool = null, t.currentCursor = "") }, Ne.prototype.doMouseDown = function () { !this.isActive && this.canStart() && this.doActivate() }, Ne.prototype.doMouseMove = function () { }, Ne.prototype.doMouseUp = function () { this.stopTool() }, Ne.prototype.doMouseWheel = function () { }, Ne.prototype.canStartMultiTouch = function () { return !0 }, Ne.prototype.standardPinchZoomStart = function () { var t, i, e = this.diagram, n = e.lastInput, o = n.pq(0, gi.allocAt(NaN, NaN)), r = n.pq(1, gi.allocAt(NaN, NaN)); o.v() && r.v() && (this.doCancel(), e.lm("hasGestureZoom")) && (e.Bl = e.scale, t = r.x - o.x, i = r.y - o.y, e.Wu = Math.sqrt(t * t + i * i), n.bubbles = !1), gi.free(o), gi.free(r) }, Ne.prototype.standardPinchZoomMove = function () { var t, i, e, n, o = this.diagram, r = o.lastInput, s = r.pq(0, gi.allocAt(NaN, NaN)), a = r.pq(1, gi.allocAt(NaN, NaN)); s.v() && a.v() && (this.doCancel(), o.lm("hasGestureZoom")) && (i = a.x - s.x, t = a.y - s.y, t = Math.sqrt(i * i + t * t) / o.Wu, i = new gi((Math.min(a.x, s.x) + Math.max(a.x, s.x)) / 2, (Math.min(a.y, s.y) + Math.max(a.y, s.y)) / 2), t *= o.Bl, e = o.commandHandler, t !== o.scale && e.canResetZoom(t) && (n = o.zoomPoint, o.zoomPoint = i, e.resetZoom(t), o.zoomPoint = n), r.bubbles = !1), gi.free(s), gi.free(a) }, Ne.prototype.doKeyDown = function () { "Esc" === this.diagram.lastInput.key && this.doCancel() }, Ne.prototype.doKeyUp = function () { }, Ne.prototype.ua = function (t) { return void 0 === t && (t = this.name), this.transactionResult = null, this.diagram.ua(t) }, Ne.prototype.Eg = function () { var t = this.diagram; return null === this.transactionResult ? t.Af() : t.Va(this.transactionResult) }, Ne.prototype.standardMouseSelect = function () { var t = this.diagram; if (t.allowSelect) { var i = t.lastInput, e = t.im(i.documentPoint, !1); if (null !== e) { if (I ? i.meta : i.control) { for (t.R("ChangingSelection", t.selection), i = e; null !== i && !i.canSelect();)i = i.containingGroup; null !== i && (i.isSelected = !i.isSelected), t.R("ChangedSelection", t.selection) } else if (i.shift) { if (!e.isSelected) { for (t.R("ChangingSelection", t.selection), i = e; null !== i && !i.canSelect();)i = i.containingGroup; null !== i && (i.isSelected = !0), t.R("ChangedSelection", t.selection) } } else if (!e.isSelected) { for (i = e; null !== i && !i.canSelect();)i = i.containingGroup; null !== i && t.select(i) } } else !i.left || (I ? i.meta : i.control) || i.shift || t.clearSelection() } }, Ne.prototype.standardMouseClick = function (t, i) { void 0 === t && (t = null), void 0 === i && (i = function (t) { return !t.layer.isTemporary }); var e = this.diagram, n = e.lastInput; return t = e.Ub(n.documentPoint, t, i), function (t, i, e) { if (i.handled = !1, null === t || t.Bg()) { var n = 0; i.left ? n = 1 !== i.clickCount && 2 === i.clickCount ? 2 : 1 : i.right && 1 === i.clickCount && (n = 3); var o = "ObjectSingleClicked"; if (null !== t) { switch (n) { case 1: o = "ObjectSingleClicked"; break; case 2: o = "ObjectDoubleClicked"; break; case 3: o = "ObjectContextClicked" }0 !== n && e.R(o, t) } else { switch (n) { case 1: o = "BackgroundSingleClicked"; break; case 2: o = "BackgroundDoubleClicked"; break; case 3: o = "BackgroundContextClicked" }0 !== n && e.R(o) } if (null !== t) for (; null !== t;) { switch (e = null, n) { case 1: e = t.click; break; case 2: e = t.doubleClick ? t.doubleClick : t.click; break; case 3: e = t.contextClick }if (null !== e && (e(i, t), i.handled)) break; t = t.panel } else { switch (t = null, n) { case 1: t = e.click; break; case 2: t = e.doubleClick ? e.doubleClick : e.click; break; case 3: t = e.contextClick }null !== t && t(i) } } }(n.targetObject = t, n, e), n.handled }, Ne.prototype.standardMouseOver = function () { var t = this.diagram, i = t.lastInput; if (!0 !== t.animationManager.qc) { var e = t.skipsUndoManager; t.skipsUndoManager = !0; var n = t.viewportBounds.aa(i.documentPoint) ? t.Ub(i.documentPoint, null, null) : null, o = !1; if ((i.targetObject = n) !== t.mj) { var r = t.mj, s = r; for (t.mj = n, this.doCurrentObjectChanged(r, n), i.handled = !1; null !== r;) { var a = r.mouseLeave; if (null !== a) { if (n === r) break; if (null !== n && n.Ag(r)) break; if (a(i, r, n), o = !0, i.handled) break } r = r.panel } for (r = s, i.handled = !1; null !== n;) { if (null !== (s = n.mouseEnter)) { if (r === n) break; if (null !== r && r.Ag(n)) break; if (s(i, n, r), o = !0, i.handled) break } n = n.panel } n = t.mj } if (null !== n) { for (r = n, s = ""; null !== r && "" === (s = r.cursor);)r = r.panel; for (t.currentCursor = s, i.handled = !1, r = n; null !== r && (null === (n = r.mouseOver) || (n(i, r), o = !0, !i.handled));)r = r.panel } else t.currentCursor = "", null !== (n = t.mouseOver) && (n(i), o = !0); o && t.Pb(), t.skipsUndoManager = e } }, Ne.prototype.doCurrentObjectChanged = function () { }, Ne.prototype.standardMouseWheel = function () { var t = this.diagram, i = t.lastInput, e = i.delta; if (0 !== e && t.documentBounds.v()) { var n = t.commandHandler, o = t.toolManager.mouseWheelBehavior; if (null !== n && (o === Ae && !i.shift || o === Le && i.control)) (0 < e ? n.canIncreaseZoom() : n.canDecreaseZoom()) && (o = t.zoomPoint, t.zoomPoint = i.viewPoint, 0 < e ? n.increaseZoom() : n.decreaseZoom(), t.zoomPoint = o), i.bubbles = !1; else if (o === Ae && i.shift || o === Le && !i.control) { n = t.position.copy(); var r = 0 < e ? e : -e, s = (a = i.event).deltaMode, o = a.deltaX, a = a.deltaY; if ((D || F || O) && (s = 1, 0 < o && (o = 3), o < 0 && (o = -3), 0 < a && (a = 3), a < 0 && (a = -3)), void 0 === s || void 0 === o || void 0 === a || 0 === o && 0 === a || i.shift) !i.shift && t.allowVerticalScroll ? (r = 3 * r * t.scrollVerticalLineChange, 0 < e ? t.scroll("pixel", "up", r) : t.scroll("pixel", "down", r)) : i.shift && t.allowHorizontalScroll && (r = 3 * r * t.scrollHorizontalLineChange, 0 < e ? t.scroll("pixel", "left", r) : t.scroll("pixel", "right", r)); else { switch (s) { case 0: e = "pixel"; break; case 1: e = "line"; break; case 2: e = "page"; break; default: e = "pixel" }0 !== o && t.allowHorizontalScroll && (0 < (o *= t.scrollHorizontalLineChange / 16) ? t.scroll(e, "left", -o) : t.scroll(e, "right", o)), 0 !== a && t.allowVerticalScroll && (0 < (a *= t.scrollVerticalLineChange / 16) ? t.scroll(e, "up", -a) : t.scroll(e, "down", a)) } t.position.w(n) || (i.bubbles = !1) } } }, Ne.prototype.standardWaitAfter = function (t, i) { void 0 === i && (i = this.diagram.lastInput), this.cancelWaitAfter(); var e = this, n = i.clone(this.Gy); this.at = m(function () { e.doWaitAfter(n) }, t) }, Ne.prototype.cancelWaitAfter = function () { -1 !== this.at && c.clearTimeout(this.at), this.at = -1 }, Ne.prototype.doWaitAfter = function () { }, Ne.prototype.findToolHandleAt = function (t, i) { return null !== (t = this.diagram.Ub(t, function (t) { for (; null !== t && !(t.panel instanceof du);)t = t.panel; return t })) && t.part.category === i ? t : null }, Ne.prototype.isBeyondDragSize = function (t, i) { var e = this.diagram; void 0 === t && (t = e.firstInput.viewPoint), void 0 === i && (i = e.lastInput.viewPoint); var n = (o = e.toolManager.dragSize).width, o = o.height; return e.firstInput.isTouchEvent && (n += 6, o += 6), Math.abs(i.x - t.x) > n || Math.abs(i.y - t.y) > o }, l.Object.defineProperties(Ne.prototype, { diagram: { get: function () { return this.B }, set: function (t) { t instanceof Lo && (this.B = t) } }, name: { get: function () { return this.Qa }, set: function (t) { this.Qa = t } }, isEnabled: { get: function () { return this.Mc }, set: function (t) { this.Mc = t } }, isActive: { get: function () { return this.kd }, set: function (t) { this.kd = t } }, transactionResult: { get: function () { return this.Iw }, set: function (t) { this.Iw = t } } }), Ne.prototype.stopTransaction = Ne.prototype.Eg, Ne.prototype.startTransaction = Ne.prototype.ua, Ne.className = "Tool", h(Ce, Ne), Ce.prototype.initializeStandardTools = function () { }, Ce.prototype.updateAdornments = function (t) { var i, e = this.currentToolTip; e instanceof du && this.rr === t && (i = e.adornedObject, (null !== t ? i.part === t : null === i) ? this.showToolTip(e, i) : this.hideToolTip()) }, Ce.prototype.doMouseDown = function () { var t = this.diagram, i = t.lastInput; if (i.isTouchEvent && this.gestureBehavior === Fe && (i.bubbles = !1), i.isMultiTouch) { if (this.cancelWaitAfter(), this.gestureBehavior === Oe) return void (i.bubbles = !0); if (this.gestureBehavior === Fe) return; if (t.currentTool.canStartMultiTouch()) return void t.currentTool.standardPinchZoomStart() } for (var e = this.mouseDownTools.length, n = 0; n < e; n++) { var o = this.mouseDownTools.L(n); if (o.diagram = this.diagram, o.canStart()) return t.doFocus(), t.currentTool = o, void (t.currentTool === o && (o.isActive || o.doActivate(), o.doMouseDown())) } 1 === t.lastInput.button && (this.mouseWheelBehavior === Le ? this.mouseWheelBehavior = Ae : this.mouseWheelBehavior === Ae && (this.mouseWheelBehavior = Le)), this.doActivate(), this.standardWaitAfter(this.holdDelay, i) }, Ce.prototype.doMouseMove = function () { var t = this.diagram, i = t.lastInput; if (i.isMultiTouch) { if (this.gestureBehavior === Oe) return void (i.bubbles = !0); if (this.gestureBehavior === Fe) return; if (t.currentTool.canStartMultiTouch()) return void t.currentTool.standardPinchZoomMove() } if (this.isActive) for (var e = this.mouseMoveTools.length, n = 0; n < e; n++) { var o = this.mouseMoveTools.L(n); if (o.diagram = this.diagram, o.canStart()) return t.doFocus(), t.currentTool = o, void (t.currentTool === o && (o.isActive || o.doActivate(), o.doMouseMove())) } Te(this, t), null === (t = i.event) || "mousemove" !== t.type && "pointermove" !== t.type && t.cancelable || (i.bubbles = !0) }, Ce.prototype.doCurrentObjectChanged = function (t, i) { null === (t = this.currentToolTip) || null !== i && t instanceof du && (i === t || i.Ag(t)) || this.hideToolTip() }, Ce.prototype.doWaitAfter = function (t) { var i = this.diagram; i.sa && (this.doMouseHover(), this.isActive || this.doToolTip(), t.isTouchEvent && !i.lastInput.handled && ((t = t.copy()).button = 2, t.buttons = 2, i.lastInput = t, i.Pj = !0, i.doMouseUp())) }, Ce.prototype.doMouseHover = function () { var t = this.diagram, i = t.lastInput; null === i.targetObject && (i.targetObject = t.Ub(i.documentPoint, null, null)); var e = i.targetObject; if (null !== e) for (i.handled = !1; null !== e && (null === (t = this.isActive ? e.mouseHold : e.mouseHover) || (t(i, e), !i.handled));)e = e.panel; else null !== (e = this.isActive ? t.mouseHold : t.mouseHover) && e(i) }, Ce.prototype.doToolTip = function () { var t = this.diagram, i = t.lastInput; if (null === i.targetObject && (i.targetObject = t.Ub(i.documentPoint, null, null)), null !== (i = i.targetObject)) { if (!((t = this.currentToolTip) instanceof du) || i !== t && !i.Ag(t)) { for (; null !== i;) { if (null !== (t = i.toolTip)) return void this.showToolTip(t, i); i = i.panel } this.hideToolTip() } } else null !== (i = t.toolTip) ? this.showToolTip(i, null) : this.hideToolTip() }, Ce.prototype.showToolTip = function (t, i) { var e, n, o = this.diagram; t !== this.currentToolTip && this.hideToolTip(), t instanceof du ? (t.layerName = "Tool", t.selectable = !1, t.scale = 1 / o.scale, t.category = "ToolTip", null !== t.placeholder && (t.placeholder.scale = o.scale), null !== (e = t.diagram) && e !== o && e.remove(t), o.add(t), null !== i ? t.adornedObject = i : t.data = o.model, t.zb(), this.positionToolTip(t, i)) : t instanceof Pn && t !== this.currentToolTip && t.show(i, o, this), this.currentToolTip = t, -1 !== this.Qj && (c.clearTimeout(this.Qj), this.Qj = -1), 0 < (t = this.toolTipDuration) && 1 / 0 !== t && ((n = this).Qj = m(function () { n.hideToolTip() }, t)) }, Ce.prototype.positionToolTip = function (t) { var i, e, n, o; null === t.placeholder && (e = (i = this.diagram).lastInput.documentPoint.copy(), n = t.measuredBounds, o = i.viewportBounds, i.lastInput.isTouchEvent && (e.x -= n.width), e.x + n.width > o.right && (e.x -= n.width + 5 / i.scale), e.x < o.x && (e.x = o.x), e.y = e.y + 20 / i.scale + n.height > o.bottom ? e.y - (n.height + 5 / i.scale) : e.y + 20 / i.scale, e.y < o.y && (e.y = o.y), t.position = e) }, Ce.prototype.hideToolTip = function () { -1 !== this.Qj && (c.clearTimeout(this.Qj), this.Qj = -1); var t = this.diagram, i = this.currentToolTip; null !== i && (i instanceof du ? (t.remove(i), null !== this.rr && this.rr.zf(i.category), i.data = null, i.adornedObject = null) : i instanceof Pn && null !== i.hide && i.hide(t, this), this.currentToolTip = null) }, Ce.prototype.doMouseUp = function () { this.cancelWaitAfter(); var t = this.diagram; if (this.isActive) for (var i = this.mouseUpTools.length, e = 0; e < i; e++) { var n = this.mouseUpTools.L(e); if (n.diagram = this.diagram, n.canStart()) return t.doFocus(), t.currentTool = n, void (t.currentTool === n && (n.isActive || n.doActivate(), n.doMouseUp())) } t.doFocus(), this.doDeactivate() }, Ce.prototype.doMouseWheel = function () { this.standardMouseWheel() }, Ce.prototype.doKeyDown = function () { var t = this.diagram; null !== t.commandHandler && t.commandHandler.doKeyDown() }, Ce.prototype.doKeyUp = function () { var t = this.diagram; null !== t.commandHandler && t.commandHandler.doKeyUp() }, Ce.prototype.findTool = function (t) { for (var i = this.mouseDownTools.length, e = 0; e < i; e++) { var n = this.mouseDownTools.L(e); if (n.name === t) return n } for (i = this.mouseMoveTools.length, e = 0; e < i; e++)if ((n = this.mouseMoveTools.L(e)).name === t) return n; for (i = this.mouseUpTools.length, e = 0; e < i; e++)if ((n = this.mouseUpTools.L(e)).name === t) return n; return null }, Ce.prototype.replaceTool = function (t, i) { null !== i && (i.diagram = this.diagram); for (var e = this.mouseDownTools.length, n = 0; n < e; n++) { var o = this.mouseDownTools.L(n); if (o.name === t) return null !== i ? this.mouseDownTools.hd(n, i) : this.mouseDownTools.$a(n), o } for (e = this.mouseMoveTools.length, n = 0; n < e; n++)if ((o = this.mouseMoveTools.L(n)).name === t) return null !== i ? this.mouseMoveTools.hd(n, i) : this.mouseMoveTools.$a(n), o; for (e = this.mouseUpTools.length, n = 0; n < e; n++)if ((o = this.mouseUpTools.L(n)).name === t) return null !== i ? this.mouseUpTools.hd(n, i) : this.mouseUpTools.$a(n), o; return null }, Ce.prototype.Wa = function (t, i, e) { null !== i && (i.name = t, i.diagram = this.diagram), this.findTool(t) ? this.replaceTool(t, i) : null !== i && e.add(i) }, l.Object.defineProperties(Ce.prototype, { mouseWheelBehavior: { get: function () { return this.Ia }, set: function (t) { this.Ia = t } }, gestureBehavior: { get: function () { return this.I }, set: function (t) { this.I = t } }, currentToolTip: { get: function () { return this.l }, set: function (t) { this.l = t, this.rr = null !== t && t instanceof du ? t.adornedPart : null } }, mouseDownTools: { get: function () { return this.Ic } }, mouseMoveTools: { get: function () { return this.Zc } }, mouseUpTools: { get: function () { return this.Df } }, hoverDelay: { get: function () { return this.Ha }, set: function (t) { this.Ha = t } }, holdDelay: { get: function () { return this.W }, set: function (t) { this.W = t } }, dragSize: { get: function () { return this.u }, set: function (t) { this.u = t.G() } }, toolTipDuration: { get: function () { return this.ab }, set: function (t) { this.ab = t } } }), Ce.prototype.replaceStandardTool = Ce.prototype.Wa; var Le = new V(Ce, "WheelScroll", 0), Ae = new V(Ce, "WheelZoom", 1), je = new V(Ce, "WheelNone", 2), De = new V(Ce, "GestureZoom", 3), Fe = new V(Ce, "GestureCancel", 4), Oe = new V(Ce, "GestureNone", 5); function Be() { Ne.call(this), this.name = "Dragging", this.I = this.Zc = !0, this.u = this.ab = this.Ha = this.lg = null, this.Bn = this.Df = !1, this.Pl = new gi(NaN, NaN), this.Ps = new gi, this.Ic = !0, this.Vk = 100, this.Qg = [], this.Tq = (new $).freeze(), this.Ia = new Ts, this.lo = null, this.W = "copy", this.Lh = "", this.Oh = "no-drop" } function Ie(t, i) { var e; !t.dragsLink || (e = t.diagram).allowRelink && (e.model.ik() && 1 === i.count && i.first() instanceof Fu ? (t.draggedLink = i.first(), t.draggedLink.canRelinkFrom() && t.draggedLink.canRelinkTo() && t.draggedLink.Yj(), t.lg = e.toolManager.findTool("Relinking"), null === t.lg && (t.lg = new un, t.lg.diagram = e)) : (t.draggedLink = null, t.lg = null)) } function Re(t) { var i = t.diagram, e = i.skipsUndoManager; i.skipsUndoManager = !0, Ke(t, i.lastInput, null), i.skipsUndoManager = e, t.Qg.length = 0 } function Ee() { var t = en; Ye(t), qe(t); var i = t.diagram; t.Pl.v() && (i.position = t.Pl), i.Bf() } function ze(t, i) { var e = 1 / 0, n = 1 / 0, o = -1 / 0, r = -1 / 0; for (t = t.iterator; t.next();) { var s, a = t.value; a.Wb() && a.isVisible() && (a = (s = a.location).x, s = s.y, isNaN(a) || isNaN(s) || (a < e && (e = a), s < n && (n = s), o < a && (o = a), r < s && (r = s))) } 1 / 0 === e ? i.h(0, 0, 0, 0) : i.h(e, n, o - e, r - n) } function Ve(t, i) { if (null === t.copiedParts) { var e = t.diagram; if ((!i || !e.isReadOnly && !e.isModelReadOnly) && null !== t.draggedParts) { var n = e.undoManager; for (n.isEnabled && n.isInTransaction ? null !== n.currentTransaction && 0 < n.currentTransaction.changes.count && (e.undoManager.Af(), e.ua("Drag")) : qe(t), e.skipsUndoManager = !i, e.partManager.addsToTemporaryLayer = !i, t.startPoint = e.firstInput.documentPoint, i = t.copiesEffectiveCollection ? t.draggedParts.Cf() : e.selection, i = (e = e.ck(i, e, !0)).iterator; i.next();)i.value.location = i.key.location; for (ze(e, i = yi.alloc()), yi.free(i), i = new at, n = t.draggedParts.iterator; n.next();) { var o = n.key; o.Wb() && o.canCopy() && (null !== (o = e.H(o)) && (o.zb(), i.add(o, t.td(o.location)))) } for (e = e.iterator; e.next();)(n = e.value) instanceof Fu && n.canCopy() && i.add(n, t.td()); t.copiedParts = i, Ie(t, i.Cf()), null !== t.draggedLink && (i = (e = t.draggedLink).routeBounds, Iu(e, t.startPoint.x - (i.x + i.width / 2), t.startPoint.y - (i.y + i.height / 2))) } } } function Ye(t) { var i = t.diagram; if (null !== t.copiedParts && (i.Lt(t.copiedParts.Cf(), !1), (t.copiedParts = null) !== t.draggedParts)) for (var e = t.draggedParts.iterator; e.next();)e.key instanceof Fu && (e.value.point = new gi(0, 0)); i.skipsUndoManager = !1, i.partManager.addsToTemporaryLayer = !1, t.startPoint = i.firstInput.documentPoint } function Ge(t) { var i; null !== t.draggedLink && (t.dragsLink && null !== t.lg && ((i = t.lg).diagram.remove(i.temporaryFromNode), i.diagram.remove(i.temporaryToNode)), t.draggedLink = null, t.lg = null) } function Xe(t, i, e) { var n = t.diagram, o = t.startPoint, r = gi.alloc(); r.assign(n.lastInput.documentPoint), t.moveParts(i, r.ae(o), e), gi.free(r), !0 === n.De("temporaryPixelRatio") && null === n.rh && 30 < n.zx && (Fo(n), n.Jt()) } function qe(t) { if (null !== t.draggedParts) { for (var i, e = t.diagram, n = t.draggedParts.iterator; n.next();) { var o = n.key; o.Wb() && (o.location = n.value.point) } for (n = t.draggedParts.iterator; n.next();) { (o = n.key) instanceof Fu && o.suspendsRouting && (i = n.value.point, t.draggedParts.add(o, t.td()), Iu(o, -i.x, -i.y)) } e.Xc() } } function Ue(t, i) { var e = t.diagram; t.dragsLink && (null !== t.draggedLink && (t.draggedLink.fromNode = null, t.draggedLink.toNode = null), Je(t, !1)); var n = t.findDragOverObject(i), o = e.lastInput; o.targetObject = n, t.doUpdateCursor(n); var r = e.skipsUndoManager, s = !1; try { if (e.skipsUndoManager = !0, s = Ke(t, o, n), !t.isActive && null === en) return; var a, h = null !== n ? n.part : null; if (null !== h && (!e.handlesDragDropForTopLevelParts || !h.isTopLevel || h instanceof Lu) || null !== (a = e.mouseDragOver) && (a(o), s = !0), !t.isActive && null === en) return; if (t.doDragOver(i, n), !t.isActive && null === en) return } finally { e.skipsUndoManager = r, s && e.Xc() } t.lo = n, e.isReadOnly || !e.allowMove && !e.allowCopy || !e.allowHorizontalScroll && !e.allowVerticalScroll || e.it(o.viewPoint) } function Ke(t, i, e) { var n = !1, o = t.Qg.length, r = 0 < o ? t.Qg[0] : null; if (e === r) return !1; i.handled = !1; for (var s = 0; s < o; s++) { var a = t.Qg[s], h = a.mouseDragLeave; if (null !== h && (h(i, a, e), n = !0, i.handled)) break } if (t.Qg.length = 0, !t.isActive && null === en || null === e) return n; for (i.handled = !1, o = e; null !== o;)t.Qg.push(o), o = He(o); for (o = t.Qg.length, e = 0; e < o && (null === (a = (s = t.Qg[e]).mouseDragEnter) || (a(i, s, r), n = !0, !i.handled)); e++); return n } function He(t) { var i = t.panel; return null !== i ? i : t instanceof Hl && !(t instanceof Lu) && (null !== (t = t.containingGroup) && t.handlesDragDropForMembers) ? t : null } function We(t, i, e) { var n = t.lg; if (null === n) return null; var o = t.diagram.xg(i, n.portGravity, function (t) { return n.findValidLinkablePort(t, e) }); t = gi.alloc(); for (var r = 1 / 0, s = null, o = o.iterator; o.next();) { var a, h = o.value; null !== h.part && (a = h.ga(Zt, t), (a = i.Ce(a)) < r && (s = h, r = a)) } return gi.free(t), s } function Je(t, i) { var e, n, o, r, s, a, h = t.draggedLink; null === h || h.pointsCount < 2 || ((e = t.diagram).isReadOnly || null !== (n = t.lg) && ((r = o = null) !== h.fromNode || null !== (o = We(t, h.i(0), !1)) && (r = o.part), (a = s = null) !== h.toNode || null !== (s = We(t, h.i(h.pointsCount - 1), !0)) && (a = s.part), n.isValidLink(r, o, a, s) ? i ? (h.defaultFromPoint = h.i(0), h.defaultToPoint = h.i(h.pointsCount - 1), h.suspendsRouting = !1, h.fromNode = r, null !== o && (h.fromPortId = o.portId), h.toNode = a, null !== s && (h.toPortId = s.portId), h.fromPort !== e.Zx && e.R("LinkRelinked", h, e.Zx), h.toPort !== e.$x && e.R("LinkRelinked", h, e.$x)) : cn(n, r, o, a, s) : cn(n, null, null, null, null))) } function Ze(t, i) { var e = t.diagram; t.dragsLink && Je(t, !0), Re(t); var n = t.findDragOverObject(i), o = e.lastInput; if (null !== (o.targetObject = n)) { o.handled = !1; for (var r = n; null !== r;) { var s = r.mouseDrop; if (null !== s && (s(o, r), o.handled)) break; $e(t, o, r), r = He(r) } } else null !== (r = e.mouseDrop) && r(o); if (t.isActive || null !== en) { for (o = (t.copiedParts || t.draggedParts).iterator; o.next();)(r = o.key) instanceof pu && r.linksConnected.each(function (t) { t.suspendsRouting = !1 }); if (t.doDropOnto(i, n), t.isActive || null !== en) { for (t = yi.alloc(), i = e.selection.iterator; i.next();)(n = i.value) instanceof pu && Qe(e, n, t); yi.free(t) } } } function $e(t, i, e) { t = t.diagram, e = e.part, !t.handlesDragDropForTopLevelParts || !e.isTopLevel || e instanceof Lu || null !== (e = t.mouseDrop) && e(i) } function Qe(t, i, e) { var n = !1; if (i.getAvoidableRect(e), t.viewportBounds.Be(e) && (n = !0), 0 !== (t = t.yv(e, function (t) { return t.part }, function (t) { return t instanceof Fu }, !0, function (t) { return t instanceof Fu }, n)).count) for (t = t.iterator; t.next();)!(e = t.value).Xd(i) && e.isAvoiding && e.Ta() } function _e(t, i, e, n) { if (null === t.copiedParts) { var o = t.diagram; if (!o.isReadOnly && !o.isModelReadOnly) { o.skipsUndoManager = !e, o.partManager.addsToTemporaryLayer = !e, t.startPoint = n.documentPoint, e = o.ck(i, o, !0); var r = yi.alloc(); ze(i, r), n = r.x + r.width / 2, o = r.y + r.height / 2, yi.free(r), r = t.Ps; var s = new at, a = gi.alloc(); for (i = i.iterator; i.next();) { var h = i.value, l = e.H(h); h.Wb() && h.canCopy() ? (h = h.location, a.h(r.x - (n - h.x), r.y - (o - h.y)), l.location = a, l.zb(), s.add(l, t.td(a))) : l instanceof Fu && h.canCopy() && (Iu(l, r.x - n, r.y - o), s.add(l, t.td())) } gi.free(a), t.copiedParts = s, Ie(t, s.Cf()), null !== t.draggedLink && (n = (e = t.draggedLink).routeBounds, Iu(e, t.startPoint.x - (n.x + n.width / 2), t.startPoint.y - (n.y + n.height / 2))) } } } Ce.className = "ToolManager", Ce.WheelScroll = Le, Ce.WheelZoom = Ae, Ce.WheelNone = je, Ce.GestureZoom = De, Ce.GestureCancel = Fe, Ce.GestureNone = Oe, h(Be, Ne), Be.prototype.canStart = function () { if (!this.isEnabled) return !1; var t = this.diagram; if (t.isReadOnly && !t.allowDragOut || !t.allowMove && !t.allowCopy && !t.allowDragOut || !t.allowSelect) return !1; var i = t.lastInput; return !(!i.left || t.currentTool !== this && (!this.isBeyondDragSize() || i.isTouchEvent && i.timestamp - t.firstInput.timestamp < this.Vk)) && null !== this.findDraggablePart() }, Be.prototype.findDraggablePart = function () { var t = this.diagram; if (null === (t = t.im(t.firstInput.documentPoint, !1))) return null; for (; null !== t && !t.canSelect();)t = t.containingGroup; return null !== t && (t.canMove() || t.canCopy()) ? t : null }, Be.prototype.standardMouseSelect = function () { var t = this.diagram; if (t.allowSelect) { var i = t.im(t.firstInput.documentPoint, !1); if (null !== i) { for (; null !== i && !i.canSelect();)i = i.containingGroup; this.currentPart = i, null === this.currentPart || this.currentPart.isSelected || (t.R("ChangingSelection", t.selection), i = t.lastInput, (I ? i.meta : i.control) || i.shift || t.clearSelection(!0), this.currentPart.isSelected = !0, t.R("ChangedSelection", t.selection)) } } }, Be.prototype.doActivate = function () { var t = this.diagram; (this.lo = null) === this.currentPart && this.standardMouseSelect(); var i = this.currentPart; null !== i && (i.canMove() || i.canCopy()) && (en = null, this.isActive = !0, this.Pl.set(t.position), Ie(this, t.selection), this.Qg.length = 0, this.draggedParts = this.computeEffectiveCollection(t.selection, this.dragOptions), (t.Rt = !0) === t.De("temporaryPixelRatio") && 30 < t.zx && Fo(t), yr(t, this.draggedParts), this.ua("Drag"), this.startPoint = t.firstInput.documentPoint, t.isMouseCaptured = !0, t.allowDragOut && (this.isDragOutStarted = !0, this.Bn = !1, nn = (en = this).diagram, this.doSimulatedDragOut())) }, Be.prototype.computeEffectiveCollection = function (t, i) { return this.diagram.commandHandler.computeEffectiveCollection(t, i) }, Be.prototype.td = function (t) { return void 0 === t ? new Ns(kt) : this.isGridSnapEnabled ? new Ns(new gi(Math.round(t.x), Math.round(t.y))) : new Ns(t.copy()) }, Be.prototype.doDeactivate = function () { this.isActive = !1; var t = this.diagram; if (t.Bf(), Re(this), mr(t, this.draggedParts), this.draggedParts = this.currentPart = this.lo = null, this.Bn = this.isDragOutStarted = !1, 0 < tn.count) { for (var i = tn, e = i.length, n = 0; n < e; n++) { var o = i.L(n); Ge(o), Ye(o), Re(o), o.diagram.Bf() } i.clear() } Ge(this), this.Pl.h(NaN, NaN), en = nn = null, Ye(this), t.isMouseCaptured = !1, t.currentCursor = "", t.Rt = !1, this.Eg(), Oo(t, !0) }, Be.prototype.doCancel = function () { Ye(this), qe(this); var t = this.diagram; this.Pl.v() && (t.position = this.Pl), this.stopTool() }, Be.prototype.doKeyDown = function () { this.isActive && ("Esc" === this.diagram.lastInput.key ? this.doCancel() : this.doMouseMove()) }, Be.prototype.doKeyUp = function () { this.isActive && this.doMouseMove() }, Be.prototype.moveParts = function (t, i, e) { var n = this.diagram; null !== n && dr(n, t, i, this.dragOptions, e) }, Be.prototype.findDragOverObject = function (t) { var i = this; return qo(this.diagram, t, null, function (t) { return !(t = null === t || !!(null === (t = t.part) || t instanceof du || t.layer.isTemporary || i.draggedParts && i.draggedParts.contains(t) || i.copiedParts && i.copiedParts.contains(t))) }) }, Be.prototype.doUpdateCursor = function (t) { var i = this.diagram; this.lo !== t && (!this.diagram.currentTool.isActive || this.mayCopy() ? i.currentCursor = this.copyCursor : this.mayMove() ? i.currentCursor = this.moveCursor : this.mayDragOut() && (i.currentCursor = this.nodropCursor)) }, Be.prototype.doDragOver = function () { }, Be.prototype.doDropOnto = function () { }, Be.prototype.doMouseMove = function () { var t, i; this.isActive && (i = (t = this.diagram).lastInput, this.simulatedMouseMove(i.event, i.documentPoint, i.targetDiagram) || null === this.currentPart || null === this.draggedParts || (this.mayCopy() ? (Ve(this, !1), yr(t, this.copiedParts), Xe(this, this.copiedParts, !1), mr(t, this.copiedParts)) : this.mayMove() ? (Ye(this), Xe(this, this.draggedParts, !0)) : this.mayDragOut() ? (Ve(this, !1), Xe(this, this.copiedParts, !1)) : Ye(this), Ue(this, t.lastInput.documentPoint))) }, Be.prototype.doMouseUp = function () { var t, i, e, n; this.isActive && (i = (t = this.diagram).lastInput, this.simulatedMouseUp(i.event, i.documentPoint, i.targetDiagram) || (i = !1, (e = this.mayCopy()) && null !== this.copiedParts ? (Ye(this), Ve(this, !0), yr(t, this.copiedParts), Xe(this, this.copiedParts, !1), mr(t, this.copiedParts), null !== this.copiedParts && (t.R("ChangingSelection", t.selection), t.clearSelection(!0), this.copiedParts.iteratorKeys.each(function (t) { t.isSelected = !0 }))) : (i = !0, Ye(this), this.mayMove() && (Xe(this, this.draggedParts, !0), Ue(this, t.lastInput.documentPoint))), this.Bn = !0, Ze(this, t.lastInput.documentPoint), this.isActive && (n = e ? this.copiedParts.Cf() : this.draggedParts.Cf(), this.copiedParts = null, i && function (t) { if (null !== t.draggedParts) for (var i = t.draggedParts.iterator; i.next();) { var e = i.key; e instanceof pu && (null === (e = e.containingGroup) || null === e.placeholder || t.draggedParts.contains(e) || e.placeholder.o()) } }(this), t.Na(), mr(t, this.draggedParts), this.transactionResult = e ? "Copy" : "Move", t.R(e ? "SelectionCopied" : "SelectionMoved", n)), this.stopTool(), e && t.R("ChangedSelection", t.selection))) }, Be.prototype.simulatedMouseMove = function (t, i, e) { if (null === en) return !1; var n = en.diagram; e instanceof Lo || (e = null); var o = nn; return e !== o && (null !== o && o !== n && (o.Bf(), en.isDragOutStarted = !1, null !== (o = o.toolManager.findTool("Dragging")) && o.doSimulatedDragLeave()), null !== (nn = e) && e !== n && (Ee(), null !== (o = e.toolManager.findTool("Dragging")) && (tn.contains(o) || tn.add(o), o.doSimulatedDragEnter()))), !(null === e || e === n || !e.allowDrop || e.isReadOnly || !e.allowInsert) && (null !== (n = e.toolManager.findTool("Dragging")) && (null !== t && (void 0 !== t.targetTouches && (0 < t.targetTouches.length ? t = t.targetTouches[0] : 0 < t.changedTouches.length && (t = t.changedTouches[0])), i = e.getMouse(t)), e.lastInput.documentPoint = i, e.lastInput.viewPoint = e.Oq(i), e.lastInput.down = !1, e.lastInput.up = !1, n.doSimulatedDragOver()), !0) }, Be.prototype.simulatedMouseUp = function (t, i, e) { if (null === en) return !1; var n = nn, o = en.diagram; if (null === e) return en.doCancel(), !0; if (e !== n) { var r = n.toolManager.findTool("Dragging"); if (null !== n && n !== o && null !== r) return n.Bf(), en.isDragOutStarted = !1, r.doSimulatedDragLeave(), !1; null !== (n = (nn = e).toolManager.findTool("Dragging")) && (Ee(), tn.contains(n) || tn.add(n), n.doSimulatedDragEnter()) } return e !== this.diagram && (null !== t ? (void 0 !== t.targetTouches && (0 < t.targetTouches.length ? t = t.targetTouches[0] : 0 < t.changedTouches.length && (t = t.changedTouches[0])), i = e.getMouse(t)) : null === i && (i = new gi), e.lastInput.documentPoint = i, e.lastInput.viewPoint = e.Oq(i), e.lastInput.down = !1, e.lastInput.up = !0, null !== (t = e.toolManager.findTool("Dragging")) && t.doSimulatedDrop(), null !== (t = en) && (e = t.mayCopy(), t.transactionResult = e ? "Copy" : "Move", t.stopTool()), !0) }, Be.prototype.mayCopy = function () { if (!this.isCopyEnabled) return !1; var t = this.diagram; if (t.isReadOnly || t.isModelReadOnly || !t.allowInsert || !t.allowCopy || (I ? !t.lastInput.alt : !t.lastInput.control)) return !1; for (t = t.selection.iterator; t.next();) { var i = t.value; if (i.Wb() && i.canCopy()) return !0 } return !(null === this.draggedLink || !this.dragsLink || !this.draggedLink.canCopy()) }, Be.prototype.mayDragOut = function () { if (!this.isCopyEnabled) return !1; var t = this.diagram; if (!t.allowDragOut || !t.allowCopy || t.allowMove) return !1; for (t = t.selection.iterator; t.next();) { var i = t.value; if (i.Wb() && i.canCopy()) return !0 } return !(null === this.draggedLink || !this.dragsLink || !this.draggedLink.canCopy()) }, Be.prototype.mayMove = function () { var t = this.diagram; if (t.isReadOnly || !t.allowMove) return !1; for (t = t.selection.iterator; t.next();) { var i = t.value; if (i.Wb() && i.canMove()) return !0 } return !(null === this.draggedLink || !this.dragsLink || !this.draggedLink.canMove()) }, Be.prototype.computeBorder = function (t, i, e) { return this.Bn || null === this.draggedParts || this.draggedParts.contains(t) ? null : e.assign(i) }, Be.prototype.Dz = function () { return en }, Be.prototype.mayDragIn = function () { var t = this.diagram; if (!t.allowDrop || t.isReadOnly || t.isModelReadOnly || !t.allowInsert) return !1; return null !== en && en.diagram.model.dataFormat === t.model.dataFormat }, Be.prototype.doSimulatedDragEnter = function () { var t; this.mayDragIn() && ((t = this.diagram).animationManager.Yc(), tr(t), t.animationManager.Yc(), null !== en && (en.diagram.Rt = !1), this.doUpdateCursor(t.grid)) }, Be.prototype.doSimulatedDragLeave = function () { null !== en && en.doSimulatedDragOut(), this.doCancel() }, Be.prototype.doSimulatedDragOver = function () { var t = this.diagram; t.animationManager.bn = !0; var i = en; if (null !== i && null !== i.draggedParts) { if (!this.mayDragIn()) return; _e(this, i.draggedParts.Cf(), !1, t.firstInput), Xe(this, this.copiedParts, !1), Ue(this, t.lastInput.documentPoint) } t.animationManager.bn = !1 }, Be.prototype.doSimulatedDrop = function () { var t = this.diagram, i = en; if (null !== i) { var e = i.diagram; if (i.Bn = !0, Ye(this), !this.mayDragIn()) return; t.animationManager.bn = !0, t.R("ChangingSelection", t.selection), this.ua("Drop"), _e(this, i.draggedParts.Cf(), !0, t.lastInput), Xe(this, this.copiedParts, !1), null !== this.copiedParts && (t.clearSelection(!0), this.copiedParts.iteratorKeys.each(function (t) { t.isSelected = !0 })), Ze(this, t.lastInput.documentPoint), t.Na(), i = t.selection, null !== this.copiedParts ? this.transactionResult = "ExternalCopy" : i = new $, this.copiedParts = null, t.doFocus(), t.R("ExternalObjectsDropped", i, e), this.Eg(), t.R("ChangedSelection", t.selection) } t.animationManager.bn = !1 }, Be.prototype.doSimulatedDragOut = function () { var t = this.diagram; t.Rt = !1, this.mayCopy() || this.mayMove() ? t.currentCursor = "" : t.currentCursor = this.nodropCursor, this.lo = null }, Be.prototype.computeMove = function (t, i, e, n) { return null !== (e = this.diagram) ? e.computeMove(t, i, this.dragOptions, n) : new gi }, l.Object.defineProperties(Be.prototype, { isCopyEnabled: { get: function () { return this.Zc }, set: function (t) { this.Zc = t } }, copiesEffectiveCollection: { get: function () { return this.I }, set: function (t) { this.I = t } }, dragOptions: { get: function () { return this.Ia }, set: function (t) { this.Ia = t } }, isGridSnapEnabled: { get: function () { return this.dragOptions.isGridSnapEnabled }, set: function (t) { this.dragOptions.isGridSnapEnabled = t } }, isComplexRoutingRealtime: { get: function () { return this.Ic }, set: function (t) { this.Ic = t } }, isGridSnapRealtime: { get: function () { return this.dragOptions.isGridSnapRealtime }, set: function (t) { this.dragOptions.isGridSnapRealtime = t } }, gridSnapCellSize: { get: function () { return this.dragOptions.gridSnapCellSize }, set: function (t) { this.dragOptions.gridSnapCellSize.w(t) || (t = t.G(), this.dragOptions.gridSnapCellSize = t) } }, gridSnapCellSpot: { get: function () { return this.dragOptions.gridSnapCellSpot }, set: function (t) { this.dragOptions.gridSnapCellSpot.w(t) || (t = t.G(), this.dragOptions.gridSnapCellSpot = t) } }, gridSnapOrigin: { get: function () { return this.dragOptions.gridSnapOrigin }, set: function (t) { this.dragOptions.gridSnapOrigin.w(t) || (t = t.G(), this.dragOptions.gridSnapOrigin = t) } }, dragsLink: { get: function () { return this.dragOptions.dragsLink }, set: function (t) { this.dragOptions.dragsLink = t } }, dragsTree: { get: function () { return this.dragOptions.dragsTree }, set: function (t) { this.dragOptions.dragsTree = t } }, copyCursor: { get: function () { return this.W }, set: function (t) { this.W = t } }, moveCursor: { get: function () { return this.Lh }, set: function (t) { this.Lh = t } }, nodropCursor: { get: function () { return this.Oh }, set: function (t) { this.Oh = t } }, currentPart: { get: function () { return this.Ha }, set: function (t) { this.Ha = t } }, copiedParts: { get: function () { return this.u }, set: function (t) { this.u = t } }, draggedParts: { get: function () { return this.ab }, set: function (t) { this.ab = t } }, draggingParts: { get: function () { return null !== this.copiedParts ? this.copiedParts.Cf() : null !== this.draggedParts ? this.draggedParts.Cf() : this.Tq } }, draggedLink: { get: function () { return this.diagram.draggedLink }, set: function (t) { this.diagram.draggedLink = t } }, isDragOutStarted: { get: function () { return this.Df }, set: function (t) { this.Df = t } }, startPoint: { get: function () { return this.Ps }, set: function (t) { this.Ps.w(t) || this.Ps.assign(t) } }, delay: { get: function () { return this.Vk }, set: function (t) { this.Vk = t } } }), Be.prototype.getDraggingSource = Be.prototype.Dz; var tn = null, en = null, nn = null; function on() { Ne.call(this), this.Oh = 100, this.Ia = !1, this.fi = "pointer"; var t = new Fu, i = new Kh; i.isPanelMain = !0, i.stroke = "blue", t.add(i), (i = new Kh).toArrow = "Standard", i.fill = "blue", i.stroke = "blue", t.add(i), t.layerName = "Tool", this.Gw = t, t = new pu, (i = new Kh).portId = "", i.figure = "Rectangle", i.fill = null, i.stroke = "magenta", i.strokeWidth = 2, i.desiredSize = yt, t.add(i), t.selectable = !1, t.layerName = "Tool", this.Fw = t, this.l = i, t = new pu, (i = new Kh).portId = "", i.figure = "Rectangle", i.fill = null, i.stroke = "magenta", i.strokeWidth = 2, i.desiredSize = yt, t.add(i), t.selectable = !1, t.layerName = "Tool", this.Hw = t, this.u = i, this.Lh = this.Df = this.Ic = this.ab = this.Zc = null, this.Ha = !0, this.xy = new at, this.Tq = this.xi = this.Ew = null } function rn(t, i, e, n, o) { if (i === e) return 1; if (null !== i && null !== e) for (var r = i.linksConnected; r.next();) { var s = r.value; if (s !== n && (!o || s.isTreeLink) && s.toNode === i && ((s = s.fromNode) !== i && rn(t, s, e, n, o))) return 1 } } function sn() { on.call(this), this.name = "Linking", this.W = {}, this.I = null, this.J = an, this.Nm = null } Be.className = "DraggingTool", tn = new J, T("draggingTool", function () { return this.findTool("Dragging") }, function (t) { this.Wa("Dragging", t, this.mouseMoveTools) }), Ce.prototype.doCancel = function () { null !== en && en.doCancel(), Ne.prototype.doCancel.call(this) }, h(on, Ne), on.prototype.doStop = function () { this.diagram.Bf(), this.originalToPort = this.originalToNode = this.originalFromPort = this.originalFromNode = this.originalLink = null, this.validPortsCache.clear(), this.targetPort = null }, on.prototype.copyPortProperties = function (t, i, e, n, o) { var r, s; null !== t && null !== i && null !== e && null !== n && (r = i.uf(), (s = Yi.alloc()).width = i.naturalBounds.width * r, s.height = i.naturalBounds.height * r, n.desiredSize = s, Yi.free(s), o ? (n.toSpot = i.toSpot, n.toEndSegmentLength = i.toEndSegmentLength) : (n.fromSpot = i.fromSpot, n.fromEndSegmentLength = i.fromEndSegmentLength), e.locationSpot = Zt, r = gi.alloc(), e.location = i.ga(Zt, r), gi.free(r), n.angle = i.Xi(), null !== this.portTargeted && this.portTargeted(t, i, e, n, o)) }, on.prototype.setNoTargetPortProperties = function (t, i, e) { null !== i && (i.desiredSize = yt, i.fromSpot = Kt, i.toSpot = Kt), null !== t && (t.location = this.diagram.lastInput.documentPoint), null !== this.portTargeted && this.portTargeted(null, null, t, i, e) }, on.prototype.doMouseDown = function () { this.isActive && this.doMouseMove() }, on.prototype.doMouseMove = function () { var t, i; this.isActive && (t = this.diagram, this.targetPort = this.findTargetPort(this.isForwards), null !== this.targetPort && this.targetPort.part instanceof pu ? (i = this.targetPort.part, this.isForwards ? this.copyPortProperties(i, this.targetPort, this.temporaryToNode, this.temporaryToPort, !0) : this.copyPortProperties(i, this.targetPort, this.temporaryFromNode, this.temporaryFromPort, !1)) : this.isForwards ? this.setNoTargetPortProperties(this.temporaryToNode, this.temporaryToPort, !0) : this.setNoTargetPortProperties(this.temporaryFromNode, this.temporaryFromPort, !1), (t.allowHorizontalScroll || t.allowVerticalScroll) && t.it(t.lastInput.viewPoint)) }, on.prototype.findValidLinkablePort = function (t, i) { if (null === t) return null; var e = t.part; if (!(e instanceof pu)) return null; for (; null !== t;) { var n = i ? t.toLinkable : t.fromLinkable; if (!0 === n && (null !== t.portId || t instanceof pu) && (i ? this.isValidTo(e, t) : this.isValidFrom(e, t))) return t; if (!1 === n) break; t = t.panel } return null }, on.prototype.findTargetPort = function (i) { var t = (r = this.diagram).lastInput.documentPoint; (o = this.portGravity) <= 0 && (o = .1); for (var e = this, n = r.xg(t, o, function (t) { return e.findValidLinkablePort(t, i) }, null, !0), o = 1 / 0, r = null, n = n.iterator; n.next();) { var s, a, h, l = n.value, u = l.part; u instanceof pu && (s = l.ga(Zt, gi.alloc()), a = t.x - s.x, h = t.y - s.y, gi.free(s), (s = a * a + h * h) < o && (null !== (a = this.validPortsCache.H(l)) ? a && (r = l, o = s) : i && this.isValidLink(this.originalFromNode, this.originalFromPort, u, l) || !i && this.isValidLink(u, l, this.originalToNode, this.originalToPort) ? (this.validPortsCache.add(l, !0), r = l, o = s) : this.validPortsCache.add(l, !1))) } return null !== r && ((t = r.part) instanceof pu && (null === t.layer || t.layer.allowLink)) ? r : null }, on.prototype.isValidFrom = function (t, i) { if (null === t || null === i) return this.isUnconnectedLinkValid; if (this.diagram.currentTool === this && (null !== t.layer && !t.layer.allowLink || !0 !== i.fromLinkable)) return !1; var e = i.fromMaxLinks; if (e < 1 / 0) { if (null !== this.originalLink && t === this.originalFromNode && i === this.originalFromPort) return !0; if (null === (i = i.portId) && (i = ""), t.mq(i).count >= e) return !1 } return !0 }, on.prototype.isValidTo = function (t, i) { if (null === t || null === i) return this.isUnconnectedLinkValid; if (this.diagram.currentTool === this && (null !== t.layer && !t.layer.allowLink || !0 !== i.toLinkable)) return !1; var e = i.toMaxLinks; if (e < 1 / 0) { if (null !== this.originalLink && t === this.originalToNode && i === this.originalToPort) return !0; if (null === (i = i.portId) && (i = ""), t.xd(i).count >= e) return !1 } return !0 }, on.prototype.isInSameNode = function (t, i) { return null !== t && null !== i && (t === i || (t = t.part, i = i.part, null !== t && t === i)) }, on.prototype.isLinked = function (t, i) { if (null === t || null === i) return !1; var e = t.part; if (!(e instanceof pu)) return !1; null === (t = t.portId) && (t = ""); var n = i.part; if (!(n instanceof pu)) return !1; for (null === (i = i.portId) && (i = ""), i = n.xd(i); i.next();)if ((n = i.value).fromNode === e && n.fromPortId === t) return !0; return !1 }, on.prototype.isValidLink = function (t, i, e, n) { if (!this.isValidFrom(t, i) || !this.isValidTo(e, n) || !(null === i || null === n || (i.fromLinkableSelfNode && n.toLinkableSelfNode || !this.isInSameNode(i, n)) && (i.fromLinkableDuplicates && n.toLinkableDuplicates || !this.isLinked(i, n))) || null !== this.originalLink && (null !== t && this.isLabelDependentOnLink(t, this.originalLink) || null !== e && this.isLabelDependentOnLink(e, this.originalLink)) || null !== t && null !== e && (null === t.data && null !== e.data || null !== t.data && null === e.data) || !this.isValidCycle(t, e, this.originalLink)) return !1; if (null !== t) { var o = t.linkValidation; if (null !== o && !o(t, i, e, n, this.originalLink)) return !1 } return !(null !== e && null !== (o = e.linkValidation) && !o(t, i, e, n, this.originalLink)) && (null === (o = this.linkValidation) || o(t, i, e, n, this.originalLink)) }, on.prototype.isLabelDependentOnLink = function (t, i) { if (null === t) return !1; var e = t.labeledLink; if (null === e) return !1; if (e === i) return !0; var n = new $; return n.add(t), function t(i, e, n, o) { if (e === n) return !0; var r = e.fromNode; if (null !== r && r.isLinkLabel && (o.add(r), t(i, r.labeledLink, n, o))) return !0; e = e.toNode; return !(null === e || !e.isLinkLabel || (o.add(e), !t(i, e.labeledLink, n, o))) }(this, e, i, n) }, on.prototype.isValidCycle = function (t, i, e) { if (void 0 === e && (e = null), null === t || null === i) return this.isUnconnectedLinkValid; var n = this.diagram.validCycle; if (n !== hs) { if (n === fs) { if (null !== (n = e || this.temporaryLink) && !n.isTreeLink) return !0; for (n = i.linksConnected; n.next();) { var o = n.value; if (o !== e && o.isTreeLink && o.toNode === i) return !1 } return !rn(this, t, i, e, !0) } if (n === ds) { if (null !== (n = e || this.temporaryLink) && !n.isTreeLink) return !0; for (n = t.linksConnected; n.next();)if ((o = n.value) !== e && o.isTreeLink && o.fromNode === t) return !1; return !rn(this, t, i, e, !0) } if (n === ls) return !(t = t === i || ((n = new $).add(i), function t(i, e, n, o, r) { if (n === o) return !0; if (null === n || null === o || e.contains(n)) return !1; e.add(n); for (var s = n.linksConnected; s.next();) { var a = s.value; if (a !== r && a.toNode === n && ((a = a.fromNode) !== n && t(i, e, a, o, r))) return !0 } return !1 }(this, n, t, i, e))); if (n === us) return !rn(this, t, i, e, !1); if (n === cs) return !(t = t === i || ((n = new $).add(i), function t(i, e, n, o, r) { if (n === o) return !0; if (null === n || null === o || e.contains(n)) return !1; e.add(n); for (var s = n.linksConnected; s.next();) { var a = s.value; if (a !== r) { var h = a.fromNode; if (a = a.toNode, (h = h === n ? a : h) !== n && t(i, e, h, o, r)) return !0 } } return !1 }(this, n, t, i, e))) } return !0 }, l.Object.defineProperties(on.prototype, { portGravity: { get: function () { return this.Oh }, set: function (t) { 0 <= t && (this.Oh = t) } }, isUnconnectedLinkValid: { get: function () { return this.Ia }, set: function (t) { this.Ia = t } }, linkingCursor: { get: function () { return this.fi }, set: function (t) { this.fi = t } }, temporaryLink: { get: function () { return this.Gw }, set: function (t) { this.Gw = t } }, temporaryFromNode: { get: function () { return this.Fw }, set: function (t) { (this.Fw = t) && (this.l = t.port) } }, temporaryFromPort: { get: function () { return this.l }, set: function (t) { var i, e; null === this.l || null !== (i = this.l.panel) && (e = i.V.indexOf(this.l), i.$a(e), i.tb(e, t)), this.l = t } }, temporaryToNode: { get: function () { return this.Hw }, set: function (t) { (this.Hw = t) && (this.u = t.port) } }, temporaryToPort: { get: function () { return this.u }, set: function (t) { var i, e; null === this.u || null !== (i = this.u.panel) && (e = i.V.indexOf(this.u), i.$a(e), i.tb(e, t)), this.u = t } }, originalLink: { get: function () { return this.Zc }, set: function (t) { this.Zc = t } }, originalFromNode: { get: function () { return this.ab }, set: function (t) { this.ab = t } }, originalFromPort: { get: function () { return this.Ic }, set: function (t) { this.Ic = t } }, originalToNode: { get: function () { return this.Df }, set: function (t) { this.Df = t } }, originalToPort: { get: function () { return this.Lh }, set: function (t) { this.Lh = t } }, isForwards: { get: function () { return this.Ha }, set: function (t) { this.Ha = t } }, validPortsCache: { get: function () { return this.xy } }, targetPort: { get: function () { return this.Ew }, set: function (t) { this.Ew = t } }, linkValidation: { get: function () { return this.xi }, set: function (t) { this.xi = t } }, portTargeted: { get: function () { return this.Tq }, set: function (t) { this.Tq = t } } }), on.className = "LinkingBaseTool", h(sn, on), sn.prototype.canStart = function () { if (!this.isEnabled) return !1; var t = this.diagram; return !(t.isReadOnly || t.isModelReadOnly || !t.allowLink || !t.model.xt() || !t.lastInput.left || t.currentTool !== this && !this.isBeyondDragSize()) && null !== this.findLinkablePort() }, sn.prototype.findLinkablePort = function () { var t = this.diagram, i = this.startObject; if (null === i && (i = t.Ub(t.firstInput.documentPoint, null, null)), null === i || !(i.part instanceof pu)) return null; if ((t = this.direction) === an || t === hn) { var e = this.findValidLinkablePort(i, !1); if (null !== e) return this.isForwards = !0, e } return t !== an && t !== ln || null === (i = this.findValidLinkablePort(i, !0)) ? null : (this.isForwards = !1, i) }, sn.prototype.doActivate = function () { var t = this.diagram, i = this.findLinkablePort(); null !== i && (this.ua(this.name), t.isMouseCaptured = !0, t.currentCursor = this.linkingCursor, this.isForwards ? (null === this.temporaryToNode || this.temporaryToNode.location.v() || (this.temporaryToNode.location = t.lastInput.documentPoint), this.originalFromPort = i, (i = this.originalFromPort.part) instanceof pu && (this.originalFromNode = i), this.copyPortProperties(this.originalFromNode, this.originalFromPort, this.temporaryFromNode, this.temporaryFromPort, !1)) : (null === this.temporaryFromNode || this.temporaryFromNode.location.v() || (this.temporaryFromNode.location = t.lastInput.documentPoint), this.originalToPort = i, (i = this.originalToPort.part) instanceof pu && (this.originalToNode = i), this.copyPortProperties(this.originalToNode, this.originalToPort, this.temporaryToNode, this.temporaryToPort, !0)), t.add(this.temporaryFromNode), t.add(this.temporaryToNode), null !== this.temporaryLink && (null !== this.temporaryFromNode && (this.temporaryLink.fromNode = this.temporaryFromNode), null !== this.temporaryToNode && (this.temporaryLink.toNode = this.temporaryToNode), this.temporaryLink.isTreeLink = this.isNewTreeLink(), this.temporaryLink.Ta(), t.add(this.temporaryLink)), this.isActive = !0) }, sn.prototype.doDeactivate = function () { this.isActive = !1; var t = this.diagram; t.remove(this.temporaryLink), t.remove(this.temporaryFromNode), t.remove(this.temporaryToNode), t.isMouseCaptured = !1, t.currentCursor = "", this.Eg() }, sn.prototype.doStop = function () { on.prototype.doStop.call(this), this.startObject = null }, sn.prototype.doMouseUp = function () { var t = this.diagram; if (this.isActive) { var i = this.transactionResult = null, e = null, n = null, o = null, r = null; try { var s, a = this.targetPort = this.findTargetPort(this.isForwards); null !== a ? (s = a.part) instanceof pu && (this.isForwards ? (null !== this.originalFromNode && (i = this.originalFromNode, e = this.originalFromPort), n = s, o = a) : (i = s, e = a, null !== this.originalToNode && (n = this.originalToNode, o = this.originalToPort))) : this.isForwards ? null !== this.originalFromNode && this.isUnconnectedLinkValid && (i = this.originalFromNode, e = this.originalFromPort) : null !== this.originalToNode && this.isUnconnectedLinkValid && (n = this.originalToNode, o = this.originalToPort), null !== i || null !== n ? null !== (r = this.insertLink(i, e, n, o)) ? (null === a && (this.isForwards ? r.defaultToPoint = t.lastInput.documentPoint : r.defaultFromPoint = t.lastInput.documentPoint), t.allowSelect && (t.R("ChangingSelection", t.selection), t.clearSelection(!0), r.isSelected = !0), this.transactionResult = this.name, t.R("LinkDrawn", r)) : (t.model.hq(), this.doNoLink(i, e, n, o)) : this.isForwards ? this.doNoLink(this.originalFromNode, this.originalFromPort, null, null) : this.doNoLink(null, null, this.originalToNode, this.originalToPort) } finally { this.stopTool(), r && t.allowSelect && t.R("ChangedSelection", t.selection) } } }, sn.prototype.isNewTreeLink = function () { var t = this.archetypeLinkData; if (null === t) return !0; if (t instanceof Fu) return t.isTreeLink; var i = this.diagram; return null === i || (t = i.partManager.getLinkCategoryForData(t), null === (i = i.partManager.findLinkTemplateForCategory(t)) || i.isTreeLink) }, sn.prototype.insertLink = function (t, i, e, n) { return this.diagram.partManager.insertLink(t, i, e, n) }, sn.prototype.doNoLink = function () { }, l.Object.defineProperties(sn.prototype, { archetypeLinkData: { get: function () { return this.W }, set: function (t) { this.W = t } }, archetypeLabelNodeData: { get: function () { return this.I }, set: function (t) { this.I = t } }, direction: { get: function () { return this.J }, set: function (t) { this.J = t } }, startObject: { get: function () { return this.Nm }, set: function (t) { this.Nm = t } } }); var an = new V(sn, "Either", 0), hn = new V(sn, "ForwardsOnly", 0), ln = new V(sn, "BackwardsOnly", 0); function un() { on.call(this), this.name = "Relinking"; var t = new Kh; t.figure = "Diamond", t.desiredSize = vt, t.fill = "lightblue", t.stroke = "dodgerblue", t.cursor = this.linkingCursor, t.segmentIndex = 0, this.W = t, (t = new Kh).figure = "Diamond", t.desiredSize = vt, t.fill = "lightblue", t.stroke = "dodgerblue", t.cursor = this.linkingCursor, t.segmentIndex = -1, this.Nm = t, this.I = null, this.ix = new yi } function cn(t, i, e, n, o) { null !== i ? (t.copyPortProperties(i, e, t.temporaryFromNode, t.temporaryFromPort, !1), t.diagram.add(t.temporaryFromNode)) : t.diagram.remove(t.temporaryFromNode), null !== n ? (t.copyPortProperties(n, o, t.temporaryToNode, t.temporaryToPort, !0), t.diagram.add(t.temporaryToNode)) : t.diagram.remove(t.temporaryToNode) } function fn() { Ne.call(this), this.name = "LinkReshaping"; var t = new Kh; t.figure = "Rectangle", t.desiredSize = mt, t.fill = "lightblue", t.stroke = "dodgerblue", this.u = t, (t = new Kh).figure = "Diamond", t.desiredSize = vt, t.fill = "lightblue", t.stroke = "dodgerblue", t.cursor = "move", this.I = t, this.W = 3, this.$t = this.l = null, this.jx = new gi, this.qs = new J } function dn(t, i, e, n, o, r) { return r ? Math.abs(i.y - e.y) < t.resegmentingDistance && Math.abs(e.y - n.y) < t.resegmentingDistance && Math.abs(n.y - o.y) < t.resegmentingDistance : Math.abs(i.x - e.x) < t.resegmentingDistance && Math.abs(e.x - n.x) < t.resegmentingDistance && Math.abs(n.x - o.x) < t.resegmentingDistance } sn.className = "LinkingTool", sn.Either = an, sn.ForwardsOnly = hn, sn.BackwardsOnly = ln, h(un, on), un.prototype.updateAdornments = function (t) { var i, e, n; null !== t && t instanceof Fu && (i = "RelinkFrom", e = null, !t.isSelected || this.diagram.isReadOnly || null !== (n = t.selectionObject) && t.canRelinkFrom() && t.actualBounds.v() && t.isVisible() && n.actualBounds.v() && n.yf() && (null === (e = t.fk(i)) && (e = this.makeAdornment(n, !1), t.zh(i, e))), null === e && t.zf(i), i = "RelinkTo", e = null, !t.isSelected || this.diagram.isReadOnly || null !== (n = t.selectionObject) && t.canRelinkTo() && t.actualBounds.v() && t.isVisible() && n.actualBounds.v() && n.yf() && (null === (e = t.fk(i)) ? (e = this.makeAdornment(n, !0), t.zh(i, e)) : e.o()), null === e && t.zf(i)) }, un.prototype.makeAdornment = function (t, i) { var e = new du; return e.type = xh.Link, null !== (i = i ? this.toHandleArchetype : this.fromHandleArchetype) && e.add(i.copy()), e.adornedObject = t, e }, un.prototype.canStart = function () { if (!this.isEnabled) return !1; var t = this.diagram; if (t.isReadOnly || t.isModelReadOnly || !t.allowRelink || !t.model.xt() || !t.lastInput.left) return !1; var i = this.findToolHandleAt(t.firstInput.documentPoint, "RelinkFrom"); return null === i && (i = this.findToolHandleAt(t.firstInput.documentPoint, "RelinkTo")), null !== i }, un.prototype.doActivate = function () { var t = this.diagram; if (null === this.originalLink) { var i = this.handle; if (null === i && (null === (i = this.findToolHandleAt(t.firstInput.documentPoint, "RelinkFrom")) && (i = this.findToolHandleAt(t.firstInput.documentPoint, "RelinkTo"))), null === i) return; var e = i.part; if (!(e instanceof du && e.adornedPart instanceof Fu)) return; this.handle = i, this.isForwards = null === e || "RelinkTo" === e.category, this.originalLink = e.adornedPart } this.ua(this.name), t.isMouseCaptured = !0, t.currentCursor = this.linkingCursor, this.originalFromPort = this.originalLink.fromPort, this.originalFromNode = this.originalLink.fromNode, this.originalToPort = this.originalLink.toPort, this.originalToNode = this.originalLink.toNode, this.ix.set(this.originalLink.actualBounds), null !== this.originalLink && 0 < this.originalLink.pointsCount && (null === this.originalLink.fromNode && (null !== this.temporaryFromPort && (this.temporaryFromPort.desiredSize = gt), null !== this.temporaryFromNode && (this.temporaryFromNode.location = this.originalLink.i(0))), null === this.originalLink.toNode && (null !== this.temporaryToPort && (this.temporaryToPort.desiredSize = gt), null !== this.temporaryToNode && (this.temporaryToNode.location = this.originalLink.i(this.originalLink.pointsCount - 1)))), this.copyPortProperties(this.originalFromNode, this.originalFromPort, this.temporaryFromNode, this.temporaryFromPort, !1), this.copyPortProperties(this.originalToNode, this.originalToPort, this.temporaryToNode, this.temporaryToPort, !0), t.add(this.temporaryFromNode), t.add(this.temporaryToNode), null !== this.temporaryLink && (null !== this.temporaryFromNode && (this.temporaryLink.fromNode = this.temporaryFromNode), null !== this.temporaryToNode && (this.temporaryLink.toNode = this.temporaryToNode), this.copyLinkProperties(this.originalLink, this.temporaryLink), this.temporaryLink.Ta(), t.add(this.temporaryLink)), this.isActive = !0 }, un.prototype.copyLinkProperties = function (t, i) { var e; null !== t && null !== i && (i.adjusting = t.adjusting, i.corner = t.corner, (e = t.curve) !== rc && e !== oc || (e = ec), i.curve = e, i.curviness = t.curviness, i.isTreeLink = t.isTreeLink, i.points = t.points, i.routing = t.routing, i.smoothness = t.smoothness, i.fromSpot = t.fromSpot, i.fromEndSegmentLength = t.fromEndSegmentLength, i.fromShortLength = t.fromShortLength, i.toSpot = t.toSpot, i.toEndSegmentLength = t.toEndSegmentLength, i.toShortLength = t.toShortLength) }, un.prototype.doDeactivate = function () { this.isActive = !1; var t = this.diagram; t.remove(this.temporaryLink), t.remove(this.temporaryFromNode), t.remove(this.temporaryToNode), t.isMouseCaptured = !1, t.currentCursor = "", this.Eg() }, un.prototype.doStop = function () { on.prototype.doStop.call(this), this.handle = null }, un.prototype.doMouseUp = function () { var t, i, e, n, o, r, s; this.isActive && (t = this.diagram, this.transactionResult = null, i = this.originalFromNode, e = this.originalFromPort, n = this.originalToNode, o = this.originalToPort, r = this.originalLink, this.targetPort = this.findTargetPort(this.isForwards), null !== this.targetPort ? (s = this.targetPort.part) instanceof pu && (this.isForwards ? (n = s, o = this.targetPort) : (i = s, e = this.targetPort)) : this.isUnconnectedLinkValid ? this.isForwards ? o = n = null : e = i = null : r = null, null !== r ? (this.reconnectLink(r, this.isForwards ? n : i, this.isForwards ? o : e, this.isForwards), null === this.targetPort && (this.isForwards ? r.defaultToPoint = t.lastInput.documentPoint : r.defaultFromPoint = t.lastInput.documentPoint, r.Ta()), t.allowSelect && (r.isSelected = !0), this.transactionResult = this.name, t.R("LinkRelinked", r, this.isForwards ? this.originalToPort : this.originalFromPort)) : this.doNoRelink(this.originalLink, this.isForwards), this.originalLink.uq(this.ix)), this.stopTool() }, un.prototype.reconnectLink = function (t, i, e, n) { return e = null !== e && null !== e.portId ? e.portId : "", n ? (t.toNode = i, t.toPortId = e) : (t.fromNode = i, t.fromPortId = e), !0 }, un.prototype.doNoRelink = function () { }, l.Object.defineProperties(un.prototype, { fromHandleArchetype: { get: function () { return this.W }, set: function (t) { this.W = t } }, toHandleArchetype: { get: function () { return this.Nm }, set: function (t) { this.Nm = t } }, handle: { get: function () { return this.I }, set: function (t) { if (null !== t && !(t.part instanceof du)) throw Error("new handle is not in an Adornment: " + t); this.I = t } } }), un.className = "RelinkingTool", T("linkingTool", function () { return this.findTool("Linking") }, function (t) { this.Wa("Linking", t, this.mouseMoveTools) }), T("relinkingTool", function () { return this.findTool("Relinking") }, function (t) { this.Wa("Relinking", t, this.mouseDownTools) }), h(fn, Ne), fn.prototype.Ev = function (t) { return t && t.xs && 0 !== t.xs.value ? t.xs : pn }, fn.prototype.Hm = function (t, i) { t.xs = i }, fn.prototype.updateAdornments = function (t) { var i, e; null !== t && t instanceof Fu && (i = null, t.isSelected && !this.diagram.isReadOnly && (!(null !== (e = t.path) && t.canReshape() && t.actualBounds.v() && t.isVisible() && e.actualBounds.v() && e.yf()) || null !== (i = t.fk(this.name)) && i.ex === t.pointsCount && i.tx === t.resegmentable || null !== (i = this.makeAdornment(e)) && (i.ex = t.pointsCount, i.tx = t.resegmentable, t.zh(this.name, i))), null === i && t.zf(this.name)) }, fn.prototype.makeAdornment = function (t) { var i = t.part, e = i.pointsCount, n = i.isOrthogonal, o = null; if (null !== i.points && 1 < e) { (o = new du).type = xh.Link, e = i.firstPickIndex; var r, s = i.lastPickIndex, a = n ? 1 : 0; if (i.resegmentable && i.computeCurve() !== nc) for (var h = e + a; h < s - a; h++) { var l = this.makeResegmentHandle(t, h); null !== l && (l.segmentIndex = h, l.segmentFraction = .5, l.fromMaxLinks = 999, o.add(l)) } for (a = e + 1; a < s; a++) { null !== (h = this.makeHandle(t, a)) && ((h.segmentIndex = a) !== e && (a === e + 1 && n ? (l = i.i(e), r = i.i(e + 1), qi.A(l.x, r.x) && qi.A(l.y, r.y) && (r = i.i(e - 1)), qi.A(l.x, r.x) ? (this.Hm(h, yn), h.cursor = "n-resize") : qi.A(l.y, r.y) && (this.Hm(h, gn), h.cursor = "w-resize")) : a === s - 1 && n ? (l = i.i(s - 1), r = i.i(s), qi.A(l.x, r.x) && qi.A(l.y, r.y) && (l = i.i(s + 1)), qi.A(l.x, r.x) ? (this.Hm(h, yn), h.cursor = "n-resize") : qi.A(l.y, r.y) && (this.Hm(h, gn), h.cursor = "w-resize")) : a !== s && (this.Hm(h, mn), h.cursor = "move")), o.add(h)) } o.adornedObject = t } return o }, fn.prototype.makeHandle = function () { var t = this.handleArchetype; return null === t ? null : t.copy() }, fn.prototype.makeResegmentHandle = function () { var t = this.midHandleArchetype; return null === t ? null : t.copy() }, fn.prototype.canStart = function () { if (!this.isEnabled) return !1; var t = this.diagram; return !(t.isReadOnly || !t.allowReshape || !t.lastInput.left) && null !== this.findToolHandleAt(t.firstInput.documentPoint, this.name) }, fn.prototype.doActivate = function () { var t = this.diagram; if (null === this.handle && (this.handle = this.findToolHandleAt(t.firstInput.documentPoint, this.name)), null !== this.handle) { var i = this.handle.part.adornedPart; if (i instanceof Fu) { if (this.$t = i, t.isMouseCaptured = !0, this.ua(this.name), i.resegmentable && 999 === this.handle.fromMaxLinks) { var e = i.points.copy(), n = this.getResegmentingPoint(); if (e.tb(this.handle.segmentIndex + 1, n), i.isOrthogonal && e.tb(this.handle.segmentIndex + 1, n), i.points = e, i.Lb(), i.updateAdornments(), this.handle = this.findToolHandleAt(t.firstInput.documentPoint, this.name), null === this.handle) return void this.doDeactivate() } this.jx = i.i(this.handle.segmentIndex), this.qs = i.points.copy(), this.isActive = !0 } } }, fn.prototype.doDeactivate = function () { this.Eg(), this.$t = this.handle = null, this.isActive = this.diagram.isMouseCaptured = !1 }, fn.prototype.doCancel = function () { var t = this.adornedLink; null !== t && (t.points = this.qs), this.stopTool() }, fn.prototype.getResegmentingPoint = function () { return this.handle.ga(Zt) }, fn.prototype.doMouseMove = function () { var t = this.diagram; this.isActive && (t = this.computeReshape(t.lastInput.documentPoint), this.reshape(t)) }, fn.prototype.doMouseUp = function () { var t, i, e, n, o, r, s, a = this.diagram; this.isActive && (t = this.computeReshape(a.lastInput.documentPoint), this.reshape(t), null !== (t = this.adornedLink) && t.resegmentable && (i = this.handle.segmentIndex, e = t.i(i - 1), n = t.i(i), o = t.i(i + 1), t.isOrthogonal ? i > t.firstPickIndex + 1 && i < t.lastPickIndex - 1 && (r = t.i(i - 2), Math.abs(e.x - n.x) < this.resegmentingDistance && Math.abs(e.y - n.y) < this.resegmentingDistance && (dn(this, r, e, n, o, !0) || dn(this, r, e, n, o, !1)) ? (s = t.points.copy(), dn(this, r, e, n, o, !0) ? (s.hd(i - 2, new gi(r.x, (o.y + r.y) / 2)), s.hd(i + 1, new gi(o.x, (o.y + r.y) / 2))) : (s.hd(i - 2, new gi((o.x + r.x) / 2, r.y)), s.hd(i + 1, new gi((o.x + r.x) / 2, o.y))), s.$a(i), s.$a(i - 1), t.points = s, t.Lb()) : (r = t.i(i + 2), Math.abs(n.x - o.x) < this.resegmentingDistance && Math.abs(n.y - o.y) < this.resegmentingDistance && (dn(this, e, n, o, r, !0) || dn(this, e, n, o, r, !1)) && (s = t.points.copy(), dn(this, e, n, o, r, !0) ? (s.hd(i - 1, new gi(e.x, (e.y + r.y) / 2)), s.hd(i + 2, new gi(r.x, (e.y + r.y) / 2))) : (s.hd(i - 1, new gi((e.x + r.x) / 2, e.y)), s.hd(i + 2, new gi((e.x + r.x) / 2, r.y))), s.$a(i + 1), s.$a(i), t.points = s, t.Lb()))) : (r = gi.alloc(), qi.Ih(e.x, e.y, o.x, o.y, n.x, n.y, r) && r.Ce(n) < this.resegmentingDistance * this.resegmentingDistance && ((e = t.points.copy()).$a(i), t.points = e, t.Lb()), gi.free(r))), a.Na(), this.transactionResult = this.name, a.R("LinkReshaped", this.adornedLink, this.qs)), this.stopTool() }, fn.prototype.reshape = function (t) { var i = this.adornedLink; i.Kh(); var e, n, o, r = this.handle.segmentIndex, s = this.Ev(this.handle); i.isOrthogonal ? r === i.firstPickIndex + 1 ? (r = i.firstPickIndex + 1, s === yn ? (i.K(r, i.i(r - 1).x, t.y), i.K(r + 1, i.i(r + 2).x, t.y)) : s === gn && (i.K(r, t.x, i.i(r - 1).y), i.K(r + 1, t.x, i.i(r + 2).y))) : r === i.lastPickIndex - 1 ? (r = i.lastPickIndex - 1, s === yn ? (i.K(r - 1, i.i(r - 2).x, t.y), i.K(r, i.i(r + 1).x, t.y)) : s === gn && (i.K(r - 1, t.x, i.i(r - 2).y), i.K(r, t.x, i.i(r + 1).y))) : (s = r, e = i.i(s), n = i.i(s - 1), o = i.i(s + 1), qi.A(n.x, e.x) && qi.A(e.y, o.y) ? (qi.A(n.x, i.i(s - 2).x) && !qi.A(n.y, i.i(s - 2).y) ? (i.m(s, t.x, n.y), r++, s++) : i.K(s - 1, t.x, n.y), qi.A(o.y, i.i(s + 2).y) && !qi.A(o.x, i.i(s + 2).x) ? i.m(s + 1, o.x, t.y) : i.K(s + 1, o.x, t.y)) : qi.A(n.y, e.y) && qi.A(e.x, o.x) ? (qi.A(n.y, i.i(s - 2).y) && !qi.A(n.x, i.i(s - 2).x) ? (i.m(s, n.x, t.y), r++, s++) : i.K(s - 1, n.x, t.y), qi.A(o.x, i.i(s + 2).x) && !qi.A(o.y, i.i(s + 2).y) ? i.m(s + 1, t.x, o.y) : i.K(s + 1, t.x, o.y)) : qi.A(n.x, e.x) && qi.A(e.x, o.x) ? (qi.A(n.x, i.i(s - 2).x) && !qi.A(n.y, i.i(s - 2).y) ? (i.m(s, t.x, n.y), r++, s++) : i.K(s - 1, t.x, n.y), qi.A(o.x, i.i(s + 2).x) && !qi.A(o.y, i.i(s + 2).y) ? i.m(s + 1, t.x, o.y) : i.K(s + 1, t.x, o.y)) : qi.A(n.y, e.y) && qi.A(e.y, o.y) && (qi.A(n.y, i.i(s - 2).y) && !qi.A(n.x, i.i(s - 2).x) ? (i.m(s, n.x, t.y), r++, s++) : i.K(s - 1, n.x, t.y), qi.A(o.y, i.i(s + 2).y) && !qi.A(o.x, i.i(s + 2).x) ? i.m(s + 1, o.x, t.y) : i.K(s + 1, o.x, t.y)), i.K(r, t.x, t.y)) : (i.K(r, t.x, t.y), s = i.fromNode, e = i.fromPort, null === s || null !== (n = s.findVisibleNode()) && n !== s && (e = (s = n).port), 1 === r && i.computeSpot(!0, e).jc() && (n = e.ga(Zt, gi.alloc()), s = i.getLinkPointFromPoint(s, e, n, t, !0, gi.alloc()), i.K(0, s.x, s.y), gi.free(n), gi.free(s)), s = i.toNode, e = i.toPort, null === s || null !== (n = s.findVisibleNode()) && n !== s && (e = (s = n).port), r === i.pointsCount - 2 && i.computeSpot(!1, e).jc() && (r = e.ga(Zt, gi.alloc()), t = i.getLinkPointFromPoint(s, e, r, t, !1, gi.alloc()), i.K(i.pointsCount - 1, t.x, t.y), gi.free(r), gi.free(t))), i.rf() }, fn.prototype.computeReshape = function (t) { var i = this.adornedLink, e = this.handle.segmentIndex; switch (this.Ev(this.handle)) { case mn: return t; case yn: return new gi(i.i(e).x, t.y); case gn: return new gi(t.x, i.i(e).y); default: return i.i(e) } }, l.Object.defineProperties(fn.prototype, { handleArchetype: { get: function () { return this.u }, set: function (t) { this.u = t } }, midHandleArchetype: { get: function () { return this.I }, set: function (t) { this.I = t } }, handle: { get: function () { return this.l }, set: function (t) { if (null !== t && !(t.part instanceof du)) throw Error("new handle is not in an Adornment: " + t); this.l = t } }, adornedLink: { get: function () { return this.$t } }, resegmentingDistance: { get: function () { return this.W }, set: function (t) { this.W = t } }, originalPoint: { get: function () { return this.jx } }, originalPoints: { get: function () { return this.qs } } }), fn.prototype.setReshapingBehavior = fn.prototype.Hm, fn.prototype.getReshapingBehavior = fn.prototype.Ev; var pn = new V(fn, "None", 0), gn = new V(fn, "Horizontal", 1), yn = new V(fn, "Vertical", 2), mn = new V(fn, "All", 3); function vn() { Ne.call(this), this.name = "Resizing", this.bg = new Yi(1, 1).freeze(), this.ag = new Yi(9999, 9999).freeze(), this.Kg = new Yi(NaN, NaN).freeze(), this.I = !1, this.ce = null; var t = new Kh; t.alignmentFocus = Zt, t.figure = "Rectangle", t.desiredSize = mt, t.fill = "lightblue", t.stroke = "dodgerblue", t.strokeWidth = 1, t.cursor = "pointer", this.u = t, this.l = null, this.ps = new gi, this.hx = new Yi, this.Yo = new gi, this.qu = new Yi(0, 0), this.pu = new Yi(1 / 0, 1 / 0), this.ou = new Yi(1, 1), this.bx = !0 } function xn() { Ne.call(this), this.name = "Rotating", this.Ia = 45, this.Ha = 2, this.Yo = new gi, this.ce = null; var t = new Kh; t.figure = "Ellipse", t.desiredSize = vt, t.fill = "lightblue", t.stroke = "dodgerblue", t.strokeWidth = 1, t.cursor = "pointer", this.u = t, this.l = null, this.gx = 0, this.Qu = new gi(NaN, NaN), this.I = 0, this.W = 50 } function bn() { Ne.call(this), this.name = "ClickSelecting" } function wn() { Ne.call(this), this.name = "Action", this.Bk = null } function kn() { Ne.call(this), this.name = "ClickCreating", this.ij = null, this.u = !0, this.l = !1, this.Ww = new gi(0, 0) } function Mn() { Ne.call(this), this.name = "DragSelecting", this.Vk = 175, this.u = !1; var t = new Hl; t.layerName = "Tool", t.selectable = !1; var i = new Kh; i.name = "SHAPE", i.figure = "Rectangle", i.fill = null, i.stroke = "magenta", t.add(i), this.l = t } function Sn() { Ne.call(this), this.name = "Panning", this.Nu = new gi, this.Fy = new gi, this.Jg = !1; var i = this; this.mx = function () { var t = i.diagram; null !== t && t.removeEventListener(c.document, "scroll", i.mx, !1), i.stopTool() } } function Pn() { this.W = this.I = this.l = this.u = null } function Nn(t, i, e) { this.text = t, this.Cx = i, this.visible = e } function Cn() { Ne.call(this), this.name = "ContextMenu", this.u = this.fu = this.l = null, this.ax = new gi, this.gu = null, this.Au = !1; var t = this; this.$u = function () { t.stopTool() } } function Tn(t) { return t.preventDefault(), !1 } function Ln(t) { var i, e, n = t.diagram; t.isActive ? null !== (i = t.currentContextMenu) && (i instanceof Pn || null !== (e = n.Ub(n.lastInput.documentPoint, null, null)) && e.Ag(i) && t.standardMouseClick(null, null), t.stopTool(), t.canStart() && (n.currentTool = t).doMouseUp()) : t.canStart() && (An(t, !0), t.isActive || t.stopTool()) } function An(t, i, e) { var n; void 0 === e && (e = null), t.Au || (t.Au = !0, i && t.standardMouseSelect(), i = t.standardMouseClick(), t.Au = !1, i) || (t.isActive = !0, i = jn, null === e && (e = t.findObjectWithContextMenu()), null !== e ? null !== (n = e.contextMenu) ? (t.currentObject = e instanceof Es ? e : null, t.showContextMenu(n, t.currentObject)) : null !== i && t.showContextMenu(i, t.currentObject) : null !== i && t.showContextMenu(i, null)) } fn.className = "LinkReshapingTool", fn.None = pn, fn.Horizontal = gn, fn.Vertical = yn, fn.All = mn, T("linkReshapingTool", function () { return this.findTool("LinkReshaping") }, function (t) { this.Wa("LinkReshaping", t, this.mouseDownTools) }), h(vn, Ne), vn.prototype.updateAdornments = function (t) { if (!(null === t || t instanceof Fu)) { if (t.isSelected && !this.diagram.isReadOnly) { var i = t.resizeObject, e = t.fk(this.name); if (null !== i && t.canResize() && t.actualBounds.v() && t.isVisible() && i.actualBounds.v() && i.yf() && (null !== e && e.adornedObject === i || (e = this.makeAdornment(i)), null !== e)) return i = i.Xi(), hu(t) && this.updateResizeHandles(e, i), void t.zh(this.name, e) } t.zf(this.name) } }, vn.prototype.makeAdornment = function (t) { var i = t.part.resizeAdornmentTemplate; if (null === i) { (i = new du).type = xh.Spot, i.locationSpot = Zt; var e = new Du; e.isPanelMain = !0, i.add(e), i.add(this.makeHandle(t, Ht)), i.add(this.makeHandle(t, Wt)), i.add(this.makeHandle(t, ti)), i.add(this.makeHandle(t, Qt)), i.add(this.makeHandle(t, Pi)), i.add(this.makeHandle(t, Ci)), i.add(this.makeHandle(t, Ti)), i.add(this.makeHandle(t, Ni)) } else if (Dh(i), null === (i = i.copy())) return null; return i.adornedObject = t, i }, vn.prototype.makeHandle = function (t, i) { return null === (t = this.handleArchetype) ? null : ((t = t.copy()).alignment = i, t) }, vn.prototype.updateResizeHandles = function (t, i) { if (null !== t) if (!t.alignment.Mb() && ("pointer" === t.cursor || 0 < t.cursor.indexOf("resize"))) t: { var e = t.alignment; if (e.jc() && (e = Zt), e.x <= 0) i = e.y <= 0 ? i + 225 : 1 <= e.y ? i + 135 : i + 180; else if (1 <= e.x) e.y <= 0 ? i += 315 : 1 <= e.y && (i += 45); else if (e.y <= 0) i += 270; else { if (!(1 <= e.y)) break t; i += 90 } i < 0 ? i += 360 : 360 <= i && (i -= 360), t.cursor = i < 22.5 ? "e-resize" : i < 67.5 ? "se-resize" : i < 112.5 ? "s-resize" : i < 157.5 ? "sw-resize" : i < 202.5 ? "w-resize" : i < 247.5 ? "nw-resize" : i < 292.5 ? "n-resize" : i < 337.5 ? "ne-resize" : "e-resize" } else if (t instanceof xh) for (t = t.elements; t.next();)this.updateResizeHandles(t.value, i) }, vn.prototype.canStart = function () { if (!this.isEnabled) return !1; var t = this.diagram; return !(t.isReadOnly || !t.allowResize || !t.lastInput.left) && null !== this.findToolHandleAt(t.firstInput.documentPoint, this.name) }, vn.prototype.doActivate = function () { var t = this.diagram; null === this.handle && (this.handle = this.findToolHandleAt(t.firstInput.documentPoint, this.name)), null !== this.handle && (this.adornedObject = this.handle.part.adornedObject, null !== this.adornedObject && (this.ps.set(this.adornedObject.ga(this.handle.alignment.Tv())), this.Yo.set(this.adornedObject.part.location), this.hx.set(this.adornedObject.desiredSize), this.ou = this.computeCellSize(), this.qu = this.computeMinSize(), this.pu = this.computeMaxSize(), t.isMouseCaptured = !0, this.bx = t.animationManager.isEnabled, t.animationManager.isEnabled = !1, this.ua(this.name), this.isActive = !0)) }, vn.prototype.doDeactivate = function () { var t = this.diagram; this.Eg(), this.ce = this.handle = null, this.isActive = t.isMouseCaptured = !1, t.animationManager.isEnabled = this.bx }, vn.prototype.doCancel = function () { null !== this.adornedObject && (this.adornedObject.desiredSize = this.originalDesiredSize, this.adornedObject.part.location = this.originalLocation), this.stopTool() }, vn.prototype.doMouseMove = function () { var t, i, e, n, o, r = this.diagram; this.isActive && (o = this.qu, t = this.pu, i = this.ou, e = this.adornedObject.qt(r.lastInput.documentPoint, gi.alloc()), n = this.computeReshape(), o = this.computeResize(e, this.handle.alignment, o, t, i, n), this.resize(o), r.Xc(), gi.free(e)) }, vn.prototype.doMouseUp = function () { var t, i, e, n, o, r = this.diagram; this.isActive && (o = this.qu, t = this.pu, i = this.ou, e = this.adornedObject.qt(r.lastInput.documentPoint, gi.alloc()), n = this.computeReshape(), o = this.computeResize(e, this.handle.alignment, o, t, i, n), this.resize(o), gi.free(e), r.Na(), this.transactionResult = this.name, r.R("PartResized", this.adornedObject, this.originalDesiredSize)), this.stopTool() }, vn.prototype.resize = function (t) { var i, e = this.diagram, n = this.adornedObject; null !== n && (n.desiredSize = t.size, (t = n.part).zb(), n = n.ga(this.handle.alignment.Tv()), t instanceof Lu ? ((i = new J).add(t), e.moveParts(i, this.oppositePoint.copy().ae(n), !0)) : t.location = t.location.copy().ae(n).add(this.oppositePoint), e.Xc()) }, vn.prototype.computeResize = function (t, i, e, n, o, r) { i.jc() && (i = Zt); var s, a = this.adornedObject.naturalBounds, h = a.x, l = a.y, u = a.x + a.width, c = a.y + a.height, f = 1; return r || ((f = a.width) <= 0 && (f = 1), (s = a.height) <= 0 && (s = 1), f = s / f), s = gi.alloc(), qi.nq(t.x, t.y, h, l, o.width, o.height, s), t = a.copy(), i.x <= 0 ? i.y <= 0 ? (t.x = Math.max(s.x, u - n.width), t.x = Math.min(t.x, u - e.width), t.width = Math.max(u - t.x, e.width), t.y = Math.max(s.y, c - n.height), t.y = Math.min(t.y, c - e.height), t.height = Math.max(c - t.y, e.height), r || (1 <= t.height / t.width ? (t.height = Math.max(Math.min(f * t.width, n.height), e.height), t.width = t.height / f) : (t.width = Math.max(Math.min(t.height / f, n.width), e.width), t.height = f * t.width), t.x = u - t.width, t.y = c - t.height)) : 1 <= i.y ? (t.x = Math.max(s.x, u - n.width), t.x = Math.min(t.x, u - e.width), t.width = Math.max(u - t.x, e.width), t.height = Math.max(Math.min(s.y - l, n.height), e.height), r || (1 <= t.height / t.width ? (t.height = Math.max(Math.min(f * t.width, n.height), e.height), t.width = t.height / f) : (t.width = Math.max(Math.min(t.height / f, n.width), e.width), t.height = f * t.width), t.x = u - t.width)) : (t.x = Math.max(s.x, u - n.width), t.x = Math.min(t.x, u - e.width), t.width = u - t.x, r || (t.height = Math.max(Math.min(f * t.width, n.height), e.height), t.width = t.height / f, t.y = l + .5 * (c - l - t.height))) : 1 <= i.x ? i.y <= 0 ? (t.width = Math.max(Math.min(s.x - h, n.width), e.width), t.y = Math.max(s.y, c - n.height), t.y = Math.min(t.y, c - e.height), t.height = Math.max(c - t.y, e.height), r || (1 <= t.height / t.width ? (t.height = Math.max(Math.min(f * t.width, n.height), e.height), t.width = t.height / f) : (t.width = Math.max(Math.min(t.height / f, n.width), e.width), t.height = f * t.width), t.y = c - t.height)) : 1 <= i.y ? (t.width = Math.max(Math.min(s.x - h, n.width), e.width), t.height = Math.max(Math.min(s.y - l, n.height), e.height), r || (1 <= t.height / t.width ? (t.height = Math.max(Math.min(f * t.width, n.height), e.height), t.width = t.height / f) : (t.width = Math.max(Math.min(t.height / f, n.width), e.width), t.height = f * t.width))) : (t.width = Math.max(Math.min(s.x - h, n.width), e.width), r || (t.height = Math.max(Math.min(f * t.width, n.height), e.height), t.width = t.height / f, t.y = l + .5 * (c - l - t.height))) : i.y <= 0 ? (t.y = Math.max(s.y, c - n.height), t.y = Math.min(t.y, c - e.height), t.height = c - t.y, r || (t.width = Math.max(Math.min(t.height / f, n.width), e.width), t.height = f * t.width, t.x = h + .5 * (u - h - t.width))) : 1 <= i.y && (t.height = Math.max(Math.min(s.y - l, n.height), e.height), r || (t.width = Math.max(Math.min(t.height / f, n.width), e.width), t.height = f * t.width, t.x = h + .5 * (u - h - t.width))), gi.free(s), t }, vn.prototype.computeReshape = function () { var t = Xr; return this.adornedObject instanceof Kh && (t = Wh(this.adornedObject)), !(t === qr || this.diagram.lastInput.shift) }, vn.prototype.computeMinSize = function () { var t = this.adornedObject.minSize.copy(), i = this.minSize; return !isNaN(i.width) && i.width > t.width && (t.width = i.width), !isNaN(i.height) && i.height > t.height && (t.height = i.height), t }, vn.prototype.computeMaxSize = function () { var t = this.adornedObject.maxSize.copy(), i = this.maxSize; return !isNaN(i.width) && i.width < t.width && (t.width = i.width), !isNaN(i.height) && i.height < t.height && (t.height = i.height), t }, vn.prototype.computeCellSize = function () { var t = new Yi(NaN, NaN), i = this.adornedObject.part; return null !== i && (i = i.resizeCellSize, !isNaN(i.width) && 0 < i.width && (t.width = i.width), !isNaN(i.height) && 0 < i.height && (t.height = i.height)), i = this.cellSize, isNaN(t.width) && !isNaN(i.width) && 0 < i.width && (t.width = i.width), isNaN(t.height) && !isNaN(i.height) && 0 < i.height && (t.height = i.height), i = this.diagram, (isNaN(t.width) || isNaN(t.height)) && i && (null !== (i = i.grid) && i.visible && this.isGridSnapEnabled && (i = i.gridCellSize, isNaN(t.width) && !isNaN(i.width) && 0 < i.width && (t.width = i.width), isNaN(t.height) && !isNaN(i.height) && 0 < i.height && (t.height = i.height))), !isNaN(t.width) && 0 !== t.width && 1 / 0 !== t.width || (t.width = 1), !isNaN(t.height) && 0 !== t.height && 1 / 0 !== t.height || (t.height = 1), t }, l.Object.defineProperties(vn.prototype, { handleArchetype: { get: function () { return this.u }, set: function (t) { this.u = t } }, handle: { get: function () { return this.l }, set: function (t) { if (null !== t && !(t.part instanceof du)) throw Error("new handle is not in an Adornment: " + t); this.l = t } }, adornedObject: { get: function () { return this.ce }, set: function (t) { if (null !== t && t.part instanceof du) throw Error("new handle must not be in an Adornment: " + t); this.ce = t } }, minSize: { get: function () { return this.bg }, set: function (t) { var i; this.bg.w(t) || (i = t.width, isNaN(i) && (i = 0), t = t.height, isNaN(t) && (t = 0), this.bg.h(i, t)) } }, maxSize: { get: function () { return this.ag }, set: function (t) { var i; this.ag.w(t) || (i = t.width, isNaN(i) && (i = 1 / 0), t = t.height, isNaN(t) && (t = 1 / 0), this.ag.h(i, t)) } }, cellSize: { get: function () { return this.Kg }, set: function (t) { this.Kg.w(t) || this.Kg.assign(t) } }, isGridSnapEnabled: { get: function () { return this.I }, set: function (t) { this.I = t } }, oppositePoint: { get: function () { return this.ps }, set: function (t) { this.ps.w(t) || this.ps.assign(t) } }, originalDesiredSize: { get: function () { return this.hx } }, originalLocation: { get: function () { return this.Yo } } }), vn.className = "ResizingTool", T("resizingTool", function () { return this.findTool("Resizing") }, function (t) { this.Wa("Resizing", t, this.mouseDownTools) }), h(xn, Ne), xn.prototype.updateAdornments = function (t) { if (null !== t) { if (t.Hh()) { var i = t.rotateObject; if (i === t || i === t.path || i.isPanelMain) return } if (t.isSelected && !this.diagram.isReadOnly && (null !== (i = t.rotateObject) && t.canRotate() && t.actualBounds.v() && t.isVisible() && i.actualBounds.v() && i.yf())) { var e = t.fk(this.name); if (null !== e && e.adornedObject === i || (e = this.makeAdornment(i)), null !== e) return e.angle = i.Xi(), null === e.placeholder && (e.location = this.computeAdornmentLocation(i)), void t.zh(this.name, e) } t.zf(this.name) } }, xn.prototype.makeAdornment = function (t) { var i = t.part.rotateAdornmentTemplate; if (null === i) { (i = new du).type = xh.Position, i.locationSpot = Zt; var e = this.handleArchetype; null !== e && i.add(e.copy()) } else if (Dh(i), null === (i = i.copy())) return null; return i.adornedObject = t, i }, xn.prototype.canStart = function () { if (!this.isEnabled) return !1; var t = this.diagram; return !(t.isReadOnly || !t.allowRotate || !t.lastInput.left) && null !== this.findToolHandleAt(t.firstInput.documentPoint, this.name) }, xn.prototype.doActivate = function () { var t = this.diagram; if (null === this.adornedObject) { if (null === this.handle && (this.handle = this.findToolHandleAt(t.firstInput.documentPoint, this.name)), null === this.handle) return; this.adornedObject = this.handle.part.adornedObject } null !== this.adornedObject && (this.gx = this.adornedObject.angle, this.Qu = this.computeRotationPoint(this.adornedObject), this.Yo = this.adornedObject.part.location.copy(), t.isMouseCaptured = !0, t.delaysLayout = !0, this.ua(this.name), this.isActive = !0) }, xn.prototype.computeRotationPoint = function (t) { var i = t.part, e = i.locationObject; return i.rotationSpot.gb() ? t.ga(i.rotationSpot) : t === i || t === e ? e.ga(i.locationSpot) : t.ga(Zt) }, xn.prototype.computeAdornmentLocation = function (t) { var i = this.rotationPoint; i.v() || (i = this.computeRotationPoint(t)), i = t.qt(i); var e = this.handleAngle; e < 0 ? e += 360 : 360 <= e && (e -= 360), e = Math.round(45 * Math.round(e / 45)); var n = this.handleDistance; return 0 === e ? i.x = t.naturalBounds.width + n : 45 === e ? (i.x = t.naturalBounds.width + n, i.y = t.naturalBounds.height + n) : 90 === e ? i.y = t.naturalBounds.height + n : 135 === e ? (i.x = -n, i.y = t.naturalBounds.height + n) : 180 === e ? i.x = -n : 225 === e ? (i.x = -n, i.y = -n) : 270 === e ? i.y = -n : 315 === e && (i.x = t.naturalBounds.width + n, i.y = -n), t.ga(i) }, xn.prototype.doDeactivate = function () { var t = this.diagram; this.Eg(), this.ce = this.handle = null, this.Qu = new gi(NaN, NaN), this.isActive = t.isMouseCaptured = !1 }, xn.prototype.doCancel = function () { this.diagram.delaysLayout = !1, this.rotate(this.originalAngle), this.stopTool() }, xn.prototype.doMouseMove = function () { var t = this.diagram; this.isActive && (t = this.computeRotate(t.lastInput.documentPoint), this.rotate(t)) }, xn.prototype.doMouseUp = function () { var t, i = this.diagram; this.isActive && (i.delaysLayout = !1, t = this.computeRotate(i.lastInput.documentPoint), this.rotate(t), i.Na(), this.transactionResult = this.name, i.R("PartRotated", this.adornedObject, this.originalAngle)), this.stopTool() }, xn.prototype.rotate = function (t) { var i, e, n = this.adornedObject; null !== n && (n.angle = t, (n = n.part).zb(), (i = n.locationObject) !== (e = n.rotateObject) && !i.Ag(e) || (i = this.Yo.copy(), n.location = i.ae(this.rotationPoint).rotate(t - this.originalAngle).add(this.rotationPoint)), this.diagram.Xc()) }, xn.prototype.computeRotate = function (t) { t = this.rotationPoint.Sa(t) - this.handleAngle; var i = this.adornedObject.panel; null !== i && (t -= i.Xi()), 360 <= t ? t -= 360 : t < 0 && (t += 360), i = Math.min(Math.abs(this.snapAngleMultiple), 180); var e = Math.min(Math.abs(this.snapAngleEpsilon), i / 2); return !this.diagram.lastInput.shift && 0 < i && 0 < e && (t % i < e ? t = Math.floor(t / i) * i : i - e < t % i && (t = (Math.floor(t / i) + 1) * i)), 360 <= t ? t -= 360 : t < 0 && (t += 360), t }, l.Object.defineProperties(xn.prototype, { handleArchetype: { get: function () { return this.u }, set: function (t) { this.u = t } }, handle: { get: function () { return this.l }, set: function (t) { if (null !== t && !(t.part instanceof du)) throw Error("new handle is not in an Adornment: " + t); this.l = t } }, adornedObject: { get: function () { return this.ce }, set: function (t) { if (null !== t && t.part instanceof du) throw Error("new handle must not be in an Adornment: " + t); this.ce = t } }, snapAngleMultiple: { get: function () { return this.Ia }, set: function (t) { this.Ia = t } }, snapAngleEpsilon: { get: function () { return this.Ha }, set: function (t) { this.Ha = t } }, originalAngle: { get: function () { return this.gx } }, rotationPoint: { get: function () { return this.Qu } }, handleAngle: { get: function () { return this.I }, set: function (t) { this.I = t } }, handleDistance: { get: function () { return this.W }, set: function (t) { this.W = t } } }), xn.className = "RotatingTool", T("rotatingTool", function () { return this.findTool("Rotating") }, function (t) { this.Wa("Rotating", t, this.mouseDownTools) }), h(bn, Ne), bn.prototype.canStart = function () { return !(!this.isEnabled || this.isBeyondDragSize()) }, bn.prototype.doMouseUp = function () { this.isActive && (this.standardMouseSelect(), !this.standardMouseClick() && this.diagram.lastInput.isTouchEvent && this.diagram.toolManager.doToolTip()), this.stopTool() }, bn.className = "ClickSelectingTool", h(wn, Ne), wn.prototype.canStart = function () { if (!this.isEnabled) return !1; var t = this.diagram, i = t.lastInput, e = t.Ub(i.documentPoint, function (t) { for (; null !== t.panel && !t.isActionable;)t = t.panel; return t }); return null !== e && (!!e.isActionable && (this.Bk = e, t.mj = t.Ub(i.documentPoint, null, null), !0)) }, wn.prototype.doMouseDown = function () { var t, i; this.isActive ? (t = this.diagram.lastInput, null === (i = this.Bk) || null !== (t.targetObject = i).actionDown && i.actionDown(t, i)) : this.canStart() && this.doActivate() }, wn.prototype.doMouseMove = function () { var t, i; this.isActive && (t = this.diagram.lastInput, null === (i = this.Bk) || null !== (t.targetObject = i).actionMove && i.actionMove(t, i)) }, wn.prototype.doMouseUp = function () { if (this.isActive) { var t = this.diagram.lastInput, i = this.Bk; if (null === i) return; null !== (t.targetObject = i).actionUp && i.actionUp(t, i), this.standardMouseClick(function (t) { for (; null !== t.panel && (!t.isActionable || t !== i);)t = t.panel; return t }, function (t) { return t === i }) } this.stopTool() }, wn.prototype.doCancel = function () { var t = this.diagram.lastInput, i = this.Bk; null !== i && (null !== (t.targetObject = i).actionCancel && i.actionCancel(t, i), this.stopTool()) }, wn.prototype.doStop = function () { this.Bk = null }, wn.className = "ActionTool", h(kn, Ne), kn.prototype.canStart = function () { if (!this.isEnabled || null === this.archetypeNodeData) return !1; var t = this.diagram; if (t.isReadOnly || t.isModelReadOnly || !t.allowInsert || !t.lastInput.left || this.isBeyondDragSize()) return !1; if (this.isDoubleClick) { if (1 === t.lastInput.clickCount && (this.Ww = t.lastInput.viewPoint.copy()), 2 !== t.lastInput.clickCount || this.isBeyondDragSize(this.Ww)) return !1 } else if (1 !== t.lastInput.clickCount) return !1; return t.currentTool === this || null === t.im(t.lastInput.documentPoint, !0) }, kn.prototype.doMouseUp = function () { var t = this.diagram; this.isActive && this.insertPart(t.lastInput.documentPoint), this.stopTool() }, kn.prototype.insertPart = function (t) { var i = this.diagram, e = this.archetypeNodeData; if (null === e) return null; var n, o, r = null; try { i.R("ChangingSelection", i.selection), this.ua(this.name), e instanceof Hl ? e.Wb() && (Dh(e), null !== (r = e.copy()) && i.add(r)) : null === e || b(n = i.model.copyNodeData(e)) && (i.model.pf(n), r = i.wc(n)), null !== r && (o = gi.allocAt(t.x, t.y), this.isGridSnapEnabled && gr(this.diagram, r, t, o), r.location = o, i.allowSelect && (i.clearSelection(!0), r.isSelected = !0), gi.free(o)), i.Na(), this.transactionResult = this.name, i.R("PartCreated", r) } finally { this.Eg(), i.R("ChangedSelection", i.selection) } return r }, l.Object.defineProperties(kn.prototype, { archetypeNodeData: { get: function () { return this.ij }, set: function (t) { this.ij = t } }, isDoubleClick: { get: function () { return this.u }, set: function (t) { this.u = t } }, isGridSnapEnabled: { get: function () { return this.l }, set: function (t) { this.l = t } } }), kn.className = "ClickCreatingTool", h(Mn, Ne), Mn.prototype.canStart = function () { if (!this.isEnabled) return !1; var t = this.diagram; if (!t.allowSelect) return !1; var i = t.lastInput; return !(!i.left || t.currentTool !== this && (!this.isBeyondDragSize() || i.timestamp - t.firstInput.timestamp < this.delay || null !== t.im(i.documentPoint, !0))) }, Mn.prototype.doActivate = function () { var t = this.diagram; this.isActive = !0, t.isMouseCaptured = !0, t.skipsUndoManager = !0, t.add(this.box), this.doMouseMove() }, Mn.prototype.doDeactivate = function () { var t = this.diagram; t.Bf(), t.remove(this.box), t.skipsUndoManager = !1, this.isActive = t.isMouseCaptured = !1 }, Mn.prototype.doMouseMove = function () { var t, i, e, n = this.diagram; this.isActive && null !== this.box && (e = this.computeBoxBounds(), null === (t = this.box.Ya("SHAPE")) && (t = this.box.Ab()), i = Yi.alloc().h(e.width, e.height), e = gi.allocAt(e.x, e.y), t.desiredSize = i, this.box.position = e, Yi.free(i), gi.free(e), (n.allowHorizontalScroll || n.allowVerticalScroll) && n.it(n.lastInput.viewPoint)) }, Mn.prototype.doMouseUp = function () { if (this.isActive) { var t = this.diagram; t.remove(this.box); try { t.currentCursor = "wait", t.R("ChangingSelection", t.selection), this.selectInRect(this.computeBoxBounds()), t.R("ChangedSelection", t.selection) } finally { t.currentCursor = "" } } this.stopTool() }, Mn.prototype.computeBoxBounds = function () { var t = this.diagram; return new yi(t.firstInput.documentPoint, t.lastInput.documentPoint) }, Mn.prototype.selectInRect = function (t) { var i = this.diagram, e = i.lastInput; if (t = i.Ox(t, this.isPartialInclusion), I ? e.meta : e.control) if (e.shift) for (t = t.iterator; t.next();)(i = t.value).isSelected && (i.isSelected = !1); else for (t = t.iterator; t.next();)(i = t.value).isSelected = !i.isSelected; else if (e.shift) for (t = t.iterator; t.next();)(i = t.value).isSelected || (i.isSelected = !0); else { for (e = new J, i = i.selection.iterator; i.next();) { var n = i.value; t.contains(n) || e.add(n) } for (i = e.iterator; i.next();)i.value.isSelected = !1; for (t = t.iterator; t.next();)(i = t.value).isSelected || (i.isSelected = !0) } }, l.Object.defineProperties(Mn.prototype, { delay: { get: function () { return this.Vk }, set: function (t) { this.Vk = t } }, isPartialInclusion: { get: function () { return this.u }, set: function (t) { this.u = t } }, box: { get: function () { return this.l }, set: function (t) { this.l = t } } }), Mn.className = "DragSelectingTool", h(Sn, Ne), Sn.prototype.canStart = function () { if (!this.isEnabled) return !1; var t = this.diagram; return !(!t.allowHorizontalScroll && !t.allowVerticalScroll || !t.lastInput.left || t.currentTool !== this && !this.isBeyondDragSize()) }, Sn.prototype.doActivate = function () { var t = this.diagram; this.Jg ? (t.lastInput.bubbles = !0, t.addEventListener(c.document, "scroll", this.mx, !1)) : (t.currentCursor = "move", t.isMouseCaptured = !0, this.Nu.assign(t.position)), this.isActive = !0 }, Sn.prototype.doDeactivate = function () { var t = this.diagram; t.currentCursor = "", this.isActive = t.isMouseCaptured = !1 }, Sn.prototype.doCancel = function () { var t = this.diagram; t.position = this.Nu, t.isMouseCaptured = !1, this.stopTool() }, Sn.prototype.doMouseMove = function () { this.move() }, Sn.prototype.doMouseUp = function () { this.move(), this.stopTool() }, Sn.prototype.move = function () { var t, i, e, n, o = this.diagram; this.isActive && o && (this.Jg ? o.lastInput.bubbles = !0 : (t = o.position, n = o.firstInput.documentPoint, i = o.lastInput.documentPoint, e = t.x + n.x - i.x, n = t.y + n.y - i.y, o.allowHorizontalScroll || (e = t.x), o.allowVerticalScroll || (n = t.y), o.position = this.Fy.h(e, n))) }, l.Object.defineProperties(Sn.prototype, { bubbles: { get: function () { return this.Jg }, set: function (t) { this.Jg = t } }, originalPosition: { get: function () { return this.Nu } } }), Sn.className = "PanningTool", T("clickCreatingTool", function () { return this.findTool("ClickCreating") }, function (t) { this.Wa("ClickCreating", t, this.mouseUpTools) }), T("clickSelectingTool", function () { return this.findTool("ClickSelecting") }, function (t) { this.Wa("ClickSelecting", t, this.mouseUpTools) }), T("panningTool", function () { return this.findTool("Panning") }, function (t) { this.Wa("Panning", t, this.mouseMoveTools) }), T("dragSelectingTool", function () { return this.findTool("DragSelecting") }, function (t) { this.Wa("DragSelecting", t, this.mouseMoveTools) }), T("actionTool", function () { return this.findTool("Action") }, function (t) { this.Wa("Action", t, this.mouseDownTools) }), l.Object.defineProperties(Pn.prototype, { mainElement: { get: function () { return this.I }, set: function (t) { this.I = t } }, show: { get: function () { return this.u }, set: function (t) { this.u !== t && (this.u = t) } }, hide: { get: function () { return this.l }, set: function (t) { this.l !== t && (this.l = t) } }, valueFunction: { get: function () { return this.W }, set: function (t) { this.W = t } } }), Pn.className = "HTMLInfo", Nn.className = "ContextMenuButtonInfo", h(Cn, Ne), Cn.prototype.canStart = function () { if (!this.isEnabled) return !1; var t = this.diagram; return !(this.isBeyondDragSize() || !t.lastInput.right) && !!(t.lastInput.isTouchEvent && null !== this.defaultTouchContextMenu || null !== this.findObjectWithContextMenu()) }, Cn.prototype.doStart = function () { this.ax.set(this.diagram.firstInput.documentPoint) }, Cn.prototype.doStop = function () { this.hideContextMenu(), this.currentObject = null }, Cn.prototype.findObjectWithContextMenu = function (t) { void 0 === t && (t = null); var i = this.diagram, e = i.lastInput, n = null; if (t instanceof Lo || (n = t instanceof Es ? t : i.Ub(e.documentPoint, null, function (t) { return !t.layer.isTemporary })), null !== n) { for (t = n; null !== t;) { if (null !== t.contextMenu) return t; t = t.panel } if (i.lastInput.isTouchEvent && this.defaultTouchContextMenu) return n.part } else if (null !== i.contextMenu) return i; return null }, Cn.prototype.doActivate = function () { }, Cn.prototype.doMouseDown = function () { var t; Ne.prototype.doMouseDown.call(this), this.isActive && this.currentContextMenu instanceof du && (null !== (t = this.diagram.toolManager.findTool("Action")) && t.canStart() && (t.doActivate(), t.doMouseDown(), t.doDeactivate())), this.diagram.toolManager.mouseDownTools.contains(this) && Ln(this) }, Cn.prototype.doMouseUp = function () { var t; this.isActive && this.currentContextMenu instanceof du && (null !== (t = this.diagram.toolManager.findTool("Action")) && t.canStart() && (t.doActivate(), t.doCancel(), t.doDeactivate())), Ln(this) }, Cn.prototype.doMouseMove = function () { var t = this.diagram.toolManager.findTool("Action"); null !== t && t.doMouseMove(), this.isActive && this.diagram.toolManager.doMouseMove() }, Cn.prototype.showContextMenu = function (t, i) { var e, n = this.diagram; t !== this.currentContextMenu && this.hideContextMenu(), t instanceof du ? (t.layerName = "Tool", t.selectable = !1, t.scale = 1 / n.scale, t.category = this.name, null !== t.placeholder && (t.placeholder.scale = n.scale), null !== (e = t.diagram) && e !== n && e.remove(t), n.add(t), null !== i ? t.adornedObject = i : t.data = n.model, t.zb(), this.positionContextMenu(t, i)) : t instanceof Pn && t.show(i, n, this), this.currentContextMenu = t }, Cn.prototype.positionContextMenu = function (t) { var i, e, n, o; null === t.placeholder && (e = (i = this.diagram).lastInput.documentPoint.copy(), n = t.measuredBounds, o = i.viewportBounds, i.lastInput.isTouchEvent && (e.x -= n.width), e.x + n.width > o.right && (e.x -= n.width + 5 / i.scale), e.x < o.x && (e.x = o.x), e.y + n.height > o.bottom && (e.y -= n.height + 5 / i.scale), e.y < o.y && (e.y = o.y), t.position = e) }, Cn.prototype.hideContextMenu = function () { var t = this.diagram, i = this.currentContextMenu; null !== i && (i instanceof du ? (t.remove(i), null !== this.fu && this.fu.zf(i.category), i.data = null, i.adornedObject = null) : i instanceof Pn && (null !== i.hide ? i.hide(t, this) : null !== i.mainElement && (i.mainElement.style.display = "none")), this.currentContextMenu = null, this.standardMouseOver()) }, Cn.prototype.showDefaultContextMenu = function () { var i, t, e = this.diagram; null === this.gu && (this.gu = (i = this, (t = new J).add(new Nn("Copy", function (t) { t.commandHandler.copySelection() }, function (t) { return t.commandHandler.canCopySelection() })), t.add(new Nn("Cut", function (t) { t.commandHandler.cutSelection() }, function (t) { return t.commandHandler.canCutSelection() })), t.add(new Nn("Delete", function (t) { t.commandHandler.deleteSelection() }, function (t) { return t.commandHandler.canDeleteSelection() })), t.add(new Nn("Paste", function (t) { t.commandHandler.pasteSelection(i.mouseDownPoint) }, function (t) { return t.commandHandler.canPasteSelection(i.mouseDownPoint) })), t.add(new Nn("Select All", function (t) { t.commandHandler.selectAll() }, function (t) { return t.commandHandler.canSelectAll() })), t.add(new Nn("Undo", function (t) { t.commandHandler.undo() }, function (t) { return t.commandHandler.canUndo() })), t.add(new Nn("Redo", function (t) { t.commandHandler.redo() }, function (t) { return t.commandHandler.canRedo() })), t.add(new Nn("Scroll To Part", function (t) { t.commandHandler.scrollToPart() }, function (t) { return t.commandHandler.canScrollToPart() })), t.add(new Nn("Zoom To Fit", function (t) { t.commandHandler.zoomToFit() }, function (t) { return t.commandHandler.canZoomToFit() })), t.add(new Nn("Reset Zoom", function (t) { t.commandHandler.resetZoom() }, function (t) { return t.commandHandler.canResetZoom() })), t.add(new Nn("Group Selection", function (t) { t.commandHandler.groupSelection() }, function (t) { return t.commandHandler.canGroupSelection() })), t.add(new Nn("Ungroup Selection", function (t) { t.commandHandler.ungroupSelection() }, function (t) { return t.commandHandler.canUngroupSelection() })), t.add(new Nn("Edit Text", function (t) { t.commandHandler.editTextBlock() }, function (t) { return t.commandHandler.canEditTextBlock() })), t)), On.innerHTML = "", Fn.addEventListener("click", this.$u, !1); var n = this, o = p("ul"); o.className = "goCXul", On.appendChild(o), o.innerHTML = ""; for (var r = this.gu.iterator; r.next();) { var s, a = r.value, h = a.visible; "function" != typeof a.Cx || "function" == typeof h && !h(e) || ((h = p("li")).className = "goCXli", (s = p("a")).className = "goCXa", s.href = "#", s.zy = a.Cx, s.addEventListener("click", function (t) { return this.zy(e), n.stopTool(), t.preventDefault(), !1 }, !1), s.textContent = a.text, h.appendChild(s), o.appendChild(h)) } On.style.display = "block", Fn.style.display = "block" }, Cn.prototype.hideDefaultContextMenu = function () { var t; null !== this.currentContextMenu && this.currentContextMenu === jn && (On.style.display = "none", Fn.style.display = "none", null !== (t = this.diagram) && t.removeEventListener(Fn, "click", this.$u, !1), this.currentContextMenu = null) }, l.Object.defineProperties(Cn.prototype, { currentContextMenu: { get: function () { return this.l }, set: function (t) { this.l = t, this.fu = t instanceof du ? t.adornedPart : null } }, defaultTouchContextMenu: { get: function () { return !1 === Dn && null === jn && es && function (t) { var i = new Pn; i.show = function (t, i, e) { e.showDefaultContextMenu() }, i.hide = function (t, i) { i.hideDefaultContextMenu() }, jn = i, t.$u = function () { t.stopTool() }, i = p("div"); var e = p("div"); i.style.cssText = "top: 0px;z-index:10002;position: fixed;display: none;text-align: center;left: 25%;width: 50%;background-color: #F5F5F5;padding: 16px;border: 16px solid #444;border-radius: 10px;margin-top: 10px", e.style.cssText = "z-index:10001;position: fixed;display: none;top: 0;left: 0;width: 100%;height: 100%;background-color: black;opacity: 0.8;"; var n = p("style"); c.document.getElementsByTagName("head")[0].appendChild(n), n.sheet.insertRule(".goCXul { list-style: none; }", 0), n.sheet.insertRule(".goCXli {font:700 1.5em Helvetica, Arial, sans-serif;position: relative;min-width: 60px; }", 0), n.sheet.insertRule(".goCXa {color: #444;display: inline-block;padding: 4px;text-decoration: none;margin: 2px;border: 1px solid gray;border-radius: 10px; }", 0), null !== (n = t.diagram) && (n.addEventListener(i, "contextmenu", Tn, !1), n.addEventListener(i, "selectstart", Tn, !1), n.addEventListener(e, "contextmenu", Tn, !1)), i.className = "goCXforeground", e.className = "goCXbackground", c.document.body && (c.document.body.appendChild(i), c.document.body.appendChild(e)), On = i, Fn = e, Dn = !0 }(this), jn }, set: function (t) { null === t && (Dn = !0), jn = t } }, currentObject: { get: function () { return this.u }, set: function (t) { this.u = t } }, mouseDownPoint: { get: function () { return this.ax } } }); var jn = null, Dn = !1, Fn = null, On = null; function Bn() { Ne.call(this), this.name = "TextEditing", this.sh = new el, this.Ia = null, this.Ha = Gn, this.Ji = null, this.ia = qn, this.I = 1, this.W = !0, this.u = null, this.l = new Pn, this.ku = null, function (e, t) { { var u; es && (u = p("textarea"), (e.ku = u).addEventListener("input", function () { var t; null !== e.textBlock && (t = e.Yx(this.value), this.style.width = 20 + t.measuredBounds.width * this.zA + "px", this.rows = t.lineCount) }, !1), u.addEventListener("keydown", function (t) { var i; null !== e.textBlock && (13 === (i = t.which) ? (!1 === e.textBlock.isMultiline && t.preventDefault(), e.acceptText(Vn)) : 9 === i ? (e.acceptText(zn), t.preventDefault()) : 27 === i && (e.doCancel(), null !== e.diagram && e.diagram.doFocus())) }, !1), u.addEventListener("focus", function () { var t; null !== e.currentTextEditor && e.state !== qn && (t = e.ku, e.ia === Un && (e.ia = Kn), "function" == typeof t.select && e.selectsTextOnActivate && (t.select(), t.setSelectionRange(0, 9999))) }, !1), u.addEventListener("blur", function () { var t; null !== e.currentTextEditor && e.state !== qn && ("function" == typeof (t = e.ku).focus && t.focus(), "function" == typeof t.select && e.selectsTextOnActivate && (t.select(), t.setSelectionRange(0, 9999))) }, !1), t.valueFunction = function () { return u.value }, t.mainElement = u, t.show = function (t, i, e) { var n, o, r, s, a, h, l; t instanceof el && e instanceof Bn && (e.state === Wn ? (u.style.border = "3px solid red", u.focus()) : (l = t.ga(Zt), n = i.position, o = i.scale, (r = t.uf() * o) < e.minimumEditorScale && (r = e.minimumEditorScale), s = t.naturalBounds.width * r + 6, a = t.naturalBounds.height * r + 2, h = (l.x - n.x) * o, l = (l.y - n.y) * o, u.value = t.text, i.div.style.font = t.font, u.style.position = "absolute", u.style.zIndex = "100", u.style.font = "inherit", u.style.fontSize = 100 * r + "%", u.style.lineHeight = "normal", u.style.width = s + "px", u.style.left = (h - s / 2 | 0) - 1 + "px", u.style.top = (l - a / 2 | 0) - 1 + "px", u.style.textAlign = t.textAlign, u.style.margin = "0", u.style.padding = "1px", u.style.border = "0", u.style.outline = "none", u.style.whiteSpace = "pre-wrap", u.style.overflow = "hidden", u.rows = t.lineCount, u.zA = r, u.className = "goTXarea", i.div.appendChild(u), u.focus(), e.selectsTextOnActivate && (u.select(), u.setSelectionRange(0, 9999)))) }, t.hide = function (t) { t.div.removeChild(u) }) } }(this, this.l) } function In(t) { var i, e, n, o = t.textBlock, r = t.diagram, s = t.currentTextEditor; null !== o && null !== s && (i = o.text, e = "", null !== s.valueFunction && (e = s.valueFunction()), t.isValidText(o, i, e) ? (t.ua(t.name), t.ia = Jn, t.transactionResult = t.name, o.text = e, null !== (s = t.textBlock).textEdited && s.textEdited(s, i, e), null !== r && r.R("TextEdited", o, i), t.Eg(), t.stopTool(), null !== r && r.doFocus()) : (t.ia = Wn, null !== (n = t.textBlock).errorFunction && n.errorFunction(t, i, e), s.show(o, r, t))) } Cn.className = "ContextMenuTool", T("contextMenuTool", function () { return this.findTool("ContextMenu") }, function (t) { this.Wa("ContextMenu", t, this.mouseUpTools) }), h(Bn, Ne), Bn.prototype.canStart = function () { if (!this.isEnabled) return !1; var t = this.diagram; if (null === t || t.isReadOnly || Zn && Zn !== this && (Zn.acceptText(En), Zn && Zn !== this) || !t.lastInput.left || this.isBeyondDragSize()) return !1; var i = t.Ub(t.lastInput.documentPoint); return !!(null !== i && i instanceof el && i.editable && i.part.canEdit()) && !(null === (i = i.part) || this.starting === Gn && !i.isSelected || this.starting === Xn && t.lastInput.clickCount < 2) }, Bn.prototype.doStart = function () { null !== (Zn = this).textBlock && this.doActivate() }, Bn.prototype.doActivate = function () { var t, i, e, n; this.isActive || null !== (t = this.diagram) && (null === (i = this.textBlock) && (i = t.Ub(t.lastInput.documentPoint)), null !== i && i instanceof el && null !== (this.textBlock = i).part && (this.isActive = !0, this.ia = Un, e = this.defaultTextEditor, null !== i.textEditor && (e = i.textEditor), this.sh = this.textBlock.copy(), n = new yi(this.textBlock.ga(Ht), this.textBlock.ga(ti)), t.gw(n), e.show(i, t, this), this.currentTextEditor = e)) }, Bn.prototype.doCancel = function () { this.stopTool() }, Bn.prototype.doMouseUp = function () { this.canStart() && this.doActivate() }, Bn.prototype.doMouseDown = function () { this.isActive && this.acceptText(En) }, Bn.prototype.acceptText = function (t) { switch (t) { case En: this.ia === Jn ? this.currentTextEditor instanceof HTMLElement && this.currentTextEditor.focus() : this.ia !== Un && this.ia !== Wn && this.ia !== Kn || (this.ia = Hn, In(this)); break; case Rn: case Vn: case zn: Vn === t && !0 === this.textBlock.isMultiline || this.ia !== Un && this.ia !== Wn && this.ia !== Kn || (this.ia = Hn, In(this)) } }, Bn.prototype.doDeactivate = function () { var t = this.diagram; null !== t && (this.ia = qn, (this.textBlock = null) !== this.currentTextEditor && this.currentTextEditor.hide(t, this), this.isActive = !1) }, Bn.prototype.doStop = function () { Zn = null }, Bn.prototype.isValidText = function (t, i, e) { var n = this.textValidation; return !(null !== n && !n(t, i, e)) && !(null !== (n = t.textValidation) && !n(t, i, e)) }, Bn.prototype.Yx = function (t) { var i = this.sh; return i.text = t, i.measure(this.textBlock.ti, 1 / 0), i }, l.Object.defineProperties(Bn.prototype, { textBlock: { get: function () { return this.Ia }, set: function (t) { this.Ia = t } }, currentTextEditor: { get: function () { return this.u }, set: function (t) { this.u = t } }, defaultTextEditor: { get: function () { return this.l }, set: function (t) { this.l = t } }, starting: { get: function () { return this.Ha }, set: function (t) { this.Ha = t } }, textValidation: { get: function () { return this.Ji }, set: function (t) { this.Ji = t } }, minimumEditorScale: { get: function () { return this.I }, set: function (t) { this.I = t } }, selectsTextOnActivate: { get: function () { return this.W }, set: function (t) { this.W = t } }, state: { get: function () { return this.ia }, set: function (t) { this.ia !== t && (this.ia = t) } } }), Bn.prototype.measureTemporaryTextBlock = Bn.prototype.Yx; var Rn = new V(Bn, "LostFocus", 0), En = new V(Bn, "MouseDown", 1), zn = new V(Bn, "Tab", 2), Vn = new V(Bn, "Enter", 3), Yn = new V(Bn, "SingleClick", 0), Gn = new V(Bn, "SingleClickSelected", 1), Xn = new V(Bn, "DoubleClick", 2), qn = new V(Bn, "StateNone", 0), Un = new V(Bn, "StateActive", 1), Kn = new V(Bn, "StateEditing", 2), Hn = new V(Bn, "StateValidating", 3), Wn = new V(Bn, "StateInvalid", 4), Jn = new V(Bn, "StateValidated", 5), Zn = null; function $n() { ho || (so(), ho = !0), this.B = Qr, this.fl = this.Ze = this.qc = this.Ur = this.hc = !1, this.sx = !0, this.gl = lo, this.bn = !1, this.oi = this.Mc = !0, this.Rg = 600, this.Ow = this.qx = !1, this.Ke = new $, this.Cd = new fo, (this.Cd.Jc = this).Ck = new $, this.Xu = new $, this.Us = new $ } function Qn(t, i) { _n(t, i) && (t.Ze = !0) } function _n(t, i) { return t.Mc && t.canStart(i) && (t.Ke.add(i), t.defaultAnimation.isAnimating && t.Yc(), t.qc = !0) } function to(t) { var i, e, n; t.Mc && t.qc && (i = t.Cd, e = t.B, (n = t.Ke.contains("Model")) && (t.fl = !0, t.gl === lo ? (i.isViewportUnconstrained = !0, i.pc.clear(), i.add(e, "position", e.position.copy().offset(0, -200), e.position), i.add(e, "opacity", 0, 1)) : t.gl === co && i.pc.clear(), t.sx = !(t.gl !== uo || !e.Bs.w(e.ma)), e.R("InitialAnimationStarting", t)), n && !t.oi || 0 === i.pc.count ? (t.Ke.clear(), t.qc = !1, t.Ze = !1, i.pc.clear(), po(i), t.fl = !1, e.M()) : (t.Ke.clear(), e.ye = !1, c.requestAnimationFrame(function () { !1 === t.qc || i.hc || (e.De("temporaryPixelRatio") && Fo(e), Bo(e), t.qc = !1, t.Ze = !1, i.start(), eo(t), e.Na(), vo(i, 0), tr(e, !0), no(t), e.R("AnimationStarting", t)) }))) } function io(t, i, e, n) { i instanceof Fu && (null !== i.fromNode || null !== i.toNode) || t.Cd.add(i, "position", e, n, !1) } function eo(t) { var i; t.Ur || (i = t.B, t.qx = i.skipsUndoManager, t.Ow = i.skipsModelSourceBindings, i.skipsUndoManager = !0, i.skipsModelSourceBindings = !0, t.Ur = !0) } function no(t) { var i = t.B; i.skipsUndoManager = t.qx, i.skipsModelSourceBindings = t.Ow, t.Ur = !1 } function oo(t, i, e) { t.Ze && !i.w(e) && (t.B.kk || (i = e.copy()), go(t.Cd, t.B, "position", i, e)) } function ro(t, i, e, n, o) { null === t && (t = "rgba(0,0,0,0)"), null === i && (i = "rgba(0,0,0,0)"), Ba(t), Ia(); var r = th.l, s = th.I, a = th.u; t = th.W, Ba(i), Ia(); var h = th.I, l = th.u; return i = th.W, "hsla(" + (r = o(e, r, th.l - r, n)) + ", " + (s = o(e, s, h - s, n)) + "%, " + (a = o(e, a, l - a, n)) + "%, " + (e = o(e, t, i - t, n)) + ")" } function so() { var t = new at; t.add("position:diagram", function (t, i, e, n, o, r) { t.position = new gi(n(o, i.x, e.x - i.x, r), n(o, i.y, e.y - i.y, r)) }), t.add("position", function (t, i, e, n, o, r) { o < r ? t.Lq(n(o, i.x, e.x - i.x, r), n(o, i.y, e.y - i.y, r), !1) : t.position = new gi(n(o, i.x, e.x - i.x, r), n(o, i.y, e.y - i.y, r)) }), t.add("location", function (t, i, e, n, o, r) { o < r ? t.Lq(n(o, i.x, e.x - i.x, r), n(o, i.y, e.y - i.y, r), !0) : t.location = new gi(n(o, i.x, e.x - i.x, r), n(o, i.y, e.y - i.y, r)) }), t.add("position:placeholder", function (t, i, e, n, o, r) { o < r ? t.Lq(n(o, i.x, e.x - i.x, r), n(o, i.y, e.y - i.y, r), !1) : t.position = new gi(n(o, i.x, e.x - i.x, r), n(o, i.y, e.y - i.y, r)) }), t.add("position:node", function (t, i, e, n, o, r) { var s = t.actualBounds, a = e.actualBounds; e = a.x + a.width / 2 - s.width / 2, s = a.y + a.height / 2 - s.height / 2, o < r ? t.Lq(n(o, i.x, e - i.x, r), n(o, i.y, s - i.y, r), !1) : t.position = new gi(n(o, i.x, e - i.x, r), n(o, i.y, s - i.y, r)) }), t.add("desiredSize", function (t, i, e, n, o, r) { t.desiredSize = new yi(n(o, i.width, e.width - i.width, r), n(o, i.height, e.height - i.height, r)) }), t.add("width", function (t, i, e, n, o, r) { t.width = n(o, i, e - i, r) }), t.add("height", function (t, i, e, n, o, r) { t.height = n(o, i, e - i, r) }), t.add("fill", function (t, i, e, n, o, r) { t.fill = ro(i, e, o, r, n) }), t.add("stroke", function (t, i, e, n, o, r) { t.stroke = ro(i, e, o, r, n) }), t.add("strokeWidth", function (t, i, e, n, o, r) { t.strokeWidth = n(o, i, e - i, r) }), t.add("strokeDashOffset", function (t, i, e, n, o, r) { t.strokeDashOffset = n(o, i, e - i, r) }), t.add("background", function (t, i, e, n, o, r) { t.background = ro(i, e, o, r, n) }), t.add("areaBackground", function (t, i, e, n, o, r) { t.areaBackground = ro(i, e, o, r, n) }), t.add("opacity", function (t, i, e, n, o, r) { t.opacity = n(o, i, e - i, r) }), t.add("scale", function (t, i, e, n, o, r) { t.scale = n(o, i, e - i, r) }), t.add("angle", function (t, i, e, n, o, r) { t.angle = n(o, i, e - i, r) }), ao = t } Bn.className = "TextEditingTool", Bn.LostFocus = Rn, Bn.MouseDown = En, Bn.Tab = zn, Bn.Enter = Vn, Bn.SingleClick = Yn, Bn.SingleClickSelected = Gn, Bn.DoubleClick = Xn, Bn.StateNone = qn, Bn.StateActive = Un, Bn.StateEditing = Kn, Bn.StateValidating = Hn, Bn.StateInvalid = Wn, Bn.StateValidated = Jn, T("textEditingTool", function () { return this.findTool("TextEditing") }, function (t) { this.Wa("TextEditing", t, this.mouseUpTools) }), $n.prototype.$d = function (t) { this.B = t }, $n.prototype.canStart = function () { return !0 }, (t = $n.prototype).Ft = function (t) { return this.Cd.Ft(t) }, t.Kv = function (t) { return this.Cd.Kv(t) }, t.Yc = function (t) { var i = this.Cd; if (!0 === this.qc && (this.fl = this.Ze = this.qc = !1, this.Ke.clear(), 0 < i.pc.count && this.B.Pb()), this.hc && this.Mc) { if (i.fm(!0), i.pc.clear(), po(i), !0 === t) for (t = this.Ck.na(), i = 0; i < t.length; i++)t[i].fm(!0) } else i.pc.clear(), po(i) }, t.fm = function (t) { t === this.defaultAnimation && this.defaultAnimation.pc.clear(), this.Ck.remove(t), 0 === this.Ck.count && (this.hc = !1, this.B.Pb()), t === this.defaultAnimation && (this.defaultAnimation.pc.clear(), this.B.R("AnimationFinished", this)) }, t.Vj = function (t, i) { this.Ze && (this.Ke.contains("Expand Tree") || this.Ke.contains("Expand SubGraph")) && this.Cd.Vj(t, i) }, t.Tj = function (t, i) { this.Ze && (this.Ke.contains("Collapse Tree") || this.Ke.contains("Collapse SubGraph")) && (this.Cd.Tj(t, i), go(this.Cd, i, "position", i.position, i.position)) }, l.Object.defineProperties($n.prototype, { animationReasons: { get: function () { return this.Ke } }, isEnabled: { get: function () { return this.Mc }, set: function (t) { this.Mc = t } }, duration: { get: function () { return this.Rg }, set: function (t) { t < 1 && y(t, ">= 1", $n, "duration"), this.Rg = t } }, isAnimating: { get: function () { return this.hc } }, isTicking: { get: function () { return this.Ur } }, isInitial: { get: function () { return this.oi }, set: function (t) { this.oi = t } }, defaultAnimation: { get: function () { return this.Cd } }, activeAnimations: { get: function () { return this.Ck } }, initialAnimationStyle: { get: function () { return this.gl }, set: function (t) { this.gl = t } } }), $n.prototype.stopAnimation = $n.prototype.Yc; var ao = null, ho = !1, lo = new V($n, "Default", 1), uo = new V($n, "AnimateLocations", 2), co = new V($n, "None", 3); function fo() { this.av = this.px = this.Jc = this.B = null, this.ol = this.hc = this.l = !1, this.Hn = this.ud = 0, this.pr = this.nu = xo, this.nl = this.mp = !1, this.Ru = 1, this.Pu = 0, this.nd = this.Rg = NaN, this.Rw = 0, this.In = null, this.u = kt, this.pc = new at, this.Lu = new at, this.Wl = new $, this.Mu = new $, this.Pw = ps } function po(t) { t.Lu.clear(), t.nl = !1, t.Pu = 0, t.nd = NaN, 0 < t.Wl.count && t.Wl.clear(), 0 < t.Mu.count && t.Mu.clear() } function go(t, i, e, n, o, r) { var s, a, h, l = t.pc; i instanceof Lo && "position" === e && (e = "position:diagram"), l.contains(i) ? (a = (s = l.H(i)).start, h = s.end, void 0 === a[e] && (a[e] = yo(n)), h[e] = yo(o)) : (h = {}, (a = {})[e] = yo(n), h[e] = yo(o), s = a.position, i instanceof Es && s instanceof gi && !s.v() && i.diagram.animationManager.Ke.contains("Expand SubGraph") && s.assign(h.position), s = new wo(a, h, r), l.add(i, s)), (l = a[e]) instanceof gi && !l.v() && l.assign(t.u), r && 0 === e.indexOf("position:") && i instanceof Hl ? s.tv.location = yo(i.location) : r && (s.tv[e] = yo(n)) } function yo(t) { return t instanceof gi || t instanceof Yi ? t.copy() : t } function mo(t, i) { var e, n, o; t.ol && !i || (e = t.Jc, !1 !== t.hc && (o = (n = +new Date) > t.Hn ? t.nd : n - t.ud, i && ((o = t.Rw) < t.nd ? (t.ud = new Date - o, t.Hn = t.ud + t.nd) : o = t.nd), eo(e), vo(t, o), tr(t.B, !0), no(e), n > t.Hn && (t.mp && !t.nl ? (t.ud = +new Date, t.Hn = t.ud + t.nd, t.nl = !0) : t.fm(!1)))) } function vo(t, i) { for (var e = t.nd, n = t.pc.iterator, o = t.nl; n.next();) { var r = n.key; if (!(r instanceof Es && null === r.diagram)) { var s, a = n.value, h = o ? a.end : a.start, a = o ? a.start : a.end, l = ao; for (s in a) "position" === s && (a["position:placeholder"] || a["position:node"]) || null === l.get(s) || l.get(s)(r, h[s], a[s], t.pr, i, e, t) } } } function xo(t, i, e, n) { return (t /= n / 2) < 1 ? e / 2 * t * t + i : -e / 2 * (--t * (t - 2) - 1) + i } function bo(t, i, e, n) { return t === n ? i + e : e * (1 - Math.pow(2, -10 * t / n)) + i } function wo(t, i, e) { this.start = t, this.end = i, this.tv = {}, this.ov = e, this.Yv = !1 } function ko(t, i, e) { this.cd = null, this.af = t, this.Np = e || Mo, this.Hk = null, void 0 !== i && (this.Hk = i, void 0 === e && (this.Np = So)) } $n.className = "AnimationManager", $n.defineAnimationEffect = function (t, i) { ho || (so(), ho = !0), ao.add(t, i) }, $n.Default = lo, $n.AnimateLocations = uo, $n.None = co, fo.prototype.suspend = function () { this.ol = !0 }, fo.prototype.advanceTo = function (t, i) { i && (this.ol = !1), this.mp && t >= this.nd && (this.nl = !0, t -= this.nd), this.Rw = t, mo(this, !0), eo(this.Jc), tr(this.B), no(this.Jc), this.B.Zd() }, (t = fo.prototype).start = function () { if (0 !== this.pc.count && !this.hc) { for (var i = this.B, t = this.pc.iterator; t.next();) { var e, n, o = t.value.end, r = t.key; !o["position:placeholder"] || (e = r.findVisibleNode()) instanceof Lu && null !== e.placeholder && (e = (n = e.placeholder).ga(Ht), n = n.padding, e.x += n.left, e.y += n.top, o["position:placeholder"] = e), null === i && (r instanceof Lo ? i = r : r instanceof Es && (i = r.diagram)) } null !== i && (this.B = i, t = this.Jc = i.animationManager, this.nd = isNaN(this.Rg) ? t.duration : this.Rg, this.pr = this.nu, t.fl && t.gl === lo && this === t.defaultAnimation && (this.pr = bo, this.nd = isNaN(this.Rg) ? 600 === t.duration ? 900 : t.duration : this.Rg), this.Pw = i.scrollMode, this.isViewportUnconstrained && (i.Gi = gs), eo(t), this.Wl.each(function (t) { t.data = null, i.add(t) }), no(t), this.hc = !0, this.ud = +new Date, this.Hn = this.ud + this.nd, h = this, l = (a = t).Ck, (u = a).hc ? a.Us.add(h) : (a.hc = !0, l.add(h), c.requestAnimationFrame(function () { s() }))) } function s() { if (0 < u.Us.count && (l.addAll(u.Us), u.Us.clear(), u.hc = !0), !1 !== u.hc && 0 !== l.count) { u.Xu.addAll(l); for (var t = u.Xu.iterator; t.next();) { var i = t.value; if (!1 !== i.hc) { t: if (0 < i.Wl.count) var e = !0; else { for (e = i.pc.iterator; e.next();) { var n = e.key; if (n instanceof Es && null !== n.diagram || n instanceof Lo) { e = !0; break t } } e = !1 } e ? mo(i, !1) : i.ol = !0 } } u.Xu.clear(), eo(u), tr(u.B), no(u), c.requestAnimationFrame(s) } } var a, h, l, u }, t.Ny = function (t, i) { t.Wb() && (this.Wl.add(t), this.B = i) }, t.add = function (t, i, e, n, o) { "position" === i && e.w(n) || (null === this.B && (t instanceof Lo ? this.B = t : t instanceof Es && null !== t.diagram && (this.B = t.diagram)), t instanceof Hl && !t.isAnimated || go(this, t, i, e, n, o)) }, t.Ft = function (t) { return !!this.hc && (null !== (t = this.pc.H(t)) && t.Yv) }, t.Kv = function (t) { return !!this.hc && (null !== (t = this.pc.H(t)) && (t.start.position || t.start.location)) }, t.stop = function () { this.hc && this.fm(!0) }, t.fm = function (t) { if (null !== this.av && this.av.tp.remove(this.px), this.hc) { var i = this.B, e = this.Jc; this.ol = this.hc = e.fl = !1, eo(e); for (var n = this.pc, o = this.Wl.iterator; o.next();)i.remove(o.value); for (o = this.Mu.iterator; o.next();)o.value.o(); o = this.mp, n = n.iterator; for (var r = ao; n.next();) { var s, a, h = n.key, l = n.value, u = o ? l.end : l.start, c = o ? l.start : l.end, f = l.tv; for (s in c) { null !== r.get(s) && (a = s, !l.ov || "position:node" !== a && "position:placeholder" !== a || (a = "position"), r.get(a)(h, u[s], void 0 !== f[s] ? f[s] : l.ov ? u[s] : c[s], this.pr, this.nd, this.nd, this)) } l.ov && void 0 !== f.location && h instanceof Hl && (h.location = f.location), l.Yv && h instanceof Hl && h.Ob(!1) } if (e.defaultAnimation === this) for (s = this.B.links; s.next();)null === (o = s.value).lh ? null !== (n = o.path) && (o.ld = !1, o.o(), n.o()) : (o.points = o.lh, o.lh = null); i.At.clear(), Oo(i, !1), i.Na(), i.M(), tr(i, !0), this.isViewportUnconstrained && (i.scrollMode = this.Pw), no(e), this.Pu++, !t && this.Ru > this.Pu ? (this.nl = !1, this.start()) : (this.In && this.In(this), po(this), e.fm(this), i.Pb()) } }, t.Vj = function (t, i) { var e = i.actualBounds, n = null; if (i instanceof Lu && (n = i.placeholder), null !== n ? (e = n.ga(Ht), n = n.padding, e.x += n.left, e.y += n.top, this.add(t, "position", e, t.position, !1)) : this.add(t, "position", new gi(e.x + e.width / 2, e.y + e.height / 2), t.position, !1), this.add(t, "scale", .01, t.scale, !1), t instanceof Lu) for (t = t.memberParts; t.next();)(n = t.value) instanceof pu && this.Vj(n, i) }, t.Tj = function (t, i) { if (t.isVisible()) { var e = null; if (i instanceof Lu && (e = i.placeholder), null !== e ? this.add(t, "position:placeholder", t.position, e, !0) : this.add(t, "position:node", t.position, i, !0), this.add(t, "scale", t.scale, .01, !0), (e = this.pc).contains(t) && (e.H(t).Yv = !0), t instanceof Lu) for (t = t.memberParts; t.next();)(e = t.value) instanceof pu && this.Tj(e, i) } }, t.Jz = function (t) { var i = this.Lu.get(t); return null === i && (i = {}, this.Lu.add(t, i)), i }, l.Object.defineProperties(fo.prototype, { duration: { get: function () { return this.Rg }, set: function (t) { t < 1 && y(t, ">= 1", fo, "duration"), this.Rg = t } }, reversible: { get: function () { return this.mp }, set: function (t) { this.mp = t } }, runCount: { get: function () { return this.Ru }, set: function (t) { 0 < t ? this.Ru = t : B("Animation.runCount value must be a positive integer.") } }, finished: { get: function () { return this.In }, set: function (t) { this.In !== t && (this.In = t) } }, easing: { get: function () { return this.nu }, set: function (t) { this.nu = t } }, isViewportUnconstrained: { get: function () { return this.l }, set: function (t) { this.l = t } }, isAnimating: { get: function () { return this.hc } } }), fo.prototype.getTemporaryState = fo.prototype.Jz, fo.prototype.stop = fo.prototype.stop, fo.prototype.add = fo.prototype.add, fo.prototype.addTemporaryPart = fo.prototype.Ny, fo.className = "Animation", fo.EaseLinear = function (t, i, e, n) { return e * t / n + i }, fo.EaseInOutQuad = xo, fo.EaseInQuad = function (t, i, e, n) { return e * (t /= n) * t + i }, fo.EaseOutQuad = function (t, i, e, n) { return -e * (t /= n) * (t - 2) + i }, fo.EaseInExpo = function (t, i, e, n) { return 0 === t ? i : e * Math.pow(2, 10 * (t / n - 1)) + i }, fo.EaseOutExpo = bo, wo.className = "AnimationState", ko.prototype.copy = function () { var t = new ko(this.af); t.Np = this.Np; var i, e = this.Hk; return null !== e && (i = {}, void 0 !== e.duration && (i.Jx = e.duration), void 0 !== e.finished && (i.Jx = e.finished), void 0 !== e.easing && (i.Jx = e.easing), t.Hk = i), t }, l.Object.defineProperties(ko.prototype, { propertyName: { get: function () { return this.af }, set: function (t) { this.af = t } }, animationSettings: { get: function () { return this.Hk }, set: function (t) { this.Hk = t } }, startCondition: { get: function () { return this.Np }, set: function (t) { this.Np = t } } }); var Mo = new V(ko, "Default", 1), So = new V(ko, "Immediate", 2), Po = new V(ko, "Bundled", 3); function No() { Q(this), this.B = null, this.Ca = new J, this.Qa = "", this.rb = 1, this.u = !1, this.Bi = this.I = this.$h = this.Zh = this.Yh = this.Xh = this.Vh = this.Wh = this.Uh = this.bi = this.Th = this.ai = this.Sh = this.Rh = !0, this.l = !1, this.Zo = [] } function Co(t, i) { var e = 1; return 1 !== t.rb && (e = i.globalAlpha, i.globalAlpha = e * t.rb), e } function To(t, i, e) { if (i = function (t, i, e) { var n = e.zOrder; if (isNaN(n)) return i; var o = (t = t.Ca).count; if (o <= 1) return i; if (i < 0 && (i = t.indexOf(e)), i < 0) return -1; for (var r = i - 1, s = NaN; 0 <= r && (s = t.L(r).zOrder, isNaN(s));)r--; for (var a = i + 1, h = NaN; a < o && (h = t.L(a).zOrder, isNaN(h));)a++; if (!isNaN(s) && n < s) for (; ;) { if (-1 === r || s <= n) { if (++r === i) break; return t.$a(i), t.tb(r, e), r } for (s = NaN; 0 <= --r && (s = t.L(r).zOrder, isNaN(s));); } else if (!isNaN(h) && h < n) for (; ;) { if (a === o || n <= h) { if (--a === i) break; return t.$a(i), t.tb(a, e), a } for (h = NaN; ++a < o && (h = t.L(a).zOrder, isNaN(h));); } return i }(t, i, e), e instanceof Lu && null !== e && isNaN(e.zOrder)) { if (0 !== e.memberParts.count) { for (var n = -1, o = t.Ca.j, r = o.length, s = 0; s < r; s++) { var a = o[s]; if (a === e && (i = s, 0 <= n)) break; if (n < 0 && a.containingGroup === e && (n = s, 0 <= i)) break } !(n < 0) && n < i && ((o = t.Ca).$a(i), o.tb(n, e)) } null !== (e = e.containingGroup) && To(t, -1, e) } } function Lo(t) { 1 < arguments.length && B("Diagram constructor can only take one optional argument, the DIV HTML element or its id."), ks || (function () { if (es) { var t = c.document.createElement("canvas"), i = t.getContext("2d"), e = A("7ca11abfd022028846"); i[e] = A("398c3597c01238"); for (var n = ["5da73c80a36455d5038e4972187c3cae51fd22", f.Dx + "4ae6247590da4bb21c324ba3a84e385776", Gi.xF + "fb236cdfda5de14c134ba1a95a2d4c7cc6f93c1387", qi.za], o = 1; o < 5; o++)i[A("7ca11abfd7330390")](A(n[o - 1]), 10, 15 * o); for (i[e] = A("39f046ebb36e4b"), e = 1; e < 5; e++)i[A("7ca11abfd7330390")](A(n[e - 1]), 10, 15 * e); ws = t } }(), ks = !0), Q(this), z = [], (Qr = this).Rb = !0, this.Jc = new $n, this.Jc.$d(this), this.lb = 17, this.ml = this.Tu = !1, this.As = "default", this.La = null; var i = this; es && (null !== c.document.body ? this.setRTL() : i.addEventListener(c.document, "DOMContentLoaded", function t() { i.removeEventListener(c.document, "DOMContentLoaded", t, !1), i.setRTL() }, !1)), this.Ja = new J, this.va = this.wa = 0, this.sa = null, this.lx = new at, this.bf = this.Eb = null, this.ew(), this.vj = null, this.dw(), this.rb = 1, this.ma = new gi(NaN, NaN).freeze(), this.Bs = new gi(NaN, NaN), this.yn = this.ya = 1, this.Lr = new gi(NaN, NaN).freeze(), this.Mr = NaN, this.es = 1e-4, this.cs = 100, this.mb = new Gi, this.bt = new gi(NaN, NaN).freeze(), this.Gr = new yi(NaN, NaN, NaN, NaN).freeze(), this.Fi = new Xt(0, 0, 0, 0).freeze(), this.Gi = ps, this.Js = !1, this.Cs = this.ws = null, this.Ig = rs, this.lj = bi, this.Uf = rs, this.Yn = bi, this.Nr = this.Kr = Ht, this.Ac = !0, this.kl = !1, this.od = new $, this.Pg = new at, this.Xk = !0, this.Zm = 250, this.jj = -1, this.an = new Xt(16, 16, 16, 16).freeze(), this.pj = this.ye = !1, this.sj = !0, this.Rf = new ye, (this.Rf.diagram = this).Rd = new ye, (this.Rd.diagram = this).$g = new ye, (this.$g.diagram = this).qe = this.Jf = null, this.Pj = !1, this.wr = this.xr = null, this.Vm = c.PointerEvent && (D || F || O) && c.navigator && !1 !== c.navigator.msPointerEnabled, Dr(this), this.wh = new $, this.Vr = !0, this.Xs = ys, this.xu = !1, this.Zs = hs, this.Ia = null, _r.add("Model", of), this.qr = this.tr = this.Vs = null, this.xn = this.nr = "auto", this.cg = this.hs = this.eg = this.fg = this.hg = this.Lf = this.Pf = this.Kf = null, this.Jr = !1, this.Mf = this.rg = this.gg = this.dg = null, this.js = !1, this.us = {}, this.Kj = [null, null], this.hr = null, this.ur = this.Ns = this.Vu = this.pg = !1, this.Du = !0, this.ni = this.Bc = !1, this.ac = null; var n = this; this.kd = function (t) { var i = n.partManager; if (t.model === i.diagram.model && i.diagram.Z) { i.diagram.Z = !1; try { var e = t.change; "" === t.modelChange && e === be && i.updateDataBindings(t.object, t.propertyName) } finally { i.diagram.Z = !0 } } }, this.Ic = function (t) { n.partManager.doModelChanged(t) }, this.dv = !0, this.Jd = -2, this.Ci = new at, this.ts = new J, this.Wf = !1, this.Sh = this.Rh = this.Vq = this.Mc = !0, this.Wq = !1, this.br = this.$q = this.$h = this.Zh = this.Yh = this.Xh = this.Vh = this.Wh = this.Uh = this.Zq = this.bi = this.Th = this.ai = this.Xq = !0, this.Vf = this.zu = !1, this.ar = this.Yq = this.cl = this.bl = !0, this.Is = this.Es = 16, this.Ds = this.wp = !1, this.xp = this.Gs = null, this.Fs = this.Hs = 0, this.eb = new Xt(5).freeze(), this.Uu = (new $).freeze(), this.ds = 999999999, this.uu = (new $).freeze(), this.mi = this.li = this.ki = !0, this.Se = this.je = !1, this.ic = null, this.Ff = !0, this.ke = !1, this.$w = new $, this.vu = new $, this.Hb = null, this.Bl = 1, this.Wu = 0, this.Sd = { scale: 1, position: new gi, bounds: new yi, Nv: !1 }, this.cv = new yi(NaN, NaN, NaN, NaN).freeze(), this.Yl = new Yi(NaN, NaN).freeze(), this.zn = new yi(NaN, NaN, NaN, NaN).freeze(), this.Wr = !1, this.ro = this.Wn = this.So = this.iu = this.hu = this.ju = this.Yf = this.Yg = this.Ye = this.Ar = null, Do(this), this.Gb = null, this.Vn = !1, this.mj = null, this.partManager = new of, this.toolManager = new Ce, this.toolManager.initializeStandardTools(), this.currentTool = this.defaultTool = this.toolManager, this.zr = null, this.Qk = new Ts, this.os = this.ns = null, this.Pp = !1, this.commandHandler = jo(), this.model = Gf(), this.pg = !0, Io(this), this.layout = new Ic, this.pg = !1, this.Tw = this.mu = null, this.Sb = 1, this.rh = null, this.Co = 1, this.Jo = 0, this.Ko = [0, 0, 0, 0, 0], this.Lo = 0, this.pd = 1, this.Aj = 0, this.mo = new gi, this.Ws = 500, this.$m = new gi, this.le = !1, this.preventDefault = this.Jt = this.um = this.vm = this.tm = this.sm = this.rk = this.tk = this.sk = this.pk = this.qk = this.yw = this.qw = this.rw = this.sw = this.kh = this.Fl = this.jh = this.El = null, this.ao = !1, this.ji = new Ms, this.Qp = !1, void 0 !== t && Ps(this, t), this.Jn = null, this.Kn = Nt, this.Rb = !1 } function Ao(t, i) { t.animationManager.Yc(!0), t.Uu = (new $).freeze(), t.uu = (new $).freeze(); var e = t.skipsUndoManager; null !== t.model && (t.skipsUndoManager = !0); var n = null; null === t.Gb || null !== (n = t.Gb.part) && t.remove(n); var o = [], r = t.Ja.length; if (i) { for (i = 0; i < r; i++)for (var s = t.Ja.j[i].parts; s.next();) { var a = s.value; a !== n && null === a.data && o.push(a) } for (i = 0; i < o.length; i++)t.remove(o[i]) } for (i = 0; i < r; i++)t.Ja.j[i].clear(); return t.partManager.clear(), t.od.clear(), t.Pg.clear(), t.wh.clear(), t.mj = null, E = [], null !== n && (t.add(n), t.partManager.parts.remove(n)), null !== t.model && (t.skipsUndoManager = e), o } function jo() { return null } function Do(t) { t.Ye = new at; var i = new pu, e = new el; e.bind(new Jf("text", "", N)), i.add(e), t.ju = i, t.Ye.add("", i), i = new pu, (e = new el).stroke = "brown", e.bind(new Jf("text", "", N)), i.add(e), t.Ye.add("Comment", i), (i = new pu).selectable = !1, i.avoidable = !1, (e = new Kh).figure = "Ellipse", e.fill = "black", e.stroke = null, e.desiredSize = new Yi(3, 3).ca(), i.add(e), t.Ye.add("LinkLabel", i), t.Yg = new at, (i = new Lu).selectionObjectName = "GROUPPANEL", i.type = xh.Vertical, (e = new el).font = "bold 12pt sans-serif", e.bind(new Jf("text", "", N)), i.add(e), (e = new xh(xh.Auto)).name = "GROUPPANEL"; var n = new Kh; n.figure = "Rectangle", n.fill = "rgba(128,128,128,0.2)", n.stroke = "black", e.add(n), (n = new Du).padding = new Xt(5, 5, 5, 5).ca(), e.add(n), i.add(e), t.hu = i, t.Yg.add("", i), t.Yf = new at, i = new Fu, (e = new Kh).isPanelMain = !0, i.add(e), (e = new Kh).toArrow = "Standard", e.fill = "black", e.stroke = null, e.strokeWidth = 0, i.add(e), t.iu = i, t.Yf.add("", i), i = new Fu, (e = new Kh).isPanelMain = !0, e.stroke = "brown", i.add(e), t.Yf.add("Comment", i), (i = new du).type = xh.Auto, (e = new Kh).fill = null, e.stroke = "dodgerblue", e.strokeWidth = 3, i.add(e), (e = new Du).margin = new Xt(1.5, 1.5, 1.5, 1.5).ca(), i.add(e), t.So = i, t.Wn = i, (i = new du).type = xh.Link, (e = new Kh).isPanelMain = !0, e.fill = null, e.stroke = "dodgerblue", e.strokeWidth = 3, i.add(e), t.ro = i } function Fo(t) { 30 < t.Jo && (t.rh = 1) } function Oo(t, i) { null !== t.rh && (t.rh = null, i && t.Jt(), t.Jo = 0, t.Ko = [0, 0, 0, 0, 0], t.Lo = 0) } function Bo(t) { var i, e, n, o; null === t.sa || 0 !== (i = t.La).clientWidth && 0 !== i.clientHeight && (t.Tu || t.setScrollWidth(), e = t.Se ? t.lb : 0, n = t.je ? t.lb : 0, o = t.Sb, t.Sb = t.computePixelRatio(), t.Sb !== o && (t.kl = !0, t.Pb()), i.clientWidth === t.wa + e && i.clientHeight === t.va + n || (t.li = !0, t.Ac = !0, null !== (i = t.layout) && i.isViewportSized && t.autoScale === rs && (t.pj = !0, i.C()), t.Bc || t.Pb())) } function Io(t) { var i = new No; i.name = "Background", t.Zl(i), (i = new No).name = "", t.Zl(i), (i = new No).name = "Foreground", t.Zl(i), (i = new No).name = "Adornment", i.isTemporary = !0, t.Zl(i), (i = new No).name = "Tool", i.isTemporary = !0, i.isBoundsIncluded = !0, t.Zl(i), (i = new No).name = "Grid", i.allowSelect = !1, i.pickable = !1, i.isTemporary = !0, t.vx(i, t.hm("Background")) } function Ro(t) { t.Gb = new xh(xh.Grid), t.Gb.name = "GRID"; var i = new Kh; i.figure = "LineH", i.stroke = "lightgray", i.strokeWidth = .5, i.interval = 1, t.Gb.add(i), (i = new Kh).figure = "LineH", i.stroke = "gray", i.strokeWidth = .5, i.interval = 5, t.Gb.add(i), (i = new Kh).figure = "LineH", i.stroke = "gray", i.strokeWidth = 1, i.interval = 10, t.Gb.add(i), (i = new Kh).figure = "LineV", i.stroke = "lightgray", i.strokeWidth = .5, i.interval = 1, t.Gb.add(i), (i = new Kh).figure = "LineV", i.stroke = "gray", i.strokeWidth = .5, i.interval = 5, t.Gb.add(i), (i = new Kh).figure = "LineV", i.stroke = "gray", i.strokeWidth = 1, i.interval = 10, t.Gb.add(i), (i = new Hl).add(t.Gb), i.layerName = "Grid", i.zOrder = 0, i.isInDocumentBounds = !1, i.isAnimated = !1, i.pickable = !1, i.locationObjectName = "GRID", t.add(i), t.partManager.parts.remove(i), t.Gb.visible = !1 } function Eo() { this.B.Ds ? this.B.Ds = !1 : this.B.isEnabled ? this.B.Gx(this) : ur(this.B) } function zo(t) { this.B.isEnabled ? (this.B.Hs = t.target.scrollTop, this.B.Fs = t.target.scrollLeft) : ur(this.B) } function Vo(t) { if (t.fixedBounds.v()) { var i = t.fixedBounds.copy(); return i.eq(t.eb), i } for (var e = !0, n = t.Ja.j, o = n.length, r = 0; r < o; r++) { var s = n[r]; if (s.visible && (!s.isTemporary || s.isBoundsIncluded)) for (var a = (s = s.Ca.j).length, h = 0; h < a; h++) { var l = s[h]; l.isInDocumentBounds && l.isVisible() && ((l = l.actualBounds).v() && (e ? (e = !1, i = l.copy()) : i.Hc(l))) } } return e && (i = new yi(0, 0, 0, 0)), i.eq(t.eb), i } function Yo(t, i) { if ((i || t.ke) && !t.Rb && null !== t.sa && t.documentBounds.v()) { if (i) { var e = t.initialPosition; if (e.v()) return void (t.position = e); (e = gi.alloc()).dj(t.documentBounds, t.initialDocumentSpot); var n = t.viewportBounds, n = yi.allocAt(0, 0, n.width, n.height), o = gi.alloc(); o.dj(n, t.initialViewportSpot), o.h(e.x - o.x, e.y - o.y), t.position = o, yi.free(n), gi.free(o), gi.free(e) } t.Rb = !0, e = t.Ig, i && t.Uf !== rs && (e = t.Uf), n = e !== rs ? Go(t, e) : t.scale, e = t.viewportBounds.copy(), o = t.wa / n; var r = t.va / n, s = t.lj, a = t.Yn; i && !s.gb() && (a.gb() || a.Mb()) && (s = a.Mb() ? Zt : a), Xo(t, t.documentBounds, o, r, s, i), i = t.scale, t.scale = n, t.Rb = !1, (n = t.viewportBounds).Ma(e) || t.Cq(e, n, i, !1), sr(t), _o(t, !0, !1) } } function Go(t, i) { var e = t.yn; if (null === t.sa) return e; if (Cr(t), !(o = t.documentBounds).v()) return e; var n = o.width, o = o.height, r = t.wa + (t.Se ? t.lb : 0), s = t.va + (t.je ? t.lb : 0), a = r / n, h = s / o; return i === ss ? (e < (i = Math.min(h, a)) && (i = e), i < t.minScale && (i = t.minScale), i > t.maxScale && (i = t.maxScale), i) : i === as ? (e < (i = a < h ? (s - t.lb) / o : (r - t.lb) / n) && (i = e), i < t.minScale && (i = t.minScale), i > t.maxScale && (i = t.maxScale), i) : t.scale } function Xo(t, i, e, n, o, r) { var s, a = gi.allocAt(t.ma.x, t.ma.y), h = a.x, l = a.y; null !== t.Jn && (s = gi.alloc(), h = (s = t.Jn.ga(Ht, s)).x - t.Kn.x / t.scale, l = s.y - t.Kn.y / t.scale, o = Kt, gi.free(s)), !r && t.scrollMode !== ps || (o.gb() && (e > i.width && (h = i.x + (o.x * i.width + o.offsetX) - (o.x * e - o.offsetX)), n > i.height && (l = i.y + (o.y * i.height + o.offsetY) - (o.y * n - o.offsetY))), o = t.Fi, r = e - i.width, e < i.width + o.left + o.right ? (h = Math.min(h + e / 2, i.right + Math.max(r, o.right) - e / 2), h = Math.max(h, i.left - Math.max(r, o.left) + e / 2), h -= e / 2) : h > i.left ? h = i.left : h < i.right - e && (h = i.right - e), e = n - i.height, n < i.height + o.top + o.bottom ? (l = Math.min(l + n / 2, i.bottom + Math.max(e, o.bottom) - n / 2), l = Math.max(l, i.top - Math.max(e, o.top) + n / 2), l -= n / 2) : l > i.top ? l = i.top : l < i.bottom - n && (l = i.bottom - n)), a.x = isFinite(h) ? h : -t.eb.left, a.y = isFinite(l) ? l : -t.eb.top, null !== t.positionComputation && (i = t.positionComputation(t, a), a.x = i.x, a.y = i.y), t.Jc.qc && oo(t.Jc, t.ma, a), t.ma.h(a.x, a.y), gi.free(a) } function qo(t, i, e, n) { for (void 0 === e && (e = null), void 0 === n && (n = null), ir(t), t = t.Ja.iteratorBackwards; t.next();) { var o = t.value; if (o.visible && !o.isTemporary && null !== (o = o.Ub(i, e, n))) return o } return null } function Uo(t, i, e) { var n = t.Rd; return t.Rd = t.$g, (t.$g = n).diagram = t, n.event = i, e ? $o(t, i, n) : (n.viewPoint = t.Rd.viewPoint, n.documentPoint = t.Rd.documentPoint), t = 0, i.ctrlKey && (t += 1), i.altKey && (t += 2), i.shiftKey && (t += 4), i.metaKey && (t += 8), n.modifiers = t, n.button = i.button, void 0 === i.buttons || j || (n.buttons = i.buttons), I && 0 === i.button && i.ctrlKey && (n.button = 2), n.down = !1, n.up = !1, n.clickCount = 1, n.delta = 0, n.handled = !1, n.bubbles = !1, n.timestamp = i.timeStamp, n.isMultiTouch = !1, n.targetDiagram = Ko(i), n.targetObject = null, n } function Ko(t) { var i, e = t.target.B; return e || ((i = t.path) || "function" != typeof t.composedPath || (i = t.composedPath()), i && i[0] && (e = i[0].B)), e || null } function Ho(t, i, e, n) { var o = Jo(t, i, !0, !1, !0, n); return $o(t, e, o), o.targetDiagram = Ko(i), o.targetObject = null, n || o.clone(t.Rf), o } function Wo(t, i, e, n) { var o; return n = Jo(t, i, !1, !1, !1, n), null !== e ? (e = (o = c.document.elementFromPoint(e.clientX, e.clientY)) && o.B ? (i = e, o.B) : (i = void 0 !== i.targetTouches ? i.targetTouches[0] : i, t), n.targetDiagram = e, $o(t, i, n)) : null !== t.Rd ? (n.documentPoint = t.Rd.documentPoint, n.viewPoint = t.Rd.viewPoint, n.targetDiagram = t.Rd.targetDiagram) : null !== t.Rf && (n.documentPoint = t.Rf.documentPoint, n.viewPoint = t.Rf.viewPoint, n.targetDiagram = t.Rf.targetDiagram), n.targetObject = null, n } function Jo(t, i, e, n, o, r) { var s = t.Rd; t.Rd = t.$g, (t.$g = s).diagram = t, s.clickCount = 1; var a = s.delta = 0; return i.ctrlKey && (a += 1), i.altKey && (a += 2), i.shiftKey && (a += 4), i.metaKey && (a += 8), s.modifiers = a, s.button = 0, s.buttons = 1, s.event = i, s.timestamp = i.timeStamp, t.Vm && i instanceof c.PointerEvent && "touch" !== i.pointerType && (s.button = i.button, void 0 === i.buttons || j || (s.buttons = i.buttons), I && 0 === i.button && i.ctrlKey && (s.button = 2)), s.down = e, s.up = n, s.handled = !1, s.bubbles = o, s.isMultiTouch = r, s } function Zo(t, i) { return !!t.bubbles || (void 0 !== i.stopPropagation && i.stopPropagation(), !1 !== i.cancelable && i.preventDefault(), !(i.cancelBubble = !0)) } function $o(t, i, e) { var n = t.sa, o = t.wa, r = t.va, s = 0, a = 0; null !== n && (n = n.getBoundingClientRect(), s = i.clientX - o / n.width * n.left, a = i.clientY - r / n.height * n.top), e.viewPoint.h(s, a), null !== t.mb ? (i = gi.allocAt(s, a), t.mb.Wd(i), e.documentPoint.assign(i), gi.free(i)) : e.documentPoint.h(s, a) } function Qo(t, i, e, n) { if (void 0 !== i.targetTouches) { if (i.targetTouches.length < 2) return; i = i.targetTouches[e] } else { if (null === t.Kj[0]) return; i = t.Kj[e] } null !== (e = t.sa) && (e = e.getBoundingClientRect(), n.h(i.clientX - t.wa / e.width * e.left, i.clientY - t.va / e.height * e.top)) } function _o(t, i, e) { t.animationManager.defaultAnimation.isAnimating || t.Rb || !t.li || ur(t) || (i && ir(t), e && Yo(t, !1)) } function tr(t, i) { if (!t.Bc && (t.ye = !1, null !== t.La || t.Yl.v())) { t.Bc = !0; var e = t.animationManager, n = t.ts; if (!e.isAnimating && 0 !== n.length) { for (var o = n.j, r = o.length, s = 0; s < r; s++) { var a = o[s]; oa(a, !1), a.o() } n.clear() } 0 < (n = t.vu).count && (n.each(function (t) { t.xw() }), n.clear()), o = n = !1, e.isAnimating && (o = !0, n = t.skipsUndoManager, t.skipsUndoManager = !0), e.qc || Bo(t), _o(t, !1, !1), null !== t.Gb && (t.Gb.visible && !t.Vn && (wr(t), t.Vn = !0), !t.Gb.visible && t.Vn && (t.Vn = !1)), ir(t), r = !1, t.ke && !t.Ff || (t.ke ? Ar(t, !t.pj) : (t.ua("Initial Layout"), !1 === e.isEnabled && e.Yc(), Ar(t, !1)), r = !0), t.pj = !1, ir(t), t.Ns || ((h = t).Bc || ir(h), Cr(h)), _o(t, !0, !1), s = !1, r ? (t.ke || (s = t.ke = !0, t.skipsUndoManager || (t.undoManager.isPendingClear = !0), t.undoManager.isPendingUnmodified = !0, function (t) { var i = t.ya; { var e; t.Uf !== rs ? t.scale = Go(t, t.Uf) : t.Ig !== rs ? t.scale = Go(t, t.Ig) : (e = t.initialScale, isFinite(e) && 0 < e && (t.scale = e)) } t.ya !== i && (sr(t), _o(t, !0, !1)), Yo(t, !0), i = t.Ja.j, t.Ad(i, i.length, t), t.R("InitialLayoutCompleted"), t.Bs.assign(t.ma), wr(t) }(t)), t.R("LayoutCompleted")) : e.fl && e.sx && (t.Uf !== rs ? t.scale = Go(t, t.Uf) : t.Ig !== rs ? t.scale = Go(t, t.Ig) : (e = t.initialScale, isFinite(e) && 0 < e && (t.scale = e)), Yo(t, !0)), ir(t), r && s && t.Va("Initial Layout"), t.kv(), i || t.bc(t.Eb), o && (t.skipsUndoManager = n), t.Bc = !1 } var h } function ir(t) { if ((t.Bc || !t.animationManager.isTicking) && 0 !== t.od.count) { for (var i = 0; i < 23; i++) { var e = t.od.iterator; if (null === e || 0 === t.od.count) break; t.od = new $, t.xw(e, t.od) } t.nodes.each(function (t) { t instanceof Lu && 0 != (65536 & t.P) != !1 && (t.P = 65536 ^ t.P) }) } } function er(t, i) { for (var e = zi(), n = zi(), o = i.memberParts; o.next();) { var r = o.value; r.isVisible() && (r instanceof Lu ? (na(r) || ra(r) || ru(r)) && er(t, r) : r instanceof Fu ? r.fromNode === i || r.toNode === i ? n.push(r) : e.push(r) : (r.measure(1 / 0, 1 / 0), r.arrange())) } for (t = e.length, o = 0; o < t; o++)(r = e[o]).measure(1 / 0, 1 / 0), r.arrange(); for (Vi(e), i.measure(1 / 0, 1 / 0), i.arrange(), t = n.length, i = 0; i < t; i++)(e = n[i]).measure(1 / 0, 1 / 0), e.arrange(); Vi(n) } function nr(l, u, t, i, e, n, o, r, c, s) { if (null !== l.La) { null === l.sa && B("No canvas specified"), void 0 === o && (o = null), void 0 === r && (r = null), void 0 === c && (c = !1), void 0 === s && (s = !1), hr(l), l.Eb.sc(!0), ar(l), l.ni = !0; var a = l.ya; l.ya = e; var h = l.Ja.j, f = h.length; try { var d = new yi(n.x, n.y, i.width / e, i.height / e), p = d.copy(); p.eq(t), wr(l, p), ir(l), l.Ad(h, f, l, d); var g = l.Sb; u.setTransform(1, 0, 0, 1, 0, 0), u.scale(g, g), u.clearRect(0, 0, i.width, i.height), null !== r && "" !== r && (u.fillStyle = r, u.fillRect(0, 0, i.width, i.height)); var y, m, v = Gi.alloc(); if (v.reset(), v.translate(t.left, t.top), v.scale(e), 0 === n.x && 0 === n.y || v.translate(-n.x, -n.y), u.setTransform(v.m11, v.m12, v.m21, v.m22, v.dx, v.dy), Gi.free(v), or(l, u), u.globalAlpha = l.rb, null !== o) { var x = new $, b = o.iterator; for (b.reset(); b.next();) { var w = b.value; !1 === s && "Grid" === w.layer.name || null === w || x.add(w) } var k = function (t) { if (t.visible && 0 !== t.rb && (c || !t.isTemporary)) { var i = t.Ca.j, e = i.length; if (0 !== e) { var n = Co(t, u), o = t.Zo; o.length = 0; for (var r = l.scale, s = yi.alloc(), a = 0; a < e; a++) { var h = i[a]; x.contains(h) && t.Pi(u, h, l, o, r, s) } yi.free(s), u.globalAlpha = n } } } } else { k = !c && s ? (y = l.grid.part, m = y.layer, function (t) { t === m ? y.bc(u, l) : t.bc(u, l, c) }) : function (t) { t.bc(u, l, c) } } for (t = 0; t < f; t++)k(h[t]); l.ni = !1, l.ji && Ss(l.ji, l) && l.Ar() } finally { l.ya = a, l.Eb.sc(!0), ar(l), l.Ad(h, f, l), wr(l) } } } function or(t, i) { null !== (t = t.bf) && (void 0 !== t.imageSmoothingEnabled && i.my(!!t.imageSmoothingEnabled), null != (t = t.defaultFont) && (i.font = t)) } function rr(t, i) { var e, n = t instanceof xh, o = t instanceof Lo; for (e in i) { "" === e && B("Setting properties requires non-empty property names"); var r, s, a = t, h = e; if (!n && !o || 0 < (r = e.indexOf(".")) && (s = e.substring(0, r), n ? a = t.Ya(s) : null == (a = t[s]) && (a = t.toolManager[s]), b(a) ? h = e.substr(r + 1) : B("Unable to find object named: " + s + " in " + t.toString() + " when trying to set property: " + e)), "_" !== h[0] && !C(a, h)) { if (o && "ModelChanged" === h) { t.xx(i[h]); continue } if (o && "Changed" === h) { t.Ah(i[h]); continue } if (o && C(t.toolManager, h)) a = t.toolManager; else { if (o && Fr(t, h)) { t.Uj(h, i[h]); continue } if (t instanceof wf && "Changed" === h) { t.Ah(i[h]); continue } B('Trying to set undefined property "' + h + '" on object: ' + a.toString()) } } a[h] = i[e], "_" === h[0] && a instanceof Es && a.ux(h) } } function sr(t) { !1 === t.li && (t.li = !0) } function ar(t) { !1 === t.mi && (t.mi = !0) } function hr(t) { !1 !== t.kl && (t.kl = !1, lr(t, t.wa, t.va)) } function lr(t, i, e) { var n = t.Sb; t.sa.resize(i * n, e * n, i, e) && (t.Ac = !0, t.Eb.sc(!0)) } function ur(t) { var i = t.sa; if (null === i) return 1; var e = t.La, n = t.wa, o = t.va, r = t.cv.copy(); if (!r.v()) return 1; var s = !1, a = t.Se ? t.lb : 0, h = t.je ? t.lb : 0, l = e.clientWidth || n + a, u = e.clientHeight || o + h; if (l === n + a && u === o + h || (t.Se = !1, t.je = !1, h = a = 0, t.wa = l, t.va = u, s = t.kl = !0), !(s || t.Se || t.je || t.bl || t.cl)) return 1; t.li = !1; var c = t.viewportBounds, f = t.documentBounds, d = 0, p = 0, g = 0, y = 0, e = c.width, m = c.height, v = t.Fi; t.contentAlignment.gb() ? (f.width > e && (d = v.left, p = v.right), f.height > m && (g = v.top, y = v.bottom)) : (d = v.left, p = v.right, g = v.top, y = v.bottom), v = f.width + d + p; var x = f.height + g + y, d = f.x - d, b = c.x, p = f.right + p, w = c.right + a, g = f.y - g, k = c.y, f = f.bottom + y, c = c.bottom + h, M = "1px", S = "1px", l = l / (y = t.scale) < v, u = u / y < x; if (t.scrollMode === ps && (l || u) && (l && t.hasHorizontalScrollbar && t.allowHorizontalScroll && (d + (l = 1) < b && (l = Math.max((b - d) * y + t.wa, l)), w + 1 < p && (l = Math.max((p - w) * y + t.wa, l)), e + a + 1 < v && (l = Math.max((v - e) * y + t.wa, l)), M = l.toString() + "px"), u && t.hasVerticalScrollbar && t.allowVerticalScroll && (g + (l = 1) < k && (l = Math.max((k - g) * y + t.va, l)), c + 1 < f && (l = Math.max((f - c) * y + t.va, l)), m + h + 1 < x && (l = Math.max((x - m) * y + t.va, l)), S = l.toString() + "px")), u = "1px" !== S, (l = "1px" !== M) && u || !l && !u || (u && (w -= t.lb), l && (c -= t.lb), v < e + a || !t.hasHorizontalScrollbar || !t.allowHorizontalScroll || (d + (a = 1) < b && (a = Math.max((b - d) * y + t.wa, a)), w + 1 < p && (a = Math.max((p - w) * y + t.wa, a)), e + 1 < v && (a = Math.max((v - e) * y + t.wa, a)), M = a.toString() + "px"), l = "1px" !== M, a = t.va, l !== t.je && (a = l ? t.va - t.lb : t.va + t.lb), x < m + h || !t.hasVerticalScrollbar || !t.allowVerticalScroll || (g + (h = 1) < k && (h = Math.max((k - g) * y + a, h)), c + 1 < f && (h = Math.max((f - c) * y + a, h)), m + 1 < x && (h = Math.max((x - m) * y + a, h)), S = h.toString() + "px"), u = "1px" !== S), t.wp && l === t.je && u === t.Se) return n === t.wa && o === t.va || t.Xc(), 0; if (l !== t.je && (t.va = "1px" === M ? t.va + t.lb : Math.max(t.va - t.lb, 1), s = !0), t.je = l, t.xp.style.width = M, u !== t.Se && (t.wa = "1px" === S ? t.wa + t.lb : Math.max(t.wa - t.lb, 1), s = !0, t.ml && (h = gi.alloc(), u ? (i.style.left = t.lb + "px", t.position = h.h(t.ma.x + t.lb / t.scale, t.ma.y)) : (i.style.left = "0px", t.position = h.h(t.ma.x - t.lb / t.scale, t.ma.y)), gi.free(h))), t.Se = u, t.xp.style.height = S, t.Ds = !0, s && (t.kl = !0), h = (i = t.Gs).scrollLeft, t.hasHorizontalScrollbar && t.allowHorizontalScroll && (e + 1 < v ? h = (t.position.x - d) * y : d + 1 < b ? h = i.scrollWidth - i.clientWidth : w + 1 < p && (h = t.position.x * y)), t.ml) switch (t.As) { case "negative": h = -(i.scrollWidth - h - i.clientWidth); break; case "reverse": h = i.scrollWidth - h - i.clientWidth }return i.scrollLeft = h, t.hasVerticalScrollbar && t.allowVerticalScroll && (m + 1 < x ? i.scrollTop = (t.position.y - g) * y : g + 1 < k ? i.scrollTop = i.scrollHeight - i.clientHeight : c + 1 < f && (i.scrollTop = t.position.y * y)), l = t.wa, u = t.va, i.style.width = l + (t.Se ? t.lb : 0) + "px", i.style.height = u + (t.je ? t.lb : 0) + "px", n === l && o === u && !t.animationManager.qc || (t.Cq(r, t.viewportBounds, y, s), 0) } function cr(t, i, e) { var n = i.layer; null !== n && n.diagram === t && (i.isSelected = !1, i.isHighlighted = !1, i.C(2), e && i.dk(), 0 <= (e = n.Fc(-1, i, !1)) && t.Za(ke, "parts", n, i, null, e, null), null !== (t = i.layerChanged) && t(i, n, null)) } function fr(t, i, e, n, o, r) { if (!i.contains(e) && (void 0 === r && (r = !1), !n || r || e.canMove() || e.canCopy())) if (void 0 === o && (o = pr(t)), e instanceof pu) { if (i.add(e, t.td(o, e, e.location)), e instanceof Lu) for (r = e.memberParts; r.next();)fr(t, i, r.value, n, o, o.groupsAlwaysMove); for (r = e.linksConnected; r.next();) { var s, a, h = r.value; i.contains(h) || (s = h.fromNode, a = h.toNode, null !== s && i.contains(s) && null !== a && i.contains(a) && fr(t, i, h, n, o)) } if (o.dragsTree) for (e = e.zv(); e.next();)fr(t, i, e.value, n, o) } else if (e instanceof Fu) for (i.add(e, t.td(o, e)), e = e.labelNodes; e.next();)fr(t, i, e.value, n, o); else e instanceof du || i.add(e, t.td(o, e, e.location)) } function dr(t, i, e, n, o) { if (null !== i && 0 !== i.count) { var r = gi.alloc(), s = gi.alloc(); s.assign(e), isNaN(s.x) && (s.x = 0), isNaN(s.y) && (s.y = 0), (e = t.Pp) || yr(t, i); for (var a = zi(), h = zi(), l = i.iterator, u = gi.alloc(); l.next();) { var c = l.key, f = l.value; c.Wb() ? null !== (g = vr(t, c, i)) ? a.push(new Cs(c, f, g)) : o && !c.canMove() || (g = f.point, r.assign(g), t.computeMove(c, r.add(s), n, u), c.location = u, void 0 === f.shifted && (f.shifted = new gi), f.shifted.assign(u.ae(g))) : l.key instanceof Fu && h.push(l.la) } for (gi.free(u), o = a.length, l = 0; l < o; l++)c = a[l], r.assign(c.info.point), void 0 === c.Fv.shifted && (c.Fv.shifted = new gi), c.node.location = r.add(c.Fv.shifted); for (o = gi.alloc(), l = gi.alloc(), c = h.length, f = 0; f < c; f++) { var d, p, g, y = h[f]; (g = y.key) instanceof Fu && (g.suspendsRouting ? (g.lh = null, u = g.fromNode, d = g.toNode, null !== t.draggedLink && n.dragsLink ? (d = y.value.point, null === g.dragComputation ? (i.add(g, t.td(n, g, s)), Iu(g, s.x - d.x, s.y - d.y)) : (y = gi.allocAt(0, 0), (u = g.i(0)) && u.v() && y.assign(u), p = u = gi.alloc().assign(y).add(s), n.isGridSnapEnabled && (n.isGridSnapRealtime || t.lastInput.up) && gr(t, g, u, p = gi.alloc(), n), u.assign(g.dragComputation(g, u, p)).ae(y), i.add(g, t.td(n, g, u)), Iu(g, u.x - d.x, u.y - d.y), gi.free(y), gi.free(u), p !== u && gi.free(p))) : (null !== u && (o.assign(u.location), null !== (p = i.H(u)) && o.ae(p.point)), null !== d && (l.assign(d.location), null !== (p = i.H(d)) && l.ae(p.point)), null !== u && null !== d ? o.Ma(l) ? (u = y.value.point, (d = r).assign(o), d.ae(u), i.add(g, t.td(n, g, o)), Iu(g, d.x, d.y)) : (g.suspendsRouting = !1, g.Ta()) : (y = y.value.point, u = null !== u ? o : null !== d ? l : s, i.add(g, t.td(n, g, u)), Iu(g, u.x - y.x, u.y - y.y)))) : null !== g.fromNode && null !== g.toNode || (u = y.value.point, i.add(g, t.td(n, g, s)), Iu(g, s.x - u.x, s.y - u.y))) } gi.free(r), gi.free(s), gi.free(o), gi.free(l), Vi(a), Vi(h), e || (ir(t), mr(t, i)) } } function pr(t) { var i = t.toolManager.findTool("Dragging"); return null !== i ? i.dragOptions : t.Qk } function gr(t, i, e, n, o) { var r, s, a, h; void 0 === o && (o = pr(t)), n.assign(e), null !== i && (r = t.grid, t = (i = o.gridSnapCellSize).width, i = i.height, s = (h = o.gridSnapOrigin).x, h = h.y, o = o.gridSnapCellSpot, null !== r && (a = r.gridCellSize, isNaN(t) && (t = a.width), isNaN(i) && (i = a.height), r = r.gridOrigin, isNaN(s) && (s = r.x), isNaN(h) && (h = r.y)), (r = gi.allocAt(0, 0)).xk(0, 0, t, i, o), qi.nq(e.x, e.y, s + r.x, h + r.y, t, i, n), gi.free(r)) } function yr(t, i) { if (null !== i) for (t.Pp = !0, t = i.iterator; t.next();)(i = t.key) instanceof Fu && (i.suspendsRouting = !0) } function mr(t, i) { if (null !== i) { for (i = i.iterator; i.next();) { var e = i.key; e instanceof Fu && (e.suspendsRouting = !1, Yu(e) && e.Ta()) } t.Pp = !1 } } function vr(t, i, e) { if (null !== (i = i.containingGroup)) { if (null !== (t = vr(t, i, e))) return t; if (null !== (t = e.H(i))) return t } return null } function xr(t, i, e) { if (null !== i.diagram && i.diagram !== t && B("Cannot share a Layer with another Diagram: " + i + " of " + i.diagram), null === e ? null !== i.diagram && B("Cannot add an existing Layer to this Diagram again: " + i) : (e.diagram !== t && B("Existing Layer must be in this Diagram: " + e + " not in " + e.diagram), i === e && B("Cannot move a Layer before or after itself: " + i)), i.diagram !== t) { i = i.name, e = (t = t.Ja).count; for (var n = 0; n < e; n++)t.L(n).name === i && B("Cannot add Layer with the name '" + i + "'; a Layer with the same name is already present in this Diagram.") } } function br(t, i, e) { var n, o, r, s, a, h, l = t.animationManager; t.Rb || t.Bc ? (t.ya = e, l.Ze && l.Cd.add(l.B, "scale", i, t.ya)) : null === t.sa ? t.ya = e : (t.Rb = !0, n = t.viewportBounds.copy(), o = t.wa, r = t.va, n.width = t.wa / i, n.height = t.va / i, s = t.zoomPoint.x, a = t.zoomPoint.y, h = t.contentAlignment, isNaN(s) && (h.gd() ? h.wf(ei) ? s = 0 : h.wf(ni) && (s = o - 1) : s = h.gb() ? h.x * (o - 1) : o / 2), isNaN(a) && (h.gd() ? h.wf(ii) ? a = 0 : h.wf(oi) && (a = r - 1) : a = h.gb() ? h.y * (r - 1) : r / 2), null === t.scaleComputation || t.animationManager.isAnimating || (e = t.scaleComputation(t, e)), e < t.minScale && (e = t.minScale), e > t.maxScale && (e = t.maxScale), o = gi.allocAt(t.ma.x + s / i - s / e, t.ma.y + a / i - a / e), t.position = o, gi.free(o), t.ya = e, t.Cq(n, t.viewportBounds, i, !1), t.Rb = !1, Yo(t, !1), l.Ze && l.Cd.add(l.B, "scale", i, t.ya), t.M(), sr(t)) } function wr(t, i) { void 0 === i && (i = null); var e = t.Gb; if (null !== e && e.visible) { for (var n = Yi.alloc(), o = 1, r = 1, s = e.V.j, a = s.length, h = 0; h < a; h++) { var l = s[h], u = l.interval; u < 2 || (Mh(l.figure) ? r = r * u / qi.Px(r, u) : o = o * u / qi.Px(o, u)) } if (s = e.gridCellSize, n.h(r * s.width, o * s.height), null !== i) o = i.width, r = i.height, t = i.x, s = i.y; else { if (i = yi.alloc(), t = t.viewportBounds, i.h(t.x, t.y, t.width, t.height), !i.v()) return void yi.free(i); o = i.width, r = i.height, t = i.x, s = i.y, yi.free(i) } e.width = o + 2 * n.width, e.height = r + 2 * n.height, i = gi.alloc(), qi.nq(t, s, 0, 0, n.width, n.height, i), i.offset(-n.width, -n.height), Yi.free(n), e.part.location = i, gi.free(i) } } function kr(t) { var i = t.isModified; t.dv !== i && (t.dv = i, t.R("Modified")) } function Mr(t, i) { for (var e = (i = i.V.j).length, n = 0; n < e; n++)Sr(t, i[n]) } function Sr(t, i) { if (i instanceof Ll) { var e = i.element; if (null !== e && e instanceof HTMLImageElement) { var n = i.Sg; if (null !== n && (n.al instanceof Event && null !== i.zc && i.zc(i, n.al), !0 === n.Qr && (null !== i.kf && i.kf(i, n.Su), null !== i.diagram && i.diagram.ts.add(i))), e = e.getAttribute("src"), null === (n = t.Ci.H(e))) (n = []).push(i), t.Ci.add(e, n); else { for (t = 0; t < n.length; t++)if (n[t] === i) return; n.push(i) } } } } function Pr(t, i) { if (i instanceof Ll) { var e = i.element; if (null !== e && e instanceof HTMLImageElement) { e = e.getAttribute("src"); var n = t.Ci.H(e); if (null !== n) for (var o = 0; o < n.length; o++)if (n[o] === i) { n.splice(o, 1), 0 === n.length && (t.Ci.remove(e), Al(e)); break } } } } function Nr(t, i) { t.ki = !1; var e = t.zn; e.w(i) || (i = i.G(), t.zn = i, Yo(t, !1), t.R("DocumentBoundsChanged", null, e.copy()), sr(t)) } function Cr(t) { t.ki && Nr(t, t.computeBounds()) } function Tr(t, i) { for (var e = t.wh.iterator; e.next();)Lr(t, e.value, i); null !== t.layout && (i ? t.layout.isValidLayout = !1 : t.layout.C()) } function Lr(t, i, e) { if (null !== i) { for (var n = i.yl.iterator; n.next();)Lr(t, n.value, e); null !== i.layout && (e ? i.layout.isValidLayout = !1 : i.layout.C()) } } function Ar(t, i) { if (t.Ff && !t.ur) { var e = t.Z; t.Z = !0; var n = t.undoManager.transactionLevel, o = t.layout; try { 0 === n && t.ua("Layout"); var r = t.animationManager; n <= 1 && !r.isAnimating && !r.qc && (i || Qn(r, "Layout")), t.Ff = !1; for (var s = t.wh.iterator; s.next();)jr(t, s.value, i, n); o.isValidLayout || (!i || o.isRealtime || null === o.isRealtime || 0 === n ? (o.doLayout(t), ir(t), o.isValidLayout = !0) : t.Ff = !0) } finally { 0 === n && t.Va("Layout"), t.Ff = !o.isValidLayout, t.Z = e } } } function jr(t, i, e, n) { if (null !== i) { for (var o = i.yl.iterator; o.next();)jr(t, o.value, e, n); null === (o = i.layout) || o.isValidLayout || (!e || o.isRealtime || 0 === n ? (i.uk = !i.location.v(), o.doLayout(i), i.C(32), er(t, i), o.isValidLayout = !0) : t.Ff = !0) } } function Dr(t) { function i(t) { var i = t.toLowerCase(), e = new J; n.add(t, e), n.add(i, e), o.add(t, t), o.add(i, t) } var n = new at, o = new at; i("InitialAnimationStarting"), i("AnimationStarting"), i("AnimationFinished"), i("BackgroundSingleClicked"), i("BackgroundDoubleClicked"), i("BackgroundContextClicked"), i("ClipboardChanged"), i("ClipboardPasted"), i("DocumentBoundsChanged"), i("ExternalObjectsDropped"), i("GainedFocus"), i("InitialLayoutCompleted"), i("LayoutCompleted"), i("LinkDrawn"), i("LinkRelinked"), i("LinkReshaped"), i("LostFocus"), i("Modified"), i("ObjectSingleClicked"), i("ObjectDoubleClicked"), i("ObjectContextClicked"), i("PartCreated"), i("PartResized"), i("PartRotated"), i("SelectionMoved"), i("SelectionCopied"), i("SelectionDeleting"), i("SelectionDeleted"), i("SelectionGrouped"), i("SelectionUngrouped"), i("ChangingSelection"), i("ChangedSelection"), i("SubGraphCollapsed"), i("SubGraphExpanded"), i("TextEdited"), i("TreeCollapsed"), i("TreeExpanded"), i("ViewportBoundsChanged"), i("InvalidateDraw"), t.xr = n, t.wr = o } function Fr(t, i) { var e = t.wr.H(i); return null !== e ? e : t.wr.H(i.toLowerCase()) } function Or(t, i) { var e = t.xr.H(i); return null !== e || null !== (e = t.xr.H(i.toLowerCase())) ? e : void B("Unknown DiagramEvent name: " + i) } function Br(t) { if (!t.animationManager.isAnimating) { var i = t.currentTool; return i !== t.toolManager.findTool("Dragging") || (!t.Pp || i.isComplexRoutingRealtime) } } function Ir(t, i, e, n) { if (null === t.Hb && (t.Hb = new vc), t.Hb.ut || t.Hb.group !== e || t.Hb.qy !== n) { if (null === e) { (i = t.computeOccupiedArea()).Wc(100, 100), t.Hb.initialize(i), i = yi.alloc(); for (var o = t.nodes; o.next();) { var r = o.value, s = r.layer; null !== s && s.visible && !s.isTemporary && Rr(t, r, n, i) } yi.free(i) } else { for (0 < e.memberParts.count && ((i = t.computePartsBounds(e.memberParts, !1)).Wc(20, 20), t.Hb.initialize(i)), i = yi.alloc(), o = e.memberParts; o.next();)(r = o.value) instanceof pu && Rr(t, r, n, i); yi.free(i) } t.Hb.group = e, t.Hb.qy = n, t.Hb.ut = !1 } else i && kc(t.Hb); return t.Hb } function Rr(t, i, e, n) { if (i !== e) if (i.isVisible() && i.avoidable && !i.isLinkLabel) { var o = i.getAvoidableRect(n), r = t.Hb.cm; e = t.Hb.bm, n = o.x + o.width, i = o.y + o.height; for (var s = o.x; s < n; s += r) { for (var a = o.y; a < i; a += e)wc(t.Hb, s, a); wc(t.Hb, s, i) } for (o = o.y; o < i; o += e)wc(t.Hb, n, o); wc(t.Hb, n, i) } else if (i instanceof Lu) for (i = i.memberParts; i.next();)(o = i.value) instanceof pu && Rr(t, o, e, n) } function Er(t, i) { null !== t.Hb && !t.Hb.ut && (void 0 === i && (i = null), null === i || i.avoidable && !i.isLinkLabel) && (t.Hb.ut = !0) } function zr(t, i) { var e = t.position, n = t.an; if (n.top <= 0 && n.left <= 0 && n.right <= 0 && n.bottom <= 0) return e; var o, r = t.viewportBounds, s = t.scale, r = yi.allocAt(0, 0, r.width * s, r.height * s), a = gi.allocAt(0, 0); return i.x >= r.x && i.x < r.x + n.left ? (o = Math.max(t.scrollHorizontalLineChange, 1), o |= 0, a.x -= o, i.x < r.x + n.left / 2 && (a.x -= o), i.x < r.x + n.left / 4 && (a.x -= 4 * o)) : i.x <= r.x + r.width && i.x > r.x + r.width - n.right && (o = Math.max(t.scrollHorizontalLineChange, 1), o |= 0, a.x += o, i.x > r.x + r.width - n.right / 2 && (a.x += o), i.x > r.x + r.width - n.right / 4 && (a.x += 4 * o)), i.y >= r.y && i.y < r.y + n.top ? (t = Math.max(t.scrollVerticalLineChange, 1), t |= 0, a.y -= t, i.y < r.y + n.top / 2 && (a.y -= t), i.y < r.y + n.top / 4 && (a.y -= 4 * t)) : i.y <= r.y + r.height && i.y > r.y + r.height - n.bottom && (t = Math.max(t.scrollVerticalLineChange, 1), t |= 0, a.y += t, i.y > r.y + r.height - n.bottom / 2 && (a.y += t), i.y > r.y + r.height - n.bottom / 4 && (a.y += 4 * t)), a.Ma(kt) || (e = new gi(e.x + a.x / s, e.y + a.y / s)), yi.free(r), gi.free(a), e } function Vr(t, i, e) { function n() { var t = +new Date; for (r = !0, s.reset(); s.next();)if (!s.value[0].ul) { r = !1; break } r || h < t - l ? i(e, o, a) : c.requestAnimationFrame(n) } for (var o = e.callback, r = !0, s = t.Ci.iterator; s.next();)if (!s.value[0].ul) { r = !1; break } if ("function" != typeof o || r) return i(e, o, t); var a = t, h = e.callbackTimeout || 300, l = +new Date; return c.requestAnimationFrame(function () { n() }), null } function Yr(t, i, e, n) { if (t.animationManager.Yc(), t.Xc(), null === t.sa) return null; "object" != typeof i && B("properties argument must be an Object."); var o = i.size || null, r = i.scale || null; void 0 !== i.scale && isNaN(i.scale) && (r = "NaN"); var s = i.maxSize; void 0 === i.maxSize && (s = "SVG" === e ? new Yi(1 / 0, 1 / 0) : new Yi(2e3, 2e3)); var a = i.position || null, h = i.parts || null, l = void 0 === i.padding ? 1 : i.padding, u = i.background || null, c = i.omitTemporary; void 0 === c && (c = !0); var f = i.document || document, d = i.elementFinished || null, p = i.showTemporary; void 0 === p && (p = !c), void 0 === (i = i.showGrid) && (i = p), null !== o && isNaN(o.width) && isNaN(o.height) && (o = null), "number" == typeof l ? l = new Xt(l) : l instanceof Xt || B("MakeImage padding must be a Margin or a number."), l.left = Math.max(l.left, 0), l.right = Math.max(l.right, 0), l.top = Math.max(l.top, 0), l.bottom = Math.max(l.bottom, 0), t.Eb.sc(!0); var g = (c = new Pa(null, f)).context; if (!(o || r || h || a)) return c.width = t.wa + Math.ceil(l.left + l.right), c.height = t.va + Math.ceil(l.top + l.bottom), "SVG" === e ? null === n ? null : (n.resize(c.width, c.height, c.width, c.height), n.ownerDocument = f, n.kq = d, nr(t, n.context, l, new Yi(c.width, c.height), t.ya, t.ma, h, u, p, i), n.context) : (t.Xk = !1, nr(t, g, l, new Yi(c.width, c.height), t.ya, t.ma, h, u, p, i), t.Xk = !0, c.context); var y, m = t.yn, v = t.documentBounds.copy(); if (v.nw(t.eb), p) for (var x = t.Ja.j, b = x.length, w = 0; w < b; w++) { var k = x[w]; if (k.visible && k.isTemporary) for (var M = (k = k.Ca.j).length, S = 0; S < M; S++) { var P = k[S]; P.isInDocumentBounds && P.isVisible() && ((P = P.actualBounds).v() && v.Hc(P)) } } if (x = new gi(v.x, v.y), null !== h) { for (b = !0, (w = h.iterator).reset(); w.next();) { (k = w.value) instanceof Hl && ((null === (M = k.layer) || M.visible) && (null === M || p || !M.isTemporary) && k.isVisible() && (k = k.actualBounds).v()) && (b ? (b = !1, y = k.copy()) : y.Hc(k)) } b && (y = new yi(0, 0, 0, 0)), v.width = y.width, v.height = y.height, x.x = y.x, x.y = y.y } return null !== a && a.v() && (x = a, r = r || m), y = a = 0, null !== l && (a = l.left + l.right, y = l.top + l.bottom), b = w = 0, null !== o && (w = o.width, b = o.height, isFinite(w) && (w = Math.max(0, w - a)), isFinite(b) && (b = Math.max(0, b - y))), v = null !== o && null !== r ? ("NaN" === r && (r = m), o.v() ? (o = w, b) : isNaN(b) ? (o = w, v.height * r) : (o = v.width * r, b)) : null !== o ? o.v() ? (r = Math.min(w / v.width, b / v.height), o = w, b) : isNaN(b) ? (r = w / v.width, o = w, v.height * r) : (r = b / v.height, o = v.width * r, b) : null !== r ? "NaN" === r && s.v() ? m < (r = Math.min((s.width - a) / v.width, (s.height - y) / v.height)) ? (r = m, o = v.width, v.height) : (o = s.width, s.height) : (o = v.width * r, v.height * r) : (r = m, o = v.width, v.height), null !== l ? (o += a, v += y) : l = new Xt(0), null !== s && (m = s.width, s = s.height, isNaN(m) && (m = 2e3), isNaN(s) && (s = 2e3), isFinite(m) && (o = Math.min(o, m)), isFinite(s) && (v = Math.min(v, s))), c.width = Math.ceil(o), c.height = Math.ceil(v), "SVG" === e ? null === n ? null : (n.resize(c.width, c.height, c.width, c.height), n.ownerDocument = f, n.kq = d, nr(t, n.context, l, new Yi(Math.ceil(o), Math.ceil(v)), r, x, h, u, p, i), n.context) : (t.Xk = !1, nr(t, g, l, new Yi(Math.ceil(o), Math.ceil(v)), r, x, h, u, p, i), t.Xk = !0, c.context) } ko.className = "AnimationTrigger", ko.Default = Mo, ko.Immediate = So, ko.Bundled = Po, (t = No.prototype).clear = function () { this.Ca.clear(), this.Zo.length = 0 }, t.$d = function (t) { this.B = t }, t.toString = function (t) { void 0 === t && (t = 0); var i = 'Layer "' + this.name + '"'; if (t <= 0) return i; for (var e = 0, n = 0, o = 0, r = 0, s = 0, a = this.Ca.iterator; a.next();) { var h = a.value; h instanceof Lu ? o++ : h instanceof pu ? n++ : h instanceof Fu ? r++ : h instanceof du ? s++ : e++ } if (a = "", 0 < e && (a += e + " Parts "), 0 < n && (a += n + " Nodes "), 0 < o && (a += o + " Groups "), 0 < r && (a += r + " Links "), 0 < s && (a += s + " Adornments "), 1 < t) for (t = this.Ca.iterator; t.next();)a += "\n    " + (e = t.value).toString(), null !== (n = e.data) && tt(n) && (a += " #" + tt(n)), e instanceof pu ? a += " " + N(n) : e instanceof Fu && (a += " " + N(e.fromNode) + " " + N(e.toNode)); return i + " " + this.Ca.count + ": " + a }, t.Ub = function (t, i, e) { if (void 0 === i && (i = null), void 0 === e && (e = null), !1 === this.Bi) return null; var n = !1; null !== this.diagram && this.diagram.viewportBounds.aa(t) && (n = !0); for (var o = gi.alloc(), r = this.Ca.j, s = r.length; s--;) { var a = r[s]; if ((!0 !== n || !1 !== hu(a)) && a.isVisible() && (o.assign(t), ct(o, a.wd), null !== (a = a.Ub(o, i, e)) && (null !== i && (a = i(a)), null !== a && (null === e || e(a))))) return gi.free(o), a } return gi.free(o), null }, t.Ti = function (t, i, e, n) { if (void 0 === i && (i = null), void 0 === e && (e = null), n instanceof J || n instanceof $ || (n = new $), !1 === this.Bi) return n; var o = !1; null !== this.diagram && this.diagram.viewportBounds.aa(t) && (o = !0); for (var r = gi.alloc(), s = this.Ca.j, a = s.length; a--;) { var h, l = s[a]; !0 === o && !1 === hu(l) || !l.isVisible() || (r.assign(t), ct(r, l.wd), (h = l).Ti(r, i, e, n) && (null !== i && (h = i(h)), null === h || null !== e && !e(h) || n.add(h))) } return gi.free(r), n }, t.tf = function (t, i, e, n, o) { if (void 0 === i && (i = null), void 0 === e && (e = null), void 0 === n && (n = !1), o instanceof J || o instanceof $ || (o = new $), !1 === this.Bi) return o; var r = !1; null !== this.diagram && this.diagram.viewportBounds.Be(t) && (r = !0); for (var s = this.Ca.j, a = s.length; a--;) { var h, l = s[a]; !0 === r && !1 === hu(l) || !l.isVisible() || (h = l).tf(t, i, e, n, o) && (null !== i && (h = i(h)), null === h || null !== e && !e(h) || o.add(h)) } return o }, t.yv = function (t, i, e, n, o, r, s) { if (!1 === this.Bi) return o; for (var a = this.Ca.j, h = a.length; h--;) { var l, u = a[h]; !0 === s && !1 === hu(u) || !r(u) || !u.isVisible() || (l = u).tf(t, i, e, n, o) && (null !== i && (l = i(l)), null === l || null !== e && !e(l) || o.add(l)) } return o }, t.xg = function (t, i, e, n, o, r) { if (void 0 === e && (e = null), void 0 === n && (n = null), void 0 === o && (o = !0), !1 !== o && !0 !== o && ((o instanceof J || o instanceof $) && (r = o), o = !0), r instanceof J || r instanceof $ || (r = new $), !1 === this.Bi) return r; var s = !1; null !== this.diagram && this.diagram.viewportBounds.aa(t) && (s = !0); for (var a = gi.alloc(), h = gi.alloc(), l = this.Ca.j, u = l.length; u--;) { var c, f = l[u]; !0 === s && !1 === hu(f) || !f.isVisible() || (a.assign(t), ct(a, f.wd), h.h(t.x + i, t.y), ct(h, f.wd), (c = f).xg(a, h, e, n, o, r) && (null !== e && (c = e(c)), null === c || null !== n && !n(c) || r.add(c))) } return gi.free(a), gi.free(h), r }, t.Ad = function (t, i) { if (this.visible) { var e = void 0 === i ? t.viewportBounds : i, n = this.Ca.j, o = n.length; t = zi(), i = zi(); for (var r = 0; r < o; r++) { var s = n[r]; s.Zw = r, s instanceof Fu && !1 === s.ld || s instanceof du && null !== s.adornedPart || (Rt(s.actualBounds, e) ? (s.Ad(!0), t.push(s)) : (s.Ad(!1), null !== s.adornments && 0 < s.adornments.count && i.push(s))) } for (e = 0; e < t.length; e++)for (Wl(n = t[e]), n = n.adornments; n.next();)(o = n.value).measure(1 / 0, 1 / 0), o.arrange(), o.Ad(!0); for (e = 0; e < i.length; e++)(n = i[e]).updateAdornments(), ou(n, !0); Vi(t), Vi(i) } }, t.bc = function (t, i, e) { if (this.visible && 0 !== this.rb && (void 0 === e && (e = !0), e || !this.isTemporary)) { var n = (e = this.Ca.j).length; if (0 !== n) { var o = Co(this, t), r = this.Zo; r.length = 0; for (var s = i.scale, a = yi.alloc(), h = 0; h < n; h++)this.Pi(t, e[h], i, r, s, a); yi.free(a), t.globalAlpha = o } } }, t.Pi = function (t, i, e, n, o, r) { if (!(null !== n && i instanceof Fu && (i.isOrthogonal && n.push(i), !1 === i.ld))) { var s = i.actualBounds; n = !1; var a = i.containingGroup; if (null !== a && a.isClipping && a.type !== xh.Spot) { if (a.locationObject.km(r), !r.Gc(s)) return; n = !r.Be(s) } n && (t.save(), t.beginPath(), t.rect(r.x, r.y, r.width, r.height), t.clip()), s.width * o > e.Co || s.height * o > e.Co ? i.bc(t, e) : (o = i.actualBounds, r = i.naturalBounds, 0 === o.width || 0 === o.height || isNaN(o.x) || isNaN(o.y) || !i.isVisible() || (e = i.transform, null !== i.areaBackground && (Us(i, t, i.areaBackground, !0, !0, r, o), t.fillRect(o.x, o.y, o.width, o.height)), null === i.areaBackground && null === i.background && (Us(i, t, "rgba(0,0,0,0.3)", !0, !1, r, o), t.fillRect(o.x, o.y, o.width, o.height)), null !== i.background && (t.transform(e.m11, e.m12, e.m21, e.m22, e.dx, e.dy), Us(i, t, i.background, !0, !1, r, o), t.fillRect(0, 0, r.width / 2, r.height / 2), e.wt() || (i = 1 / (e.m11 * e.m22 - e.m12 * e.m21), t.transform(e.m22 * i, -e.m12 * i, -e.m21 * i, e.m11 * i, i * (e.m21 * e.dy - e.m22 * e.dx), i * (e.m12 * e.dx - e.m11 * e.dy)))))), n && (t.restore(), t.sc(!0)) } }, t.g = function (t, i, e, n, o) { var r = this.diagram; null !== r && r.Za(be, t, this, i, e, n, o) }, t.aj = function (t, i, e) { var n = this.Ca; if (i.ui = this, t >= n.count) t = n.count; else if (n.L(t) === i) return -1; return n.tb(t, i), i.rq(e), null !== (n = this.diagram) && (e ? n.M() : n.aj(i)), To(this, t, i), t }, t.Fc = function (t, i, e) { if (!e && i.layer !== this && null !== i.layer) return i.layer.Fc(t, i, e); var n = this.Ca; if (t < 0 || t >= n.length) { if ((t = n.indexOf(i)) < 0) return -1 } else if (n.L(t) !== i && (t = n.indexOf(i)) < 0) return -1; return i.sq(e), n.$a(t), null !== (n = this.diagram) && (e ? n.M() : n.Fc(i)), i.ui = null, t }, l.Object.defineProperties(No.prototype, { parts: { get: function () { return this.Ca.iterator } }, partsBackwards: { get: function () { return this.Ca.iteratorBackwards } }, diagram: { get: function () { return this.B } }, name: { get: function () { return this.Qa }, set: function (t) { var i = this.Qa; if (i !== t) { var e = this.diagram; if (null !== e) for ("" === i && B("Cannot rename default Layer to: " + t), e = e.layers; e.next();)e.value.name === t && B("Layer.name is already present in this diagram: " + t); for (this.Qa = t, this.g("name", i, t), t = this.Ca.iterator; t.next();)t.value.layerName = this.Qa } } }, opacity: { get: function () { return this.rb }, set: function (t) { var i = this.rb; i !== t && ((t < 0 || 1 < t) && y(t, "0 <= value <= 1", No, "opacity"), this.rb = t, this.g("opacity", i, t), null !== (t = this.diagram) && t.M()) } }, isTemporary: { get: function () { return this.u }, set: function (t) { var i = this.u; i !== t && (this.u = t, this.g("isTemporary", i, t)) } }, visible: { get: function () { return this.I }, set: function (t) { var i = this.I; if (i !== t) { for (this.I = t, this.g("visible", i, t), i = this.Ca.iterator; i.next();)i.value.Ob(t); null !== (t = this.diagram) && t.M() } } }, pickable: { get: function () { return this.Bi }, set: function (t) { var i = this.Bi; i !== t && (this.Bi = t, this.g("pickable", i, t)) } }, isBoundsIncluded: { get: function () { return this.l }, set: function (t) { this.l !== t && (this.l = t, null !== this.diagram && this.diagram.Na()) } }, allowCopy: { get: function () { return this.Rh }, set: function (t) { var i = this.Rh; i !== t && (this.Rh = t, this.g("allowCopy", i, t)) } }, allowDelete: { get: function () { return this.Sh }, set: function (t) { var i = this.Sh; i !== t && (this.Sh = t, this.g("allowDelete", i, t)) } }, allowTextEdit: { get: function () { return this.ai }, set: function (t) { var i = this.ai; i !== t && (this.ai = t, this.g("allowTextEdit", i, t)) } }, allowGroup: { get: function () { return this.Th }, set: function (t) { var i = this.Th; i !== t && (this.Th = t, this.g("allowGroup", i, t)) } }, allowUngroup: { get: function () { return this.bi }, set: function (t) { var i = this.bi; i !== t && (this.bi = t, this.g("allowUngroup", i, t)) } }, allowLink: { get: function () { return this.Uh }, set: function (t) { var i = this.Uh; i !== t && (this.Uh = t, this.g("allowLink", i, t)) } }, allowRelink: { get: function () { return this.Wh }, set: function (t) { var i = this.Wh; i !== t && (this.Wh = t, this.g("allowRelink", i, t)) } }, allowMove: { get: function () { return this.Vh }, set: function (t) { var i = this.Vh; i !== t && (this.Vh = t, this.g("allowMove", i, t)) } }, allowReshape: { get: function () { return this.Xh }, set: function (t) { var i = this.Xh; i !== t && (this.Xh = t, this.g("allowReshape", i, t)) } }, allowResize: { get: function () { return this.Yh }, set: function (t) { var i = this.Yh; i !== t && (this.Yh = t, this.g("allowResize", i, t)) } }, allowRotate: { get: function () { return this.Zh }, set: function (t) { var i = this.Zh; i !== t && (this.Zh = t, this.g("allowRotate", i, t)) } }, allowSelect: { get: function () { return this.$h }, set: function (t) { var i = this.$h; i !== t && (this.$h = t, this.g("allowSelect", i, t)) } } }), No.prototype.findObjectsNear = No.prototype.xg, No.prototype.findObjectsIn = No.prototype.tf, No.prototype.findObjectsAt = No.prototype.Ti, No.prototype.findObjectAt = No.prototype.Ub, No.className = "Layer", Lo.prototype.clear = function () { this.animationManager.Yc(), this.model.clear(), ns = null, os = "", Ao(this, !1), this.Na(), Cr(this), this.M() }, Lo.prototype.reset = function () { this.clear(), this.Rb = !0, this.Jc = new $n, this.Jc.$d(this), this.lb = 17, this.ml = this.Tu = !1, this.As = "default", this.Ja = new J, this.lx = new at, this.bf = null, this.ew(), this.vj = null, this.dw(), this.rb = 1, this.ma = new gi(NaN, NaN).freeze(), this.Bs = new gi(NaN, NaN), this.yn = this.ya = 1, this.Lr = new gi(NaN, NaN).freeze(), this.Mr = NaN, this.es = 1e-4, this.cs = 100, this.mb = new Gi, this.bt = new gi(NaN, NaN).freeze(), this.Gr = new yi(NaN, NaN, NaN, NaN).freeze(), this.Fi = new Xt(0, 0, 0, 0).freeze(), this.Gi = ps, this.Js = !1, this.Cs = this.ws = null, this.Ig = rs, this.lj = bi, this.Uf = rs, this.Yn = bi, this.Nr = this.Kr = Ht, this.Ac = !0, this.kl = !1, this.od = new $, this.Pg = new at, this.Xk = !0, this.Zm = 250, this.jj = -1, this.an = new Xt(16, 16, 16, 16).freeze(), this.pj = this.ye = !1, this.sj = !0, this.Rf = new ye, (this.Rf.diagram = this).Rd = new ye, (this.Rd.diagram = this).$g = new ye, (this.$g.diagram = this).qe = this.Jf = null, this.Pj = !1, this.wr = this.xr = null, this.Vm = c.PointerEvent && (D || F || O) && c.navigator && !1 !== c.navigator.msPointerEnabled, Dr(this), this.wh = new $, this.Vr = !0, this.Xs = ys, this.xu = !1, this.Zs = hs, this.qr = this.tr = this.Vs = null, this.xn = this.nr = "auto", this.cg = this.hs = this.eg = this.fg = this.hg = this.Lf = this.Pf = this.Kf = null, this.Jr = !1, this.Mf = this.rg = this.gg = this.dg = null, this.js = !1, this.us = {}, this.Kj = [null, null], this.hr = null, this.ur = this.Ns = this.Vu = this.pg = !1, this.Du = !0, this.ni = this.Bc = !1, this.dv = !0, this.Jd = -2, this.Ci = new at, this.ts = new J, this.Wf = !1, this.Sh = this.Rh = this.Vq = this.Mc = !0, this.Wq = !1, this.br = this.$q = this.$h = this.Zh = this.Yh = this.Xh = this.Vh = this.Wh = this.Uh = this.Zq = this.bi = this.Th = this.ai = this.Xq = !0, this.Vf = this.zu = !1, this.ar = this.Yq = this.cl = this.bl = !0, this.Is = this.Es = 16, this.Ds = this.wp = !1, this.Fs = this.Hs = 0, this.eb = new Xt(5).freeze(), this.Uu = (new $).freeze(), this.ds = 999999999, this.uu = (new $).freeze(), this.mi = this.li = this.ki = !0, this.Se = this.je = !1, this.ic = null, this.Ff = !0, this.ke = !1, this.$w = new $, this.vu = new $, this.Hb = null, this.Bl = 1, this.Wu = 0, this.Sd = { scale: 1, position: new gi, bounds: new yi, Nv: !1 }, this.cv = new yi(NaN, NaN, NaN, NaN).freeze(), this.Yl = new Yi(NaN, NaN).freeze(), this.zn = new yi(NaN, NaN, NaN, NaN).freeze(), this.Wr = !1, this.ro = this.Wn = this.So = this.iu = this.hu = this.ju = this.Yf = this.Yg = this.Ye = null, Do(this), this.Gb = null, this.Vn = !1, this.mj = null, this.partManager = new of, this.toolManager = new Ce, this.toolManager.initializeStandardTools(), this.currentTool = this.defaultTool = this.toolManager, this.zr = null, this.Qk = new Ts, this.os = this.ns = null, this.Pp = !1, this.commandHandler = jo(), this.pg = !0, Io(this), this.layout = new Ic, this.pg = !1, this.model = Gf(), this.model.undoManager = new Se, this.ke = !1, this.sj = !0, this.ye = !1, this.Sb = 1, this.rh = null, this.Co = 1, this.Jo = 0, this.Ko = [0, 0, 0, 0, 0], this.Lo = 0, this.pd = 1, this.Aj = 0, this.mo = new gi, this.Ws = 500, this.$m = new gi, this.le = !1, this.kh = this.Fl = this.jh = this.El = null, this.Qp = this.ao = !1, this.Jn = null, this.Kn = Nt, this.Rb = !1, this.M() }, Lo.prototype.setRTL = function (t) { null === (t = void 0 === t ? this.div : t) && (t = c.document.body); var i = p("div"); i.dir = "rtl", i.style.cssText = "font-size: 14px; width: 1px; height: 1px; position: absolute; top: -1000px; overflow: scroll;", i.textContent = "A", t.appendChild(i); var e = "reverse"; 0 < i.scrollLeft ? e = "default" : (i.scrollLeft = 1, 0 === i.scrollLeft && (e = "negative")), t.removeChild(i), this.As = e }, Lo.prototype.setScrollWidth = function (t) { null === (t = void 0 === t ? this.div : t) && (t = c.document.body); var i, e, n = 0; es && (n = ts, null === (i = is) && ((i = is = p("p")).style.width = "100%", i.style.height = "200px", i.style.boxSizing = "content-box", (n = ts = p("div")).style.position = "absolute", n.style.visibility = "hidden", n.style.width = "200px", n.style.height = "150px", n.style.boxSizing = "content-box", n.appendChild(i)), n.style.overflow = "hidden", t.appendChild(n), e = i.offsetWidth, n.style.overflow = "scroll", e === (i = i.offsetWidth) && (i = n.clientWidth), t.removeChild(n), 0 !== (n = e - i) || R || (n = 11)), this.lb = n, this.Tu = !0 }, Lo.prototype.fb = function (t) { t.classType === Lo && (this.autoScale = t) }, Lo.prototype.toString = function (t) { void 0 === t && (t = 0); var i = ""; if (this.div && this.div.id && (i = this.div.id), i = 'Diagram "' + i + '"', t <= 0) return i; for (var e = this.Ja.iterator; e.next();)i += "\n  " + e.value.toString(t - 1); return i }, Lo.prototype.addEventListener = function (t, i, e, n) { t.addEventListener(i, e, n) }, Lo.prototype.removeEventListener = function (t, i, e, n) { t.removeEventListener(i, e, n) }, Lo.prototype.computePixelRatio = function () { return null !== this.rh ? this.rh : c.devicePixelRatio || 1 }, Lo.prototype.doMouseMove = function () { this.currentTool.doMouseMove() }, Lo.prototype.doMouseDown = function () { this.currentTool.doMouseDown() }, Lo.prototype.doMouseUp = function () { this.currentTool.doMouseUp() }, Lo.prototype.doMouseWheel = function () { this.currentTool.doMouseWheel() }, Lo.prototype.doKeyDown = function () { this.currentTool.doKeyDown() }, Lo.prototype.doKeyUp = function () { this.currentTool.doKeyUp() }, Lo.prototype.doFocus = function () { this.focus() }, Lo.prototype.focus = function () { var t, i; this.sa && (this.scrollsPageOnFocus ? this.sa.focus() : (t = c.scrollX || c.pageXOffset, i = c.scrollY || c.pageYOffset, this.sa.focus(), c.scrollTo(t, i))) }, Lo.prototype.Uy = function () { this.B.R("GainedFocus") }, Lo.prototype.Ty = function () { this.B.R("LostFocus") }, Lo.prototype.Gx = function (t) { if (null !== this.sa) { this.wp = !0; var i = this.documentBounds, e = this.viewportBounds, n = this.Fi, o = i.x - n.left, r = i.y - n.top, s = i.width + n.left + n.right, a = i.height + n.top + n.bottom, h = i.right + n.right, n = i.bottom + n.bottom, l = e.x, i = e.y, u = e.width, c = e.height, f = e.right, d = e.bottom, e = this.scale, p = t.scrollLeft; if (this.ml) switch (this.As) { case "negative": p = p + t.scrollWidth - t.clientWidth; break; case "reverse": p = t.scrollWidth - p - t.clientWidth }var g = p; u < s || c < a ? (p = gi.allocAt(this.position.x, this.position.y), this.allowHorizontalScroll && this.Fs !== g && (p.x = g / e + o, this.Fs = g), this.allowVerticalScroll && this.Hs !== t.scrollTop && (p.y = t.scrollTop / e + r, this.Hs = t.scrollTop), this.position = p, gi.free(p), this.li = this.wp = !1) : (p = gi.alloc(), t.Cy && this.allowHorizontalScroll && (o < l && (this.position = p.h(g + o, this.position.y)), f < h && (this.position = p.h(-(this.Gs.scrollWidth - this.wa) + g - this.wa / e + h, this.position.y))), t.Dy && this.allowVerticalScroll && (r < i && (this.position = p.h(this.position.x, t.scrollTop + r)), d < n && (this.position = p.h(this.position.x, -(this.Gs.scrollHeight - this.va) + t.scrollTop - this.va / e + n))), gi.free(p), ar(this), this.li = this.wp = !1, i = this.documentBounds, e = this.viewportBounds, h = i.right, f = e.right, n = i.bottom, d = e.bottom, o = i.x, l = e.x, r = i.y, i = e.y, s <= u && l <= o && h <= f && (this.xp.style.width = "1px"), a <= c && i <= r && n <= d && (this.xp.style.height = "1px")) } }, Lo.prototype.computeBounds = function () { return 0 < this.od.count && ir(this), Vo(this) }, Lo.prototype.computePartsBounds = function (t, i) { void 0 === i && (i = !1); var e = null; if (w(t)) for (var n = 0; n < t.length; n++) { var o = t[n]; !i && o instanceof Fu || (o.zb(), null === e ? e = o.actualBounds.copy() : e.Hc(o.actualBounds)) } else for (t = t.iterator; t.next();)n = t.value, !i && n instanceof Fu || (n.zb(), null === e ? e = n.actualBounds.copy() : e.Hc(n.actualBounds)); return null === e ? new yi(NaN, NaN, 0, 0) : e }, Lo.prototype.zoomToFit = function () { var t = this.Gi; this.Gi = ps, this.scale = Go(this, ss), t !== ps && (Yo(this, !1), Xo(this, this.documentBounds, this.wa / this.ya, this.va / this.ya, this.lj, !1)), this.Gi = t }, (t = Lo.prototype).FA = function (t, i) { void 0 === i && (i = ss); var e, n, o = t.width, r = t.height; 0 === o || 0 === r || isNaN(o) && isNaN(r) || (n = 1, i !== ss && i !== as || (n = isNaN(o) ? this.viewportBounds.height * this.scale / r : isNaN(r) ? this.viewportBounds.width * this.scale / o : (n = this.wa, e = this.va, i === as ? n / o < e / r ? (e - (this.je ? this.lb : 0)) / r : (n - (this.Se ? this.lb : 0)) / o : Math.min(e / r, n / o))), this.scale = n, this.position = new gi(t.x, t.y)) }, t.Oy = function (t, i) { Cr(this); var e = this.documentBounds, n = this.viewportBounds; this.position = new gi(e.x + (t.x * e.width + t.offsetX) - (i.x * n.width - i.offsetX), e.y + (t.y * e.height + t.offsetY) - (i.y * n.height - i.offsetY)) }, t.Cz = function (t) { var i; t instanceof Es ? (this.Jn = t, i = gi.alloc(), this.Kn = this.Oq(t.ga(Ht, i)), gi.free(i)) : (this.Jn = null, this.Kn = Nt) }, t.im = function (t, i) { if (void 0 === i && (i = !0), i) { if ((t = qo(this, t, function (t) { return t.part }, function (t) { return t.canSelect() })) instanceof Hl) return t } else if ((t = qo(this, t, function (t) { return t.part })) instanceof Hl) return t; return null }, t.Ub = function (t, i, e) { void 0 === i && (i = null), void 0 === e && (e = null), ir(this); for (var n = this.Ja.iteratorBackwards; n.next();) { var o = n.value; if (o.visible && null !== (o = o.Ub(t, i, e))) return o } return null }, t.pz = function (t, i, e) { return void 0 === i && (i = !0), function (t, i, e, n, o) { for (void 0 === e && (e = null), void 0 === n && (n = null), o instanceof J || o instanceof $ || (o = new $), ir(t), t = t.Ja.iteratorBackwards; t.next();) { var r = t.value; r.visible && !r.isTemporary && r.Ti(i, e, n, o) } return o }(this, t, function (t) { return t.part }, i ? function (t) { return t instanceof Hl && t.canSelect() } : null, e) }, t.Ti = function (t, i, e, n) { void 0 === i && (i = null), void 0 === e && (e = null), n instanceof J || n instanceof $ || (n = new $), ir(this); for (var o = this.Ja.iteratorBackwards; o.next();) { var r = o.value; r.visible && r.Ti(t, i, e, n) } return n }, t.Ox = function (t, i, e, n) { return void 0 === i && (i = !1), void 0 === e && (e = !0), function (t, i, e, n, o) { var r = null; for (void 0 === r && (r = null), void 0 === e && (e = null), void 0 === n && (n = !1), o instanceof J || o instanceof $ || (o = new $), ir(t), t = t.Ja.iteratorBackwards; t.next();) { var s = t.value; s.visible && !s.isTemporary && s.tf(i, r, e, n, o) } return o }(this, t, function (t) { return t instanceof Hl && (!e || t.canSelect()) }, i, n) }, t.tf = function (t, i, e, n, o) { void 0 === i && (i = null), void 0 === e && (e = null), void 0 === n && (n = !1), o instanceof J || o instanceof $ || (o = new $), ir(this); for (var r = this.Ja.iteratorBackwards; r.next();) { var s = r.value; s.visible && s.tf(t, i, e, n, o) } return o }, t.yv = function (t, i, e, n, o, r) { var s = new $; ir(this); for (var a = this.Ja.iteratorBackwards; a.next();) { var h = a.value; h.visible && h.yv(t, i, e, n, s, o, r) } return s }, t.qz = function (t, i, e, n, o) { return void 0 === e && (e = !0), void 0 === n && (n = !0), function (t, i, e, n, o, r) { var s = null; void 0 === s && (s = null), void 0 === n && (n = null), void 0 === o && (o = !0), !1 !== o && !0 !== o && ((o instanceof J || o instanceof $) && (r = o), o = !0); for (r instanceof J || r instanceof $ || (r = new $), ir(t), t = t.Ja.iteratorBackwards; t.next();) { var a = t.value; a.visible && !a.isTemporary && a.xg(i, e, s, n, o, r) } return r }(this, t, i, function (t) { return t instanceof Hl && (!n || t.canSelect()) }, e, o) }, t.xg = function (t, i, e, n, o, r) { void 0 === e && (e = null), void 0 === n && (n = null), void 0 === o && (o = !0), !1 !== o && !0 !== o && ((o instanceof J || o instanceof $) && (r = o), o = !0), r instanceof J || r instanceof $ || (r = new $), ir(this); for (var s = this.Ja.iteratorBackwards; s.next();) { var a = s.value; a.visible && a.xg(t, i, e, n, o, r) } return r }, Lo.prototype.acceptEvent = function (t) { return Uo(this, t, t instanceof MouseEvent) }, Lo.prototype.Xz = function (t) { var i = this.B; if (!this.B.isEnabled) return !1; var e = Uo(i, t, !1); switch (e.key = String.fromCharCode(t.which), e.down = !0, t.which) { case 8: e.key = "Backspace"; break; case 33: e.key = "PageUp"; break; case 34: e.key = "PageDown"; break; case 35: e.key = "End"; break; case 36: e.key = "Home"; break; case 37: e.key = "Left"; break; case 38: e.key = "Up"; break; case 39: e.key = "Right"; break; case 40: e.key = "Down"; break; case 45: e.key = "Insert"; break; case 46: e.key = "Del"; break; case 48: e.key = "0"; break; case 187: case 61: case 107: e.key = "Add"; break; case 189: case 173: case 109: e.key = "Subtract"; break; case 27: e.key = "Esc" }return i.doKeyDown(), Zo(e, t) }, Lo.prototype.Yz = function (t) { var i = this.B; if (!i.isEnabled) return !1; var e = Uo(i, t, !1); switch (e.key = String.fromCharCode(t.which), e.up = !0, t.which) { case 8: e.key = "Backspace"; break; case 33: e.key = "PageUp"; break; case 34: e.key = "PageDown"; break; case 35: e.key = "End"; break; case 36: e.key = "Home"; break; case 37: e.key = "Left"; break; case 38: e.key = "Up"; break; case 39: e.key = "Right"; break; case 40: e.key = "Down"; break; case 45: e.key = "Insert"; break; case 46: e.key = "Del" }return i.doKeyUp(), Zo(e, t) }, Lo.prototype.fz = function (t) { var i = this.B; if (!i.isEnabled) return !1; var e = Uo(i, t, !0); return null !== i.mouseEnter && i.mouseEnter(e), Zo(e, t) }, Lo.prototype.gz = function (t) { var i = this.B; if (!i.isEnabled) return !1; var e = Uo(i, t, !0); return null !== i.mouseLeave && i.mouseLeave(e), Zo(e, t) }, Lo.prototype.getMouse = function (t) { if (null === (e = this.sa)) return new gi(0, 0); var i = e.getBoundingClientRect(), e = t.clientX - this.wa / i.width * i.left; return t = t.clientY - this.va / i.height * i.top, null !== this.mb ? ct(new gi(e, t), this.mb) : new gi(e, t) }, (t = Lo.prototype).Na = function () { this.ki || (this.ki = !0, this.Pb(!0)) }, t.Zd = function () { this.Rb || this.Bc || (this.M(), sr(this), ar(this), this.Na(), this.Xc()) }, t.Wz = function () { return this.ye }, t.az = function (t) { void 0 === t && (t = null); var i = this.animationManager, e = i.isEnabled; i.Yc(), i.isEnabled = !1, tr(this), this.ke = !1, this.Bs = new gi(NaN, NaN), i.isEnabled = e, null !== t && m(function () { Qn(i, "Model"), t() }, 1) }, t.Pb = function (t) { var i; void 0 === t && (t = !1), !0 === this.ye || this.Rb || !1 === t && this.Bc || (this.ye = !0, i = this, c.requestAnimationFrame(function () { i.ye && i.Xc() })) }, t.Xc = function () { this.sj && !this.ye || (this.sj && (this.sj = !1), tr(this)) }, t.xw = function (t, i) { for (t.reset(); t.next();) { var e = t.value; !e.Wb() || e instanceof Lu || (e.bj() ? (e.measure(1 / 0, 1 / 0), e.arrange()) : i.add(e)) } for (t.reset(); t.next();)(e = t.value) instanceof Lu && e.isVisible() && er(this, e); for (t.reset(); t.next();)(e = t.value) instanceof Fu && e.isVisible() && (e.bj() ? (e.measure(1 / 0, 1 / 0), e.arrange()) : i.add(e)); for (t.reset(); t.next();)(e = t.value) instanceof du && e.isVisible() && (e.bj() ? (e.measure(1 / 0, 1 / 0), e.arrange()) : i.add(e)) }, t.Ad = function (t, i, e, n) { if (this.mi || this.animationManager.isAnimating) for (var o = 0; o < i; o++)t[o].Ad(e, n) }, t.bc = function (u, c) { if ((void 0 === c && (c = null), null !== this.La) && (null === this.sa && B("No canvas specified"), !(o = this.animationManager).qc && (!o.isAnimating || o.isTicking))) { var t = new Date; if (hr(this), "0" !== this.La.style.opacity) { var i = u !== this.Eb, e = this.Ja.j, n = e.length, f = this; if (this.Ad(e, n, f), i) u.sc(!0), ar(this); else if (!this.Ac && null === c && !o.isAnimating) return; n = this.ma; var o, r = this.ya, s = Math.round(n.x * r) / r, a = Math.round(n.y * r) / r; for ((o = this.mb).reset(), 1 !== r && o.scale(r), 0 === n.x && 0 === n.y || o.translate(-s, -a), r = this.Sb, u.setTransform(1, 0, 0, 1, 0, 0), u.scale(r, r), u.clearRect(0, 0, this.wa, this.va), u.setTransform(1, 0, 0, 1, 0, 0), u.scale(r, r), u.transform(o.m11, o.m12, o.m21, o.m22, o.dx, o.dy), or(this, u), u.globalAlpha = this.rb, s = null !== c ? function (t) { var i = c; if (t.visible && 0 !== t.rb) { var e = t.Ca.j, n = e.length; if (0 !== n) { var o = Co(t, u), r = t.Zo; r.length = 0; for (var s = f.scale, a = yi.alloc(), h = 0; h < n; h++) { var l = e[h]; i.contains(l) || t.Pi(u, l, f, r, s, a) } yi.free(a), u.globalAlpha = o } } } : function (t) { t.bc(u, f) }, n = e.length, a = 0; a < n; a++)u.setTransform(1, 0, 0, 1, 0, 0), u.scale(r, r), u.transform(o.m11, o.m12, o.m21, o.m22, o.dx, o.dy), s(e[a]); if (this.ji && Ss(this.ji, this) && this.Ar(), i ? (this.Eb.sc(!0), ar(this)) : this.Ac = this.mi = !1, i = new Date - t, null === this.rh) { for ((t = this.Ko)[this.Lo] = i, this.Lo = (this.Lo + 1) % t.length, e = i = 0; e < this.Ko.length; e++)i += this.Ko[e]; this.Jo = i / t.length } } } }, t.De = function (t) { return this.bf[t] }, t.ny = function (t, i) { "minDrawingLength" === t && (this.Co = i), this.bf[t] = i, this.Zd() }, t.ew = function () { this.bf = new X, this.bf.drawShadows = !0, this.bf.textGreeking = !0, this.bf.viewportOptimizations = !(R || D || F), this.bf.temporaryPixelRatio = !0, this.bf.pictureRatioOptimization = !0, this.Co = this.bf.minDrawingLength = 1 }, t.lm = function (t) { return this.vj[t] }, t.uA = function (t, i) { this.vj[t] = i }, t.dw = function () { this.vj = new X, this.vj.extraTouchArea = 10, this.vj.extraTouchThreshold = 10, this.vj.hasGestureZoom = !0 }, t.lw = function (t) { rr(this, t) }, t.kv = function () { if (0 === this.undoManager.transactionLevel && 0 !== this.Pg.count) { for (; 0 < this.Pg.count;) { var t = this.Pg; for (this.Pg = new at, t = t.iterator; t.next();) { var i = t.key; i.uq(t.value), i.cc() } } this.M() } }, t.M = function (t) { var i; void 0 === t && (t = null), null === t ? (this.Ac = !0, this.Pb()) : (i = this.viewportBounds, null !== t && t.v() && i.Gc(t) && (this.Ac = !0, this.Pb())), this.R("InvalidateDraw") }, t.Ux = function (t, i) { if (!0 !== this.Ac) { var e = (this.Ac = !0) === this.De("temporaryPixelRatio"); if (!0 === this.De("viewportOptimizations") && this.scrollMode !== gs && this.Fi.Ri(0, 0, 0, 0) && i.width === t.width && i.height === t.height) { var n = this.scale, o = Math.max(t.x, i.x), r = Math.max(t.y, i.y), n = yi.allocAt(o, r, Math.max(0, Math.min(t.x + t.width, i.x + i.width) - o) * n, Math.max(0, Math.min(t.y + t.height, i.y + i.height) - r) * n); if (!this.Qp && 0 < n.width && 0 < n.height) { if (!(this.Bc || (this.ye = !1, null === this.La || (this.Bc = !0, this.kv(), this.documentBounds.v() || Nr(this, this.computeBounds()), null === (o = this.sa) || o instanceof va)))) { var s = this.Sb, r = this.wa * s, a = this.va * s, h = this.scale * s, l = Math.round(Math.round(i.x * h) - Math.round(t.x * h)); i = Math.round(Math.round(i.y * h) - Math.round(t.y * h)), h = this.mu, t = this.Tw, h.width !== r && (h.width = r), h.height !== a && (h.height = a), t.clearRect(0, 0, r, a), h = 190 * s; var u = 70 * s, c = Math.max(l, 0), f = Math.max(i, 0), d = Math.floor(r - c), p = Math.floor(a - f); t.drawImage(o.Ea, c, f, d, p, 0, 0, d, p), Ss(this.ji, this) && t.clearRect(0, 0, h, u), o = zi(), t = zi(), p = Math.abs(l), d = Math.abs(i); var g = 0 === c ? 0 : r - p, c = gi.allocAt(g, 0), p = gi.allocAt(p + g, a); t.push(new yi(Math.min(c.x, p.x), Math.min(c.y, p.y), Math.abs(c.x - p.x), Math.abs(c.y - p.y))); var y = this.mb; if (y.reset(), y.scale(s, s), 1 !== this.ya && y.scale(this.ya), (0 !== (s = this.ma).x || 0 !== s.y) && isFinite(s.x) && isFinite(s.y) && y.translate(-s.x, -s.y), ct(c, y), ct(p, y), o.push(new yi(Math.min(c.x, p.x), Math.min(c.y, p.y), Math.abs(c.x - p.x), Math.abs(c.y - p.y))), g = 0 === f ? 0 : a - d, c.h(0, g), p.h(r, d + g), t.push(new yi(Math.min(c.x, p.x), Math.min(c.y, p.y), Math.abs(c.x - p.x), Math.abs(c.y - p.y))), ct(c, y), ct(p, y), o.push(new yi(Math.min(c.x, p.x), Math.min(c.y, p.y), Math.abs(c.x - p.x), Math.abs(c.y - p.y))), Ss(this.ji, this) && (r = 0 < l ? 0 : -l, a = 0 < i ? 0 : -i, c.h(r, a), p.h(h + r, u + a), t.push(new yi(Math.min(c.x, p.x), Math.min(c.y, p.y), Math.abs(c.x - p.x), Math.abs(c.y - p.y))), ct(c, y), ct(p, y), o.push(new yi(Math.min(c.x, p.x), Math.min(c.y, p.y), Math.abs(c.x - p.x), Math.abs(c.y - p.y)))), gi.free(c), gi.free(p), _o(this, !1, !0), null === this.La && B("No div specified"), null === this.sa && B("No canvas specified"), !this.animationManager.qc && (r = this.Eb, this.Ac)) { for (hr(this), a = this.Sb, r.setTransform(1, 0, 0, 1, 0, 0), r.clearRect(0, 0, this.wa * a, this.va * a), r.drawImage(this.mu.Ea, 0 < l ? 0 : Math.round(-l), 0 < i ? 0 : Math.round(-i)), l = this.ma, s = this.ya, h = Math.round(l.x * s) / s, u = Math.round(l.y * s) / s, (i = this.mb).reset(), 1 !== s && i.scale(s), 0 === l.x && 0 === l.y || i.translate(-h, -u), r.save(), r.beginPath(), l = t.length, s = 0; s < l; s++)0 !== (h = t[s]).width && 0 !== h.height && r.rect(Math.floor(h.x), Math.floor(h.y), Math.ceil(h.width), Math.ceil(h.height)); for (r.clip(), r.setTransform(1, 0, 0, 1, 0, 0), r.scale(a, a), r.transform(i.m11, i.m12, i.m21, i.m22, i.dx, i.dy), l = (i = this.Ja.j).length, this.Ad(i, l, this), or(this, r), r.globalAlpha = this.rb, a = 0; a < l; a++)if (h = o, (s = i[a]).visible && 0 !== s.rb) { u = Co(s, r), (f = s.Zo).length = 0, c = this.scale, d = yi.alloc(), y = (p = s.Ca.j).length, g = h.length; for (var m = 0; m < y; m++) { var v = p[m], x = $l(v, v.actualBounds); t: { for (var b = 2 / c, w = 4 / c, k = 0; k < g; k++) { var M = h[k]; if (0 !== M.width && 0 !== M.height && x.Iv(M.x - b, M.y - b, M.width + w, M.height + w)) { x = !0; break t } } x = !1 } x && s.Pi(r, v, this, f, c, d) } yi.free(d), r.globalAlpha = u } r.restore(), r.sc(!0), this.ji && Ss(this.ji, this) && this.Ar(), this.Ac = this.mi = !1, this.Jt() } Vi(o), Vi(t), this.Bc = !1 } } else this.Xc(); yi.free(n), e && (Fo(this), this.Xc(), Oo(this, !0)) } else e ? (Fo(this), this.Xc(), Oo(this, !0)) : this.Xc() } }, t.add = function (t) { var i, e = t.diagram; e !== this && (null !== e && B("Cannot add part " + t.toString() + " to " + this.toString() + ". It is already a part of " + e.toString()), null === (e = this.hm(t.layerName)) && (e = this.hm("")), null === e && B('Cannot add a Part when unable find a Layer named "' + t.layerName + '" and there is no default Layer'), t.layer !== e) && (0 <= (i = e.aj(99999999, t, t.diagram === this)) && this.Za(we, "parts", e, null, t, null, i), e.isTemporary || this.Na(), t.C(1), null !== (i = t.layerChanged) && i(t, null, e)) }, t.aj = function (t) { this.partManager.aj(t); var i = this; Ph(t, function (t) { Mr(i, t) }), (t instanceof du || t instanceof Lu && null !== t.placeholder) && t.o(), null !== t.data && Ph(t, function (t) { lf(i.partManager, t) }), !0 !== ra(t) && !0 !== ru(t) || this.od.add(t), eu(t, !0, this), uu(t) ? (t.actualBounds.v() && this.M($l(t, t.actualBounds)), this.Na()) : t.isVisible() && t.actualBounds.v() && this.M($l(t, t.actualBounds)), this.Pb() }, t.Fc = function (t) { t.Yj(), this.partManager.Fc(t); var i = this; null !== t.data && Ph(t, function (t) { uf(i.partManager, t, i) }), this.od.remove(t), uu(t) ? (t.actualBounds.v() && this.M($l(t, t.actualBounds)), this.Na()) : t.isVisible() && t.actualBounds.v() && this.M($l(t, t.actualBounds)), this.Pb() }, t.remove = function (t) { cr(this, t, !0) }, t.Lt = function (t, i) { if (w(t)) for (var e = t.length, n = 0; n < e; n++) { var o = t[n]; i && !o.canDelete() || this.remove(o) } else for ((e = new $).addAll(t), t = e.iterator; t.next();)e = t.value, i && !e.canDelete() || this.remove(e) }, t.ck = function (t, i, e) { return this.partManager.ck(t, i, e) }, Lo.prototype.moveParts = function (t, i, e, n) { if (void 0 === n && (n = pr(this)), null !== this.toolManager) { var o = new at; if (null !== t) if (w(t)) for (var r = 0; r < t.length; r++)fr(this, o, t[r], e, n); else for (t = t.iterator; t.next();)fr(this, o, t.value, e, n); else { for (t = this.parts; t.next();)fr(this, o, t.value, e, n); for (t = this.nodes; t.next();)fr(this, o, t.value, e, n); for (t = this.links; t.next();)fr(this, o, t.value, e, n) } dr(this, o, i, n, e) } }, Lo.prototype.computeMove = function (t, i, e, n) { if (void 0 === n && (n = new gi), n.assign(i), null === t) return n; var o = i, r = e.isGridSnapEnabled; r && (e.isGridSnapRealtime || this.lastInput.up) && gr(this, t, i, o = gi.alloc(), e), e = null !== t.dragComputation ? t.dragComputation(t, i, o) : o; var s = t.minLocation, a = s.x; isNaN(a) && (a = r ? Math.round(t.location.x) : t.location.x), s = s.y, isNaN(s) && (s = r ? Math.round(t.location.y) : t.location.y); var h = t.maxLocation, l = h.x; return isNaN(l) && (l = r ? Math.round(t.location.x) : t.location.x), h = h.y, isNaN(h) && (h = r ? Math.round(t.location.y) : t.location.y), n.h(Math.max(a, Math.min(e.x, l)), Math.max(s, Math.min(e.y, h))), o !== i && gi.free(o), n }, (t = Lo.prototype).td = function (t, i, e) { if (void 0 === e) return new Ns(kt); var n = t.isGridSnapEnabled; return t.groupsSnapMembers || null === i.containingGroup || (n = !1), new Ns(n ? new gi(Math.round(e.x), Math.round(e.y)) : e.copy()) }, t.Zl = function (t) { xr(this, t, null), t.$d(this); var i = this.Ja, e = i.count - 1; if (!t.isTemporary) for (; 0 <= e && i.L(e).isTemporary;)e--; i.tb(e + 1, t), null !== this.ac && this.Za(we, "layers", this, null, t, null, e + 1), this.M(), this.Na() }, t.vx = function (t, i) { xr(this, t, i), t.$d(this); var e = this.Ja, n = e.indexOf(t); 0 <= n && (e.remove(t), null !== this.ac && this.Za(ke, "layers", this, t, null, n, null)); for (var o = e.count, r = 0; r < o; r++)if (e.L(r) === i) { e.tb(r, t); break } null !== this.ac && this.Za(we, "layers", this, null, t, null, r), this.M(), n < 0 && this.Na() }, t.Iy = function (t, i) { xr(this, t, i), t.$d(this); var e = this.Ja, n = e.indexOf(t); 0 <= n && (e.remove(t), null !== this.ac && this.Za(ke, "layers", this, t, null, n, null)); for (var o = e.count, r = 0; r < o; r++)if (e.L(r) === i) { e.tb(r + 1, t); break } null !== this.ac && this.Za(we, "layers", this, null, t, null, r + 1), this.M(), n < 0 && this.Na() }, t.nA = function (t) { if (t.diagram !== this && B("Cannot remove a Layer from another Diagram: " + t + " of " + t.diagram), "" !== t.name) { var i = this.Ja, e = i.indexOf(t); if (i.remove(t)) { for (i = t.Ca.copy().iterator; i.next();) { var n = i.value, o = n.layerName; o !== t.name ? n.layerName = o : n.layerName = "" } null !== this.ac && this.Za(ke, "layers", this, t, null, e, null), this.M(), this.Na() } } }, t.hm = function (t) { for (var i = this.layers; i.next();) { var e = i.value; if (e.name === t) return e } return null }, t.xx = function (t) { null === this.qe && (this.qe = new J), this.qe.add(t), this.model.Ah(t) }, t.pA = function (t) { null !== this.qe && (this.qe.remove(t), 0 === this.qe.count && (this.qe = null)), this.model.wk(t) }, t.Ah = function (t) { null === this.Jf && (this.Jf = new J), this.Jf.add(t) }, t.wk = function (t) { null !== this.Jf && (this.Jf.remove(t), 0 === this.Jf.count && (this.Jf = null)) }, t.dt = function (t) { if (this.skipsUndoManager || this.model.skipsUndoManager || this.model.undoManager.Gv(t), t.change !== xe && (this.isModified = !0), null !== this.Jf) for (var i = this.Jf, e = i.length, n = 0; n < e; n++)i.L(n)(t) }, t.Za = function (t, i, e, n, o, r, s) { void 0 === r && (r = null), void 0 === s && (s = null); var a = new ve; a.diagram = this, a.change = t, a.propertyName = i, a.object = e, a.oldValue = n, a.oldParam = r, a.newValue = o, a.newParam = s, this.dt(a) }, t.g = function (t, i, e, n, o) { this.Za(be, t, this, i, e, n, o) }, Lo.prototype.changeState = function (t, i) { if (null !== t && t.diagram === this) { var e = this.skipsModelSourceBindings; try { this.skipsModelSourceBindings = !0; var n, o, r, s, a, h, l, u, c, f, d, p = t.change; p === be ? (Kf(n = t.object, t.propertyName, t.H(i)), n instanceof Es && (null !== (o = n.part) && o.Lb()), this.isModified = !0) : p === we ? (r = t.object, s = t.newParam, a = t.newValue, r instanceof xh ? "number" == typeof s && a instanceof Es ? (i ? r.Fc(s) : r.tb(s, a), null !== (h = r.part) && h.Lb()) : "number" == typeof s && a instanceof Yh && (i ? a.isRow ? r.bw(s) : r.$v(s) : (a.isRow ? r.getRowDefinition(a.index) : r.getColumnDefinition(a.index)).gt(a)) : r instanceof No ? (l = !0 === t.oldParam, "number" == typeof s && a instanceof Hl && (i ? (a.isSelected = !1, a.isHighlighted = !1, a.Lb(), r.Fc(l ? s : -1, a, l)) : r.aj(s, a, l))) : r instanceof Lo ? "number" == typeof s && a instanceof No && (i ? this.Ja.$a(s) : (a.$d(this), this.Ja.tb(s, a))) : B("unknown ChangedEvent.Insert object: " + t.toString()), this.isModified = !0) : p === ke ? (u = t.object, c = t.oldParam, f = t.oldValue, u instanceof xh ? "number" == typeof c && f instanceof Es ? i ? u.tb(c, f) : u.Fc(c) : "number" == typeof c && f instanceof Yh && (i ? (f.isRow ? u.getRowDefinition(f.index) : u.getColumnDefinition(f.index)).gt(f) : f.isRow ? u.bw(c) : u.$v(c)) : u instanceof No ? (d = !0 === t.newParam, "number" == typeof c && f instanceof Hl && (i ? u.Ca.indexOf(f) < 0 && u.aj(c, f, d) : (f.isSelected = !1, f.isHighlighted = !1, f.Lb(), u.Fc(d ? c : -1, f, d)))) : u instanceof Lo ? "number" == typeof c && f instanceof No && (i ? (f.$d(this), this.Ja.tb(c, f)) : this.Ja.$a(c)) : B("unknown ChangedEvent.Remove object: " + t.toString()), this.isModified = !0) : p !== xe && B("unknown ChangedEvent: " + t.toString()) } finally { this.skipsModelSourceBindings = e } } }, Lo.prototype.ua = function (t) { return this.undoManager.ua(t) }, Lo.prototype.Va = function (t) { return this.undoManager.Va(t) }, Lo.prototype.Af = function () { return this.undoManager.Af() }, Lo.prototype.commit = function (t, i) { void 0 === i && (i = ""); var e = this.skipsUndoManager; null === i && (this.skipsUndoManager = !0, i = ""), this.undoManager.ua(i); var n = !1; try { t(this), n = !0 } finally { n ? this.undoManager.Va(i) : this.undoManager.Af(), this.skipsUndoManager = e } }, Lo.prototype.updateAllTargetBindings = function (t) { this.partManager.updateAllTargetBindings(t) }, Lo.prototype.Qq = function () { this.partManager.Qq() }, Lo.prototype.Cq = function (t, i, e, n) { var o; t.w(i) || (void 0 === n && (n = !1), n || sr(this), ar(this), null === (o = this.layout) || !o.isViewportSized || this.autoScale !== rs || n || t.width === i.width && t.height === i.height || o.C(), o = this.currentTool, !0 === this.Vf && o instanceof Ce && (this.lastInput.documentPoint = this.St(this.lastInput.viewPoint), Te(o, this)), this.Rb || this.Ux(t, i), wr(this), this.Sd.scale = e, this.Sd.position.x = t.x, this.Sd.position.y = t.y, this.Sd.bounds.assign(t), this.Sd.Nv = n, this.R("ViewportBoundsChanged", this.Sd, t), this.isVirtualized && this.links.each(function (t) { t.isAvoiding && t.actualBounds.Gc(i) && t.Ta() })) }, Lo.prototype.clearSelection = function (t) { void 0 === t && (t = !1); var i = this.selection; if (0 !== i.count) { t || this.R("ChangingSelection", i); for (var e = i.na(), n = e.length, o = 0; o < n; o++)e[o].isSelected = !1; i.ea(), i.clear(), i.freeze(), t || this.R("ChangedSelection", i) } }, Lo.prototype.select = function (t) { null !== t && t.layer.diagram === this && (!t.isSelected || 1 < this.selection.count) && (this.R("ChangingSelection", this.selection), this.clearSelection(!0), t.isSelected = !0, this.R("ChangedSelection", this.selection)) }, Lo.prototype.tA = function (t) { if (this.R("ChangingSelection", this.selection), this.clearSelection(!0), w(t)) for (var i = t.length, e = 0; e < i; e++) { var n = t[e]; n instanceof Hl || B("Diagram.selectCollection given something that is not a Part: " + n), n.isSelected = !0 } else for (t = t.iterator; t.next();)(i = t.value) instanceof Hl || B("Diagram.selectCollection given something that is not a Part: " + i), i.isSelected = !0; this.R("ChangedSelection", this.selection) }, Lo.prototype.clearHighlighteds = function () { var t = this.highlighteds; if (0 < t.count) { for (var i = t.na(), e = i.length, n = 0; n < e; n++)i[n].isHighlighted = !1; t.ea(), t.clear(), t.freeze() } }, (t = Lo.prototype).Pz = function (t) { null !== t && t.layer.diagram === this && (!t.isHighlighted || 1 < this.highlighteds.count) && (this.clearHighlighteds(), t.isHighlighted = !0) }, t.Qz = function (t) { t = (new $).addAll(t); for (var i = this.highlighteds.copy().Gq(t).iterator; i.next();)i.value.isHighlighted = !1; for (t = t.iterator; t.next();)(i = t.value) instanceof Hl || B("Diagram.highlightCollection given something that is not a Part: " + i), i.isHighlighted = !0 }, t.scroll = function (t, i, e) { void 0 === e && (e = 1); var n = "up" === i || "down" === i, o = 0; if ("pixel" === t) o = e; else if ("line" === t) o = e * (n ? this.scrollVerticalLineChange : this.scrollHorizontalLineChange); else if ("page" === t) t = n ? this.viewportBounds.height : this.viewportBounds.width, 0 !== (t *= this.scale) && (o = e * Math.max(t - (n ? this.scrollVerticalLineChange : this.scrollHorizontalLineChange), 0)); else { if ("document" === t) return o = this.documentBounds, e = this.viewportBounds, n = gi.alloc(), "up" === i ? this.position = n.h(e.x, o.y) : "left" === i ? this.position = n.h(o.x, e.y) : "down" === i ? this.position = n.h(e.x, o.bottom - e.height) : "right" === i && (this.position = n.h(o.right - e.width, e.y)), void gi.free(n); B("scrolling unit must be 'pixel', 'line', 'page', or 'document', not: " + t) } o /= this.scale, e = this.position.copy(), "up" === i ? e.y = this.position.y - o : "down" === i ? e.y = this.position.y + o : "left" === i ? e.x = this.position.x - o : "right" === i ? e.x = this.position.x + o : B("scrolling direction must be 'up', 'down', 'left', or 'right', not: " + i), this.position = e }, t.gw = function (t) { var i = this.viewportBounds; i.Be(t) || ((t = t.center).x -= i.width / 2, t.y -= i.height / 2, this.position = t) }, t.et = function (t) { var i = this.viewportBounds; (t = t.center).x -= i.width / 2, t.y -= i.height / 2, this.position = t }, t.Oq = function (t) { var i = this.mb; i.reset(), 1 !== this.ya && i.scale(this.ya); var e = this.ma; return (0 !== e.x || 0 !== e.y) && isFinite(e.x) && isFinite(e.y) && i.translate(-e.x, -e.y), t.copy().transform(this.mb) }, t.CA = function (t) { var i = this.mb, e = t.x, n = t.y, o = e + t.width, r = n + t.height, s = i.m11, a = i.m12, h = i.m21, l = i.m22, u = i.dx, c = i.dy, f = e * s + n * h + u, i = e * a + n * l + c, d = o * s + n * h + u; return t = o * a + n * l + c, n = e * s + r * h + u, e = e * a + r * l + c, s = o * s + r * h + u, o = o * a + r * l + c, r = Math.min(f, d), f = Math.max(f, d), d = Math.min(i, t), i = Math.max(i, t), r = Math.min(r, n), f = Math.max(f, n), d = Math.min(d, e), i = Math.max(i, e), r = Math.min(r, s), f = Math.max(f, s), new yi(r, d = Math.min(d, o), f - r, (i = Math.max(i, o)) - d) }, t.St = function (t) { var i = this.mb; i.reset(), 1 !== this.ya && i.scale(this.ya); var e = this.ma; return (0 !== e.x || 0 !== e.y) && isFinite(e.x) && isFinite(e.y) && i.translate(-e.x, -e.y), ct(t.copy(), this.mb) }, Lo.prototype.doModelChanged = function (t) { var i = this; if (t.model === this.model) { var e, n, o, r, s = t.change, a = t.propertyName; if (s === xe && "S" === a[0]) "StartingFirstTransaction" === a ? ((t = (e = this).toolManager).mouseDownTools.each(function (t) { t.diagram = e }), t.mouseMoveTools.each(function (t) { t.diagram = e }), t.mouseUpTools.each(function (t) { t.diagram = e }), this.Bc || this.ke || (this.pj = !0, this.sj && (this.ye = !0))) : "StartingUndo" === a || "StartingRedo" === a ? ((t = this.animationManager).defaultAnimation.isAnimating && !this.skipsUndoManager && t.Yc(), this.R("ChangingSelection", this.selection)) : "StartedTransaction" !== a || (t = this.animationManager).defaultAnimation.isAnimating && !this.skipsUndoManager && t.Yc(); else if (this.Z) { this.Z = !1; try { "" === t.modelChange && s === xe && ("FinishedUndo" !== a && "FinishedRedo" !== a || (this.R("ChangedSelection", this.selection), ir(this)), n = this.animationManager, "RolledBackTransaction" === a && n.Yc(), this.pj = !0, this.Xc(), 0 !== this.undoManager.transactionLevel && 1 !== this.undoManager.transactionLevel || to(n), "CommittedTransaction" === a && this.undoManager.Eu && (this.Jd = Math.min(this.Jd, this.undoManager.historyIndex - 1)), "CommittedTransaction" !== a && "RolledBackTransaction" !== a || !this.undoManager.isPendingUnmodified || setTimeout(function () { i.isModified = !1 }, 1), (o = t.isTransactionFinished) && (kr(this), this.At.clear(), function (t) { for (t = t.Ck.iterator; t.next();)t.value.ol = !1 }(this.animationManager)), !this.js && o && (this.js = !0, r = this, m(function () { r.currentTool.standardMouseOver(), r.js = !1 }, 10))) } finally { this.Z = !0 } } } }, Lo.prototype.zd = function () { this.partManager.zd() }, Lo.prototype.Tj = function (t, i) { this.Jc.Tj(t, i) }, Lo.prototype.Vj = function (t, i) { this.Jc.Vj(t, i) }, Lo.prototype.findPartForKey = function (t) { return this.partManager.findPartForKey(t) }, Lo.prototype.Kb = function (t) { return this.partManager.Kb(t) }, Lo.prototype.findLinkForKey = function (t) { return this.partManager.findLinkForKey(t) }, (t = Lo.prototype).wc = function (t) { return this.partManager.wc(t) }, t.Si = function (t) { return this.partManager.Si(t) }, t.vc = function (t) { return this.partManager.vc(t) }, t.mt = function (t) { for (var i = [], e = 0; e < arguments.length; ++e)i[e] = arguments[e]; return this.partManager.mt.apply(this.partManager, i instanceof Array ? i : o(n(i))) }, t.lt = function (t) { for (var i = [], e = 0; e < arguments.length; ++e)i[e] = arguments[e]; return this.partManager.lt.apply(this.partManager, i instanceof Array ? i : o(n(i))) }, t.vz = function () { for (var t = new $, i = this.nodes; i.next();) { var e = i.value; e.isTopLevel && t.add(e) } for (i = this.links; i.next();)(e = i.value).isTopLevel && t.add(e); return t.iterator }, t.uz = function () { return this.wh.iterator }, t.aA = function (t) { ir(this), t && Tr(this, !0), this.pj = !0, tr(this) }, t.Bz = function () { for (var t = new J, i = this.nodes; i.next();) { var e = i.value; e.isTopLevel && null === e.Vi() && t.add(e) } return t.iterator }, t.Uj = function (t, i) { null !== (t = Or(this, t)) && t.add(i) }, t.xm = function (t, i) { null !== (t = Or(this, t)) && t.remove(i) }, t.R = function (t, i, e) { var n = Or(this, t), o = new me; if (null !== (t = Fr(o.diagram = this, t)) && (o.name = t), void 0 !== i && (o.subject = i), void 0 !== e && (o.parameter = e), 1 === (i = n.length)) n.L(0)(o); else if (0 !== i) for (n = n.na(), e = 0; e < i; e++)(0, n[e])(o) }, t.lk = function (t, i) { return void 0 === i && (i = null), Ir(this, !1, null, i).lk(t.x, t.y, t.width, t.height) }, Lo.prototype.computeOccupiedArea = function () { return this.isVirtualized ? this.viewportBounds.copy() : this.ki ? Vo(this) : this.documentBounds.copy() }, (t = Lo.prototype).it = function (t) { this.$m.assign(t), zr(this, this.$m).Ma(this.position) ? this.Bf() : function i(e) { -1 === e.jj && (e.jj = m(function () { var t; -1 !== e.jj && (e.Bf(), null !== e.lastInput.event) && ((t = zr(e, e.$m)).Ma(e.position) || (e.position = t, e.lastInput.documentPoint = e.St(e.$m), e.doMouseMove(), e.ki = !0, Nr(e, e.documentBounds.copy().Hc(e.computeBounds())), e.Ac = !0, e.Xc(), i(e))) }, e.Zm)) }(this) }, t.Bf = function () { -1 !== this.jj && (c.clearTimeout(this.jj), this.jj = -1) }, t.Ct = function () { return null }, t.Ov = function () { return null }, t.My = function (t, i) { this.lx.add(t, i) }, t.cA = function (t) { return es ? (void 0 === t && (t = new X), t.returnType = "Image", this.Wx(t)) : null }, t.Wx = function (t) { return void 0 === t && (t = new X), Vr(this, this.dA, t) }, t.dA = function (t, i, e) { var n = Yr(e, t, "canvas", null); if (null === n) return null; var o = null; if (null !== (e = n.Y.canvas)) switch (o = t.returnType, o = void 0 === o ? "string" : o.toLowerCase(), o) { case "imagedata": o = n.getImageData(0, 0, e.width, e.height); break; case "image": (n = (t.document || document).createElement("img")).src = e.toDataURL(t.type, t.details), o = n; break; case "blob": return ("function" != typeof i && B('Error: Diagram.makeImageData called with "returnType: toBlob", but no required "callback" function property defined.'), "function" == typeof e.toBlob) ? (e.toBlob(i, t.type, t.details), "toBlob") : "function" == typeof e.msToBlob ? (i(e.msToBlob()), "msToBlob") : (i(null), null); default: o = e.toDataURL(t.type, t.details) }return "function" == typeof i ? (i(o), null) : o }, l.Object.defineProperties(Lo.prototype, { div: { get: function () { return this.La }, set: function (t) { var i; this.La !== t && (z = [], null !== (i = this.La) ? (i.B = void 0, i.innerHTML = "", null !== this.sa && (i = this.sa.Ea, this.removeEventListener(i, "touchstart", this.sw, !1), this.removeEventListener(i, "touchmove", this.rw, !1), this.removeEventListener(i, "touchend", this.qw, !1), this.sa.Hx()), null !== (i = this.toolManager) && (i.mouseDownTools.each(function (t) { t.cancelWaitAfter() }), i.mouseMoveTools.each(function (t) { t.cancelWaitAfter() }), i.mouseUpTools.each(function (t) { t.cancelWaitAfter() })), i.cancelWaitAfter(), this.currentTool.doCancel(), this.Eb = this.sa = null, this.removeEventListener(c, "resize", this.yw, !1), this.removeEventListener(c, "mousemove", this.qk, !0), this.removeEventListener(c, "mousedown", this.pk, !0), this.removeEventListener(c, "mouseup", this.sk, !0), this.removeEventListener(c, "wheel", this.tk, !0), this.removeEventListener(c, "mouseout", this.rk, !0), Qr === this && (Qr = null)) : this.ke = !1, (this.La = null) !== t && ((i = t.B) && (i.div = null), Ps(this, t), this.Zd())) } }, zx: { get: function () { return this.Jo } }, kk: { get: function () { return this.ke } }, draggedLink: { get: function () { return this.zr }, set: function (t) { this.zr !== t && (null !== (this.zr = t) && (this.ns = t.fromPort, this.os = t.toPort)) } }, Zx: { get: function () { return this.ns }, set: function (t) { this.ns = t } }, $x: { get: function () { return this.os }, set: function (t) { this.os = t } }, animationManager: { get: function () { return this.Jc } }, undoManager: { get: function () { return this.ac.undoManager } }, skipsUndoManager: { get: function () { return this.pg }, set: function (t) { this.pg = t, this.ac.skipsUndoManager = t } }, delaysLayout: { get: function () { return this.ur }, set: function (t) { this.ur = t } }, opacity: { get: function () { return this.rb }, set: function (t) { var i = this.rb; i !== t && ((t < 0 || 1 < t) && y(t, "0 <= value <= 1", Lo, "opacity"), this.rb = t, this.g("opacity", i, t), this.M()) } }, validCycle: { get: function () { return this.Zs }, set: function (t) { var i = this.Zs; i !== t && (this.Zs = t, this.g("validCycle", i, t)) } }, layers: { get: function () { return this.Ja.iterator } }, isModelReadOnly: { get: function () { var t = this.ac; return null !== t && t.isReadOnly }, set: function (t) { var i = this.ac; null !== i && (i.isReadOnly = t) } }, isReadOnly: { get: function () { return this.Wf }, set: function (t) { var i = this.Wf; i !== t && (this.Wf = t, this.g("isReadOnly", i, t)) } }, isEnabled: { get: function () { return this.Mc }, set: function (t) { var i = this.Mc; i !== t && (this.Mc = t, this.g("isEnabled", i, t)) } }, allowClipboard: { get: function () { return this.Vq }, set: function (t) { var i = this.Vq; i !== t && (this.Vq = t, this.g("allowClipboard", i, t)) } }, allowCopy: { get: function () { return this.Rh }, set: function (t) { var i = this.Rh; i !== t && (this.Rh = t, this.g("allowCopy", i, t)) } }, allowDelete: { get: function () { return this.Sh }, set: function (t) { var i = this.Sh; i !== t && (this.Sh = t, this.g("allowDelete", i, t)) } }, allowDragOut: { get: function () { return this.Wq }, set: function (t) { var i = this.Wq; i !== t && (this.Wq = t, this.g("allowDragOut", i, t)) } }, allowDrop: { get: function () { return this.Xq }, set: function (t) { var i = this.Xq; i !== t && (this.Xq = t, this.g("allowDrop", i, t)) } }, allowTextEdit: { get: function () { return this.ai }, set: function (t) { var i = this.ai; i !== t && (this.ai = t, this.g("allowTextEdit", i, t)) } }, allowGroup: { get: function () { return this.Th }, set: function (t) { var i = this.Th; i !== t && (this.Th = t, this.g("allowGroup", i, t)) } }, allowUngroup: { get: function () { return this.bi }, set: function (t) { var i = this.bi; i !== t && (this.bi = t, this.g("allowUngroup", i, t)) } }, allowInsert: { get: function () { return this.Zq }, set: function (t) { var i = this.Zq; i !== t && (this.Zq = t, this.g("allowInsert", i, t)) } }, allowLink: { get: function () { return this.Uh }, set: function (t) { var i = this.Uh; i !== t && (this.Uh = t, this.g("allowLink", i, t)) } }, allowRelink: { get: function () { return this.Wh }, set: function (t) { var i = this.Wh; i !== t && (this.Wh = t, this.g("allowRelink", i, t)) } }, allowMove: { get: function () { return this.Vh }, set: function (t) { var i = this.Vh; i !== t && (this.Vh = t, this.g("allowMove", i, t)) } }, allowReshape: { get: function () { return this.Xh }, set: function (t) { var i = this.Xh; i !== t && (this.Xh = t, this.g("allowReshape", i, t)) } }, allowResize: { get: function () { return this.Yh }, set: function (t) { var i = this.Yh; i !== t && (this.Yh = t, this.g("allowResize", i, t)) } }, allowRotate: { get: function () { return this.Zh }, set: function (t) { var i = this.Zh; i !== t && (this.Zh = t, this.g("allowRotate", i, t)) } }, allowSelect: { get: function () { return this.$h }, set: function (t) { var i = this.$h; i !== t && (this.$h = t, this.g("allowSelect", i, t)) } }, allowUndo: { get: function () { return this.$q }, set: function (t) { var i = this.$q; i !== t && (this.$q = t, this.g("allowUndo", i, t)) } }, allowZoom: { get: function () { return this.br }, set: function (t) { var i = this.br; i !== t && (this.br = t, this.g("allowZoom", i, t)) } }, hasVerticalScrollbar: { get: function () { return this.cl }, set: function (t) { var i = this.cl; i !== t && (this.cl = t, sr(this), this.M(), this.g("hasVerticalScrollbar", i, t), Yo(this, !1)) } }, hasHorizontalScrollbar: { get: function () { return this.bl }, set: function (t) { var i = this.bl; i !== t && (this.bl = t, sr(this), this.M(), this.g("hasHorizontalScrollbar", i, t), Yo(this, !1)) } }, allowHorizontalScroll: { get: function () { return this.Yq }, set: function (t) { var i = this.Yq; i !== t && (this.Yq = t, this.g("allowHorizontalScroll", i, t), Yo(this, !1)) } }, allowVerticalScroll: { get: function () { return this.ar }, set: function (t) { var i = this.ar; i !== t && (this.ar = t, this.g("allowVerticalScroll", i, t), Yo(this, !1)) } }, scrollHorizontalLineChange: { get: function () { return this.Es }, set: function (t) { var i = this.Es; i !== t && (t < 0 && y(t, ">= 0", Lo, "scrollHorizontalLineChange"), this.Es = t, this.g("scrollHorizontalLineChange", i, t)) } }, scrollVerticalLineChange: { get: function () { return this.Is }, set: function (t) { var i = this.Is; i !== t && (t < 0 && y(t, ">= 0", Lo, "scrollVerticalLineChange"), this.Is = t, this.g("scrollVerticalLineChange", i, t)) } }, lastInput: { get: function () { return this.$g }, set: function (t) { this.$g = t } }, firstInput: { get: function () { return this.Rf }, set: function (t) { this.Rf = t } }, currentCursor: { get: function () { return this.nr }, set: function (t) { var i, e, n; "" === t && (t = this.xn), this.nr !== t && (i = this.sa, e = this.La, null !== i && (this.nr = t, n = i.style.cursor, i.style.cursor = t, e.style.cursor = t, i.style.cursor === n && (i.style.cursor = "-webkit-" + t, e.style.cursor = "-webkit-" + t, i.style.cursor === n && (i.style.cursor = "-moz-" + t, e.style.cursor = "-moz-" + t, i.style.cursor === n && (i.style.cursor = t, e.style.cursor = t))))) } }, defaultCursor: { get: function () { return this.xn }, set: function (t) { "" === t && (t = "auto"); var i = this.xn; i !== t && (this.xn = t, this.g("defaultCursor", i, t)) } }, click: { get: function () { return this.Kf }, set: function (t) { var i = this.Kf; i !== t && (this.Kf = t, this.g("click", i, t)) } }, doubleClick: { get: function () { return this.Pf }, set: function (t) { var i = this.Pf; i !== t && (this.Pf = t, this.g("doubleClick", i, t)) } }, contextClick: { get: function () { return this.Lf }, set: function (t) { var i = this.Lf; i !== t && (this.Lf = t, this.g("contextClick", i, t)) } }, mouseOver: { get: function () { return this.hg }, set: function (t) { var i = this.hg; i !== t && (this.hg = t, this.g("mouseOver", i, t)) } }, mouseHover: { get: function () { return this.fg }, set: function (t) { var i = this.fg; i !== t && (this.fg = t, this.g("mouseHover", i, t)) } }, mouseHold: { get: function () { return this.eg }, set: function (t) { var i = this.eg; i !== t && (this.eg = t, this.g("mouseHold", i, t)) } }, mouseDragOver: { get: function () { return this.hs }, set: function (t) { var i = this.hs; i !== t && (this.hs = t, this.g("mouseDragOver", i, t)) } }, mouseDrop: { get: function () { return this.cg }, set: function (t) { var i = this.cg; i !== t && (this.cg = t, this.g("mouseDrop", i, t)) } }, handlesDragDropForTopLevelParts: { get: function () { return this.Jr }, set: function (t) { var i = this.Jr; i !== t && (this.Jr = t, this.g("handlesDragDropForTopLevelParts", i, t)) } }, mouseEnter: { get: function () { return this.dg }, set: function (t) { var i = this.dg; i !== t && (this.dg = t, this.g("mouseEnter", i, t)) } }, mouseLeave: { get: function () { return this.gg }, set: function (t) { var i = this.gg; i !== t && (this.gg = t, this.g("mouseLeave", i, t)) } }, toolTip: { get: function () { return this.rg }, set: function (t) { var i = this.rg; i !== t && (this.rg = t, this.g("toolTip", i, t)) } }, contextMenu: { get: function () { return this.Mf }, set: function (t) { var i = this.Mf; i !== t && (this.Mf = t, this.g("contextMenu", i, t)) } }, commandHandler: { get: function () { return this.hr }, set: function (t) { this.hr !== t && (this.hr = t).$d(this) } }, toolManager: { get: function () { return this.Vs }, set: function (t) { this.Vs !== t && ((this.Vs = t).diagram = this) } }, defaultTool: { get: function () { return this.tr }, set: function (t) { var i = this.tr; i === t || ((this.tr = t).diagram = this).currentTool === i && (this.currentTool = t) } }, currentTool: { get: function () { return this.qr }, set: function (t) { var i = this.qr; null !== i && (i.isActive && i.doDeactivate(), i.cancelWaitAfter(), i.doStop()), null === t && (t = this.defaultTool), null !== t && ((this.qr = t).diagram = this, t.doStart()) } }, selection: { get: function () { return this.Uu } }, maxSelectionCount: { get: function () { return this.ds }, set: function (t) { var i = this.ds; if (i !== t) if (0 <= t && !isNaN(t)) { if (this.ds = t, this.g("maxSelectionCount", i, t), !this.undoManager.isUndoingRedoing && 0 < (t = this.selection.count - t)) { this.R("ChangingSelection", this.selection), i = this.selection.na(); for (var e = 0; e < t; e++)i[e].isSelected = !1; this.R("ChangedSelection", this.selection) } } else y(t, ">= 0", Lo, "maxSelectionCount") } }, nodeSelectionAdornmentTemplate: { get: function () { return this.So }, set: function (t) { var i = this.So; i !== t && (this.So = t, this.g("nodeSelectionAdornmentTemplate", i, t)) } }, groupSelectionAdornmentTemplate: { get: function () { return this.Wn }, set: function (t) { var i = this.Wn; i !== t && (this.Wn = t, this.g("groupSelectionAdornmentTemplate", i, t)) } }, linkSelectionAdornmentTemplate: { get: function () { return this.ro }, set: function (t) { var i = this.ro; i !== t && (this.ro = t, this.g("linkSelectionAdornmentTemplate", i, t)) } }, highlighteds: { get: function () { return this.uu } }, isModified: { get: function () { var t = this.undoManager; return t.isEnabled ? null !== t.currentTransaction || this.ao && this.Jd !== t.historyIndex : this.ao }, set: function (t) { var i; this.ao !== t && (this.ao = t, i = this.undoManager, !t && i.isEnabled && (this.Jd = i.historyIndex), t || kr(this)) } }, model: { get: function () { return this.ac }, set: function (i) { var t, e = this.ac; if (e !== i) { this.currentTool.doCancel(), null !== e && e.undoManager !== i.undoManager && e.undoManager.isInTransaction && B("Do not replace a Diagram.model while a transaction is in progress."), this.animationManager.Yc(!0); var n = Ao(this, !0); this.ke = !1, this.sj = !0, this.Jd = -2, this.ye = !1; var o = this.Bc; this.Bc = !0, Qn(this.animationManager, "Model"), null !== e && (null !== this.qe && this.qe.each(function (t) { e.wk(t) }), e.wk(this.Ic)), this.ac = i, this.partManager = (t = this.ac.constructor.type, new (null !== (t = _r.get(t)) ? t : of)); for (var r = 0; r < n.length; r++)this.add(n[r]); i.Ah(this.kd), this.partManager.addAllModeledParts(), i.wk(this.kd), i.Ah(this.Ic), null !== this.qe && this.qe.each(function (t) { i.Ah(t) }), this.Bc = o, this.Rb || this.M(), null !== e && i.undoManager.copyProperties(e.undoManager) } } }, Z: { get: function () { return this.Du }, set: function (t) { this.Du = t } }, At: { get: function () { return this.$w } }, skipsModelSourceBindings: { get: function () { return this.Vu }, set: function (t) { this.Vu = t } }, Rt: { get: function () { return this.Ns }, set: function (t) { this.Ns = t } }, nodeTemplate: { get: function () { return this.Ye.H("") }, set: function (t) { var i = this.Ye.H(""); i !== t && (this.Ye.add("", t), this.g("nodeTemplate", i, t), this.undoManager.isUndoingRedoing || this.zd()) } }, nodeTemplateMap: { get: function () { return this.Ye }, set: function (t) { var i = this.Ye; i !== t && (this.Ye = t, this.g("nodeTemplateMap", i, t), this.undoManager.isUndoingRedoing || this.zd()) } }, groupTemplate: { get: function () { return this.Yg.H("") }, set: function (t) { var i = this.Yg.H(""); i !== t && (this.Yg.add("", t), this.g("groupTemplate", i, t), this.undoManager.isUndoingRedoing || this.zd()) } }, groupTemplateMap: { get: function () { return this.Yg }, set: function (t) { var i = this.Yg; i !== t && (this.Yg = t, this.g("groupTemplateMap", i, t), this.undoManager.isUndoingRedoing || this.zd()) } }, linkTemplate: { get: function () { return this.Yf.H("") }, set: function (t) { var i = this.Yf.H(""); i !== t && (this.Yf.add("", t), this.g("linkTemplate", i, t), this.undoManager.isUndoingRedoing || this.zd()) } }, linkTemplateMap: { get: function () { return this.Yf }, set: function (t) { var i = this.Yf; i !== t && (this.Yf = t, this.g("linkTemplateMap", i, t), this.undoManager.isUndoingRedoing || this.zd()) } }, isMouseCaptured: { get: function () { return this.zu }, set: function (t) { var i = this.sa; null !== i && ((i = i.Ea) instanceof SVGElement || (t ? (this.lastInput.bubbles = !1, this.Vm ? (this.removeEventListener(i, "pointermove", this.tm, !1), this.removeEventListener(i, "pointerdown", this.sm, !1), this.removeEventListener(i, "pointerup", this.vm, !1), this.removeEventListener(i, "pointerout", this.um, !1), this.addEventListener(c, "pointermove", this.tm, !0), this.addEventListener(c, "pointerdown", this.sm, !0), this.addEventListener(c, "pointerup", this.vm, !0), this.addEventListener(c, "pointerout", this.um, !0)) : (this.removeEventListener(i, "mousemove", this.qk, !1), this.removeEventListener(i, "mousedown", this.pk, !1), this.removeEventListener(i, "mouseup", this.sk, !1), this.removeEventListener(i, "mouseout", this.rk, !1), this.addEventListener(c, "mousemove", this.qk, !0), this.addEventListener(c, "mousedown", this.pk, !0), this.addEventListener(c, "mouseup", this.sk, !0), this.addEventListener(c, "mouseout", this.rk, !0)), this.removeEventListener(i, "wheel", this.tk, !1), this.addEventListener(c, "wheel", this.tk, !0), this.addEventListener(c, "selectstart", this.preventDefault, !1)) : (this.Vm ? (this.removeEventListener(c, "pointermove", this.tm, !0), this.removeEventListener(c, "pointerdown", this.sm, !0), this.removeEventListener(c, "pointerup", this.vm, !0), this.removeEventListener(c, "pointerout", this.um, !0), this.addEventListener(i, "pointermove", this.tm, !1), this.addEventListener(i, "pointerdown", this.sm, !1), this.addEventListener(i, "pointerup", this.vm, !1), this.addEventListener(i, "pointerout", this.um, !1)) : (this.removeEventListener(c, "mousemove", this.qk, !0), this.removeEventListener(c, "mousedown", this.pk, !0), this.removeEventListener(c, "mouseup", this.sk, !0), this.removeEventListener(c, "mouseout", this.rk, !0), this.addEventListener(i, "mousemove", this.qk, !1), this.addEventListener(i, "mousedown", this.pk, !1), this.addEventListener(i, "mouseup", this.sk, !1), this.addEventListener(i, "mouseout", this.rk, !1)), this.removeEventListener(c, "wheel", this.tk, !0), this.removeEventListener(c, "selectstart", this.preventDefault, !1), this.addEventListener(i, "wheel", this.tk, !1)), this.zu = t)) } }, position: { get: function () { return this.ma }, set: function (t) { var i, e = gi.alloc().assign(this.ma); e.w(t) || (i = this.viewportBounds.copy(), this.ma.assign(t), oo(this.animationManager, e, this.ma), this.Rb || null === this.sa && !this.Yl.v() || (this.Rb = !0, t = this.scale, Xo(this, this.zn, this.wa / t, this.va / t, this.lj, !1), this.Rb = !1), this.Rb || this.Cq(i, this.viewportBounds, this.ya, !1)), gi.free(e) } }, initialPosition: { get: function () { return this.Lr }, set: function (t) { this.Lr.w(t) || (this.Lr = t.G()) } }, initialScale: { get: function () { return this.Mr }, set: function (t) { this.Mr !== t && (this.Mr = t) } }, grid: { get: function () { return null === this.Gb && Ro(this), this.Gb }, set: function (t) { var i, e = this.Gb; e !== t && (null === e && (Ro(this), e = this.Gb), t.type !== xh.Grid && B("Diagram.grid must be a Panel of type Panel.Grid"), null !== (i = e.panel) && i.remove(e), (this.Gb = t).name = "GRID", null !== i && i.add(t), wr(this), this.M(), this.g("grid", e, t)) } }, viewportBounds: { get: function () { var t = this.cv, i = this.ma, e = this.ya; return null === this.sa ? this.Yl.v() && t.h(i.x, i.y, this.wa / e, this.va / e) : t.h(i.x, i.y, Math.max(this.wa, 0) / e, Math.max(this.va, 0) / e), t } }, viewSize: { get: function () { return this.Yl }, set: function (t) { var i = this.viewSize; i.w(t) || (this.Yl = t = t.G(), this.wa = t.width, this.va = t.height, this.Na(), this.g("viewSize", i, t)) } }, fixedBounds: { get: function () { return this.Gr }, set: function (t) { var i = this.Gr; i.w(t) || (-1 / 0 !== t.width && 1 / 0 !== t.height && -1 / 0 !== t.height || B("fixedBounds width/height must not be Infinity"), this.Gr = t = t.G(), this.Na(), this.g("fixedBounds", i, t)) } }, scrollMargin: { get: function () { return this.Fi }, set: function (t) { "number" == typeof t && (t = new Xt(t)); var i = this.Fi; i.w(t) || (this.Fi = t = t.G(), this.g("scrollMargin", i, t), this.Zd()) } }, scrollMode: { get: function () { return this.Gi }, set: function (t) { var i = this.Gi; i !== t && ((this.Gi = t) === ps && Yo(this, !1), this.g("scrollMode", i, t), this.M()) } }, scrollsPageOnFocus: { get: function () { return this.Js }, set: function (t) { var i = this.Js; i !== t && (this.Js = t, this.g("scrollsPageOnFocus", i, t)) } }, positionComputation: { get: function () { return this.ws }, set: function (t) { var i = this.ws; i !== t && (this.ws = t, Yo(this, !1), this.g("positionComputation", i, t)) } }, scaleComputation: { get: function () { return this.Cs }, set: function (t) { var i = this.Cs; i !== t && (this.Cs = t, br(this, this.scale, this.scale), this.g("scaleComputation", i, t)) } }, documentBounds: { get: function () { return this.zn } }, isVirtualized: { get: function () { return this.Wr }, set: function (t) { var i = this.Wr; i !== t && (this.Wr = t, this.g("isVirtualized", i, t)) } }, scale: { get: function () { return this.ya }, set: function (t) { var i = this.ya; i !== t && br(this, i, t) } }, defaultScale: { get: function () { return this.yn }, set: function (t) { this.yn = t } }, autoScale: { get: function () { return this.Ig }, set: function (t) { var i = this.Ig; i !== t && (this.Ig = t, this.g("autoScale", i, t), t !== rs && Yo(this, !1)) } }, initialAutoScale: { get: function () { return this.Uf }, set: function (t) { var i = this.Uf; i !== t && (this.Uf = t, this.g("initialAutoScale", i, t)) } }, initialViewportSpot: { get: function () { return this.Nr }, set: function (t) { var i = this.Nr; i !== t && (t.gb() || B("initialViewportSpot must be a specific Spot: " + t), this.Nr = t, this.g("initialViewportSpot", i, t)) } }, initialDocumentSpot: { get: function () { return this.Kr }, set: function (t) { var i = this.Kr; i !== t && (t.gb() || B("initialViewportSpot must be a specific Spot: " + t), this.Kr = t, this.g("initialDocumentSpot", i, t)) } }, minScale: { get: function () { return this.es }, set: function (t) { var i = this.es; i !== t && (0 < t ? (this.es = t, this.g("minScale", i, t), t > this.scale && (this.scale = t)) : y(t, "> 0", Lo, "minScale")) } }, maxScale: { get: function () { return this.cs }, set: function (t) { var i = this.cs; i !== t && (0 < t ? (this.cs = t, this.g("maxScale", i, t), t < this.scale && (this.scale = t)) : y(t, "> 0", Lo, "maxScale")) } }, zoomPoint: { get: function () { return this.bt }, set: function (t) { this.bt.w(t) || (this.bt = t = t.G()) } }, contentAlignment: { get: function () { return this.lj }, set: function (t) { var i = this.lj; i.w(t) || (this.lj = t = t.G(), this.g("contentAlignment", i, t), Yo(this, !1)) } }, initialContentAlignment: { get: function () { return this.Yn }, set: function (t) { var i = this.Yn; i.w(t) || (this.Yn = t = t.G(), this.g("initialContentAlignment", i, t)) } }, padding: { get: function () { return this.eb }, set: function (t) { "number" == typeof t && (t = new Xt(t)); var i = this.eb; i.w(t) || (this.eb = t = t.G(), this.Na(), this.g("padding", i, t)) } }, partManager: { get: function () { return this.Ia }, set: function (t) { var i = this.Ia; i !== t && (null !== t.diagram && B("Cannot share PartManagers between Diagrams: " + t.toString()), null !== i && i.$d(null), (this.Ia = t).$d(this)) } }, nodes: { get: function () { return this.partManager.nodes.iterator } }, links: { get: function () { return this.partManager.links.iterator } }, parts: { get: function () { return this.partManager.parts.iterator } }, layout: { get: function () { return this.ic }, set: function (t) { var i = this.ic; i !== t && ((this.ic = t).diagram = this, t.group = null, this.Ff = !0, this.g("layout", i, t), this.Pb()) } }, isTreePathToChildren: { get: function () { return this.Vr }, set: function (t) { var i = this.Vr; if (i !== t && (this.Vr = t, this.g("isTreePathToChildren", i, t), !this.undoManager.isUndoingRedoing)) for (t = this.nodes; t.next();)wu(t.value) } }, treeCollapsePolicy: { get: function () { return this.Xs }, set: function (t) { var i = this.Xs; i !== t && (t !== ys && t !== ms && t !== vs && B("Unknown Diagram.treeCollapsePolicy: " + t), this.Xs = t, this.g("treeCollapsePolicy", i, t)) } }, Ee: { get: function () { return this.xu }, set: function (t) { this.xu = t } }, autoScrollInterval: { get: function () { return this.Zm }, set: function (t) { var i = this.Zm; i !== t && (this.Zm = t, this.g("autoScrollInterval", i, t)) } }, autoScrollRegion: { get: function () { return this.an }, set: function (t) { "number" == typeof t && (t = new Xt(t)); var i = this.an; i.w(t) || (this.an = t = t.G(), this.Na(), this.g("autoScrollRegion", i, t)) } } }), l.Object.defineProperties(Lo, { licenseKey: { get: function () { return xs.Xb() }, set: function (t) { xs.add(t) } }, version: { get: function () { return bs } } }), Lo.prototype.makeImageData = Lo.prototype.Wx, Lo.prototype.makeImage = Lo.prototype.cA, Lo.prototype.addRenderer = Lo.prototype.My, Lo.prototype.makeSVG = Lo.prototype.Ov, Lo.prototype.makeSvg = Lo.prototype.Ct, Lo.prototype.stopAutoScroll = Lo.prototype.Bf, Lo.prototype.doAutoScroll = Lo.prototype.it, Lo.prototype.isUnoccupied = Lo.prototype.lk, Lo.prototype.raiseDiagramEvent = Lo.prototype.R, Lo.prototype.removeDiagramListener = Lo.prototype.xm, Lo.prototype.addDiagramListener = Lo.prototype.Uj, Lo.prototype.findTreeRoots = Lo.prototype.Bz, Lo.prototype.layoutDiagram = Lo.prototype.aA, Lo.prototype.findTopLevelGroups = Lo.prototype.uz, Lo.prototype.findTopLevelNodesAndLinks = Lo.prototype.vz, Lo.prototype.findLinksByExample = Lo.prototype.lt, Lo.prototype.findNodesByExample = Lo.prototype.mt, Lo.prototype.findLinkForData = Lo.prototype.vc, Lo.prototype.findNodeForData = Lo.prototype.Si, Lo.prototype.findPartForData = Lo.prototype.wc, Lo.prototype.findLinkForKey = Lo.prototype.findLinkForKey, Lo.prototype.findNodeForKey = Lo.prototype.Kb, Lo.prototype.findPartForKey = Lo.prototype.findPartForKey, Lo.prototype.rebuildParts = Lo.prototype.zd, Lo.prototype.transformViewToDoc = Lo.prototype.St, Lo.prototype.transformRectDocToView = Lo.prototype.CA, Lo.prototype.transformDocToView = Lo.prototype.Oq, Lo.prototype.centerRect = Lo.prototype.et, Lo.prototype.scrollToRect = Lo.prototype.gw, Lo.prototype.scroll = Lo.prototype.scroll, Lo.prototype.highlightCollection = Lo.prototype.Qz, Lo.prototype.highlight = Lo.prototype.Pz, Lo.prototype.selectCollection = Lo.prototype.tA, Lo.prototype.select = Lo.prototype.select, Lo.prototype.updateAllRelationshipsFromData = Lo.prototype.Qq, Lo.prototype.updateAllTargetBindings = Lo.prototype.updateAllTargetBindings, Lo.prototype.commit = Lo.prototype.commit, Lo.prototype.rollbackTransaction = Lo.prototype.Af, Lo.prototype.commitTransaction = Lo.prototype.Va, Lo.prototype.startTransaction = Lo.prototype.ua, Lo.prototype.raiseChanged = Lo.prototype.g, Lo.prototype.raiseChangedEvent = Lo.prototype.Za, Lo.prototype.removeChangedListener = Lo.prototype.wk, Lo.prototype.addChangedListener = Lo.prototype.Ah, Lo.prototype.removeModelChangedListener = Lo.prototype.pA, Lo.prototype.addModelChangedListener = Lo.prototype.xx, Lo.prototype.findLayer = Lo.prototype.hm, Lo.prototype.removeLayer = Lo.prototype.nA, Lo.prototype.addLayerAfter = Lo.prototype.Iy, Lo.prototype.addLayerBefore = Lo.prototype.vx, Lo.prototype.addLayer = Lo.prototype.Zl, Lo.prototype.moveParts = Lo.prototype.moveParts, Lo.prototype.copyParts = Lo.prototype.ck, Lo.prototype.removeParts = Lo.prototype.Lt, Lo.prototype.remove = Lo.prototype.remove, Lo.prototype.add = Lo.prototype.add, Lo.prototype.clearDelayedGeometries = Lo.prototype.kv, Lo.prototype.setProperties = Lo.prototype.lw, Lo.prototype.resetInputOptions = Lo.prototype.dw, Lo.prototype.setInputOption = Lo.prototype.uA, Lo.prototype.getInputOption = Lo.prototype.lm, Lo.prototype.resetRenderingHints = Lo.prototype.ew, Lo.prototype.setRenderingHint = Lo.prototype.ny, Lo.prototype.getRenderingHint = Lo.prototype.De, Lo.prototype.maybeUpdate = Lo.prototype.Xc, Lo.prototype.requestUpdate = Lo.prototype.Pb, Lo.prototype.delayInitialization = Lo.prototype.az, Lo.prototype.isUpdateRequested = Lo.prototype.Wz, Lo.prototype.redraw = Lo.prototype.Zd, Lo.prototype.invalidateDocumentBounds = Lo.prototype.Na, Lo.prototype.findObjectsNear = Lo.prototype.xg, Lo.prototype.findPartsNear = Lo.prototype.qz, Lo.prototype.findObjectsIn = Lo.prototype.tf, Lo.prototype.findPartsIn = Lo.prototype.Ox, Lo.prototype.findObjectsAt = Lo.prototype.Ti, Lo.prototype.findPartsAt = Lo.prototype.pz, Lo.prototype.findObjectAt = Lo.prototype.Ub, Lo.prototype.findPartAt = Lo.prototype.im, Lo.prototype.focusObject = Lo.prototype.Cz, Lo.prototype.alignDocument = Lo.prototype.Oy, Lo.prototype.zoomToRect = Lo.prototype.FA, Lo.prototype.zoomToFit = Lo.prototype.zoomToFit, Lo.prototype.diagramScroll = Lo.prototype.Gx, Lo.prototype.focus = Lo.prototype.focus, Lo.prototype.reset = Lo.prototype.reset, Lo.useDOM = function (t) { es = !!t && void 0 !== c.document }, Lo.isUsingDOM = function () { return es }; var Gr, Xr, qr, Ur, Kr, Hr, Wr, Jr, Zr, $r, Qr = null, _r = new at, ts = null, is = null, es = void 0 !== c.document, ns = null, os = "", rs = new V(Lo, "None", 0), ss = new V(Lo, "Uniform", 1), as = new V(Lo, "UniformToFill", 2), hs = new V(Lo, "CycleAll", 10), ls = new V(Lo, "CycleNotDirected", 11), us = new V(Lo, "CycleNotDirectedFast", 12), cs = new V(Lo, "CycleNotUndirected", 13), fs = new V(Lo, "CycleDestinationTree", 14), ds = new V(Lo, "CycleSourceTree", 15), ps = new V(Lo, "DocumentScroll", 1), gs = new V(Lo, "InfiniteScroll", 2), ys = new V(Lo, "TreeParentCollapsed", 21), ms = new V(Lo, "AllParentsCollapsed", 22), vs = new V(Lo, "AnyParentsCollapsed", 23), xs = new J, bs = "2.1.18", ws = null, ks = !1; function Ms() { this.Ey = null, this.l = "zz@orderNum", "63ad05bbe23a1786468a4c741b6d2" === this._tk ? this.Pe = this.l = !0 : this.Pe = null } function Ss(t, i) { if (i.Eb.setTransform(i.Sb, 0, 0, i.Sb, 0, 0), null === t.Pe) { i = "f"; var e = c[A("76a715b2f73f148a")][A("72ba13b5")]; if (t.Pe = !0, es) { var n = Lo[A("76a115b6ed251eaf4692")]; if (n) for (var o = xs.iterator; o.next() && !((n = A(n = o.value).split(A("39e9"))).length < 6);) { var r = A(n[1]).split("."); if ("7da71ca0" !== n[4]) break; var s = A(f[A("6cae19")]).split("."); if (r[0] > s[0] || r[0] === s[0] && r[1] >= s[1]) { for (r = e[A("76ad18b4f73e")], s = e[A("73a612b6fb191d")](A("35e7")) + 2; s < r; s++)i += e[s]; if ((r = i[A("73a612b6fb191d")](A(n[2]))) < 0 && A(n[2]) !== A("7da71ca0ad381e90") && (r = i[A("73a612b6fb191d")](A("76a715b2ef3e149757"))), r < 0 && (r = i[A("73a612b6fb191d")](A("76a715b2ef3e149757"))), r < 0 && (r = e[A("73a612b6fb191d")](A("7baa19a6f76c1988428554"))), t.Pe = !(0 <= r && r < i[A("73a612b6fb191d")](A("35")) || -1 === i[A("73a612b6fb191d")](A("35"))), !t.Pe) break; if ("#" !== (r = A(n[2]))[0]) break; s = c.document.createElement("div"); for (var a = n[0].replace(/[A-Za-z]/g, ""); a.length < 4;)a += "9"; if (a = a.substr(a.length - 4), n = "", n += ["gsh", "gsf"][parseInt(a.substr(0, 1), 10) % 2], n += ["Header", "Background", "Display", "Feedback"][parseInt(a.substr(0, 1), 10) % 4], s[A("79a417a0f0181a8946")] = n, c.document[A("78a712aa")]) { if (c.document[A("78a712aa")][A("7bb806b6ed32388c4a875b")](s), a = c.getComputedStyle(s).getPropertyValue(A("78a704b7e62456904c9b12701b6532a8")), c.document[A("78a712aa")][A("68ad1bbcf533388c4a875b")](s), !a) break; if (-1 !== a.indexOf(parseInt(r[1] + r[2], 16)) && -1 !== a.indexOf(parseInt(r[3] + r[4], 16))) { t.Pe = !1; break } if (j || D || F || O) for (n = "." + n, r = 0; r < document.styleSheets.length; r++)for (var h in s = document.styleSheets[r].rules || document.styleSheets[r].cssRules) if (n === s[h].selectorText) { t.Pe = !1; break } } else t.Pe = null, t.Pe = !1 } } else { for (h = e[A("76ad18b4f73e")], o = e[A("73a612b6fb191d")](A("35e7")) + 2; o < h; o++)i += e[o]; e = i[A("73a612b6fb191d")](A("7da71ca0ad381e90")), t.Pe = !(0 <= e && e < i[A("73a612b6fb191d")](A("35"))) } } } return 0 < t.Pe && t !== t.Ey } function Ps(r, t) { var i, e, o, n; es && (null != t || B("Diagram setup requires an argument DIV."), null !== r.La && B("Diagram has already completed setup."), "string" == typeof t ? r.La = c.document.getElementById(t) : t instanceof HTMLDivElement ? r.La = t : B("No DIV or DIV id supplied: " + t), null === r.La && B("Invalid DIV id; could not get element with id: " + t), void 0 !== r.La.B && B("Invalid div id; div already has a Diagram associated with it."), "static" === c.getComputedStyle(r.La, null).position && (r.La.style.position = "relative"), r.La.style["-webkit-tap-highlight-color"] = "rgba(255, 255, 255, 0)", r.La.style["-ms-touch-action"] = "none", r.La.innerHTML = "", void 0 !== (i = new ((r.La.B = r).Qp ? va : Pa)(r)).style && (i.style.position = "absolute", i.style.top = "0px", i.style.left = "0px", "rtl" === c.getComputedStyle(r.La, null).getPropertyValue("direction") && (r.ml = !0), i.style.zIndex = "2", i.style.userSelect = "none", i.style.webkitUserSelect = "none", i.style.MozUserSelect = "none"), r.sa = i, r.Eb = i.context, t = r.Eb, r.Sb = r.computePixelRatio(), r.wa = r.La.clientWidth || 1, r.va = r.La.clientHeight || 1, lr(r, r.wa, r.va), r.Ar = t.Y[A("7eba17a4ca3b1a8346")][A("78a118b7")](t.Y, ws, 4, 4), r.La.insertBefore(i.Ea, r.La.firstChild), (i = new Pa(null)).width = 1, i.height = 1, r.mu = i, r.Tw = i.context, es && (i = p("div"), e = p("div"), i.style.position = "absolute", i.style.overflow = "auto", i.style.width = r.wa + "px", i.style.height = r.va + "px", i.style.zIndex = "1", e.style.position = "absolute", e.style.width = "1px", e.style.height = "1px", r.La.appendChild(i), i.appendChild(e), i.onscroll = Eo, i.onmousedown = zo, i.ontouchstart = zo, i.B = r, i.Cy = !0, i.Dy = !0, r.Gs = i, r.xp = e), r.Jt = d(function () { r.rh = null, r.M() }, 300), r.yw = d(function () { Bo(r) }, 250), r.preventDefault = function (t) { return t.preventDefault(), !1 }, r.qk = function (t) { var i; r.isEnabled && (r.Vf = !0, i = Uo(r, t, !0), r.doMouseMove(), r.currentTool.isBeyondDragSize() && (r.pd = 0), Zo(i, t)) }, r.pk = function (t) { var i; r.isEnabled && (r.Vf = !0, r.le ? t.preventDefault() : ((i = Uo(r, t, !0)).down = !0, i.clickCount = t.detail, (D || F) && (t.timeStamp - r.Aj < r.Ws && !r.currentTool.isBeyondDragSize() ? r.pd++ : r.pd = 1, r.Aj = t.timeStamp, i.clickCount = r.pd), i.clone(r.firstInput), r.doMouseDown(), 1 === t.button ? t.preventDefault() : Zo(i, t))) }, r.sk = function (t) { var i; r.isEnabled && (r.le && 2 === t.button ? t.preventDefault() : (r.le && 0 === t.button && (r.le = !1), r.Pj ? t.preventDefault() : (r.Vf = !0, (i = Uo(r, t, !0)).up = !0, i.clickCount = t.detail, (D || F) && (i.clickCount = r.pd), i.bubbles = t.bubbles, i.targetDiagram = Ko(t), r.doMouseUp(), r.Bf(), Zo(i, t)))) }, r.tk = function (t) { var i, e, n; r.isEnabled && ((i = Uo(r, t, !0)).bubbles = !0, n = e = 0, void (i.delta = 0) !== t.deltaX ? (0 !== t.deltaX && (e = 0 < t.deltaX ? 1 : -1), 0 !== t.deltaY && (n = 0 < t.deltaY ? 1 : -1), i.delta = Math.abs(t.deltaX) > Math.abs(t.deltaY) ? -e : -n) : void 0 !== t.wheelDeltaX ? (0 !== t.wheelDeltaX && (e = 0 < t.wheelDeltaX ? -1 : 1), 0 !== t.wheelDeltaY && (n = 0 < t.wheelDeltaY ? -1 : 1), i.delta = Math.abs(t.wheelDeltaX) > Math.abs(t.wheelDeltaY) ? -e : -n) : void 0 !== t.wheelDelta && 0 !== t.wheelDelta && (i.delta = 0 < t.wheelDelta ? 1 : -1), r.doMouseWheel(), Zo(i, t)) }, r.rk = function (t) { r.isEnabled && (r.Vf = !1, Uo(r, t, !0), (t = r.currentTool).cancelWaitAfter(), t.standardMouseOver()) }, r.sw = function (t) { var i, e, n, o; r.isEnabled && (r.Pj = !1, r.le = !0, i = Ho(r, t, t.targetTouches[0], 1 < t.touches.length), n = null, 0 < t.targetTouches.length ? n = t.targetTouches[0] : 0 < t.changedTouches.length && (n = t.changedTouches[0]), null !== n && (e = n.screenX, n = n.screenY, o = r.mo, t.timeStamp - r.Aj < r.Ws && !(25 < Math.abs(o.x - e) || 25 < Math.abs(o.y - n)) ? r.pd++ : r.pd = 1, i.clickCount = r.pd, r.Aj = t.timeStamp, r.mo.h(e, n)), r.doMouseDown(), Zo(i, t)) }, r.rw = function (t) { var i; r.isEnabled && (i = null, 0 < t.targetTouches.length ? i = t.targetTouches[0] : 0 < t.changedTouches.length && (i = t.changedTouches[0]), i = Wo(r, t, i, 1 < t.touches.length), r.doMouseMove(), Zo(i, t)) }, r.qw = function (t) { var i, e, n; r.isEnabled && (r.Pj ? t.preventDefault() : 1 < t.touches.length || (e = i = null, 0 < t.targetTouches.length ? e = t.targetTouches[0] : 0 < t.changedTouches.length && (e = t.changedTouches[0]), n = Jo(r, t, !1, !0, !1, !1), null !== e && (null !== (i = c.document.elementFromPoint(e.clientX, e.clientY)) && i.B instanceof Lo && i.B !== r && $o(i.B, e, n), $o(r, e, n), n.clickCount = r.pd), null === i ? n.targetDiagram = Ko(t) : i.B ? n.targetDiagram = i.B : n.targetDiagram = null, n.targetObject = null, r.doMouseUp(), Zo(n, t), r.le = !1)) }, r.sm = function (t) { if (r.isEnabled) { r.Vf = !0; var i = r.us; void 0 === i[t.pointerId] && (i[t.pointerId] = t); var e = !1; if (null !== (i = r.Kj)[0] && i[0].pointerId === t.pointerId) i[0] = t; else if (null !== i[1] && i[1].pointerId === t.pointerId) i[1] = t, e = !0; else if (null === i[0]) i[0] = t; else { if (null !== i[1]) return void t.preventDefault(); i[1] = t, e = !0 } "touch" !== t.pointerType && "pen" !== t.pointerType || (r.Pj = !1, r.le = !0), i = Ho(r, t, t, e), e = r.mo; var n = "touch" === t.pointerType || "pen" === t.pointerType ? 25 : 10; t.timeStamp - r.Aj < r.Ws && !(Math.abs(e.x - t.screenX) > n || Math.abs(e.y - t.screenY) > n) ? r.pd++ : r.pd = 1, i.clickCount = r.pd, r.Aj = t.timeStamp, r.mo.Cg(t.screenX, t.screenY), r.doMouseDown(), 1 === t.button ? t.preventDefault() : Zo(i, t) } }, r.tm = function (t) { if (r.isEnabled) { r.Vf = !0; var i = r.Kj; if (null !== i[0] && i[0].pointerId === t.pointerId) i[0] = t; else { if (null !== i[1] && i[1].pointerId === t.pointerId) return void (i[1] = t); if (null !== i[0]) return; i[0] = t } i[0].pointerId === t.pointerId && ((i = Wo(r, t, t, null !== i[1])).targetDiagram = Ko(t), r.doMouseMove(), Zo(i, t)) } }, r.vm = function (t) { var i, e, n; r.isEnabled && (r.Vf = !0, i = "touch" === t.pointerType || "pen" === t.pointerType, e = r.us, i && r.Pj ? (delete e[t.pointerId], t.preventDefault()) : null !== (e = r.Kj)[0] && e[0].pointerId === t.pointerId ? (e[0] = null, e = Jo(r, t, !1, !0, !0, !1), null !== (n = c.document.elementFromPoint(t.clientX, t.clientY)) && n.B instanceof Lo && n.B !== r && $o(n.B, t, e), $o(r, t, e), e.clickCount = r.pd, null === n ? e.targetDiagram = Ko(t) : n.B ? e.targetDiagram = n.B : e.targetDiagram = null, e.targetObject = null, r.doMouseUp(), Zo(e, t), i && (r.le = !1)) : null !== e[1] && e[1].pointerId === t.pointerId && (e[1] = null)) }, r.um = function (t) { var i; r.isEnabled && (r.Vf = !1, (i = r.us)[t.pointerId] && delete i[t.pointerId], null !== (i = r.Kj)[0] && i[0].pointerId === t.pointerId && (i[0] = null), null !== i[1] && i[1].pointerId === t.pointerId && (i[1] = null), "touch" !== t.pointerType && "pen" !== t.pointerType && ((t = r.currentTool).cancelWaitAfter(), t.standardMouseOver())) }, t.sc(!0), (n = (o = r).sa.Ea) instanceof HTMLCanvasElement && (o.Vm ? (o.addEventListener(n, "pointerdown", o.sm, !1), o.addEventListener(n, "pointermove", o.tm, !1), o.addEventListener(n, "pointerup", o.vm, !1), o.addEventListener(n, "pointerout", o.um, !1)) : (o.addEventListener(n, "touchstart", o.sw, !1), o.addEventListener(n, "touchmove", o.rw, !1), o.addEventListener(n, "touchend", o.qw, !1), o.addEventListener(n, "mousemove", o.qk, !1), o.addEventListener(n, "mousedown", o.pk, !1), o.addEventListener(n, "mouseup", o.sk, !1), o.addEventListener(n, "mouseout", o.rk, !1)), o.addEventListener(n, "mouseenter", o.fz, !1), o.addEventListener(n, "mouseleave", o.gz, !1), o.addEventListener(n, "wheel", o.tk, !1), o.addEventListener(n, "keydown", o.Xz, !1), o.addEventListener(n, "keyup", o.Yz, !1), o.addEventListener(n, "blur", o.Ty, !1), o.addEventListener(n, "focus", o.Uy, !1), o.addEventListener(n, "selectstart", function (t) { return t.preventDefault(), !1 }, !1), o.addEventListener(n, "contextmenu", function (t) { return t.preventDefault(), !1 }, !1), o.addEventListener(n, "gesturestart", function (t) { o.toolManager.gestureBehavior !== Oe && (o.toolManager.gestureBehavior === Fe ? t.preventDefault() : o.le && o.lastInput.handled || (t.preventDefault(), o.Bl = o.scale, o.currentTool.doCancel())) }, !1), o.addEventListener(n, "gesturechange", function (t) { var i, e, n; o.toolManager.gestureBehavior !== Oe && (o.toolManager.gestureBehavior === Fe ? t.preventDefault() : o.le && o.lastInput.handled || (t.preventDefault(), i = t.scale, null !== o.Bl && (e = o.sa.getBoundingClientRect(), t = new gi(t.pageX - window.scrollX - o.wa / e.width * e.left, t.pageY - window.scrollY - o.va / e.height * e.top), i = o.Bl * i, e = o.commandHandler, i !== o.scale && e.canResetZoom(i) && (n = o.zoomPoint, o.zoomPoint = t, e.resetZoom(i), o.zoomPoint = n)))) }, !1), o.addEventListener(c, "resize", o.yw, !1))) } function Ns(t) { this.l = void 0 === t ? new gi : t, this.u = new gi } function Cs(t, i, e) { this.node = t, this.info = i, this.Fv = e } function Ts() { this.reset() } function Ls(t) { 1 < arguments.length && B("Palette constructor can only take one optional argument, the DIV HTML element or its id."), Lo.call(this, t), As(this) } function As(t) { t.allowDragOut = !0, t.allowMove = !1, t.isReadOnly = !0, t.contentAlignment = vi, t.layout = new Hc } function js(t) { 1 < arguments.length && B("Overview constructor can only take one optional argument, the DIV HTML element or its id."), Lo.call(this, t); var n = this; this.animationManager.isEnabled = !1, this.Rb = !0, this.Ha = null, this.cl = this.bl = !1, this.u = this.I = !0, this.ab = 0, this.W = !1, this.Ll = null, this.ny("drawShadows", !1); var i = new Hl, e = new Kh; e.stroke = "magenta", e.strokeWidth = 2, e.fill = "transparent", e.name = "BOXSHAPE", i.selectable = !0, i.selectionAdorned = !1, i.selectionObjectName = "BOXSHAPE", i.locationObjectName = "BOXSHAPE", i.resizeObjectName = "BOXSHAPE", i.cursor = "move", i.add(e), this.l = i, this.allowDelete = this.allowCopy = !1, this.allowSelect = !0, this.autoScrollRegion = new Xt(0, 0, 0, 0), this.ma.h(0, 0), this.toolManager.Wa("Dragging", new Bs, this.toolManager.mouseMoveTools), this.click = function () { var t, i, e = n.observed; null !== e && (t = e.viewportBounds, i = n.lastInput.documentPoint, e.position = new gi(i.x - t.width / 2, i.y - t.height / 2)) }, this.Oh = function () { n.Na(), Os(n) }, this.Df = function () { null !== n.observed && (n.Na(), n.M()) }, this.Lh = function () { n.updateDelay < 1 ? n.M() : n.W || (n.W = !0, setTimeout(function () { n.W = !1, Ds(n), n.M() }, n.updateDelay)) }, this.Zc = function () { null !== n.observed && Os(n) }, this.autoScale = ss, this.Rb = !1 } function Ds(t) { var i, e = t.sa, n = t.Eb; if (null !== e && null !== n) { hr(t), null === t.Ll && ((i = new Pa(null)).width = e.width, i.height = e.height, t.Ll = i); try { t.sa = t.Ll, t.Eb = t.sa.context, t.Eb.sc(!0), t.Eb.setTransform(1, 0, 0, 1, 0, 0), t.Eb.clearRect(0, 0, t.sa.width, t.sa.height), Fs(t) } finally { t.sa = e, t.Eb = n } } } function Fs(t) { var i = t.observed; if (null !== i) { var e = t.drawsTemporaryLayers, n = t.drawsGrid && e, o = i.grid; n && null !== o && o.visible && !isNaN(o.width) && !isNaN(o.height) && (wr(i, o = yi.alloc().assign(t.viewportBounds).Hc(i.viewportBounds)), yi.free(o), ir(i)); var r = t.mb; r.reset(), 1 !== t.scale && r.scale(t.scale), 0 === t.position.x && 0 === t.position.y || r.translate(-t.position.x, -t.position.y), (o = t.Eb).scale(t.Sb, t.Sb), o.transform(r.m11, r.m12, r.m21, r.m22, r.dx, r.dy), r = (i = i.Ja.j).length; for (var s = 0; s < r; s++) { var a = i[s], h = t; if (a.visible && 0 !== a.opacity) { var l = a.diagram.grid.part; if (!e && a.isTemporary) n && l.layer === a && (a = Co(a, o), l.bc(o, h), o.globalAlpha = a); else { for (var u = Co(a, o), c = h.scale, f = yi.alloc(), d = a.Ca.j, p = d.length, g = 0; g < p; g++) { var y = d[g]; !n && y === l || a.Pi(o, y, h, null, c, f) } yi.free(f), o.globalAlpha = u } } } } } function Os(t) { var i, e, n, o = t.box; null === o || null !== (i = t.observed) && (t.Ac = !0, i = i.viewportBounds, e = o.selectionObject, (n = Yi.alloc()).h(i.width, i.height), e.desiredSize = n, Yi.free(n), t = 2 / t.scale, e instanceof Kh && (e.strokeWidth = t), o.location = new gi(i.x - t / 2, i.y - t / 2), o.isSelected = !0) } function Bs() { Be.call(this), this.l = null } function Is() { Q(this), this.B = Qr, this.ab = this.I = this.u = !0, this.W = this.Ha = this.kd = this.Ia = !1, this.yi = this.l = null, this.Zc = 1.05, this.Fu = NaN, this.Yw = null, this.fv = NaN, this.ev = Vt, this.mg = null, this.Ic = 200 } function Rs(t) { var i = zi(); for (t = t.iterator; t.next();) { var e = t.value; e instanceof Fu || i.push(e) } t = new $, e = i.length; for (var n = 0; n < e; n++) { for (var o = i[n], r = !0, s = 0; s < e; s++)if (o.Xd(i[s])) { r = !1; break } r && t.add(o) } return Vi(i), t } function Es() { Q(this), this.F = 4225027, this.rb = 1, this.kg = null, this.Qa = "", this.dc = this.ib = null, this.ma = new gi(NaN, NaN).freeze(), this.Lc = wt, this.bg = gt, this.ag = bt, this.mb = new Gi, this.Qh = new Gi, this.Zf = new Gi, this.ya = this.Wk = 1, this.Yb = 0, this.xe = Ur, this.bh = ji, this.nc = new yi(NaN, NaN, NaN, NaN).freeze(), this.vb = new yi(NaN, NaN, NaN, NaN).freeze(), this.oc = new yi(0, 0, NaN, NaN).freeze(), this.O = this.ep = this.fp = null, this.Fk = this.wb = bi, this.qp = 0, this.rp = 1, this.Lg = 0, this.gn = 1, this.Lp = null, this.yp = -1 / 0, this.Gl = 0, this.Hl = kt, this.Il = ec, this.fi = "", this.bb = this.N = null, this.Jk = -1, this.Kl = this.md = this.ei = this.Ol = null, this.xs = Xr, this.tp = this.Hg = this.Jj = null } function zs(t) { null === t.N && (t.N = new ga) } function Vs(t, i, e) { var n = t.Ui(); if (null !== n) for (var o = t.bb.iterator; o.next();) { var r = o.value, s = null; if (null !== r.sourceName) { if (null === (s = Zf(r, n, t))) continue; r.Rq(t, s, e, null) } else if (r.isToModel) { var a = i.diagram; null === a || a.skipsModelSourceBindings || r.Rq(t, a.model.modelData, e, n) } else { if (null === (a = n.data)) continue; var h = i.diagram; null === h || h.skipsModelSourceBindings || r.Rq(t, a, e, n) } s === t && (null !== (a = n.kt(r.gj)) && r.ww(a, s, e)) } } function Ys(t, i, e, n, o) { var r = t.nc, s = t.Zf; s.reset(), Hs(t, s, i, e, n, o), t.Zf = s, r.h(i, e, n, o), s.wt() || s.tw(r) } function Gs(t, i, e, n) { return !1 !== t.pickable && (n.multiply(t.transform), e ? t.Gc(i, n) : t.Dh(i, n)) } function Xs(t, i, e, n, o) { if (t.vb.h(i, e, n, o), !t.desiredSize.v()) { var r = t.nc; i = (e = t.bh).right + e.left; var s = e.top + e.bottom; switch (e = r.width + i, r = r.height + s, n += i, o += s, i = Js(t, !0), e === n && r === o && (i = Xr), i) { case Xr: (n < e || o < r) && (oa(t, !0), t.measure(n < e ? n : e, o < r ? o : r, 0, 0)); break; case Gr: oa(t, !0), t.measure(n, o, 0, 0); break; case Kr: oa(t, !0), t.measure(n, r, 0, 0); break; case Hr: oa(t, !0), t.measure(e, o, 0, 0) } } } function qs(t, i, e) { var n = t.vb, o = t.oc; null !== t.dc && (Us(t, i, t.dc, !0, !0, o, n), t.dc instanceof La && t.dc.type === Ua ? (i.beginPath(), i.rect(n.x, n.y, n.width, n.height), i.Vd(t.dc)) : i.fillRect(n.x, n.y, n.width, n.height)), null !== t.ib && (Us(t, i, t.ib, !0, !1, o, n), t.ib instanceof La && t.ib.type === Ua ? (i.beginPath(), i.rect(n.x, n.y, n.width, n.height), i.Vd(t.ib)) : i.fillRect(n.x, n.y, n.width, n.height)), t.Qi(i, e) } function Us(t, i, e, n, o, r, s) { if (null !== e) { var a = 1, h = 1; if ("string" == typeof e) n ? i.fillStyle = e : i.strokeStyle = e; else if (e.type === Xa) n ? i.fillStyle = e.color : i.strokeStyle = e.color; else { if (a = r.width, h = r.height, o && (a = s.width, h = s.height), (r = i instanceof Na) && e.ee && (e.type === Ka || e.Mk === a && e.du === h)) var l = e.ee; else { var u, c = 0, f = 0, d = 0, p = 0, g = 0, y = 0, y = g = 0; if (o && (g = s.x, y = s.y), c = e.start.x * a + e.start.offsetX, f = e.start.y * h + e.start.offsetY, d = e.end.x * a + e.end.offsetX, p = e.end.y * h + e.end.offsetY, c += g, d += g, f += y, p += y, e.type === qa) l = i.createLinearGradient(c, f, d, p); else if (e.type === Ua) y = isNaN(e.endRadius) ? Math.max(a, h) / 2 : e.endRadius, isNaN(e.startRadius) ? (g = 0, y = Math.max(a, h) / 2) : g = e.startRadius, l = i.createRadialGradient(c, f, g, d, p, y); else if (e.type === Ka) try { l = i.createPattern(e.pattern, "repeat") } catch (t) { l = null } if (e.type !== Ka && null !== (o = e.colorStops)) for (o = o.iterator; o.next();)l.addColorStop(o.key, o.value); r && (null !== (e.ee = l) && (e.Mk = a, e.du = h), null === l && e.type === Ka && -1 !== e.Mk) && (e.Mk = -1, null !== (u = t.diagram) && -1 === e.Mk && m(function () { u.Zd() }, 600)) } n ? i.fillStyle = l : i.strokeStyle = l } } } function Ks(t) { if (0 != (2048 & t.F) == !0) { var i, e = t.mb; if (e.reset(), !t.vb.v() || !t.nc.v()) return void ia(t, !1); e.translate(t.vb.x - t.nc.x, t.vb.y - t.nc.y), 1 === t.scale && 0 === t.angle || Hs(t, e, (i = t.naturalBounds).x, i.y, i.width, i.height), ia(t, !1), ea(t, !0) } 0 != (4096 & t.F) == !0 && (null === (e = t.panel) ? (t.Qh.set(t.mb), t.Wk = t.scale, ea(t, !1)) : null !== e.wd && ((i = t.Qh).reset(), e.be() ? i.multiply(e.Qh) : null !== e.panel && i.multiply(e.panel.Qh), i.multiply(t.mb), t.Wk = t.scale * e.Wk, ea(t, !1))) } function Hs(t, i, e, n, o, r) { if (1 !== t.scale && i.scale(t.scale), 0 !== t.Yb) { var s = Zt; t.xf() && t.locationSpot.gb() && (s = t.locationSpot); var a = gi.alloc(); if (t instanceof Hl && t.locationObject !== t) for (n = (e = t.locationObject).naturalBounds, a.xk(n.x, n.y, n.width, n.height, s), e.Zf.ra(a), a.offset(-e.measuredBounds.x, -e.measuredBounds.y), s = e.panel; null !== s && s !== t;)s.Zf.ra(a), a.offset(-s.measuredBounds.x, -s.measuredBounds.y), s = s.panel; else a.xk(e, n, o, r, s); i.rotate(t.Yb, a.x, a.y), gi.free(a) } } function Ws(t) { var i; !1 === ra(t) && (null !== (i = t.panel) ? i.o() : !t.xf() || null !== (i = t.diagram) && (i.od.add(t), t instanceof pu && t.fd(), i.Pb()), sa(t, !0)) } function Js(t, i) { var e = t.stretch, n = t.panel; return null !== n && n.type === xh.Table ? Zs(t, n.getRowDefinition(t.row), n.getColumnDefinition(t.column), i) : null !== n && n.type === xh.Auto && n.Ab() === t ? $s(t, Gr, i) : e === Ur ? null !== n ? n.type === xh.Spot && n.Ab() === t ? $s(t, Gr, i) : $s(t, (e = n.defaultStretch) === Ur ? Xr : e, i) : $s(t, Xr, i) : $s(t, e, i) } function Zs(t, i, e, n) { var o = t.stretch; if (o !== Ur) return $s(t, o, n); var r = o = null; switch (i.stretch) { case Hr: r = !0; break; case Gr: r = !0 }switch (e.stretch) { case Kr: o = !0; break; case Gr: o = !0 }return i = t.panel.defaultStretch, null === o && (o = i === Kr || i === Gr), null === r && (r = i === Hr || i === Gr), $s(t, !0 === o && !0 === r ? Gr : !0 === o ? Kr : !0 === r ? Hr : Xr, n) } function $s(t, i, e) { if (e) return i; if (i === Xr) return Xr; if ((e = t.desiredSize).v()) return Xr; if (t = t.angle, !isNaN(e.width)) if (90 !== t && 270 !== t) { if (i === Kr) return Xr; if (i === Gr) return Hr } else { if (i === Hr) return Xr; if (i === Gr) return Kr } if (!isNaN(e.height)) if (90 !== t && 270 !== t) { if (i === Hr) return Xr; if (i === Gr) return Kr } else { if (i === Kr) return Xr; if (i === Gr) return Hr } return i } function Qs(t, i) { t.F = i ? 512 | t.F : -513 & t.F } function _s(t) { return 0 != (1024 & t.F) } function ta(t, i) { t.F = i ? 1024 | t.F : -1025 & t.F } function ia(t, i) { t.F = i ? 2048 | t.F : -2049 & t.F } function ea(t, i) { t.F = i ? 4096 | t.F : -4097 & t.F } function na(t) { return 0 != (8192 & t.F) } function oa(t, i) { t.F = i ? 8192 | t.F : -8193 & t.F } function ra(t) { return 0 != (16384 & t.F) } function sa(t, i) { t.F = i ? 16384 | t.F : -16385 & t.F } function aa(t) { var i, e = t.part; e instanceof pu && (null !== t.portId || t === e.port) && (null === (i = e.diagram) || i.undoManager.isUndoingRedoing || mu(e, t)) } function ha(t) { var i = t.diagram; null === i || i.undoManager.isUndoingRedoing || (t instanceof xh ? t instanceof pu ? t.fd() : t.Jm(t, function (t) { aa(t) }) : aa(t)) } function la(t, i) { null === (i.cd = t).Hg && (t.Hg = new at), t.Hg.add(i.propertyName, i) } function ua(t, i) { for (var e = 1; e < arguments.length; ++e); e = arguments; var n, o, r = null, s = null; for ("function" == typeof t ? s = t : "string" == typeof t && ("function" == typeof (n = pa.H(t)) ? b(r = n(e = k(arguments))) || B('GraphObject.make invoked object builder "' + t + '", but it did not return an Object') : s = c.go[t]), null === r && (null != s && s.constructor || B("GraphObject.make requires a class function or GoJS class name or name of an object builder, not: " + t), r = new s), s = 1, r instanceof Lo && 1 < e.length && (n = r, ("string" == typeof (o = e[1]) || o instanceof HTMLDivElement) && (Ps(n, o), s++)); s < e.length; s++)void 0 === (n = e[s]) ? B("Undefined value at argument " + s + " for object being constructed by GraphObject.make: " + r) : ca(r, n); return r } function ca(t, i) { var e, n; if ("string" == typeof i) t instanceof el ? t.text = i : t instanceof Kh ? t.figure = i : t instanceof Ll ? t.source = i : t instanceof xh ? null !== (i = Vh.H(i)) && (t.type = i) : t instanceof La ? null !== (e = Y(La, i)) ? t.type = e : B("Unknown Brush type as an argument to GraphObject.make: " + i) : t instanceof Ui ? null !== (i = Y(Ui, i)) && (t.type = i) : t instanceof ae && (null !== (i = Y(ae, i)) && (t.type = i)); else if (i instanceof Es) t instanceof xh || B("A GraphObject can only be added to a Panel, not to: " + t), t.add(i); else if (i instanceof Yh) { i.isRow && "function" == typeof t.getRowDefinition ? n = t.getRowDefinition(i.index) : i.isRow || "function" != typeof t.getColumnDefinition || (n = t.getColumnDefinition(i.index)), n instanceof Yh ? n.gt(i) : B("A RowColumnDefinition can only be added to an object that implements getRowDefinition/getColumnDefinition, not to: " + t) } else if (i instanceof V) "function" == typeof t.fb && t.fb(i); else if (i instanceof oh) t.type = i; else if (i instanceof Jf) t instanceof Es || t instanceof Yh ? t.bind(i) : B("A Binding can only be applied to a GraphObject or RowColumnDefinition, not to: " + t); else if (i instanceof ko) t instanceof Es ? la(t, i) : B("An AnimationTrigger can only be applied to a GraphObject, not to: " + t); else if (i instanceof se) t instanceof Ui ? t.figures.add(i) : B("A PathFigure can only be added to a Geometry, not to: " + t); else if (i instanceof ae) t instanceof se ? t.segments.add(i) : B("A PathSegment can only be added to a PathFigure, not to: " + t); else if (i instanceof Ic) t instanceof Lo || t instanceof Lu ? t.layout = i : B("A Layout can only be assigned to a Diagram or a Group, not to: " + t); else if (Array.isArray(i)) for (e = 0; e < i.length; e++)ca(t, i[e]); else if ("object" == typeof i && null !== i) if (t instanceof La) { for (var o in e = new X, i) n = parseFloat(o), isNaN(n) ? e[o] = i[o] : t.addColorStop(n, i[o]); rr(t, e) } else if (t instanceof Yh) { for (e in void 0 !== i.row ? ((null == (o = i.row) || 1 / 0 === o || isNaN(o) || o < 0) && B("Must specify non-negative integer row for RowColumnDefinition " + i + ", not: " + o), t.isRow = !0, t.index = o) : void 0 !== i.column && ((null == (o = i.column) || 1 / 0 === o || isNaN(o) || o < 0) && B("Must specify non-negative integer column for RowColumnDefinition " + i + ", not: " + o), t.isRow = !1, t.index = o), o = new X, i) "row" !== e && "column" !== e && (o[e] = i[e]); rr(t, o) } else rr(t, i); else B('Unknown initializer "' + i + '" for object being constructed by GraphObject.make: ' + t) } function fa(t, i) { pa.add(t, i) } function da(t, i, e) { void 0 === e && (e = null); var n = t[1]; if ("function" == typeof e ? e(n) : "string" == typeof n) return t.splice(1, 1), n; if (void 0 === i) throw Error("no " + ("function" == typeof e ? "satisfactory" : "string") + " argument for GraphObject builder " + t[0]); return i } Lo.className = "Diagram", Lo.fromDiv = function (t) { var i = t; return "string" == typeof t && (i = c.document.getElementById(t)), i instanceof HTMLDivElement && i.B instanceof Lo ? i.B : null }, Lo.inherit = function (t, i) { function e() { } if (Object.getPrototypeOf(t).prototype) throw Error("Used go.Diagram.inherit defining already defined class \n" + t); e.prototype = i.prototype, t.prototype = new e, t.prototype.constructor = t }, Lo.None = rs, Lo.Uniform = ss, Lo.UniformToFill = as, Lo.CycleAll = hs, Lo.CycleNotDirected = ls, Lo.CycleNotDirectedFast = us, Lo.CycleNotUndirected = cs, Lo.CycleDestinationTree = fs, Lo.CycleSourceTree = ds, Lo.DocumentScroll = ps, Lo.InfiniteScroll = gs, Lo.TreeParentCollapsed = ys, Lo.AllParentsCollapsed = ms, Lo.AnyParentsCollapsed = vs, Ms.className = "DiagramHelper", l.Object.defineProperties(Ns.prototype, { point: { get: function () { return this.l }, set: function (t) { this.l = t } }, shifted: { get: function () { return this.u }, set: function (t) { this.u = t } } }), Ns.className = "DraggingInfo", Cs.className = "DraggingNodeInfoPair", Ts.prototype.reset = function () { this.isGridSnapEnabled = !1, this.isGridSnapRealtime = !0, this.gridSnapCellSize = new Yi(NaN, NaN).freeze(), this.gridSnapCellSpot = Ht, this.gridSnapOrigin = new gi(NaN, NaN).freeze(), this.groupsSnapMembers = this.dragsTree = this.dragsLink = !1, this.groupsAlwaysMove = !0 }, Ts.className = "DraggingOptions", h(Ls, Lo), Ls.prototype.reset = function () { Lo.prototype.reset.call(this), As(this) }, Ls.className = "Palette", h(js, Lo), js.prototype.computePixelRatio = function () { return 1 }, js.prototype.bc = function () { if ((null === this.La && B("No div specified"), null === this.sa && B("No canvas specified"), !(this.sa instanceof va) && (Wl(this.box), this.Ac)) && (null !== (t = this.observed) && !t.animationManager.isAnimating)) { hr(this); var t, i = this.sa; (t = this.Eb).sc(!0), t.setTransform(1, 0, 0, 1, 0, 0), t.clearRect(0, 0, i.width, i.height), this.updateDelay < 1 ? Fs(this) : null !== this.Ll && (t.drawImage(this.Ll.Ea, 0, 0), (i = this.mb).reset(), 1 !== this.scale && i.scale(this.scale), 0 === this.position.x && 0 === this.position.y || i.translate(-this.position.x, -this.position.y), t.scale(this.Sb, this.Sb), t.transform(i.m11, i.m12, i.m21, i.m22, i.dx, i.dy)); for (var e = (i = this.Ja.j).length, n = 0; n < e; n++)i[n].bc(t, this); this.Ac = this.mi = !1 } }, js.prototype.computeBounds = function () { var t = this.observed; if (null === t) return Vt; var i = t.documentBounds.copy(); return i.Hc(t.viewportBounds), i }, js.prototype.Ux = function () { !0 !== this.Ac && (this.Ac = !0, this.Pb()) }, js.prototype.Cq = function (t, i, e, n) { this.Rb || (ar(this), this.M(), sr(this), this.Na(), Os(this), this.Sd.scale = e, this.Sd.position.x = t.x, this.Sd.position.y = t.y, this.Sd.bounds.assign(t), this.Sd.Nv = n, this.R("ViewportBoundsChanged", this.Sd, t)) }, l.Object.defineProperties(js.prototype, { observed: { get: function () { return this.Ha }, set: function (t) { var i, e, n = this.Ha; t instanceof js && B("Overview.observed Diagram may not be an Overview itself: " + t), n !== t && (null !== n && (this.remove(this.box), n.xm("ViewportBoundsChanged", this.Oh), n.xm("DocumentBoundsChanged", this.Df), n.xm("InvalidateDraw", this.Lh), n.xm("AnimationFinished", this.Zc)), null !== (this.Ha = t) && (t.Uj("ViewportBoundsChanged", this.Oh), t.Uj("DocumentBoundsChanged", this.Df), t.Uj("InvalidateDraw", this.Lh), t.Uj("AnimationFinished", this.Zc), this.add(this.box), Os(this)), this.Na(), null === t ? (this.Ll = null, i = this.sa, e = this.Eb, i && e && (e.setTransform(1, 0, 0, 1, 0, 0), e.clearRect(0, 0, i.width, i.height))) : (Ds(this), Os(this), this.M()), this.g("observed", n, t)) } }, box: { get: function () { return this.l }, set: function (t) { var i = this.l; i !== t && (this.l = t, this.remove(i), this.add(this.l), Os(this), this.g("box", i, t)) } }, drawsTemporaryLayers: { get: function () { return this.I }, set: function (t) { this.I !== t && (this.I = t, this.Zd()) } }, drawsGrid: { get: function () { return this.u }, set: function (t) { this.u !== t && (this.u = t, this.Zd()) } }, updateDelay: { get: function () { return this.ab }, set: function (t) { t < 0 && (t = 0), this.ab !== t && (this.ab = t) } } }), js.className = "Overview", h(Bs, Be), Bs.prototype.canStart = function () { if (!this.isEnabled) return !1; var t = this.diagram; if (null === t || !t.allowMove || !t.allowSelect) return !1; var i = t.observed; if (null === i) return !1; var e = t.lastInput; return !(!e.left || t.currentTool !== this && (!this.isBeyondDragSize() || e.isTouchEvent && e.timestamp - t.firstInput.timestamp < this.delay)) && (null === this.findDraggablePart() && (e = i.viewportBounds, this.l = new gi(e.width / 2, e.height / 2), t = t.firstInput.documentPoint, i.position = new gi(t.x - this.l.x, t.y - this.l.y)), !0) }, Bs.prototype.doActivate = function () { this.l = null, Be.prototype.doActivate.call(this) }, Bs.prototype.doUpdateCursor = function () { var t = this.diagram, i = t.box; null !== i && i.cursor && (t.currentCursor = i.cursor) }, Bs.prototype.moveParts = function () { var t, i, e = this.diagram, n = e.observed; null === n || null !== (i = e.box) && (null === this.l && (t = e.firstInput.documentPoint, i = i.location, this.l = new gi(t.x - i.x, t.y - i.y)), e = e.lastInput.documentPoint, n.position = new gi(e.x - this.l.x, e.y - this.l.y)) }, Bs.className = "OverviewDraggingTool", Is.prototype.toString = function () { return "CommandHandler" }, Is.prototype.$d = function (t) { this.B = t }, Is.prototype.doKeyDown = function () { var t = this.diagram, i = t.lastInput, e = I ? i.meta : i.control, n = i.shift, o = i.alt, r = i.key; !e || "C" !== r && "Insert" !== r ? e && "X" === r || n && "Del" === r ? this.canCutSelection() && this.cutSelection() : e && "V" === r || n && "Insert" === r ? this.canPasteSelection() && this.pasteSelection() : e && "Y" === r || o && n && "Backspace" === r ? this.canRedo() && this.redo() : e && "Z" === r || o && "Backspace" === r ? this.canUndo() && this.undo() : "Del" === r || "Backspace" === r ? this.canDeleteSelection() && this.deleteSelection() : e && "A" === r ? this.canSelectAll() && this.selectAll() : "Esc" === r ? this.canStopCommand() && this.stopCommand() : "Up" === r ? t.allowVerticalScroll && (e ? t.scroll("pixel", "up") : t.scroll("line", "up")) : "Down" === r ? t.allowVerticalScroll && (e ? t.scroll("pixel", "down") : t.scroll("line", "down")) : "Left" === r ? t.allowHorizontalScroll && (e ? t.scroll("pixel", "left") : t.scroll("line", "left")) : "Right" === r ? t.allowHorizontalScroll && (e ? t.scroll("pixel", "right") : t.scroll("line", "right")) : "PageUp" === r ? n && t.allowHorizontalScroll ? t.scroll("page", "left") : t.allowVerticalScroll && t.scroll("page", "up") : "PageDown" === r ? n && t.allowHorizontalScroll ? t.scroll("page", "right") : t.allowVerticalScroll && t.scroll("page", "down") : "Home" === r ? e && t.allowVerticalScroll ? t.scroll("document", "up") : !e && t.allowHorizontalScroll && t.scroll("document", "left") : "End" === r ? e && t.allowVerticalScroll ? t.scroll("document", "down") : !e && t.allowHorizontalScroll && t.scroll("document", "right") : " " === r ? this.canScrollToPart() && this.scrollToPart() : "Subtract" === r ? this.canDecreaseZoom() && this.decreaseZoom() : "Add" === r ? this.canIncreaseZoom() && this.increaseZoom() : e && "0" === r ? this.canResetZoom() && this.resetZoom() : n && "Z" === r ? this.canZoomToFit() && this.zoomToFit() : e && !n && "G" === r ? this.canGroupSelection() && this.groupSelection() : e && n && "G" === r ? this.canUngroupSelection() && this.ungroupSelection() : i.event && 113 === i.event.which ? this.canEditTextBlock() && this.editTextBlock() : i.event && 93 === i.event.which ? this.canShowContextMenu() && this.showContextMenu() : i.bubbles = !0 : this.canCopySelection() && this.copySelection() }, Is.prototype.doKeyUp = function () { this.diagram.lastInput.bubbles = !0 }, Is.prototype.stopCommand = function () { var t = this.diagram, i = t.currentTool; i instanceof Ce && t.allowSelect && t.clearSelection(), null !== i && i.doCancel() }, Is.prototype.canStopCommand = function () { return !0 }, Is.prototype.selectAll = function () { var t = this.diagram; t.M(); try { t.currentCursor = "wait", t.R("ChangingSelection", t.selection); for (var i = t.parts; i.next();)i.value.isSelected = !0; for (var e = t.nodes; e.next();)e.value.isSelected = !0; for (var n = t.links; n.next();)n.value.isSelected = !0 } finally { t.R("ChangedSelection", t.selection), t.currentCursor = "" } }, Is.prototype.canSelectAll = function () { return this.diagram.allowSelect }, Is.prototype.deleteSelection = function () { var t = this.diagram; try { t.currentCursor = "wait", t.R("ChangingSelection", t.selection), t.ua("Delete"), t.R("SelectionDeleting", t.selection); for (var i = new $, e = t.selection.iterator; e.next();)cu(i, e.value, !0, this.deletesTree ? 1 / 0 : 0, !!this.deletesConnectedLinks && null, function (t) { return t.canDelete() }); t.Lt(i, !0), t.R("SelectionDeleted", i) } finally { t.Va("Delete"), t.R("ChangedSelection", t.selection), t.currentCursor = "" } }, Is.prototype.canDeleteSelection = function () { var t = this.diagram; return !(t.isReadOnly || t.isModelReadOnly || !t.allowDelete || 0 === t.selection.count) }, Is.prototype.copySelection = function () { for (var t = this.diagram, i = new $, t = t.selection.iterator; t.next();)cu(i, t.value, !0, this.copiesTree ? 1 / 0 : 0, this.copiesConnectedLinks, function (t) { return t.canCopy() }); this.copyToClipboard(i) }, Is.prototype.canCopySelection = function () { var t = this.diagram; return !(!t.allowCopy || !t.allowClipboard || 0 === t.selection.count) }, Is.prototype.cutSelection = function () { this.copySelection(), this.deleteSelection() }, Is.prototype.canCutSelection = function () { var t = this.diagram; return !(t.isReadOnly || t.isModelReadOnly || !t.allowCopy || !t.allowDelete || !t.allowClipboard || 0 === t.selection.count) }, Is.prototype.copyToClipboard = function (t) { var i = this.diagram, e = null; if (null === t) ns = null, os = ""; else { e = i.model; var n = !1, o = !1, r = null; try { e.pm() && (n = e.bk, e.bk = this.copiesParentKey), e.ik() && (o = e.ak, e.ak = this.copiesGroupKey), r = i.ck(t, null, !0) } finally { e.pm() && (e.bk = n), e.ik() && (e.ak = o), (e = new J).addAll(r), ns = e, os = i.model.dataFormat } } i.R("ClipboardChanged", e) }, Is.prototype.pasteFromClipboard = function () { var t = new $, i = ns; if (null === i) return t; var e = this.diagram; if (os !== e.model.dataFormat) return t; var n = e.model, o = !1, r = !1, s = null; try { n.pm() && (o = n.bk, n.bk = this.copiesParentKey), n.ik() && (r = n.ak, n.ak = this.copiesGroupKey), s = e.ck(i, e, !1) } finally { for (n.pm() && (n.bk = o), n.ik() && (n.ak = r), i = s.iterator; i.next();)e = i.value, n = i.key, e.location.v() || (n.location.v() ? e.location = n.location : !e.position.v() && n.position.v() && (e.position = n.position)), t.add(e) } return t }, Is.prototype.pasteSelection = function (t) { void 0 === t && (t = null); var i = this.diagram; try { i.currentCursor = "wait", i.R("ChangingSelection", i.selection), i.ua("Paste"); var e = this.pasteFromClipboard(); 0 < e.count && i.clearSelection(!0); for (var n, o = e.iterator; o.next();)o.value.isSelected = !0; null === t || (n = i.computePartsBounds(i.selection)).v() && dr(i, this.computeEffectiveCollection(i.selection, i.Qk), new gi(t.x - n.centerX, t.y - n.centerY), i.Qk, !1), i.R("ClipboardPasted", e) } finally { i.Va("Paste"), i.R("ChangedSelection", i.selection), i.currentCursor = "" } }, Is.prototype.canPasteSelection = function () { var t = this.diagram; return !(t.isReadOnly || t.isModelReadOnly || !t.allowInsert || !t.allowClipboard || null === ns || 0 === ns.count || os !== t.model.dataFormat) }, Is.prototype.undo = function () { this.diagram.undoManager.undo() }, Is.prototype.canUndo = function () { var t = this.diagram; return !t.isReadOnly && !t.isModelReadOnly && (t.allowUndo && t.undoManager.canUndo()) }, Is.prototype.redo = function () { this.diagram.undoManager.redo() }, Is.prototype.canRedo = function () { var t = this.diagram; return !t.isReadOnly && !t.isModelReadOnly && (t.allowUndo && t.undoManager.canRedo()) }, Is.prototype.decreaseZoom = function (t) { void 0 === t && (t = 1 / this.zoomFactor); var i = this.diagram; i.autoScale === rs && ((t = i.scale * t) < i.minScale || t > i.maxScale || (i.scale = t)) }, Is.prototype.canDecreaseZoom = function (t) { void 0 === t && (t = 1 / this.zoomFactor); var i = this.diagram; return i.autoScale === rs && (!((t = i.scale * t) < i.minScale || t > i.maxScale) && i.allowZoom) }, Is.prototype.increaseZoom = function (t) { void 0 === t && (t = this.zoomFactor); var i = this.diagram; i.autoScale === rs && ((t = i.scale * t) < i.minScale || t > i.maxScale || (i.scale = t)) }, Is.prototype.canIncreaseZoom = function (t) { void 0 === t && (t = this.zoomFactor); var i = this.diagram; return i.autoScale === rs && (!((t = i.scale * t) < i.minScale || t > i.maxScale) && i.allowZoom) }, Is.prototype.resetZoom = function (t) { void 0 === t && (t = this.defaultScale); var i = this.diagram; t < i.minScale || t > i.maxScale || (i.scale = t) }, Is.prototype.canResetZoom = function (t) { void 0 === t && (t = this.defaultScale); var i = this.diagram; return !(t < i.minScale || t > i.maxScale) && i.allowZoom }, Is.prototype.zoomToFit = function () { var t = this.diagram, i = t.animationManager; i.Yc(), t.Zd(); var e = t.position, n = t.scale; Qn(i, "Zoom To Fit"), n === this.fv && !isNaN(this.Fu) && t.documentBounds.w(this.ev) ? (t.scale = this.Fu, t.position = this.Yw, this.fv = NaN, this.ev = Vt) : (this.Fu = n, this.Yw = e.copy(), t.zoomToFit(), this.fv = t.scale, this.ev = t.documentBounds.copy()), to(i) }, Is.prototype.canZoomToFit = function () { return this.diagram.allowZoom }, Is.prototype.scrollToPart = function (t) { void 0 === t && (t = null); var i, e, n, o, r, s, a = this.diagram; if (Cr(a), null === t) { try { null !== this.mg && (this.mg.next() ? t = this.mg.value : this.mg = null) } catch (t) { this.mg = null } null === t && (0 < a.highlighteds.count ? this.mg = a.highlighteds.iterator : 0 < a.selection.count && (this.mg = a.selection.iterator), null !== this.mg && this.mg.next() && (t = this.mg.value)) } null !== t && (Qn(i = a.animationManager, "Scroll To Part"), 0 < (e = this.scrollToPartPause) ? 1 === (n = function t(i, e, n) { if (e.isVisible()) return n; { var o; e instanceof du ? t(i, e.adornedPart, n) : e instanceof Fu ? (null !== (o = e.fromNode) && t(i, o, n), null !== (e = e.toNode) && t(i, e, n)) : (e instanceof pu && (null !== (o = e.labeledLink) && t(i, o, n), null !== (o = e.yg()) && (o.isTreeExpanded || o.wasTreeExpanded || n.push(o), t(i, o, n))), null !== (e = e.containingGroup) && (e.isSubGraphExpanded || e.wasSubGraphExpanded || n.push(e), t(i, e, n))) } return n }(this, t, [t])).length ? (a.ua(), a.et(t.actualBounds), a.Va("Scroll To Part")) : (o = function () { a.ua(); for (var t = n.pop(); 0 < n.length && t instanceof pu && t.isTreeExpanded && (!(t instanceof Lu) || t.isSubGraphExpanded);)t = n.pop(); 0 < n.length ? (t instanceof Hl && a.gw(t.actualBounds), t instanceof pu && !t.isTreeExpanded && (t.isTreeExpanded = !0), t instanceof Lu && !t.isSubGraphExpanded && (t.isSubGraphExpanded = !0)) : (t instanceof Hl && a.et(t.actualBounds), a.xm("LayoutCompleted", r)), a.Va("Scroll To Part") }, r = function () { m(o, (i.isEnabled ? i.duration : 0) + e) }, a.Uj("LayoutCompleted", r), o()) : (s = a.position.copy(), a.et(t.actualBounds), s.Ma(a.position) && i.Yc())) }, Is.prototype.canScrollToPart = function (t) { return void 0 === t && (t = null), (null === t || t instanceof Hl) && ((0 !== (t = this.diagram).selection.count || 0 !== t.highlighteds.count) && (t.allowHorizontalScroll && t.allowVerticalScroll)) }, Is.prototype.collapseTree = function (t) { void 0 === t && (t = null); var i = this.diagram; try { i.ua("Collapse Tree"), Qn(i.animationManager, "Collapse Tree"); var e = new J; if (null !== t && t.isTreeExpanded) t.collapseTree(), e.add(t); else if (null === t) for (var n = i.selection.iterator; n.next();) { var o = n.value; o instanceof pu && o.isTreeExpanded && (o.collapseTree(), e.add(o)) } i.R("TreeCollapsed", e) } finally { i.Va("Collapse Tree") } }, Is.prototype.canCollapseTree = function (t) { void 0 === t && (t = null); var i = this.diagram; if (i.isReadOnly) return !1; if (null !== t) { if (!(t instanceof pu && t.isTreeExpanded)) return !1; if (0 < t.oq().count) return !0 } else for (t = i.selection.iterator; t.next();)if ((i = t.value) instanceof pu && i.isTreeExpanded && 0 < i.oq().count) return !0; return !1 }, Is.prototype.expandTree = function (t) { void 0 === t && (t = null); var i = this.diagram; try { i.ua("Expand Tree"), Qn(i.animationManager, "Expand Tree"); var e = new J; if (null === t || t.isTreeExpanded) { if (null === t) for (var n = i.selection.iterator; n.next();) { var o = n.value; o instanceof pu && !o.isTreeExpanded && (o.expandTree(), e.add(o)) } } else t.expandTree(), e.add(t); i.R("TreeExpanded", e) } finally { i.Va("Expand Tree") } }, Is.prototype.canExpandTree = function (t) { void 0 === t && (t = null); var i = this.diagram; if (i.isReadOnly) return !1; if (null !== t) { if (!(t instanceof pu) || t.isTreeExpanded) return !1; if (0 < t.oq().count) return !0 } else for (t = i.selection.iterator; t.next();)if ((i = t.value) instanceof pu && !i.isTreeExpanded && 0 < i.oq().count) return !0; return !1 }, Is.prototype.groupSelection = function () { var t = this.diagram, i = t.model; if (i.jk()) { var e = this.archetypeGroupData; if (null !== e) { var n = null; try { t.currentCursor = "wait", t.R("ChangingSelection", t.selection), t.ua("Group"); for (var o = new J, r = t.selection.iterator; r.next();) { var s = r.value; s.Wb() && s.canGroup() && o.add(s) } for (var a = new J, h = o.iterator; h.next();) { for (var l = h.value, r = !1, u = o.iterator; u.next();)if (l.Xd(u.value)) { r = !0; break } r || a.add(l) } if (0 < a.count) { var c, f = a.first().containingGroup; if (null !== f) for (; null !== f;) { o = !1; for (var d = a.iterator; d.next();)if (!d.value.Xd(f)) { o = !0; break } if (!o) break; f = f.containingGroup } if (e instanceof Lu ? (Dh(e), null !== (n = e.copy()) && t.add(n)) : !i.Lv(e) || b(c = i.copyNodeData(e)) && (i.pf(c), n = t.Si(c)), null !== n) { null !== f && this.isValidMember(f, n) && (n.containingGroup = f); for (var p = a.iterator; p.next();) { var g = p.value; this.isValidMember(n, g) && (g.containingGroup = n) } t.clearSelection(!0), n.isSelected = !0 } } t.R("SelectionGrouped", n) } finally { t.Va("Group"), t.R("ChangedSelection", t.selection), t.currentCursor = "" } } } }, Is.prototype.canGroupSelection = function () { var t = this.diagram; if (t.isReadOnly || t.isModelReadOnly || !t.allowInsert || !t.allowGroup || !t.model.jk() || null === this.archetypeGroupData) return !1; for (t = t.selection.iterator; t.next();) { var i = t.value; if (i.Wb() && i.canGroup()) return !0 } return !1 }, Is.prototype.isValidMember = function (t, i) { if (null === i || t === i || i instanceof Fu) return !1; if (null !== t) { if (t === i || t.Xd(i)) return !1; var e = t.memberValidation; if (null !== e && !e(t, i) || null === t.data && null !== i.data || null !== t.data && null === i.data) return !1 } return null === (e = this.memberValidation) || e(t, i) }, Is.prototype.ungroupSelection = function (t) { void 0 === t && (t = null); var i = this.diagram, e = i.model; if (e.jk()) try { i.currentCursor = "wait", i.R("ChangingSelection", i.selection), i.ua("Ungroup"); var n = new J; if (null !== t) n.add(t); else for (var o = i.selection.iterator; o.next();) { var r = o.value; r instanceof Lu && r.canUngroup() && n.add(r) } var s = new J; if (0 < n.count) { i.clearSelection(!0); for (var a = n.iterator; a.next();) { var h = a.value; h.expandSubGraph(); var l = h.containingGroup, u = null !== l && null !== l.data ? e.ja(l.data) : void 0; s.addAll(h.memberParts); for (var c = s.iterator; c.next();) { var f, d = c.value; d.isSelected = !0, d instanceof Fu || (null !== (f = d.data) ? e.Ot(f, u) : d.containingGroup = l) } i.remove(h) } } i.R("SelectionUngrouped", n, s) } finally { i.Va("Ungroup"), i.R("ChangedSelection", i.selection), i.currentCursor = "" } }, Is.prototype.canUngroupSelection = function (t) { void 0 === t && (t = null); var i = this.diagram; if (i.isReadOnly || i.isModelReadOnly || !i.allowDelete || !i.allowUngroup || !i.model.jk()) return !1; if (null !== t) { if (!(t instanceof Lu)) return !1; if (t.canUngroup()) return !0 } else for (t = i.selection.iterator; t.next();)if ((i = t.value) instanceof Lu && i.canUngroup()) return !0; return !1 }, Is.prototype.addTopLevelParts = function (t, i) { var e = !0; for (t = Rs(t).iterator; t.next();) { var n = t.value; null !== n.containingGroup && (!i || this.isValidMember(null, n) ? n.containingGroup = null : e = !1) } return e }, Is.prototype.collapseSubGraph = function (t) { void 0 === t && (t = null); var i = this.diagram; try { i.ua("Collapse SubGraph"), Qn(i.animationManager, "Collapse SubGraph"); var e = new J; if (null !== t && t.isSubGraphExpanded) t.collapseSubGraph(), e.add(t); else if (null === t) for (var n = i.selection.iterator; n.next();) { var o = n.value; o instanceof Lu && o.isSubGraphExpanded && (o.collapseSubGraph(), e.add(o)) } i.R("SubGraphCollapsed", e) } finally { i.Va("Collapse SubGraph") } }, Is.prototype.canCollapseSubGraph = function (t) { void 0 === t && (t = null); var i = this.diagram; if (i.isReadOnly) return !1; if (null !== t) return !!(t instanceof Lu && t.isSubGraphExpanded); for (t = i.selection.iterator; t.next();)if ((i = t.value) instanceof Lu && i.isSubGraphExpanded) return !0; return !1 }, Is.prototype.expandSubGraph = function (t) { void 0 === t && (t = null); var i = this.diagram; try { i.ua("Expand SubGraph"), Qn(i.animationManager, "Expand SubGraph"); var e = new J; if (null === t || t.isSubGraphExpanded) { if (null === t) for (var n = i.selection.iterator; n.next();) { var o = n.value; o instanceof Lu && !o.isSubGraphExpanded && (o.expandSubGraph(), e.add(o)) } } else t.expandSubGraph(), e.add(t); i.R("SubGraphExpanded", e) } finally { i.Va("Expand SubGraph") } }, Is.prototype.canExpandSubGraph = function (t) { void 0 === t && (t = null); var i = this.diagram; if (i.isReadOnly) return !1; if (null !== t) return t instanceof Lu && !t.isSubGraphExpanded; for (t = i.selection.iterator; t.next();)if ((i = t.value) instanceof Lu && !i.isSubGraphExpanded) return !0; return !1 }, Is.prototype.editTextBlock = function (t) { void 0 === t && (t = null); var i = this.diagram, e = i.toolManager.findTool("TextEditing"); if (null !== e) { if (null === t) { t = null; for (var n = i.selection.iterator; n.next();) { var o = n.value; if (o.canEdit()) { t = o; break } } if (null === t) return; t = t.gm(function (t) { return t instanceof el && t.editable }) } null !== t && (i.currentTool = null, e.textBlock = t, i.currentTool = e) } }, Is.prototype.canEditTextBlock = function (t) { void 0 === t && (t = null); var i = this.diagram; if (i.isReadOnly || i.isModelReadOnly || !i.allowTextEdit || null === i.toolManager.findTool("TextEditing")) return !1; if (null !== t) { if (!(t instanceof el)) return !1; if (null !== (t = t.part) && t.canEdit()) return !0 } else for (i = i.selection.iterator; i.next();)if ((t = i.value).canEdit() && null !== (t = t.gm(function (t) { return t instanceof el && t.editable }))) return !0; return !1 }, Is.prototype.showContextMenu = function (t) { var i, e, n = this.diagram, o = n.toolManager.findTool("ContextMenu"); null !== o && (void 0 === t && (t = 0 < n.selection.count ? n.selection.first() : n), null !== (t = o.findObjectWithContextMenu(t))) && (i = n.lastInput, e = null, t instanceof Es ? e = t.ga(Zt) : n.viewportBounds.aa(i.documentPoint) || (e = new gi((e = n.viewportBounds).x + e.width / 2, e.y + e.height / 2)), null !== e && (i.viewPoint = n.Oq(e), i.documentPoint = e, i.left = !1, i.right = !0, i.up = !0), An(n.currentTool = o, !1, t)) }, Is.prototype.canShowContextMenu = function (t) { var i = this.diagram, e = i.toolManager.findTool("ContextMenu"); return null !== e && (void 0 === t && (t = 0 < i.selection.count ? i.selection.first() : i), null !== e.findObjectWithContextMenu(t)) }, Is.prototype.computeEffectiveCollection = function (t, i) { var e = this.diagram, n = e.toolManager.findTool("Dragging"), o = e.currentTool === n; if (void 0 === i && (i = o ? n.dragOptions : e.Qk), n = new at, null === t) return n; for (var r = t.iterator; r.next();)fr(e, n, r.value, o, i); if (null !== e.draggedLink && i.dragsLink) return n; for (r = t.iterator; r.next();)(t = r.value) instanceof Fu && (null === (i = t.fromNode) || n.contains(i) ? null === (i = t.toNode) || n.contains(i) || n.remove(t) : n.remove(t)); return n }, l.Object.defineProperties(Is.prototype, { diagram: { get: function () { return this.B } }, copiesClipboardData: { get: function () { return this.u }, set: function (t) { this.u = t } }, copiesConnectedLinks: { get: function () { return this.I }, set: function (t) { this.I = t } }, deletesConnectedLinks: { get: function () { return this.ab }, set: function (t) { this.ab = t } }, copiesTree: { get: function () { return this.Ia }, set: function (t) { this.Ia = t } }, deletesTree: { get: function () { return this.kd }, set: function (t) { this.kd = t } }, copiesParentKey: { get: function () { return this.Ha }, set: function (t) { this.Ha = t } }, copiesGroupKey: { get: function () { return this.W }, set: function (t) { this.W = t } }, archetypeGroupData: { get: function () { return this.l }, set: function (t) { this.l = t } }, memberValidation: { get: function () { return this.yi }, set: function (t) { this.yi = t } }, defaultScale: { get: function () { return this.diagram.defaultScale }, set: function (t) { this.diagram.defaultScale = t } }, zoomFactor: { get: function () { return this.Zc }, set: function (t) { 1 < t || B("zoomFactor must be larger than 1.0, not: " + t), this.Zc = t } }, scrollToPartPause: { get: function () { return this.Ic }, set: function (t) { this.Ic = t } } }), Is.className = "CommandHandler", jo = function () { return new Is }, Es.prototype.cloneProtected = function (t) { t.F = 6144 | this.F, t.rb = this.rb, t.Qa = this.Qa, t.ib = this.ib, t.dc = this.dc, t.Hg = this.Hg, t.ma.assign(this.ma), t.Lc = this.Lc.G(), t.bg = this.bg.G(), t.ag = this.ag.G(), t.Zf = this.Zf.copy(), t.ya = this.ya, t.Yb = this.Yb, t.xe = this.xe, t.bh = this.bh.G(), t.nc.assign(this.nc), t.vb.assign(this.vb), t.oc.assign(this.oc), t.ep = this.ep, null !== this.O && (t.O = this.O.copy()), t.wb = this.wb.G(), t.Fk = this.Fk.G(), t.qp = this.qp, t.rp = this.rp, t.Lg = this.Lg, t.gn = this.gn, t.Lp = this.Lp, t.yp = this.yp, t.Gl = this.Gl, t.Hl = this.Hl.G(), t.Il = this.Il, t.fi = this.fi, null !== this.N && (t.N = this.N.copy()), t.bb = this.bb, t.Jk = this.Jk, null !== this.ei && (t.ei = k(this.ei)), null !== this.md && (t.md = this.md.copy()), t.Kl = this.Kl }, Es.prototype.ux = function (t) { var i = this.ei; if (w(i)) { for (var e = 0; e < i.length; e++)if (i[e] === t) return } else this.ei = i = []; i.push(t) }, Es.prototype.sf = function (t) { t.fp = null, t.Jj = null, t.o() }, Es.prototype.clone = function () { var t = new this.constructor; if (this.cloneProtected(t), null !== this.ei) for (var i = 0; i < this.ei.length; i++) { var e = this.ei[i]; t[e] = this[e] } return t }, Es.prototype.copy = function () { return this.clone() }, (t = Es.prototype).fb = function (t) { t.classType === Fu ? 0 === t.name.indexOf("Orient") ? this.segmentOrientation = t : B("Unknown Link enum value for GraphObject.segmentOrientation property: " + t) : t.classType === Es && (this.stretch = t) }, t.toString = function () { return P(this.constructor) + "#" + tt(this) }, t.Ec = function () { var t; null === this.O && ((t = new Bc).Vg = Kt, t.vh = Kt, t.Tg = 10, t.th = 10, t.Ug = 0, t.uh = 0, this.O = t) }, t.Za = function (t, i, e, n, o, r, s) { var a, h, l = this.part; if (null !== l && (l.vk(t, i, e, n, o, r, s), e === this && t === be && _s(this) && Vs(this, l, i), r = this.diagram, null === this.Hg || null === r || !r.kk || r.undoManager.isUndoingRedoing || r.currentTool !== r.toolManager || r.animationManager.bn || (null === (t = this.Hg.get(i)) || r.animationManager.isTicking || (null === this.tp && (this.tp = new at), s = 0 === r.undoManager.transactionLevel, t.startCondition === So ? s = !0 : t.startCondition === Po && (s = !1), s ? (r = new fo, h = r, null !== (a = (a = t).Hk) && (a.duration && (h.duration = a.duration), a.finished && (h.finished = a.finished), a.easing && (h.easing = a.easing)), null !== (s = this.tp.get(t)) && s.stop(), this.tp.add(t, r), r.av = this, r.px = t, r.add(this, i, n, o), r.start()) : (_n(r.animationManager, "Trigger"), r.animationManager.defaultAnimation.add(this, i, n, o)))), this instanceof xh && e === l && 0 != (16777216 & l.F) && null !== l.data)) for (n = (e = this.V.j).length, o = 0; o < n; o++)(l = e[o]) instanceof xh && Ph(l, function (t) { null !== t.data && 0 != (16777216 & t.F) && t.Ba(i) }) }, t.kt = function (t) { return this.Jk === t ? this : null }, t.g = function (t, i, e) { this.Za(be, t, this, i, e) }, t.Nx = function (t, i, e) { if (!1 === this.pickable) return !1; var n = this.naturalBounds; return i = t.Ce(i), e ? ft(t.x, t.y, 0, 0, 0, n.height) <= i || ft(t.x, t.y, 0, n.height, n.width, n.height) <= i || ft(t.x, t.y, n.width, n.height, n.width, 0) <= i || ft(t.x, t.y, n.width, 0, 0, 0) <= i : t.dd(0, 0) <= i && t.dd(0, n.height) <= i && t.dd(n.width, 0) <= i && t.dd(n.width, n.height) <= i }, t.be = function () { return !0 }, t.aa = function (t) { var i = gi.alloc(); i.assign(t), this.transform.ra(i); var e = this.actualBounds; if (!e.v()) return gi.free(i), !1; if (null !== (n = this.diagram) && n.le) { var n, o = n.lm("extraTouchThreshold"), r = n.lm("extraTouchArea"), s = r / 2, a = this.naturalBounds, h = 1 / (n = this.uf() * n.scale); if (a.width * n < o && a.height * n < o) return t = Et(e.x - s * h, e.y - s * h, e.width + r * h, e.height + r * h, i.x, i.y), gi.free(i), t } return o = !1, (this instanceof du || this instanceof Kh ? Et(e.x - 5, e.y - 5, e.width + 10, e.height + 10, i.x, i.y) : e.aa(i)) && (o = !(this.md && !this.md.aa(i)) && (!(null === this.dc || !e.aa(i)) || (!(null === this.ib || !this.oc.aa(t)) || this.Eh(t)))), gi.free(i), o }, t.Eh = function (t) { var i = this.naturalBounds; return Et(0, 0, i.width, i.height, t.x, t.y) }, t.Be = function (t) { if (0 === this.angle) return this.actualBounds.Be(t); var i = this.naturalBounds, i = yi.allocAt(0, 0, i.width, i.height), e = this.transform, n = !1, o = gi.allocAt(t.x, t.y); return i.aa(e.Wd(o)) && (o.h(t.x, t.bottom), i.aa(e.Wd(o)) && (o.h(t.right, t.bottom), i.aa(e.Wd(o)) && (o.h(t.right, t.y), i.aa(e.Wd(o)) && (n = !0)))), gi.free(o), yi.free(i), n }, t.Dh = function (t, i) { if (void 0 === i) return t.Be(this.actualBounds); var e = this.naturalBounds, n = !1, o = gi.allocAt(0, 0); return t.aa(i.ra(o)) && (o.h(0, e.height), t.aa(i.ra(o)) && (o.h(e.width, e.height), t.aa(i.ra(o)) && (o.h(e.width, 0), t.aa(i.ra(o)) && (n = !0)))), gi.free(o), n }, t.Gc = function (t, i) { if (void 0 === i && (i = this.transform, 0 === this.angle)) return t.Gc(this.actualBounds); var e, n = this.naturalBounds, o = gi.allocAt(0, 0), r = gi.allocAt(0, n.height), s = gi.allocAt(n.width, n.height), a = gi.allocAt(n.width, 0), h = !1; return t.aa(i.ra(o)) || t.aa(i.ra(r)) || t.aa(i.ra(s)) || t.aa(i.ra(a)) ? h = !0 : (n = yi.allocAt(0, 0, n.width, n.height), e = gi.allocAt(t.x, t.y), n.aa(i.Wd(e)) ? h = !0 : (e.h(t.x, t.bottom), n.aa(i.Wd(e)) ? h = !0 : (e.h(t.right, t.bottom), n.aa(i.Wd(e)) ? h = !0 : (e.h(t.right, t.y), n.aa(i.Wd(e)) && (h = !0)))), gi.free(e), yi.free(n), !h && (qi.tt(t, o, r) || qi.tt(t, r, s) || qi.tt(t, s, a) || qi.tt(t, a, o)) && (h = !0)), gi.free(o), gi.free(r), gi.free(s), gi.free(a), h }, t.ga = function (t, i) { var e; return void 0 === i && (i = new gi), t instanceof Oi ? (e = this.naturalBounds, i.h(t.x * e.width + t.offsetX, t.y * e.height + t.offsetY)) : i.set(t), this.wd.ra(i), i }, t.km = function (t) { void 0 === t && (t = new yi); var i = this.naturalBounds, e = this.wd, n = gi.allocAt(0, 0).transform(e); return t.h(n.x, n.y, 0, 0), n.h(i.width, 0).transform(e), mi(t, n.x, n.y, 0, 0), n.h(i.width, i.height).transform(e), mi(t, n.x, n.y, 0, 0), n.h(0, i.height).transform(e), mi(t, n.x, n.y, 0, 0), gi.free(n), t }, t.Xi = function () { var t = this.wd; return 1 === t.m11 && 0 === t.m12 ? t = 0 : (t = 180 * Math.atan2(t.m12, t.m11) / Math.PI) < 0 && (t += 360), t }, t.uf = function () { if (0 != (4096 & this.F) == !1) return this.Wk; var t = this.ya; return null !== this.panel ? t * this.panel.uf() : t }, t.qt = function (t, i) { return void 0 === i && (i = new gi), i.assign(t), this.wd.Wd(i), i }, t.Vc = function (t, i, e) { return this.hk(t.x, t.y, i.x, i.y, e) }, t.hk = function (t, i, e, n, o) { var r = this.transform, s = 1 / (r.m11 * r.m22 - r.m12 * r.m21), a = r.m22 * s, h = -r.m12 * s, l = -r.m21 * s, u = r.m11 * s, c = s * (r.m21 * r.dy - r.m22 * r.dx), f = s * (r.m12 * r.dx - r.m11 * r.dy); return null !== this.areaBackground ? (r = this.actualBounds, qi.Vc(r.left, r.top, r.right, r.bottom, t, i, e, n, o)) : (s = t * a + i * l + c, t = t * h + i * u + f, i = e * a + n * l + c, e = e * h + n * u + f, o.h(0, 0), n = this.naturalBounds, e = qi.Vc(0, 0, n.width, n.height, s, t, i, e, o), o.transform(r), e) }, Es.prototype.measure = function (t, i, e, n) { if (!1 !== na(this)) { var o = (r = this.bh).right + r.left, r = r.top + r.bottom; t = Math.max(t - o, 0), i = Math.max(i - r, 0), e = Math.max((e || 0) - o, 0), n = Math.max((n || 0) - r, 0), o = this.angle, r = this.desiredSize; var s = 0; this instanceof Kh && (s = this.strokeWidth), i = 90 === o || 270 === o ? (t = isFinite(r.height) ? r.height + s : t, isFinite(r.width) ? r.width + s : i) : (t = isFinite(r.width) ? r.width + s : t, isFinite(r.height) ? r.height + s : i), r = e || 0, s = n || 0; var a = this instanceof xh; switch (Js(this, !0)) { case Xr: s = r = 0, a && (i = t = 1 / 0); break; case Gr: isFinite(t) && e < t && (r = t), isFinite(i) && n < i && (s = i); break; case Kr: isFinite(t) && e < t && (r = t), s = 0, a && (i = 1 / 0); break; case Hr: isFinite(i) && n < i && (s = i), r = 0, a && (t = 1 / 0) }a = this.maxSize; var h = this.minSize; r > a.width && h.width < a.width && (r = a.width), s > a.height && h.height < a.height && (s = a.height), e = Math.max(r / this.scale, h.width), n = Math.max(s / this.scale, h.height), a.width < e && (e = Math.min(h.width, e)), a.height < n && (n = Math.min(h.height, n)), t = Math.min(a.width, t), i = Math.min(a.height, i), t = Math.max(e, t), i = Math.max(n, i), 90 !== o && 270 !== o || (o = t, t = i, i = o, o = e, e = n, n = o), this.nc.ea(), this.rm(t, i, e, n), this.nc.freeze(), this.nc.v() || B("Non-real measuredBounds has been set. Object " + this + ", measuredBounds: " + this.nc.toString()), oa(this, !1) } }, Es.prototype.rm = function () { }, Es.prototype.xf = function () { return !1 }, Es.prototype.arrange = function (t, i, e, n, o) { this.ll(); var r = yi.alloc(); r.assign(this.vb), this.vb.ea(), !1 === ra(this) ? this.vb.h(t, i, e, n) : this.Ch(t, i, e, n), this.vb.freeze(), this.md = void 0 === o ? null : o, e = !1, void 0 !== o ? e = !0 : (null === (o = this.panel) || o.type !== xh.TableRow && o.type !== xh.TableColumn || (o = o.panel), null !== o && (o = o.oc, n = this.measuredBounds, null !== this.areaBackground && (n = this.vb), e = i + n.height, n = t + n.width, e = !(0 <= t + .05 && n <= o.width + .05 && 0 <= i + .05 && e <= o.height + .05), this instanceof el && (t = this.naturalBounds, this.bs > t.height || this.qb > t.width)) && (e = !0)), this.F = e ? 256 | this.F : -257 & this.F, this.vb.v() || B("Non-real actualBounds has been set. Object " + this + ", actualBounds: " + this.vb.toString()), this.Gt(r, this.vb), sa(this, !1), yi.free(r) }, (t = Es.prototype).Ch = function () { }, t.Gt = function (t, i) { var e = this.part; null !== e && null !== e.diagram && (e.selectionObject !== this && e.resizeObject !== this && e.rotateObject !== this || au(e, !0), this.M(), Ot(t, i) || (e.Gh(), this.Uo(e))) }, t.Uo = function (t) { null !== this.portId && (au(t, !0), t instanceof pu && mu(t, this)) }, t.bc = function (t, i) { if (this.visible) { var e = this instanceof xh && (this.type === xh.TableRow || this.type === xh.TableColumn), n = this.vb; if (e || 0 !== n.width && 0 !== n.height && !isNaN(n.x) && !isNaN(n.y)) { var o = this.opacity; if (0 !== o) { var r = 1; if (1 !== o && (r = t.globalAlpha, t.globalAlpha = r * o), !this.Ix(t, i)) if (e) qs(this, t, i); else { this instanceof Fu && this.nk(!1), e = this.transform; var s = this.panel; 0 != (4096 & this.F) == !0 && Ks(this); var a, h, l, u, c, f, d, p, g, y, m, v, x, b, w, k = this.part, M = !1, S = 0; if (k && i.De("drawShadows") && (M = k.isShadowed) && (h = k.shadowOffset, S = Math.max(h.y, h.x) * i.scale * i.Sb), (h = i.ni || !this.xf()) || (a = this.naturalBounds, l = (h = this.Qh).m11, u = h.m21, c = h.dx, f = h.m12, d = h.m22, p = h.dy, m = y = 0, h = y * l + m * u + c, g = y * f + m * d + p, v = (y = a.width + S) * l + (m = 0) * u + c, y = y * f + m * d + p, m = Math.min(h, v), x = Math.min(g, y), b = Math.max(h + 0, v) - m, w = Math.max(g + 0, y) - x, h = m, g = x, v = (y = a.width + S) * l + (m = a.height + S) * u + c, y = y * f + m * d + p, m = Math.min(h, v), x = Math.min(g, y), b = Math.max(h + b, v) - m, w = Math.max(g + w, y) - x, h = m, g = x, v = (y = 0) * l + (m = a.height + S) * u + c, y = y * f + m * d + p, m = Math.min(h, v), x = Math.min(g, y), b = Math.max(h + b, v) - m, w = Math.max(g + w, y) - x, h = m, g = x, a = (S = i.viewportBounds).x, l = S.y, h = !(h > S.width + a || b + h < a || g > S.height + l || w + g < l)), h) { if (h = 0 != (256 & this.F), t.clipInsteadOfFill && (h = !1), this instanceof el && (t.font = this.font), h) { if (g = s.be() ? s.naturalBounds : s.actualBounds, a = null !== this.md ? (b = (a = this.md).x, w = a.y, S = a.width, a.height) : (b = Math.max(n.x, g.x), w = Math.max(n.y, g.y), S = Math.min(n.right, g.right) - b, Math.min(n.bottom, g.bottom) - w), b > n.width + n.x || n.x > g.width + g.x) return void (1 !== o && (t.globalAlpha = r)); t.save(), t.beginPath(), t.rect(b, w, S, a), t.clip() } if (this.xf()) { if (!k.isVisible()) return void (1 !== o && (t.globalAlpha = r)); M && (g = k.shadowOffset, t.mw(g.x * i.scale * i.Sb, g.y * i.scale * i.Sb, k.shadowBlur), Sa(t), t.shadowColor = k.shadowColor) } !0 === this.shadowVisible ? Sa(t) : !1 === this.shadowVisible && Ma(t), k = this.naturalBounds, null !== this.dc && (Us(this, t, this.dc, !0, !0, k, n), this.dc instanceof La && this.dc.type === Ua ? (t.beginPath(), t.rect(n.x, n.y, n.width, n.height), t.Vd(this.dc)) : t.fillRect(n.x, n.y, n.width, n.height)), t.transform(e.m11, e.m12, e.m21, e.m22, e.dx, e.dy), M && (null !== s && 0 != (512 & s.F) || null !== s && (s.type === xh.Auto || s.type === xh.Spot) && s.Ab() !== this) && null === this.shadowVisible && Ma(t), null !== this.ib && (b = g = 0, w = (S = this.naturalBounds).width, S = S.height, a = 0, this instanceof Kh && (g = (S = this.ka.bounds).x, b = S.y, w = S.width, S = S.height, a = this.strokeWidth), Us(this, t, this.ib, !0, !1, k, n), this.ib instanceof La && this.ib.type === Ua ? (t.beginPath(), t.rect(g - a / 2, b - a / 2, w + a, S + a), t.Vd(this.ib)) : t.fillRect(g - a / 2, b - a / 2, w + a, S + a)), M && (null !== this.ib || null !== this.dc || null !== s && 0 != (512 & s.F) || null !== s && (s.type === xh.Auto || s.type === xh.Spot) && s.Ab() !== this) ? (Qs(this, !0), null === this.shadowVisible && Ma(t)) : Qs(this, !1), this.Qi(t, i), M && 0 != (512 & this.F) == !0 && Sa(t), this.xf() && M && Ma(t), h ? (t.restore(), this instanceof xh ? t.sc(!0) : t.sc(!1)) : e.wt() || (i = 1 / (e.m11 * e.m22 - e.m12 * e.m21), t.transform(e.m22 * i, -e.m12 * i, -e.m21 * i, e.m11 * i, i * (e.m21 * e.dy - e.m22 * e.dx), i * (e.m12 * e.dx - e.m11 * e.dy))) } } 1 !== o && (t.globalAlpha = r) } } } }, t.Ix = function () { return !1 }, t.Qi = function () { }, t.Ag = function (t) { if (t instanceof xh) t: { if (this !== t && null !== t) for (var i = this.panel; null !== i;) { if (i === t) { t = !0; break t } i = i.panel } t = !1 } else t = !1; return t }, t.yf = function () { if (!this.visible) return !1; var t = this.panel; return null === t || t.yf() }, t.Bg = function () { for (var t = this instanceof xh ? this : this.panel; null !== t && t.isEnabled;)t = t.panel; return null === t }, t.o = function (t) { var i; void 0 === t && (t = !1), !0 !== na(this) && (oa(this, !0), sa(this, !0), null === (i = this.panel) || t || i.o()) }, t.nm = function () { !0 !== na(this) && (oa(this, !0), sa(this, !0)) }, t.ll = function () { 0 != (2048 & this.F) == !1 && (ia(this, !0), ea(this, !0)) }, t.Jv = function () { ea(this, !0) }, t.M = function () { var t = this.part; null !== t && t.M() }, t.cj = function (t) { this.kg = t }, t.Qt = function () { }, t.kw = function (t) { return this.ma.assign(t), Ws(this), !0 }, t.Lq = function (t, i) { this.ma.x === t && this.ma.y === i || (this.ma.h(t, i), this.ll()) }, t.bind = function (t) { var i = (t.cd = this).Ui(); null !== i && jh(i) && B("Cannot add a Binding to a template that has already been copied: " + t), null === this.bb && (this.bb = new J), this.bb.add(t) }, t.Ui = function () { for (var t = this instanceof xh ? this : this.panel; null !== t;) { if (null !== t.ci) return t; t = t.panel } return null }, t.lw = function (t) { rr(this, t) }, l.Object.defineProperties(Es.prototype, { shadowVisible: { get: function () { return this.Kl }, set: function (t) { var i = this.Kl; i !== t && (this.Kl = t, this.M(), this.g("shadowVisible", i, t)) } }, enabledChanged: { get: function () { return null !== this.N ? this.N.En : null }, set: function (t) { zs(this); var i = this.N.En; i !== t && (this.N.En = t, this.g("enabledChanged", i, t)) } }, segmentOrientation: { get: function () { return this.Il }, set: function (t) { var i = this.Il; i !== t && (this.Il = t, this.o(), this.g("segmentOrientation", i, t), t === ec && (this.angle = 0)) } }, segmentIndex: { get: function () { return this.yp }, set: function (t) { t = Math.round(t); var i = this.yp; i !== t && (this.yp = t, this.o(), this.g("segmentIndex", i, t)) } }, segmentFraction: { get: function () { return this.Gl }, set: function (t) { isNaN(t) || t < 0 ? t = 0 : 1 < t && (t = 1); var i = this.Gl; i !== t && (this.Gl = t, this.o(), this.g("segmentFraction", i, t)) } }, segmentOffset: { get: function () { return this.Hl }, set: function (t) { var i = this.Hl; i.w(t) || (this.Hl = t = t.G(), this.o(), this.g("segmentOffset", i, t)) } }, stretch: { get: function () { return this.xe }, set: function (t) { var i = this.xe; i !== t && (this.xe = t, this.o(), this.g("stretch", i, t)) } }, name: { get: function () { return this.Qa }, set: function (t) { var i = this.Qa; i !== t && (this.Qa = t, null !== this.part && (this.part.Fj = null), this.g("name", i, t)) } }, opacity: { get: function () { return this.rb }, set: function (t) { var i = this.rb; i !== t && ((t < 0 || 1 < t) && y(t, "0 <= value <= 1", Es, "opacity"), this.rb = t, this.g("opacity", i, t), t = this.diagram, i = this.part, null !== t && null !== i && t.M($l(i, i.actualBounds))) } }, visible: { get: function () { return 0 != (1 & this.F) }, set: function (t) { var i = 0 != (1 & this.F); i !== t && (this.F ^= 1, this.g("visible", i, t), null !== (i = this.panel) ? i.o() : this.xf() && this.Ob(t), this.M(), ha(this)) } }, pickable: { get: function () { return 0 != (2 & this.F) }, set: function (t) { var i = 0 != (2 & this.F); i !== t && (this.F ^= 2, this.g("pickable", i, t)) } }, fromLinkableDuplicates: { get: function () { return 0 != (4 & this.F) }, set: function (t) { var i = 0 != (4 & this.F); i !== t && (this.F ^= 4, this.g("fromLinkableDuplicates", i, t)) } }, fromLinkableSelfNode: { get: function () { return 0 != (8 & this.F) }, set: function (t) { var i = 0 != (8 & this.F); i !== t && (this.F ^= 8, this.g("fromLinkableSelfNode", i, t)) } }, toLinkableDuplicates: { get: function () { return 0 != (16 & this.F) }, set: function (t) { var i = 0 != (16 & this.F); i !== t && (this.F ^= 16, this.g("toLinkableDuplicates", i, t)) } }, toLinkableSelfNode: { get: function () { return 0 != (32 & this.F) }, set: function (t) { var i = 0 != (32 & this.F); i !== t && (this.F ^= 32, this.g("toLinkableSelfNode", i, t)) } }, isPanelMain: { get: function () { return 0 != (64 & this.F) }, set: function (t) { var i = 0 != (64 & this.F); i !== t && (this.F ^= 64, this.o(), this.g("isPanelMain", i, t)) } }, isActionable: { get: function () { return 0 != (128 & this.F) }, set: function (t) { var i = 0 != (128 & this.F); i !== t && (this.F ^= 128, this.g("isActionable", i, t)) } }, areaBackground: { get: function () { return this.dc }, set: function (t) { var i = this.dc; i !== t && (null !== t && Ya(t, "GraphObject.areaBackground"), t instanceof La && t.freeze(), this.dc = t, this.M(), this.g("areaBackground", i, t)) } }, background: { get: function () { return this.ib }, set: function (t) { var i = this.ib; i !== t && (null !== t && Ya(t, "GraphObject.background"), t instanceof La && t.freeze(), this.ib = t, this.M(), this.g("background", i, t)) } }, part: { get: function () { if (this.xf()) return this; if (null !== this.Jj) return this.Jj; for (var t = this.panel; t;) { if (t instanceof Hl) return this.Jj = t; t = t.panel } return null } }, svg: { get: function () { return this.Qp }, set: function (t) { this.Qp = t } }, panel: { get: function () { return this.kg } }, layer: { get: function () { var t = this.part; return null !== t ? t.layer : null } }, diagram: { get: function () { var t = this.part; return null !== t ? t.diagram : null } }, position: { get: function () { return this.ma }, set: function (t) { var i = t.x, e = t.y, n = this.ma, o = n.x, r = n.y; (o === i || isNaN(o) && isNaN(i)) && (r === e || isNaN(r) && isNaN(e)) ? this.Qt() : (t = t.copy(), this.kw(t, n) && this.g("position", n.copy(), t)) } }, actualBounds: { get: function () { return this.vb } }, scale: { get: function () { return this.ya }, set: function (t) { var i = this.ya; i !== t && (t <= 0 && B("GraphObject.scale for " + this + " must be greater than zero, not: " + t), this.ya = t, this.o(), this.g("scale", i, t)) } }, angle: { get: function () { return this.Yb }, set: function (t) { var i = this.Yb; i !== t && ((t %= 360) < 0 && (t += 360), i !== t && (this.Yb = t, ha(this), this.o(), this.g("angle", i, t))) } }, desiredSize: { get: function () { return this.Lc }, set: function (t) { var i = t.width, e = t.height, n = this.Lc, o = n.width, r = n.height; (o === i || isNaN(o) && isNaN(i)) && (r === e || isNaN(r) && isNaN(e)) || (this.Lc = t = t.G(), this.o(), this instanceof Kh && this.cc(), this.g("desiredSize", n, t), !_s(this) || null !== (t = this.part) && (Vs(this, t, "width"), Vs(this, t, "height"))) } }, width: { get: function () { return this.Lc.width }, set: function (t) { var i = this.Lc.width; i === t || isNaN(i) && isNaN(t) || (i = this.Lc, this.Lc = t = new Yi(t, this.Lc.height).freeze(), this.o(), this instanceof Kh && this.cc(), this.g("desiredSize", i, t), !_s(this) || null !== (t = this.part) && Vs(this, t, "width")) } }, height: { get: function () { return this.Lc.height }, set: function (t) { var i = this.Lc.height; i === t || isNaN(i) && isNaN(t) || (i = this.Lc, this.Lc = t = new Yi(this.Lc.width, t).freeze(), this.o(), this instanceof Kh && this.cc(), this.g("desiredSize", i, t), !_s(this) || null !== (t = this.part) && Vs(this, t, "height")) } }, minSize: { get: function () { return this.bg }, set: function (t) { var i = this.bg; i.w(t) || (t = t.copy(), isNaN(t.width) && (t.width = 0), isNaN(t.height) && (t.height = 0), t.freeze(), this.bg = t, this.o(), this.g("minSize", i, t)) } }, maxSize: { get: function () { return this.ag }, set: function (t) { var i = this.ag; i.w(t) || (t = t.copy(), isNaN(t.width) && (t.width = 1 / 0), isNaN(t.height) && (t.height = 1 / 0), t.freeze(), this.ag = t, this.o(), this.g("maxSize", i, t)) } }, measuredBounds: { get: function () { return this.nc } }, naturalBounds: { get: function () { return this.oc } }, margin: { get: function () { return this.bh }, set: function (t) { "number" == typeof t && (t = new Xt(t)); var i = this.bh; i.w(t) || (this.bh = t = t.G(), this.o(), this.g("margin", i, t)) } }, transform: { get: function () { return 0 != (2048 & this.F) == !0 && Ks(this), this.mb } }, wd: { get: function () { return 0 != (4096 & this.F) == !0 && Ks(this), this.Qh } }, alignment: { get: function () { return this.wb }, set: function (t) { var i = this.wb; i.w(t) || (t.jc() && !t.Mb() && B("GraphObject.alignment for " + this + " must be a real Spot or Spot.Default, not: " + t), this.wb = t = t.G(), Ws(this), this.g("alignment", i, t)) } }, column: { get: function () { return this.Lg }, set: function (t) { t = Math.round(t); var i = this.Lg; i !== t && (t < 0 && y(t, ">= 0", Es, "column"), this.Lg = t, this.o(), this.g("column", i, t)) } }, columnSpan: { get: function () { return this.gn }, set: function (t) { t = Math.round(t); var i = this.gn; i !== t && (t < 1 && y(t, ">= 1", Es, "columnSpan"), this.gn = t, this.o(), this.g("columnSpan", i, t)) } }, row: { get: function () { return this.qp }, set: function (t) { t = Math.round(t); var i = this.qp; i !== t && (t < 0 && y(t, ">= 0", Es, "row"), this.qp = t, this.o(), this.g("row", i, t)) } }, rowSpan: { get: function () { return this.rp }, set: function (t) { t = Math.round(t); var i = this.rp; i !== t && (t < 1 && y(t, ">= 1", Es, "rowSpan"), this.rp = t, this.o(), this.g("rowSpan", i, t)) } }, spanAllocation: { get: function () { return this.Lp }, set: function (t) { var i = this.Lp; i !== t && (this.Lp = t, this.o(), this.g("spanAllocation", i, t)) } }, alignmentFocus: { get: function () { return this.Fk }, set: function (t) { var i = this.Fk; i.w(t) || (this.Fk = t = t.G(), this.o(), this.g("alignmentFocus", i, t)) } }, portId: { get: function () { return this.ep }, set: function (t) { var i, e = this.ep; e !== t && (null === (i = this.part) || i instanceof pu || (B("Cannot set portID on a Link: " + t), i = null), null !== e && null !== i && Su(i, this), null !== (this.ep = t) && null !== i && (i.Fh = !0, Mu(i, this)), this.g("portId", e, t)) } }, toSpot: { get: function () { return null !== this.O ? this.O.vh : Kt }, set: function (t) { this.Ec(); var i = this.O.vh; i.w(t) || (t = t.G(), this.O.vh = t, this.g("toSpot", i, t), aa(this)) } }, toEndSegmentLength: { get: function () { return null !== this.O ? this.O.th : 10 }, set: function (t) { this.Ec(); var i = this.O.th; i !== t && (t < 0 && y(t, ">= 0", Es, "toEndSegmentLength"), this.O.th = t, this.g("toEndSegmentLength", i, t), aa(this)) } }, toShortLength: { get: function () { return null !== this.O ? this.O.uh : 0 }, set: function (t) { this.Ec(); var i = this.O.uh; i !== t && (this.O.uh = t, this.g("toShortLength", i, t), aa(this)) } }, toLinkable: { get: function () { return null !== this.O ? this.O.Up : null }, set: function (t) { this.Ec(); var i = this.O.Up; i !== t && (this.O.Up = t, this.g("toLinkable", i, t)) } }, toMaxLinks: { get: function () { return null !== this.O ? this.O.Vp : 1 / 0 }, set: function (t) { this.Ec(); var i = this.O.Vp; i !== t && (t < 0 && y(t, ">= 0", Es, "toMaxLinks"), this.O.Vp = t, this.g("toMaxLinks", i, t)) } }, fromSpot: { get: function () { return null !== this.O ? this.O.Vg : Kt }, set: function (t) { this.Ec(); var i = this.O.Vg; i.w(t) || (t = t.G(), this.O.Vg = t, this.g("fromSpot", i, t), aa(this)) } }, fromEndSegmentLength: { get: function () { return null !== this.O ? this.O.Tg : 10 }, set: function (t) { this.Ec(); var i = this.O.Tg; i !== t && (t < 0 && y(t, ">= 0", Es, "fromEndSegmentLength"), this.O.Tg = t, this.g("fromEndSegmentLength", i, t), aa(this)) } }, fromShortLength: { get: function () { return null !== this.O ? this.O.Ug : 0 }, set: function (t) { this.Ec(); var i = this.O.Ug; i !== t && (this.O.Ug = t, this.g("fromShortLength", i, t), aa(this)) } }, fromLinkable: { get: function () { return null !== this.O ? this.O.Ln : null }, set: function (t) { this.Ec(); var i = this.O.Ln; i !== t && (this.O.Ln = t, this.g("fromLinkable", i, t)) } }, fromMaxLinks: { get: function () { return null !== this.O ? this.O.Mn : 1 / 0 }, set: function (t) { this.Ec(); var i = this.O.Mn; i !== t && (t < 0 && y(t, ">= 0", Es, "fromMaxLinks"), this.O.Mn = t, this.g("fromMaxLinks", i, t)) } }, cursor: { get: function () { return this.fi }, set: function (t) { var i = this.fi; i !== t && (this.fi = t, this.g("cursor", i, t)) } }, click: { get: function () { return null !== this.N ? this.N.Kf : null }, set: function (t) { zs(this); var i = this.N.Kf; i !== t && (this.N.Kf = t, this.g("click", i, t)) } }, doubleClick: { get: function () { return null !== this.N ? this.N.Pf : null }, set: function (t) { zs(this); var i = this.N.Pf; i !== t && (this.N.Pf = t, this.g("doubleClick", i, t)) } }, contextClick: { get: function () { return null !== this.N ? this.N.Lf : null }, set: function (t) { zs(this); var i = this.N.Lf; i !== t && (this.N.Lf = t, this.g("contextClick", i, t)) } }, mouseEnter: { get: function () { return null !== this.N ? this.N.dg : null }, set: function (t) { zs(this); var i = this.N.dg; i !== t && (this.N.dg = t, this.g("mouseEnter", i, t)) } }, mouseLeave: { get: function () { return null !== this.N ? this.N.gg : null }, set: function (t) { zs(this); var i = this.N.gg; i !== t && (this.N.gg = t, this.g("mouseLeave", i, t)) } }, mouseOver: { get: function () { return null !== this.N ? this.N.hg : null }, set: function (t) { zs(this); var i = this.N.hg; i !== t && (this.N.hg = t, this.g("mouseOver", i, t)) } }, mouseHover: { get: function () { return null !== this.N ? this.N.fg : null }, set: function (t) { zs(this); var i = this.N.fg; i !== t && (this.N.fg = t, this.g("mouseHover", i, t)) } }, mouseHold: { get: function () { return null !== this.N ? this.N.eg : null }, set: function (t) { zs(this); var i = this.N.eg; i !== t && (this.N.eg = t, this.g("mouseHold", i, t)) } }, mouseDragEnter: { get: function () { return null !== this.N ? this.N.Go : null }, set: function (t) { zs(this); var i = this.N.Go; i !== t && (this.N.Go = t, this.g("mouseDragEnter", i, t)) } }, mouseDragLeave: { get: function () { return null !== this.N ? this.N.Ho : null }, set: function (t) { zs(this); var i = this.N.Ho; i !== t && (this.N.Ho = t, this.g("mouseDragLeave", i, t)) } }, mouseDrop: { get: function () { return null !== this.N ? this.N.cg : null }, set: function (t) { zs(this); var i = this.N.cg; i !== t && (this.N.cg = t, this.g("mouseDrop", i, t)) } }, actionDown: { get: function () { return null !== this.N ? this.N.Pm : null }, set: function (t) { zs(this); var i = this.N.Pm; i !== t && (this.N.Pm = t, this.g("actionDown", i, t)) } }, actionMove: { get: function () { return null !== this.N ? this.N.Qm : null }, set: function (t) { zs(this); var i = this.N.Qm; i !== t && (this.N.Qm = t, this.g("actionMove", i, t)) } }, actionUp: { get: function () { return null !== this.N ? this.N.Rm : null }, set: function (t) { zs(this); var i = this.N.Rm; i !== t && (this.N.Rm = t, this.g("actionUp", i, t)) } }, actionCancel: { get: function () { return null !== this.N ? this.N.Om : null }, set: function (t) { zs(this); var i = this.N.Om; i !== t && (this.N.Om = t, this.g("actionCancel", i, t)) } }, toolTip: { get: function () { return null !== this.N ? this.N.rg : null }, set: function (t) { zs(this); var i = this.N.rg; i !== t && (this.N.rg = t, this.g("toolTip", i, t)) } }, contextMenu: { get: function () { return null !== this.N ? this.N.Mf : null }, set: function (t) { zs(this); var i = this.N.Mf; i !== t && (this.N.Mf = t, this.g("contextMenu", i, t)) } } }), Es.prototype.setProperties = Es.prototype.lw, Es.prototype.findTemplateBinder = Es.prototype.Ui, Es.prototype.bind = Es.prototype.bind, Es.prototype.isEnabledObject = Es.prototype.Bg, Es.prototype.isVisibleObject = Es.prototype.yf, Es.prototype.isContainedBy = Es.prototype.Ag, Es.prototype.getNearestIntersectionPoint = Es.prototype.Vc, Es.prototype.getLocalPoint = Es.prototype.qt, Es.prototype.getDocumentScale = Es.prototype.uf, Es.prototype.getDocumentAngle = Es.prototype.Xi, Es.prototype.getDocumentBounds = Es.prototype.km, Es.prototype.getDocumentPoint = Es.prototype.ga, Es.prototype.intersectsRect = Es.prototype.Gc, Es.prototype.containedInRect = Es.prototype.Dh, Es.prototype.containsRect = Es.prototype.Be, Es.prototype.containsPoint = Es.prototype.aa, Es.prototype.raiseChanged = Es.prototype.g, Es.prototype.raiseChangedEvent = Es.prototype.Za, Es.prototype.addCopyProperty = Es.prototype.ux; var pa = null; function ga() { this.En = this.Mf = this.rg = this.Om = this.Rm = this.Qm = this.Pm = this.cg = this.Ho = this.Go = this.eg = this.fg = this.hg = this.gg = this.dg = this.Lf = this.Pf = this.Kf = null } function ya() { this.Ka = [1, 0, 0, 1, 0, 0] } function ma(t) { this.type = t, this.r2 = this.y2 = this.x2 = this.r1 = this.y1 = this.x1 = 0, this.Bx = [], this.pattern = null } function va(t, i) { this.ownerDocument = t = void 0 === i ? c.document : i, this.hA = "http://www.w3.org/2000/svg", void 0 !== t && (this.Ea = this.ub("svg", { width: "1px", height: "1px", viewBox: "0 0 1 1" }), this.Ea.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns", "http://www.w3.org/2000/svg"), this.Ea.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:xlink", "http://www.w3.org/1999/xlink")), this.kq = null, this.context = new xa(this) } function xa(t) { this.yk = t, this.svg = t.Ea, this.stack = [], this.xc = [], this.fillStyle = "#000000", this.font = "10px sans-serif", this.globalAlpha = 1, this.lineCap = "butt", this.lineDashOffset = 0, this.lineJoin = "miter", this.lineWidth = 1, this.miterLimit = 10, this.shadowBlur = 0, this.shadowColor = "rgba(0, 0, 0, 0)", this.shadowOffsetY = this.shadowOffsetX = 0, this.strokeStyle = "#000000", this.textAlign = "start", this.clipInsteadOfFill = !1, this.df = this.Hp = this.Gp = 0, this.vq = null, this.path = [], this.yu = !1, this.oh = null, this.ph = 0, this.Ud = new ya, ka(this, 1, 0, 0, 1, 0, 0); var i = it++, e = this.ub("clipPath", { id: "mainClip" + i }); e.appendChild(this.ub("rect", { x: 0, y: 0, width: t.width, height: t.height })), this.Hu = e, this.yk.Ea.appendChild(e), this.xc[0].setAttributeNS(null, "clip-path", "url(#mainClip" + i + ")"), this.jA = {} } function ba(t, i, e, n, o) { 1 !== t.globalAlpha && (e.opacity = t.globalAlpha), "fill" === i ? (t.fillStyle instanceof ma ? e.fill = wa(t, t.fillStyle) : /^rgba\(/.test(t.fillStyle) ? (t = /^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(t.fillStyle), e.fill = "rgb(" + t[1] + "," + t[2] + "," + t[3] + ")", e["fill-opacity"] = t[4]) : e.fill = t.fillStyle, e.stroke = "none") : "stroke" === i && (e.fill = "none", t.strokeStyle instanceof ma ? e.stroke = wa(t, t.strokeStyle) : /^rgba\(/.test(t.strokeStyle) ? (i = /^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(t.strokeStyle), e.stroke = "rgb(" + i[1] + "," + i[2] + "," + i[3] + ")", e["stroke-opacity"] = i[4]) : e.stroke = t.strokeStyle, e["stroke-width"] = t.lineWidth, e["stroke-linecap"] = t.lineCap, e["stroke-linejoin"] = t.lineJoin, e["stroke-miterlimit"] = t.miterLimit), n = "matrix(" + (n = n.Ka)[0] + ", " + n[1] + ", " + n[2] + ", " + n[3] + ", " + n[4] + ", " + n[5] + ")", void 0 !== o && (n += o), e.transform = n } function wa(t, i) { var e = "GRAD" + it++; if ("linear" === i.type) var n = t.ub("linearGradient", { x1: i.x1, x2: i.x2, y1: i.y1, y2: i.y2, id: e, gradientUnits: "userSpaceOnUse" }); else { if ("radial" !== i.type) throw Error("invalid gradient"); n = t.ub("radialGradient", { x1: i.x1, x2: i.x2, y1: i.y1, y2: i.y2, r1: i.r1, r2: i.r2, id: e }) } var o = i.Bx; i = o.length; for (var r = [], s = 0; s < i; s++) { var a = (h = o[s]).color, h = { offset: h.offset, "stop-color": a }; /^rgba\(/.test(a) && (a = /^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(a), h["stop-color"] = "rgb(" + a[1] + "," + a[2] + "," + a[3] + ")", h["stop-opacity"] = a[4]), r.push(h) } for (r.sort(function (t, i) { return t.offset > i.offset ? 1 : -1 }), o = 0; o < i; o++)n.appendChild(t.ub("stop", r[o])); return t.svg.appendChild(n), "url(#" + e + ")" } function ka(t, i, e, n, o, r, s) { var a = new ya; a.Ka = [i, e, n, o, r, s], ba(t, "g", i = {}, a), a = t.addElement("g", i), t.xc.push(a) } function Ma(t) { t.shadowOffsetX = 0, t.shadowOffsetY = 0, t.shadowBlur = 0 } function Sa(t) { t.shadowOffsetX = t.Gp, t.shadowOffsetY = t.Hp, t.shadowBlur = t.df } function Pa(t, i) { this.ownerDocument = i = void 0 === i ? c.document : i, this.kq = null, (i = i.createElement("canvas")).tabIndex = 0, this.Ea = i, this.Ea.innerHTML = "This text is displayed if your browser does not support the Canvas HTML element.", this.context = new Na(i), i.B = t } function Na(t) { t.getContext && t.getContext("2d") || B("Browser does not support HTML Canvas Element"), this.Y = t.getContext("2d"), this.au = this.cu = this.bu = "", this.fn = !1, this.df = this.Hp = this.Gp = 0 } Es.className = "GraphObject", pa = new at, fa("Button", function () { function r(t, i) { return null !== t.diagram.Ub(t.documentPoint, function (t) { for (; null !== t.panel && !t.isActionable;)t = t.panel; return t }, function (t) { return t === i }) } var t = ua(xh, xh.Auto, { isActionable: !0, enabledChanged: function (t, i) { var e; t instanceof xh && (null !== (e = t.Ya("ButtonBorder")) && (e.fill = i ? t._buttonFillNormal : t._buttonFillDisabled)) }, cursor: "pointer", _buttonFillNormal: "#F5F5F5", _buttonStrokeNormal: "#BDBDBD", _buttonFillOver: "#E0E0E0", _buttonStrokeOver: "#9E9E9E", _buttonFillPressed: "#BDBDBD", _buttonStrokePressed: "#9E9E9E", _buttonFillDisabled: "#E5E5E5" }, ua(Kh, { name: "ButtonBorder", figure: "RoundedRectangle", spot1: new Oi(0, 0, 2.76142374915397, 2.761423749153969), spot2: new Oi(1, 1, -2.76142374915397, -2.761423749153969), parameter1: 2, parameter2: 2, fill: "#F5F5F5", stroke: "#BDBDBD" })); return t.mouseEnter = function (t, i) { var e; i.Bg() && i instanceof xh && (t = i.Ya("ButtonBorder")) instanceof Kh && (e = i._buttonFillOver, i._buttonFillNormal = t.fill, t.fill = e, e = i._buttonStrokeOver, i._buttonStrokeNormal = t.stroke, t.stroke = e) }, t.mouseLeave = function (t, i) { i.Bg() && i instanceof xh && ((t = i.Ya("ButtonBorder")) instanceof Kh && (t.fill = i._buttonFillNormal, t.stroke = i._buttonStrokeNormal)) }, t.actionDown = function (t, i) { var e, n, o; i.Bg() && i instanceof xh && null !== i._buttonFillPressed && 0 === t.button && ((e = i.Ya("ButtonBorder")) instanceof Kh && (n = (t = t.diagram).skipsUndoManager, t.skipsUndoManager = !0, o = i._buttonFillPressed, i._buttonFillOver = e.fill, e.fill = o, o = i._buttonStrokePressed, i._buttonStrokeOver = e.stroke, e.stroke = o, t.skipsUndoManager = n)) }, t.actionUp = function (t, i) { var e, n, o; i.Bg() && i instanceof xh && null !== i._buttonFillPressed && 0 === t.button && ((e = i.Ya("ButtonBorder")) instanceof Kh && (o = (n = t.diagram).skipsUndoManager, n.skipsUndoManager = !0, r(t, i) ? (e.fill = i._buttonFillOver, e.stroke = i._buttonStrokeOver) : (e.fill = i._buttonFillNormal, e.stroke = i._buttonStrokeNormal), n.skipsUndoManager = o)) }, t.actionCancel = function (t, i) { var e, n, o; i.Bg() && i instanceof xh && null !== i._buttonFillPressed && ((e = i.Ya("ButtonBorder")) instanceof Kh && (o = (n = t.diagram).skipsUndoManager, n.skipsUndoManager = !0, r(t, i) ? (e.fill = i._buttonFillOver, e.stroke = i._buttonStrokeOver) : (e.fill = i._buttonFillNormal, e.stroke = i._buttonStrokeNormal), n.skipsUndoManager = o)) }, t.actionMove = function (t, i) { var e, n, o; i.Bg() && i instanceof xh && null !== i._buttonFillPressed && (0 === (e = t.diagram).firstInput.button && (e.currentTool.standardMouseOver(), r(t, i) && (t = i.Ya("ButtonBorder")) instanceof Kh) && (n = e.skipsUndoManager, e.skipsUndoManager = !0, o = i._buttonFillPressed, t.fill !== o && (t.fill = o), o = i._buttonStrokePressed, t.stroke !== o && (t.stroke = o), e.skipsUndoManager = n)) }, t }), fa("TreeExpanderButton", function () { var t = ua("Button", { _treeExpandedFigure: "MinusLine", _treeCollapsedFigure: "PlusLine" }, ua(Kh, { name: "ButtonIcon", figure: "MinusLine", stroke: "#424242", strokeWidth: 2, desiredSize: vt }, new Jf("figure", "isTreeExpanded", function (t, i) { return i = i.panel, t ? i._treeExpandedFigure : i._treeCollapsedFigure }).Bq()), { visible: !1 }, new Jf("visible", "isTreeLeaf", function (t) { return !t }).Bq()); return t.click = function (t, i) { if ((i = i.part) instanceof du && (i = i.adornedPart), i instanceof pu) { var e = i.diagram; if (null !== e) { if (e = e.commandHandler, i.isTreeExpanded) { if (!e.canCollapseTree(i)) return } else if (!e.canExpandTree(i)) return; t.handled = !0, i.isTreeExpanded ? e.collapseTree(i) : e.expandTree(i) } } }, t }), fa("SubGraphExpanderButton", function () { var t = ua("Button", { _subGraphExpandedFigure: "MinusLine", _subGraphCollapsedFigure: "PlusLine" }, ua(Kh, { name: "ButtonIcon", figure: "MinusLine", stroke: "#424242", strokeWidth: 2, desiredSize: vt }, new Jf("figure", "isSubGraphExpanded", function (t, i) { return i = i.panel, t ? i._subGraphExpandedFigure : i._subGraphCollapsedFigure }).Bq())); return t.click = function (t, i) { if ((i = i.part) instanceof du && (i = i.adornedPart), i instanceof Lu) { var e = i.diagram; if (null !== e) { if (e = e.commandHandler, i.isSubGraphExpanded) { if (!e.canCollapseSubGraph(i)) return } else if (!e.canExpandSubGraph(i)) return; t.handled = !0, i.isSubGraphExpanded ? e.collapseSubGraph(i) : e.expandSubGraph(i) } } }, t }), fa("ToolTip", function () { return ua(du, xh.Auto, { isShadowed: !0, shadowColor: "rgba(0, 0, 0, .4)", shadowOffset: new gi(0, 3), shadowBlur: 5 }, ua(Kh, { name: "Border", figure: "RoundedRectangle", parameter1: 1, parameter2: 1, fill: "#F5F5F5", stroke: "#F0F0F0", spot1: new Oi(0, 0, 4, 6), spot2: new Oi(1, 1, -4, -4) })) }), fa("ContextMenu", function () { return ua(du, xh.Vertical, { background: "#F5F5F5", isShadowed: !0, shadowColor: "rgba(0, 0, 0, .4)", shadowOffset: new gi(0, 3), shadowBlur: 5 }, new Jf("background", "", function (t) { return null !== t.adornedPart && null !== t.placeholder ? null : "#F5F5F5" })) }), fa("ContextMenuButton", function () { var t = ua("Button"); t.stretch = Kr; var i = t.Ya("ButtonBorder"); return i instanceof Kh && (i.figure = "Rectangle", i.strokeWidth = 0, i.spot1 = new Oi(0, 0, 2, 3), i.spot2 = new Oi(1, 1, -2, -2)), t }), fa("PanelExpanderButton", function (t) { var o = da(t, "COLLAPSIBLE"), i = ua("Button", { _buttonExpandedFigure: "M0 0 M0 6 L4 2 8 6 M8 8", _buttonCollapsedFigure: "M0 0 M0 2 L4 6 8 2 M8 8", _buttonFillNormal: "rgba(0, 0, 0, 0)", _buttonStrokeNormal: null, _buttonFillOver: "rgba(0, 0, 0, .2)", _buttonStrokeOver: null, _buttonFillPressed: "rgba(0, 0, 0, .4)", _buttonStrokePressed: null }, ua(Kh, { name: "ButtonIcon", strokeWidth: 2 }, new Jf("geometryString", "visible", function (t) { return t ? i._buttonExpandedFigure : i._buttonCollapsedFigure }).Bq(o))); return (t = i.Ya("ButtonBorder")) instanceof Kh && (t.stroke = null, t.fill = "rgba(0, 0, 0, 0)"), i.click = function (t, i) { var e, n = i.diagram; null === n || n.isReadOnly || (null === (e = i.Ui()) && (e = i.part), null === e || null !== (i = e.Ya(o)) && (t.handled = !0, n.ua("Collapse/Expand Panel"), i.visible = !i.visible, n.Va("Collapse/Expand Panel"))) }, i }), fa("CheckBoxButton", function (t) { var o = da(t); return (t = ua("Button", { desiredSize: new Yi(14, 14) }, ua(Kh, { name: "ButtonIcon", geometryString: "M0 0 M0 8.85 L4.9 13.75 16.2 2.45 M16.2 16.2", strokeWidth: 2, stretch: Gr, geometryStretch: qr, visible: !1 }, "" !== o ? new Jf("visible", o).Xx() : []))).click = function (t, i) { var e, n; i instanceof xh && (null === (e = t.diagram) || e.isReadOnly || "" !== o && e.model.isReadOnly || (t.handled = !0, n = i.Ya("ButtonIcon"), e.ua("checkbox"), n.visible = !n.visible, "function" == typeof i._doClick && i._doClick(t, i), e.Va("checkbox"))) }, t }), fa("CheckBox", function (t) { t = ua("CheckBoxButton", t = da(t), { name: "Button", isActionable: !1, margin: new Xt(0, 1, 0, 0) }); var i = ua(xh, "Horizontal", t, { isActionable: !0, cursor: t.cursor, margin: 1, _buttonFillNormal: t._buttonFillNormal, _buttonStrokeNormal: t._buttonStrokeNormal, _buttonFillOver: t._buttonFillOver, _buttonStrokeOver: t._buttonStrokeOver, _buttonFillPressed: t._buttonFillPressed, _buttonStrokePressed: t._buttonStrokePressed, _buttonFillDisabled: t._buttonFillDisabled, mouseEnter: t.mouseEnter, mouseLeave: t.mouseLeave, actionDown: t.actionDown, actionUp: t.actionUp, actionCancel: t.actionCancel, actionMove: t.actionMove, click: t.click, _buttonClick: t.click }); return t.mouseEnter = null, t.mouseLeave = null, t.actionDown = null, t.actionUp = null, t.actionCancel = null, t.actionMove = null, t.click = null, i }), Es.None = Xr = new V(Es, "None", 0), Es.Default = Ur = new V(Es, "Default", 0), Es.Vertical = Hr = new V(Es, "Vertical", 4), Es.Horizontal = Kr = new V(Es, "Horizontal", 5), Es.Fill = Gr = new V(Es, "Fill", 3), Es.Uniform = qr = new V(Es, "Uniform", 1), Es.UniformToFill = Wr = new V(Es, "UniformToFill", 2), Es.FlipVertical = Jr = new V(Es, "FlipVertical", 1), Es.FlipHorizontal = Zr = new V(Es, "FlipHorizontal", 2), Es.FlipBoth = $r = new V(Es, "FlipBoth", 3), Es.make = ua, Es.getBuilders = function () { var t, i, e = new at; for (t in pa) { t === t.toLowerCase() || "function" == typeof (i = pa.H(t)) && e.add(t, i) } return e.freeze(), e }, Es.defineBuilder = fa, Es.takeBuilderArgument = da, ga.prototype.copy = function () { var t = new ga; return t.Kf = this.Kf, t.Pf = this.Pf, t.Lf = this.Lf, t.dg = this.dg, t.gg = this.gg, t.hg = this.hg, t.fg = this.fg, t.eg = this.eg, t.Go = this.Go, t.Ho = this.Ho, t.cg = this.cg, t.Pm = this.Pm, t.Qm = this.Qm, t.Rm = this.Rm, t.Om = this.Om, t.rg = this.rg, t.Mf = this.Mf, t.En = this.En, t }, ga.className = "GraphObjectEventHandlers", ya.prototype.copy = function () { var t = new ya; return t.Ka[0] = this.Ka[0], t.Ka[1] = this.Ka[1], t.Ka[2] = this.Ka[2], t.Ka[3] = this.Ka[3], t.Ka[4] = this.Ka[4], t.Ka[5] = this.Ka[5], t }, ya.prototype.translate = function (t, i) { this.Ka[4] += this.Ka[0] * t + this.Ka[2] * i, this.Ka[5] += this.Ka[1] * t + this.Ka[3] * i }, ya.prototype.scale = function (t, i) { this.Ka[0] *= t, this.Ka[1] *= t, this.Ka[2] *= i, this.Ka[3] *= i }, ya.className = "STransform", ma.prototype.addColorStop = function (t, i) { this.Bx.push({ offset: t, color: i }) }, ma.className = "SGradient", va.prototype.resize = function (t, i, e, n) { return (this.width !== t || this.height !== i) && (this.style.width = e + "px", this.style.height = n + "px", this.Ea.setAttributeNS(null, "width", e + "px"), this.Ea.setAttributeNS(null, "height", n + "px"), this.Ea.setAttributeNS(null, "viewBox", "0 0 " + e + " " + n), this.context.Hu.firstElementChild.setAttributeNS(null, "width", e + "px"), this.context.Hu.firstElementChild.setAttributeNS(null, "height", n + "px"), !0) }, va.prototype.ub = function (t, i, e) { if (t = this.ownerDocument.createElementNS(this.hA, t), b(i)) for (var n in i) t.setAttributeNS("href" === n ? "http://www.w3.org/1999/xlink" : "", n, i[n]); return void 0 !== e && (t.textContent = e), t }, va.prototype.getBoundingClientRect = function () { return this.Ea.getBoundingClientRect() }, va.prototype.focus = function () { this.Ea.focus() }, va.prototype.Hx = function () { this.ownerDocument = null }, l.Object.defineProperties(va.prototype, { width: { get: function () { return this.Ea.width.baseVal.value }, set: function (t) { this.Ea.width = t } }, height: { get: function () { return this.Ea.height.baseVal.value }, set: function (t) { this.Ea.height = t } }, style: { get: function () { return this.Ea.style } } }), va.className = "SVGSurface", (t = xa.prototype).reset = function () { this.stack = [], this.xc = [], this.fillStyle = "#000000", this.font = "10px sans-serif", this.globalAlpha = 1, this.lineCap = "butt", this.lineDashOffset = 0, this.lineJoin = "miter", this.lineWidth = 1, this.miterLimit = 10, this.shadowBlur = 0, this.shadowColor = "rgba(0, 0, 0, 0)", this.shadowOffsetY = this.shadowOffsetX = 0, this.strokeStyle = "#000000", this.textAlign = "start", this.clipInsteadOfFill = !1, this.df = this.Hp = this.Gp = 0, this.vq = null, this.path = [], this.Ud = new ya, ka(this, 1, 0, 0, 1, 0, 0); var t = it++, i = this.ub("clipPath", { id: "mainClip" + t }); i.appendChild(this.ub("rect", { x: 0, y: 0, width: this.yk.width, height: this.yk.height })), this.Hu = i, this.yk.Ea.appendChild(i), this.xc[0].setAttributeNS(null, "clip-path", "url(#mainClip" + t + ")") }, t.arc = function (t, i, e, n, o, r, s, a) { var h = 2 * Math.PI, l = h - 1e-6, u = e * Math.cos(n), c = e * Math.sin(n), f = t + u, d = i + c, p = r ? 0 : 1; n = r ? n - o : o - n, (1e-6 < Math.abs(s - f) || 1e-6 < Math.abs(a - d)) && this.path.push(["L", f, +d]), n < 0 && (n = n % h + h), l < n ? (this.path.push(["A", e, e, 0, 1, p, t - u, i - c]), this.path.push(["A", e, e, 0, 1, p, f, d])) : 1e-6 < n && this.path.push(["A", e, e, 0, +(n >= Math.PI), p, t + e * Math.cos(o), i + e * Math.sin(o)]) }, t.beginPath = function () { this.path = [] }, t.bezierCurveTo = function (t, i, e, n, o, r) { this.path.push(["C", t, i, e, n, o, r]) }, t.clearRect = function () { }, t.clip = function () { this.addPath("clipPath", this.path, this.Ud), this.addPath("clipPath", this.path, new ya) }, t.closePath = function () { this.path.push(["z"]) }, t.createLinearGradient = function (t, i, e, n) { var o = new ma("linear"); return o.x1 = t, o.y1 = i, o.x2 = e, o.y2 = n, o }, t.createPattern = function (t) { var i = ""; t instanceof HTMLCanvasElement && (i = t.toDataURL()), t instanceof HTMLImageElement && (i = t.getAttribute("src")); var e = this.jA; if (e[i]) return "url(#" + e[i] + ")"; var n = "PATTERN" + it++, o = { x: 0, y: 0, width: t.width, height: t.height, href: i }; return (t = this.ub("pattern", { width: t.width, height: t.height, id: n, patternUnits: "userSpaceOnUse" })).appendChild(this.ub("image", o)), this.svg.appendChild(t), "url(#" + (e[i] = n) + ")" }, t.createRadialGradient = function (t, i, e, n, o, r) { var s = new ma("radial"); return s.x1 = t, s.y1 = i, s.r1 = e, s.x2 = n, s.y2 = o, s.r2 = r, s }, t.drawImage = function (t, i, e, n, o, r, s, a, h) { var l = ""; t instanceof HTMLCanvasElement && (l = t.toDataURL()), t instanceof HTMLImageElement && (l = t.getAttribute("src")); var u = t instanceof HTMLImageElement ? t.naturalWidth : t.width, c = t instanceof HTMLImageElement ? t.naturalHeight : t.height; void 0 === n && (r = i, s = e, a = n = u, h = o = c), n = n || 0, o = o || 0, r = r || 0, s = s || 0, a = a || 0, h = h || 0, t = { x: 0, y: 0, width: u || n, height: c || o, href: l }, qi.$(n, a) && qi.$(o, h) ? -1 === l.toLowerCase().indexOf(".svg") && -1 === l.toLowerCase().indexOf("data:image/svg") && (t.preserveAspectRatio = "xMidYMid slice") : t.preserveAspectRatio = "none", l = "", h /= o, 0 === r && 0 === s || (l += " translate(" + r + ", " + s + ")"), 1 === (a /= n) && 1 === h || (l += " scale(" + a + ", " + h + ")"), 0 === i && 0 === e || (l += " translate(" + -i + ", " + -e + ")"), 0 === i && 0 === e && n === u && o === c || (r = "CLIP" + it++, (s = this.ub("clipPath", { id: r })).appendChild(this.ub("rect", { x: i, y: e, width: n, height: o })), this.svg.appendChild(s), t["clip-path"] = "url(#" + r + ")"), ba(this, "image", t, this.Ud, l), this.addElement("image", t) }, t.fill = function () { this.addPath("fill", this.path, this.Ud) }, t.Vd = function () { this.clipInsteadOfFill ? this.clip() : this.fill() }, t.fillRect = function (t, i, e, n) { ba(this, "fill", t = { x: (t = [t, i, e, n])[0], y: t[1], width: t[2], height: t[3] }, this.Ud), this.addElement("rect", t) }, t.fillText = function (t, i, e) { t = [t, i, e], "left" === (i = this.textAlign) ? i = "start" : "right" === i ? i = "end" : "center" === i && (i = "middle"), ba(this, "fill", i = { x: t[1], y: t[2], style: "font: " + this.font, "text-anchor": i }, this.Ud), this.addElement("text", i, t[0]) }, t.lineTo = function (t, i) { this.path.push(["L", t, i]) }, t.moveTo = function (t, i) { this.path.push(["M", t, i]) }, t.quadraticCurveTo = function (t, i, e, n) { this.path.push(["Q", t, i, e, n]) }, t.rect = function (t, i, e, n) { this.path.push(["M", t, i], ["L", t + e, i], ["L", t + e, i + n], ["L", t, i + n], ["z"]) }, t.restore = function () { this.Ud = this.stack.pop(), this.path = this.stack.pop(); var t = this.stack.pop(); this.fillStyle = t.fillStyle, this.font = t.font, this.globalAlpha = t.globalAlpha, this.lineCap = t.lineCap, this.lineDashOffset = t.lineDashOffset, this.lineJoin = t.lineJoin, this.lineWidth = t.lineWidth, this.miterLimit = t.miterLimit, this.shadowBlur = t.shadowBlur, this.shadowColor = t.shadowColor, this.shadowOffsetX = t.shadowOffsetX, this.shadowOffsetY = t.shadowOffsetY, this.strokeStyle = t.strokeStyle, this.textAlign = t.textAlign }, t.save = function () { this.stack.push({ fillStyle: this.fillStyle, font: this.font, globalAlpha: this.globalAlpha, lineCap: this.lineCap, lineDashOffset: this.lineDashOffset, lineJoin: this.lineJoin, lineWidth: this.lineWidth, miterLimit: this.miterLimit, shadowBlur: this.shadowBlur, shadowColor: this.shadowColor, shadowOffsetX: this.shadowOffsetX, shadowOffsetY: this.shadowOffsetY, strokeStyle: this.strokeStyle, textAlign: this.textAlign }); for (var t = [], i = 0; i < this.path.length; i++)t.push(this.path[i]); this.stack.push(t), this.stack.push(this.Ud.copy()) }, t.setTransform = function (t, i, e, n, o, r) { 1 === t && 0 === i && 0 === e && 1 === n && 0 === o && 0 === r || ka(this, t, i, e, n, o, r) }, t.scale = function (t, i) { this.Ud.scale(t, i) }, t.translate = function (t, i) { this.Ud.translate(t, i) }, t.transform = function () { }, t.stroke = function () { this.addPath("stroke", this.path, this.Ud) }, t.fj = function () { this.clipInsteadOfFill || this.stroke() }, t.ub = function (t, i, e) { return this.yk.ub(t, i, e) }, t.addElement = function (t, i, e) { return t = this.ub(t, i, e), 0 < this.xc.length ? this.xc[this.xc.length - 1].appendChild(t) : this.svg.appendChild(t), this.vq = t }, t.addPath = function (t, i, e) { for (var n = [], o = 0; o < i.length; o++) { var r = k(i[o]), s = [r.shift()]; if ("A" === s[0]) s.push(r.shift() + "," + r.shift(), r.shift(), r.shift() + "," + r.shift(), r.shift() + "," + r.shift()); else for (; r.length;)s.push(r.shift() + "," + r.shift()); n.push(s.join(" ")) } i = { d: n.join(" ") }, "stroke" === t && this.yu && (i["stroke-dasharray"] = this.oh.toString(), i["stroke-dashoffset"] = this.ph), ba(this, t, i, e), "clipPath" === t ? (t = "CLIP" + it++, (e = this.ub("clipPath", { id: t })).appendChild(this.ub("path", i)), this.svg.appendChild(e), 0 < this.xc.length && this.xc[this.xc.length - 1].setAttributeNS(null, "clip-path", "url(#" + t + ")")) : this.addElement("path", i) }, t.Mq = function () { var t, i, e, n, o, r, s; 0 === this.shadowOffsetX && 0 === this.shadowOffsetY && 0 === this.shadowBlur || (t = "SHADOW" + it++, i = this.addElement("filter", { id: t, x: "-100%", y: "-100%", width: "300%", height: "300%" }, null), e = this.ub("feGaussianBlur", { in: "SourceAlpha", result: "blur", LA: this.shadowBlur / 2 }), n = this.ub("feFlood", { in: "blur", result: "flood", "flood-color": this.shadowColor }), o = this.ub("feComposite", { in: "flood", in2: "blur", operator: "in", result: "comp" }), r = this.ub("feOffset", { in: "comp", result: "offsetBlur", dx: this.shadowOffsetX, dy: this.shadowOffsetY }), (s = this.ub("feMerge", {})).appendChild(this.ub("feMergeNode", { in: "offsetBlur" })), s.appendChild(this.ub("feMergeNode", { in: "SourceGraphic" })), i.appendChild(e), i.appendChild(n), i.appendChild(o), i.appendChild(r), i.appendChild(s), 0 < this.xc.length && this.xc[this.xc.length - 1].setAttributeNS(null, "filter", "url(#" + t + ")")) }, t.mw = function (t, i, e) { this.Gp = t, this.Hp = i, this.df = e }, t.jt = function (t, i) { this.yu = !0, this.oh = t, this.ph = i }, t.ht = function () { this.yu = !1 }, t.sc = function () { }, t.my = function () { }, xa.prototype.rotate = function () { }, xa.prototype.getImageData = function () { return null }, xa.prototype.measureText = function () { return null }, xa.className = "SVGContext", Lo.prototype.makeSvg = Lo.prototype.Ct = function (t) { var e = new va(this, c.document); void 0 === t && (t = new X); var n = this; return Vr(this, function (t, i) { return t = null !== (t = Yr(n, t, "SVG", e)) ? t.svg : null, "function" == typeof i ? (i(t), null) : t }, t) }, Lo.prototype.makeSVG = Lo.prototype.Ov = function (t) { return this.Ct(t) }, Es.prototype.Ix = function (t, i) { if (!(t instanceof xa)) return !1; if (!this.visible) return !0; var e = null, n = t.vq; if (this instanceof xh && (this.type === xh.TableRow || this.type === xh.TableColumn)) return qs(this, t, i), !0; var o = this.vb; if (0 === o.width || 0 === o.height || isNaN(o.x) || isNaN(o.y)) return !0; var r = this.transform, s = this.panel; 0 != (4096 & this.F) == !0 && Ks(this); var a, h, l, u = 0 != (256 & this.F), c = !1; if (this instanceof el && (t.font = this.font), u) { var f, d, p, g, c = s.be() ? s.naturalBounds : s.actualBounds; if (g = null !== this.md ? (f = (g = this.md).x, d = g.y, p = g.width, g.height) : (f = Math.max(o.x, c.x), d = Math.max(o.y, c.y), p = Math.min(o.right, c.right) - f, Math.min(o.bottom, c.bottom) - d), f > o.width + o.x || o.x > c.width + c.x || d > o.height + o.y || o.y > c.height + c.y) return !0; c = !0, ka(t, 1, 0, 0, 1, 0, 0), t.save(), t.beginPath(), t.rect(f, d, p, g), t.clip() } return this.xf() && !this.isVisible() || (t.Ud.Ka = [1, 0, 0, 1, 0, 0], (this instanceof el && 1 < this.lineCount || this instanceof Kh && 1 < this.geometry.figures.length) && ka(t, 1, 0, 0, 1, 0, 0), f = !1, this.xf() && this.isShadowed && i.De("drawShadows") && (d = this.shadowOffset, t.mw(d.x * i.scale * i.Sb, d.y * i.scale * i.Sb, this.shadowBlur), Sa(t), t.shadowColor = this.shadowColor), d = !1, this.part && i.De("drawShadows") && (d = this.part.isShadowed), !0 === this.shadowVisible ? (Sa(t), !1 === f && d && (ka(t, 1, 0, 0, 1, 0, 0), t.Mq(), f = !0)) : !1 === this.shadowVisible && Ma(t), p = this.naturalBounds, null !== this.areaBackground && (Us(this, t, this.areaBackground, !0, !0, p, o), !1 === f && d && (ka(t, 1, 0, 0, 1, 0, 0), t.Mq(), f = !0), this.areaBackground instanceof La && this.areaBackground.type === Ua ? (t.beginPath(), t.rect(o.x, o.y, o.width, o.height), t.Vd(this.areaBackground)) : t.fillRect(o.x, o.y, o.width, o.height)), this instanceof xh ? ka(t, r.m11, r.m12, r.m21, r.m22, r.dx, r.dy) : t.Ud.Ka = [r.m11, r.m12, r.m21, r.m22, r.dx, r.dy], null !== this.background && (!1 === f && d && (ka(t, 1, 0, 0, 1, 0, 0), t.Mq(), f = !0), g = r = 0, a = (h = this.naturalBounds).width, h = h.height, l = 0, this instanceof Kh && (r = (h = this.geometry.bounds).x, g = h.y, a = h.width, h = h.height, l = this.strokeWidth), Us(this, t, this.background, !0, !1, p, o), this.background instanceof La && this.background.type === Ua ? (t.beginPath(), t.rect(r - l / 2, g - l / 2, a + l, h + l), t.Vd(this.background)) : t.fillRect(r - l / 2, g - l / 2, a + l, h + l)), d && (null !== this.background || null !== this.areaBackground || null !== s && 0 != (512 & s.F) || null !== s && (s.type === xh.Auto || s.type === xh.Spot) && s.Ab() !== this) ? (Qs(this, !0), null === this.shadowVisible && Ma(t)) : Qs(this, !1), this.Qi(t, i), d && 0 != (512 & this.F) == !0 && Sa(t), this.xf() && d && Ma(t), u && (t.restore(), c && t.xc.pop()), this instanceof xh && (e = t.xc.pop()), !0 === f && t.xc.pop(), (this instanceof el && 1 < this.lineCount || this instanceof Kh && 1 < this.geometry.figures.length) && (e = t.xc.pop()), null !== t.yk.kq && (null === e && (e = n === t.vq ? (ka(t, 1, 0, 0, 1, 0, 0), t.xc.pop()) : t.vq), t.yk.kq(this, e)), this.svg = e), !0 }, Pa.prototype.resize = function (t, i, e, n) { return (this.width !== t || this.height !== i) && (this.width = t, this.height = i, this.style.width = e + "px", this.style.height = n + "px", !0) }, Pa.prototype.toDataURL = function (t, i) { return this.Ea.toDataURL(t, i) }, Pa.prototype.getBoundingClientRect = function () { return this.Ea.getBoundingClientRect() }, Pa.prototype.focus = function () { this.Ea.focus() }, Pa.prototype.Hx = function () { this.ownerDocument = this.Ea.B = null }, l.Object.defineProperties(Pa.prototype, { width: { get: function () { return this.Ea.width }, set: function (t) { this.Ea.width = t } }, height: { get: function () { return this.Ea.height }, set: function (t) { this.Ea.height = t } }, style: { get: function () { return this.Ea.style } } }), Pa.className = "CanvasSurface", (t = Na.prototype).my = function (t) { this.Y.imageSmoothingEnabled = t }, t.arc = function (t, i, e, n, o, r) { this.Y.arc(t, i, e, n, o, r) }, t.beginPath = function () { this.Y.beginPath() }, t.bezierCurveTo = function (t, i, e, n, o, r) { this.Y.bezierCurveTo(t, i, e, n, o, r) }, t.clearRect = function (t, i, e, n) { this.Y.clearRect(t, i, e, n) }, t.clip = function () { this.Y.clip() }, t.closePath = function () { this.Y.closePath() }, t.createLinearGradient = function (t, i, e, n) { return this.Y.createLinearGradient(t, i, e, n) }, t.createPattern = function (t, i) { return this.Y.createPattern(t, i) }, t.createRadialGradient = function (t, i, e, n, o, r) { return this.Y.createRadialGradient(t, i, e, n, o, r) }, t.drawImage = function (t, i, e, n, o, r, s, a, h) { void 0 === n ? this.Y.drawImage(t, i, e) : this.Y.drawImage(t, i, e, n, o, r, s, a, h) }, t.fill = function () { this.Y.fill() }, t.fillRect = function (t, i, e, n) { this.Y.fillRect(t, i, e, n) }, t.fillText = function (t, i, e) { this.Y.fillText(t, i, e) }, t.getImageData = function (t, i, e, n) { return this.Y.getImageData(t, i, e, n) }, t.lineTo = function (t, i) { this.Y.lineTo(t, i) }, t.measureText = function (t) { return this.Y.measureText(t) }, t.moveTo = function (t, i) { this.Y.moveTo(t, i) }, t.quadraticCurveTo = function (t, i, e, n) { this.Y.quadraticCurveTo(t, i, e, n) }, t.rect = function (t, i, e, n) { this.Y.rect(t, i, e, n) }, t.restore = function () { this.Y.restore() }, Na.prototype.rotate = function (t) { this.Y.rotate(t) }, (t = Na.prototype).save = function () { this.Y.save() }, t.setTransform = function (t, i, e, n, o, r) { this.Y.setTransform(t, i, e, n, o, r) }, t.scale = function (t, i) { this.Y.scale(t, i) }, t.stroke = function () { this.Y.stroke() }, t.transform = function (t, i, e, n, o, r) { 1 === t && 0 === i && 0 === e && 1 === n && 0 === o && 0 === r || this.Y.transform(t, i, e, n, o, r) }, t.translate = function (t, i) { this.Y.translate(t, i) }, t.Vd = function (t) { var i; t instanceof La && t.type === Ua ? ((i = t.Mk) < (t = t.du) ? (this.scale(i / t, 1), this.translate((t - i) / 2, 0)) : t < i && (this.scale(1, t / i), this.translate(0, (i - t) / 2)), this.fn ? this.clip() : this.fill(), i < t ? (this.translate(-(t - i) / 2, 0), this.scale(1 / (i / t), 1)) : t < i && (this.translate(0, -(i - t) / 2), this.scale(1, 1 / (t / i)))) : this.fn ? this.clip() : this.fill() }, t.fj = function () { this.fn || this.stroke() }, t.mw = function (t, i, e) { this.Gp = t, this.Hp = i, this.df = e }, t.jt = function (t, i) { var e = this.Y; void 0 !== e.setLineDash && (e.setLineDash(t), e.lineDashOffset = i) }, t.ht = function () { var t = this.Y; void 0 !== t.setLineDash && (t.setLineDash(Ca), t.lineDashOffset = 0) }, t.sc = function (t) { t && (this.bu = ""), this.au = this.cu = "" }, l.Object.defineProperties(Na.prototype, { fillStyle: { get: function () { return this.Y.fillStyle }, set: function (t) { this.au !== t && (this.au = this.Y.fillStyle = t) } }, font: { get: function () { return this.Y.font }, set: function (t) { this.bu !== t && (this.bu = this.Y.font = t) } }, globalAlpha: { get: function () { return this.Y.globalAlpha }, set: function (t) { this.Y.globalAlpha = t } }, lineCap: { get: function () { return this.Y.lineCap }, set: function (t) { this.Y.lineCap = t } }, lineDashOffset: { get: function () { return this.Y.lineDashOffset }, set: function (t) { this.Y.lineDashOffset = t } }, lineJoin: { get: function () { return this.Y.lineJoin }, set: function (t) { this.Y.lineJoin = t } }, lineWidth: { get: function () { return this.Y.lineWidth }, set: function (t) { this.Y.lineWidth = t } }, miterLimit: { get: function () { return this.Y.miterLimit }, set: function (t) { this.Y.miterLimit = t } }, shadowBlur: { get: function () { return this.Y.shadowBlur }, set: function (t) { this.Y.shadowBlur = t } }, shadowColor: { get: function () { return this.Y.shadowColor }, set: function (t) { this.Y.shadowColor = t } }, shadowOffsetX: { get: function () { return this.Y.shadowOffsetX }, set: function (t) { this.Y.shadowOffsetX = t } }, shadowOffsetY: { get: function () { return this.Y.shadowOffsetY }, set: function (t) { this.Y.shadowOffsetY = t } }, strokeStyle: { get: function () { return this.Y.strokeStyle }, set: function (t) { this.cu !== t && (this.cu = this.Y.strokeStyle = t) } }, textAlign: { get: function () { return this.Y.textAlign }, set: function (t) { this.Y.textAlign = t } }, imageSmoothingEnabled: { get: function () { return this.Y.imageSmoothingEnabled }, set: function (t) { this.Y.imageSmoothingEnabled = t } }, clipInsteadOfFill: { get: function () { return this.fn }, set: function (t) { this.fn = t } } }); var Ca = Object.freeze([]); function Ta() { this.W = this.u = this.I = this.l = 0 } function La(t) { nh || (Ga(), nh = !0), Q(this), this.s = !1, void 0 === t ? (this.pa = Xa, this.Lk = "black") : "string" == typeof t ? (this.pa = Xa, this.Lk = t) : (this.pa = t, this.Lk = "black"), (t = this.pa) === qa ? (this.ud = vi, this.Yk = _t) : this.Yk = this.ud = t === Ua ? Zt : Kt, this.Qs = 0, this.Cr = NaN, this.ee = this.ss = this.de = null, this.du = this.Mk = 0 } function Aa(t, i, e) { return i = void 0 === i || "number" != typeof i ? .2 : i, e = void 0 === e ? Ha : e, Ba(t), Oa(i, e) } function ja(t, i, e) { return i = void 0 === i || "number" != typeof i ? .2 : i, e = void 0 === e ? Ha : e, Ba(t), Oa(-i, e) } function Da(t, i, e) { Ba(t), t = _a.l; var n = _a.I, o = _a.u, r = _a.W; return Ba(i), void 0 === e && (e = .5), "rgba(" + Math.round((_a.l - t) * e + t) + ", " + Math.round((_a.I - n) * e + n) + ", " + Math.round((_a.u - o) * e + o) + ", " + Math.round((_a.W - r) * e + r) + ")" } function Fa(t) { return null === t ? null : t instanceof La ? t.Vx() : (Ba(t), (299 * _a.l + 587 * _a.I + 114 * _a.u) / 1e3 < 128) } function Oa(t, i) { switch (i) { case Ha: i = 100 * Ra(_a.l); var e = 100 * Ra(_a.I), n = 100 * Ra(_a.u); return ih.l = .4124564 * i + .3575761 * e + .1804375 * n, ih.I = .2126729 * i + .7151522 * e + .072175 * n, ih.u = .0193339 * i + .119192 * e + .9503041 * n, ih.W = _a.W, i = za(ih.l / $a[0]), e = za(ih.I / $a[1]), n = za(ih.u / $a[2]), eh.l = 116 * e - 16, eh.I = 500 * (i - e), eh.u = 200 * (e - n), eh.W = ih.W, eh.l = Math.min(100, Math.max(0, eh.l + 100 * t)), i = (t = (eh.l + 16) / 116) - eh.u / 200, ih.l = $a[0] * Va(eh.I / 500 + t), ih.I = $a[1] * (eh.l > Za * Ja ? Math.pow(t, 3) : eh.l / Za), ih.u = $a[2] * Va(i), ih.W = eh.W, t = -.969266 * ih.l + 1.8760108 * ih.I + .041556 * ih.u, i = .0556434 * ih.l + -.2040259 * ih.I + 1.0572252 * ih.u, _a.l = 255 * Ea((3.2404542 * ih.l + -1.5371385 * ih.I + -.4985314 * ih.u) / 100), _a.I = 255 * Ea(t / 100), _a.u = 255 * Ea(i / 100), _a.W = ih.W, _a.l = Math.round(_a.l), 255 < _a.l ? _a.l = 255 : _a.l < 0 && (_a.l = 0), _a.I = Math.round(_a.I), 255 < _a.I ? _a.I = 255 : _a.I < 0 && (_a.I = 0), _a.u = Math.round(_a.u), 255 < _a.u ? _a.u = 255 : _a.u < 0 && (_a.u = 0), "rgba(" + _a.l + ", " + _a.I + ", " + _a.u + ", " + _a.W + ")"; case Wa: return Ia(), th.u = Math.min(100, Math.max(0, th.u + 100 * t)), "hsla(" + th.l + ", " + th.I + "%, " + th.u + "%, " + th.W + ")"; default: return B("Unknown color space: " + i), "rgba(0, 0, 0, 1)" } } function Ba(t) { nh || (Ga(), nh = !0); var i, e = Qa; null !== e && (e.clearRect(0, 0, 1, 1), e.fillStyle = "#000000", i = e.fillStyle, e.fillStyle = t, e.fillStyle !== i ? (e.fillRect(0, 0, 1, 1), t = e.getImageData(0, 0, 1, 1).data, _a.l = t[0], _a.I = t[1], _a.u = t[2], _a.W = t[3] / 255) : (e.fillStyle = "#FFFFFF", e.fillStyle = t, _a.l = 0, _a.I = 0, _a.u = 0, _a.W = 1)) } function Ia() { var t = _a.l / 255, i = _a.I / 255, e = _a.u / 255, n = Math.max(t, i, e), o = n - (r = Math.min(t, i, e)), r = (n + r) / 2; if (0 == o) var s = t = 0; else { switch (n) { case t: s = (i - e) / o % 6; break; case i: s = (e - t) / o + 2; break; case e: s = (t - i) / o + 4 }(s *= 60) < 0 && (s += 360), t = o / (1 - Math.abs(2 * r - 1)) } th.l = Math.round(s), th.I = Math.round(100 * t), th.u = Math.round(100 * r), th.W = _a.W } function Ra(t) { return (t /= 255) <= .04045 ? t / 12.92 : Math.pow((t + .055) / 1.055, 2.4) } function Ea(t) { return t <= .0031308 ? 12.92 * t : 1.055 * Math.pow(t, 1 / 2.4) - .055 } function za(t) { return Ja < t ? Math.pow(t, 1 / 3) : (Za * t + 16) / 116 } function Va(t) { var i = t * t * t; return Ja < i ? i : (116 * t - 16) / Za } function Ya(t, i) { "string" != typeof t && (t instanceof La || B("Value for " + i + " must be a color string or a Brush, not " + t)) } function Ga() { Qa = es ? new Pa(null).context : null } Na.className = "CanvasSurfaceContext", Ta.className = "ColorNumbers", La.prototype.copy = function () { var t = new La; return t.pa = this.pa, t.Lk = this.Lk, t.ud = this.ud.G(), t.Yk = this.Yk.G(), t.Qs = this.Qs, t.Cr = this.Cr, null !== this.de && (t.de = this.de.copy()), t.ss = this.ss, t }, (t = La.prototype).freeze = function () { return this.s = !0, null !== this.de && this.de.freeze(), this }, t.ea = function () { return Object.isFrozen(this) && B("cannot thaw constant: " + this), this.s = !1, null !== this.de && this.de.ea(), this }, t.fb = function (t) { t.classType === La && (this.type = t) }, t.toString = function () { var t = "Brush("; if (this.type === Xa) t += this.color; else if (t = this.type === qa ? t + "Linear " : this.type === Ua ? t + "Radial " : this.type === Ka ? t + "Pattern " : t + "(unknown) ", t += this.start + " " + this.end, null !== this.colorStops) for (var i = this.colorStops.iterator; i.next();)t += " " + i.key + ":" + i.value; return t + ")" }, t.addColorStop = function (t, i) { return this.s && g(this), ("number" != typeof t || !isFinite(t) || 1 < t || t < 0) && y(t, "0 <= loc <= 1", La, "addColorStop:loc"), null === this.de && (this.de = new at), this.de.add(t, i), this.pa === Xa && (this.type = qa), this.ee = null, this }, t.bA = function (t, i) { if (this.s && g(this), t = void 0 === t || "number" != typeof t ? .2 : t, i = void 0 === i ? Ha : i, this.type === Xa) Ba(this.color), this.color = Oa(t, i); else if ((this.type === qa || this.type === Ua) && null !== this.colorStops) for (var e = this.colorStops.iterator; e.next();)Ba(e.value), this.addColorStop(e.key, Oa(t, i)); return this }, t.$y = function (t, i) { if (this.s && g(this), t = void 0 === t || "number" != typeof t ? .2 : t, i = void 0 === i ? Ha : i, this.type === Xa) Ba(this.color), this.color = Oa(-t, i); else if ((this.type === qa || this.type === Ua) && null !== this.colorStops) for (var e = this.colorStops.iterator; e.next();)Ba(e.value), this.addColorStop(e.key, Oa(-t, i)); return this }, t.Vx = function () { if (this.type === Xa) return Fa(this.color); if (this.type !== qa && this.type !== Ua || null === this.colorStops) return !1; var t = this.colorStops; if (this.type === Ua) return Fa(t.first().value); if (null !== t.get(.5)) return Fa(t.get(.5)); if (2 === t.count) return Fa(Da((t = t.na())[0].value, t[1].value)); for (var i = t.iterator, e = -1, n = -1, o = 1, r = 1; i.next();) { var s = i.key, a = Math.abs(.5 - i.key); r < o && a < o ? (e = s, o = a) : o <= r && a < r && (n = s, r = a) } return n < e && (r = e, e = n, n = r, r = o), o = n - e, Fa(Da(t.get(e), t.get(n), 1 - r / o)) }, l.Object.defineProperties(La.prototype, { type: { get: function () { return this.pa }, set: function (t) { this.s && g(this, t), this.pa = t, this.start.jc() && (t === qa ? this.start = vi : t === Ua && (this.start = Zt)), this.end.jc() && (t === qa ? this.end = _t : t === Ua && (this.end = Zt)), this.ee = null } }, color: { get: function () { return this.Lk }, set: function (t) { this.s && g(this, t), this.Lk = t, this.ee = null } }, start: { get: function () { return this.ud }, set: function (t) { this.s && g(this, t), this.ud = t.G(), this.ee = null } }, end: { get: function () { return this.Yk }, set: function (t) { this.s && g(this, t), this.Yk = t.G(), this.ee = null } }, startRadius: { get: function () { return this.Qs }, set: function (t) { this.s && g(this, t), t < 0 && y(t, ">= zero", La, "startRadius"), this.Qs = t, this.ee = null } }, endRadius: { get: function () { return this.Cr }, set: function (t) { this.s && g(this, t), t < 0 && y(t, ">= zero", La, "endRadius"), this.Cr = t, this.ee = null } }, colorStops: { get: function () { return this.de }, set: function (t) { this.s && g(this, t), this.de = t, this.ee = null } }, pattern: { get: function () { return this.ss }, set: function (t) { this.s && g(this, t), this.ss = t, this.ee = null } } }), La.prototype.isDark = La.prototype.Vx, La.prototype.darkenBy = La.prototype.$y, La.prototype.lightenBy = La.prototype.bA, La.prototype.addColorStop = La.prototype.addColorStop; var Xa, qa, Ua, Ka, Ha, Wa, Ja = 216 / 24389, Za = 24389 / 27, $a = [95.047, 100, 108.883], Qa = null, _a = new Ta, th = new Ta, ih = new Ta, eh = new Ta, nh = !1; function oh() { this.name = "Base" } function rh() { this.name = "Base" } function sh() { this.name = "Base" } function ah() { this.name = "Base" } function hh() { this.name = "Base" } function lh() { this.name = "Base" } function uh() { this.name = "Base", this.name = "Table" } function ch() { this.name = "Base" } function fh() { this.name = "Base" } function dh() { this.name = "Base" } function ph() { this.name = "Base" } function gh(t, i, e) { if (i < 0) return 0 == t % i; if (0 == t % i) { i = e.length; for (var n = 0; n < i; n++)if (0 == t % e[n]) return; return 1 } } function yh() { this.name = "Base" } function mh(t, i, e, n) { var o; !1 !== na(n) && (0 === (o = n.strokeWidth) && t instanceof du && t.type === xh.Link && t.adornedObject instanceof Kh && (o = t.adornedObject.strokeWidth), o *= n.ya, t instanceof Fu && null !== t.ka ? Ys(n, (t = t.ka.bounds).x - o / 2, t.y - o / 2, t.width + o, t.height + o) : t instanceof du && null !== t.adornedPart.ka ? Ys(n, (t = t.adornedPart.ka.bounds).x - o / 2, t.y - o / 2, t.width + o, t.height + o) : Ys(n, -o / 2, -o / 2, i + o, e + o), oa(n, !1)) } function vh() { this.name = "Base" } function xh(t) { Es.call(this), this.pa = void 0 === t ? xh.Position : t, null === this.pa && B("Panel type not specified or PanelLayout not loaded: " + t), this.V = new J, this.eb = ji, this.pa === xh.Grid && (this.isAtomic = !0), this.un = bi, this.Nf = Ur, this.pa === xh.Table && bh(this), this.Zp = qr, this.Tn = xt, this.Un = kt, this.Qn = 0, this.Pn = 100, this.Sn = 10, this.Rn = 0, this.ci = this.jb = this.Xg = this.Wg = this.uj = null, this.jo = NaN, this.ne = this.si = null, this.pl = "category", this.Ld = null, this.sg = new yi(NaN, NaN, NaN, NaN), this.sh = this.sp = this.Hi = null, this.Gg = "" } function bh(t) { t.nj = ji, t.Og = 1, t.ii = null, t.hi = null, t.Ng = 1, t.Mg = null, t.gi = null, t.sb = [], t.ob = [], t.Mj = Uh, t.kj = Uh, t.Ki = 0, t.vi = 0 } function wh(t, i, e, n) { for (var o = n.length, r = t.actualBounds, s = t.naturalBounds, a = !0, h = 0; h < o; h++) { var l = n[h]; if (void 0 !== l) if (a) a = !1; else if (0 !== l.actual) { if (e) { if (l.position > r.height) continue } else if (l.position > r.width) continue; var u = l.separatorStrokeWidth; isNaN(u) && (u = e ? t.Og : t.Ng); var c, f = l.separatorStroke; null === f && (f = e ? t.ii : t.Mg), 0 !== u && null !== f && (Us(t, i, f, !1, !1, s, r), f = !1, null === (c = l.separatorDashArray) && (c = e ? t.hi : t.gi), null !== c && (f = !0, i.jt(c, 0)), i.beginPath(), c = l.position + u, e ? c > r.height && (u -= c - r.height) : c > r.width && (u -= c - r.width), l = l.position + u / 2, i.lineWidth = u, u = t.eb, e ? (l += u.top, c = r.width - u.right, i.moveTo(u.left, l), i.lineTo(c, l)) : (l += u.left, c = r.height - u.bottom, i.moveTo(l, u.top), i.lineTo(l, c)), i.stroke(), f && i.ht()) } } } function kh(t, i, e, n, o) { for (var r = n.length, s = t.actualBounds, a = t.naturalBounds, h = 0; h < r; h++) { var l, u, c, f, d = n[h]; void 0 !== d && null !== d.background && d.coversSeparators !== o && 0 !== d.actual && (l = e ? s.height : s.width, d.position > l || (u = d.uc(), c = d.separatorStrokeWidth, isNaN(c) && (c = e ? t.Og : t.Ng), null === (f = d.separatorStroke) && (f = e ? t.ii : t.Mg), null === f && (c = 0), u -= c, l < (c = d.position + c) + (u += d.actual) && (u = l - c), u <= 0 || (l = t.eb, Us(t, i, d.background, !0, !1, a, s), e ? i.fillRect(l.left, c + l.top, s.width - (l.left + l.right), u) : i.fillRect(c + l.left, l.top, u, s.height - (l.top + l.bottom))))) } } function Mh(t) { return "LineV" === t || "BarV" === t } function Sh(t) { return null !== t.part ? t.part.locationObject : null } function Ph(t, i) { !function t(i, e, n) { n(e); e = e.V.j; for (var o = e.length, r = 0; r < o; r++) { var s = e[r]; s instanceof xh && t(i, s, n) } }(t, t, i) } function Nh(t, i) { !function t(i, e, n) { n(e); if (e instanceof xh) for (var o = (e = e.V.j).length, r = 0; r < o; r++)t(i, e[r], n) }(t, t, i) } function Ch(t, i, e, n) { for (var o = t.V.j, r = o.length; r--;) { var s, a, h = o[r]; h.visible && (s = h.actualBounds, a = t.naturalBounds, s.x > a.width || s.y > a.height || s.x + s.width < 0 || s.y + s.height < 0 || (h instanceof xh && Ch(h, i, e, n), null !== i && (h = i(h)), null === h || null !== e && !e(h) || n.add(h))) } } function Th(t) { var i = null; return t instanceof Kh && ((i = t.spot1) === bi && (i = null), null !== (t = t.geometry) && null === i && (i = t.spot1)), null === i && (i = Ht), i } function Lh(t) { var i = null; return t instanceof Kh && ((i = t.spot2) === bi && (i = null), null !== (t = t.geometry) && null === i && (i = t.spot2)), null === i && (i = ti), i } function Ah(t, i) { t.F = i ? 16777216 | t.F : -16777217 & t.F } function jh(t) { return null !== (t = t.ci) && t.s } function Dh(t) { var a = t.ci; if (null === a) null !== t.data && B("Template cannot have .data be non-null: " + t), t.ci = a = new J; else if (a.s) return; var h = new J; Ah(t, !1), t.Jm(t, function (t, i) { var e = i.bb; if (null !== e) for (ta(i, !1), e = e.iterator; e.next();) { var n = e.value; n.mode === Qf && ta(i, !0); var o = n.sourceName; null !== o && ("/" === o && Ah(t, !0), null !== (o = Zf(n, t, i)) && (h.add(o), null === o.Ol && (o.Ol = new J), o.Ol.add(n))), a.add(n) } if (i instanceof xh && i.type === xh.Table) { if (0 < i.sb.length) for (e = (t = i.sb).length, n = 0; n < e; n++)if (void 0 !== (o = t[n]) && null !== o.bb) for (var r = o.bb.iterator; r.next();) { var s = r.value; s.cd = o, s.Rp = 2, s.Ul = o.index, a.add(s) } if (0 < i.ob.length) for (t = (i = i.ob).length, e = 0; e < t; e++)if (void 0 !== (n = i[e]) && null !== n.bb) for (o = n.bb.iterator; o.next();)(r = o.value).cd = n, r.Rp = 1, r.Ul = n.index, a.add(r) } }); for (var i, e, n = h.iterator; n.next();) { var o = n.value; if (null !== o.Ol) { ta(o, !0); for (var r = o.Ol.iterator; r.next();) { var s = r.value; null === o.bb && (o.bb = new J), o.bb.add(s) } } o.Ol = null } for (n = a.iterator; n.next();) { null !== (r = (o = n.value).cd) && (o.cd = null, 0 < (e = (i = o.targetProperty).indexOf(".")) && r instanceof xh && (s = i.substring(0, e), i = i.substr(e + 1), null !== (e = r.Ya(s)) ? (r = e, o.targetProperty = i) : v('Warning: unable to find GraphObject named "' + s + '" for Binding: ' + o.toString())), r instanceof Yh ? (s = tt(r.panel), o.gj = void 0 === s ? -1 : s, r.panel.Jk = o.gj) : r instanceof Es ? (s = tt(r), o.gj = void 0 === s ? -1 : s, r.Jk = o.gj) : B("Unknown type of binding target: " + r)) } a.freeze(), t instanceof Hl && t.Wb() && t.zb() } function Fh(t) { if (t.type === xh.Spot || t.type === xh.Auto) return Math.min(t.V.length, 1); if (t.type !== xh.Link) return t.type === xh.Table && 0 < t.V.length && ((t = t.V.L(0)).isPanelMain && t instanceof xh && (t.type === xh.TableRow || t.type === xh.TableColumn)) ? 1 : 0; for (var i = (t = t.V).length, e = 0; e < i; e++) { var n = t.L(e); if (!(n instanceof Kh && n.isPanelMain)) break } return e } function Oh(t, i, e) { var n, o, r; null == i || e < 0 || (n = function (t, i) { if (null === i) return ""; if ("function" == typeof (t = t.pl)) t = t(i); else { if ("string" != typeof t || "object" != typeof i) return ""; if ("" === t) return ""; t = Uf(i, t) } return void 0 === t ? "" : "string" == typeof t ? t : (B("Panel.getCategoryForItemData found a non-string category for " + i + ": " + t), "") }(t, i), (r = null) !== (o = t.itemTemplateMap) && (r = o.H(n)), null === r && (Eh || (Eh = !0, v('No item template Panel found for category "' + n + '" on ' + t), v("  Using default item template."), n = new xh, (o = new el).bind(new Jf("text", "", N)), n.add(o), zh = n), r = zh), null !== (n = r) && (Dh(n), 0 == (16777216 & (n = n.copy()).F) || null !== (o = t.Ui()) && Ah(o, !0), "object" == typeof i && (null === t.Ld && (t.Ld = new at), t.Ld.add(i, n)), o = e + Fh(t), t.tb(o, n), n.jb = i, Bh(t, o, e), n.jb = null, n.data = i)) } function Bh(t, i, e) { for (t = t.V; i < t.length;) { var n, o, r = t.L(i); r instanceof xh && (n = i, o = e, r.type === xh.TableRow ? r.row = n : r.type === xh.TableColumn && (r.column = n), r.itemIndex = o), i++, e++ } } function Ih(t, i, e) { var n = i.enabledChanged; if (null !== n && n(i, e), i instanceof xh) { n = (i = i.V.j).length; for (var o = 0; o < n; o++) { var r = i[o]; e && r instanceof xh && !r.isEnabled || Ih(t, r, e) } } } function Rh(t, i) { i.name = t, Vh.add(t, i) } La.className = "Brush", La.Solid = Xa = new V(La, "Solid", 0), La.Linear = qa = new V(La, "Linear", 1), La.Radial = Ua = new V(La, "Radial", 2), La.Pattern = Ka = new V(La, "Pattern", 4), La.Lab = Ha = new V(La, "Lab", 5), La.HSL = Wa = new V(La, "HSL", 6), La.randomColor = function (t, i) { void 0 === t && (t = 128), void 0 === i && (i = Math.max(t, 255)); var e = Math.abs(i - t); i = Math.floor(t + Math.random() * e).toString(16); var n = Math.floor(t + Math.random() * e).toString(16); return t = Math.floor(t + Math.random() * e).toString(16), i.length < 2 && (i = "0" + i), n.length < 2 && (n = "0" + n), t.length < 2 && (t = "0" + t), "#" + i + n + t }, La.isValidColor = function (t) { if ("black" === t) return !0; if ("" === t) return !1; nh || (Ga(), nh = !0); var i = Qa; if (null === i) return !0; i.fillStyle = "#000000"; var e = i.fillStyle; return i.fillStyle = t, i.fillStyle !== e || (i.fillStyle = "#FFFFFF", e = i.fillStyle, i.fillStyle = t, i.fillStyle !== e) }, La.lighten = function (t) { return Aa(t) }, La.lightenBy = Aa, La.darken = function (t) { return ja(t) }, La.darkenBy = ja, La.mix = Da, La.isDark = Fa, oh.prototype.measure = function () { }, oh.prototype.eA = function (t, i, e, n, o) { t.measure(i, e, n, o) }, oh.prototype.arrange = function () { }, oh.prototype.Qy = function (t, i, e, n, o, r) { t.arrange(i, e, n, o, r) }, oh.prototype.bc = function () { }, l.Object.defineProperties(oh.prototype, { classType: { get: function () { return xh } } }), oh.prototype.arrangeElement = oh.prototype.Qy, oh.prototype.measureElement = oh.prototype.eA, oh.className = "PanelLayout", h(rh, oh), rh.prototype.measure = function (t, i, e, n, o, r, s) { var a = n.length; t = Sh(t); for (var h = 0; h < a; h++) { var l, u, c, f, d = n[h]; !d.visible && d !== t || (c = (l = d.margin).right + l.left, l = l.top + l.bottom, d.measure(i, e, r, s), u = d.measuredBounds, c = Math.max(u.width + c, 0), l = Math.max(u.height + l, 0), u = d.position.x, f = d.position.y, isFinite(u) || (u = 0), isFinite(f) || (f = 0), d instanceof Kh && d.isGeometryPositioned && (u -= d = d.strokeWidth / 2, f -= d), mi(o, u, f, c, l)) } }, rh.prototype.arrange = function (t, i, e) { var n = i.length, o = t.padding; for (t = e.x - o.left, e = e.y - o.top, o = 0; o < n; o++) { var r, s = i[o], a = s.measuredBounds, h = s.margin, l = s.position.x, u = s.position.y, l = isNaN(l) ? -t : l - t, u = isNaN(u) ? -e : u - e; s instanceof Kh && s.isGeometryPositioned && (l -= r = s.strokeWidth / 2, u -= r), s.visible && s.arrange(l + h.left, u + h.top, a.width, a.height) } }, h(sh, oh), sh.prototype.measure = function (t, i, e, n, o, r, s) { var a = n.length; i = zi(), r = Sh(t); for (var h = 0; h < a; h++) { var l, u, c = n[h]; !c.visible && c !== r || ((l = Js(c, !1)) !== Xr && l !== Kr ? i.push(c) : (c.measure(1 / 0, e, 0, s), l = c.margin, c = c.measuredBounds, u = Math.max(c.height + l.top + l.bottom, 0), o.width += Math.max(c.width + l.right + l.left, 0), o.height = Math.max(o.height, u))) } for (n = i.length, t.desiredSize.height ? e = Math.min(t.desiredSize.height, t.maxSize.height) : 0 !== o.height && (e = Math.min(o.height, t.maxSize.height)), t = 0; t < n; t++)!(h = i[t]).visible && h !== r || (a = (l = h.margin).right + l.left, l = l.top + l.bottom, h.measure(1 / 0, e, 0, s), h = h.measuredBounds, l = Math.max(h.height + l, 0), o.width += Math.max(h.width + a, 0), o.height = Math.max(o.height, l)); Vi(i) }, sh.prototype.arrange = function (t, i, e) { for (var n = i.length, o = t.padding, r = o.top, s = t.isOpposite, a = s ? e.width : o.left, h = 0; h < n; h++) { var l, u, c, f, d, p, g = r, y = i[h]; y.visible && (l = y.measuredBounds, c = (u = y.margin).top + u.bottom, f = r + o.bottom, d = l.height, p = Js(y, !1), (isNaN(y.desiredSize.height) && p === Gr || p === Hr) && (d = Math.max(e.height - c - f, 0)), c = d + c + f, (f = y.alignment).Mb() && (f = t.defaultAlignment), f.gb() || (f = Zt), s && (a -= l.width + u.left + u.right), y.arrange(a + f.offsetX + u.left, g + f.offsetY + u.top + (e.height * f.y - c * f.y), l.width, d), s || (a += l.width + u.left + u.right)) } }, h(ah, oh), ah.prototype.measure = function (t, i, e, n, o, r) { var s = n.length; e = zi(); for (var a = Sh(t), h = 0; h < s; h++) { var l, u, c = n[h]; !c.visible && c !== a || ((l = Js(c, !1)) !== Xr && l !== Hr ? e.push(c) : (l = (u = c.margin).right + u.left, u = u.top + u.bottom, c.measure(i, 1 / 0, r, 0), c = c.measuredBounds, jt(o, Math.max(o.width, Math.max(c.width + l, 0)), o.height + Math.max(c.height + u, 0)))) } if (0 !== (n = e.length)) { for (t.desiredSize.width ? i = Math.min(t.desiredSize.width, t.maxSize.width) : 0 !== o.width && (i = Math.min(o.width, t.maxSize.width)), t = 0; t < n; t++)!(h = e[t]).visible && h !== a || (s = (c = h.margin).right + c.left, c = c.top + c.bottom, h.measure(i, 1 / 0, r, 0), h = h.measuredBounds, c = Math.max(h.height + c, 0), o.width = Math.max(o.width, Math.max(h.width + s, 0)), o.height += c); Vi(e) } }, ah.prototype.arrange = function (t, i, e) { for (var n = i.length, o = t.padding, r = o.left, s = t.isOpposite, a = s ? e.height : o.top, h = 0; h < n; h++) { var l, u, c, f, d, p, g = r, y = i[h]; y.visible && (l = y.measuredBounds, c = (u = y.margin).left + u.right, f = r + o.right, d = l.width, p = Js(y, !1), (isNaN(y.desiredSize.width) && p === Gr || p === Kr) && (d = Math.max(e.width - c - f, 0)), c = d + c + f, (f = y.alignment).Mb() && (f = t.defaultAlignment), f.gb() || (f = Zt), s && (a -= l.height + u.bottom + u.top), y.arrange(g + f.offsetX + u.left + (e.width * f.x - c * f.x), a + f.offsetY + u.top, d, l.height), s || (a += l.height + u.bottom + u.top)) } }, h(hh, oh), hh.prototype.measure = function (t, i, e, n, o, r, s) { var a = n.length, h = t.Ab(), l = h.margin, u = l.right + l.left, c = l.top + l.bottom; h.measure(i, e, r, s); var f = h.measuredBounds; r = f.width, s = f.height; for (var d = Math.max(r + u, 0), p = Math.max(s + c, 0), g = t.isClipping, y = yi.allocAt(-l.left, -l.top, d, p), m = !0, v = Sh(t), x = 0; x < a; x++) { var b = n[x]; if (b !== h && (b.visible || b === v)) { switch (d = (l = b.margin).right + l.left, p = l.top + l.bottom, f = Js(b, !1)) { case Gr: i = r, e = s; break; case Kr: i = r; break; case Hr: e = s }b.measure(i, e, 0, 0), f = b.measuredBounds, d = Math.max(f.width + d, 0), p = Math.max(f.height + p, 0); var w = b.alignment; w.Mb() && (w = t.defaultAlignment), w.gb() || (w = Zt); var k = b.alignmentFocus; k.Mb() && (k = Zt); var M = null; if (b instanceof xh && "" !== b.Gg && (b.arrange(0, 0, f.width, f.height), (M = b.Ya(b.Gg)) === b && (M = null)), null !== M) { for (l = M.naturalBounds, f = M.margin, l = gi.allocAt(k.x * l.width - k.offsetX - f.left, k.y * l.height - k.offsetY - f.top); M !== b;)M.transform.ra(l), M = M.panel; b = w.x * r + w.offsetX - l.x, f = w.y * s + w.offsetY - l.y, gi.free(l) } else b = w.x * r + w.offsetX - (k.x * f.width + k.offsetX) - l.left, f = w.y * s + w.offsetY - (k.y * f.height + k.offsetY) - l.top; m ? (m = !1, o.h(b, f, d, p)) : mi(o, b, f, d, p) } } switch (m ? o.assign(y) : g ? o.Hv(y.x, y.y, y.width, y.height) : mi(o, y.x, y.y, y.width, y.height), yi.free(y), (f = h.stretch) === Ur && (f = Js(h, !1)), f) { case Xr: return; case Gr: if (!isFinite(i) && !isFinite(e)) return; break; case Kr: if (!isFinite(i)) return; break; case Hr: if (!isFinite(e)) return }for (r = (f = h.measuredBounds).width, s = f.height, d = Math.max(r + u, 0), p = Math.max(s + c, 0), l = h.margin, y = yi.allocAt(-l.left, -l.top, d, p), i = 0; i < a; i++)(e = n[i]) === h || !e.visible && e !== v || (d = (l = e.margin).right + l.left, p = l.top + l.bottom, f = e.measuredBounds, d = Math.max(f.width + d, 0), p = Math.max(f.height + p, 0), (u = e.alignment).Mb() && (u = t.defaultAlignment), u.gb() || (u = Zt), (e = e.alignmentFocus).Mb() && (e = Zt), m ? (m = !1, o.h(u.x * r + u.offsetX - (e.x * f.width + e.offsetX) - l.left, u.y * s + u.offsetY - (e.y * f.height + e.offsetY) - l.top, d, p)) : mi(o, u.x * r + u.offsetX - (e.x * f.width + e.offsetX) - l.left, u.y * s + u.offsetY - (e.y * f.height + e.offsetY) - l.top, d, p)); m ? o.assign(y) : g ? o.Hv(y.x, y.y, y.width, y.height) : mi(o, y.x, y.y, y.width, y.height), yi.free(y) }, hh.prototype.arrange = function (t, i, e) { var n = i.length, o = t.Ab(), r = (s = o.measuredBounds).width, s = s.height, a = (h = t.padding).left, h = h.top, l = a - e.x, u = h - e.y; o.arrange(l, u, r, s); for (var c = 0; c < n; c++) { var f = i[c]; if (f !== o) { var d = (p = f.measuredBounds).width, p = p.height; if ((u = f.alignment).Mb() && (u = t.defaultAlignment), u.gb() || (u = Zt), (y = f.alignmentFocus).Mb() && (y = Zt), l = null, f instanceof xh && "" !== f.Gg && ((l = f.Ya(f.Gg)) === f && (l = null)), null !== l) { for (var g = l.naturalBounds, y = gi.allocAt(y.x * g.width - y.offsetX, y.y * g.height - y.offsetY); l !== f;)l.transform.ra(y), l = l.panel; l = u.x * r + u.offsetX - y.x, u = u.y * s + u.offsetY - y.y, gi.free(y) } else l = u.x * r + u.offsetX - (y.x * d + y.offsetX), u = u.y * s + u.offsetY - (y.y * p + y.offsetY); l -= e.x, u -= e.y, f.visible && f.arrange(a + l, h + u, d, p) } } }, h(lh, oh), lh.prototype.measure = function (t, i, e, n, o, r, s) { var a = n.length, h = t.Ab(), l = i, u = e, c = (y = h.margin).right + y.left, f = y.top + y.bottom; h.measure(i, e, r, s), y = h.measuredBounds; var d = 0, p = null; h instanceof Kh && (d = (p = h).strokeWidth * p.scale); var g = Math.max(y.width + c, 0), y = Math.max(y.height + f, 0), m = (v = Th(h)).x * g + v.offsetX, v = v.y * y + v.offsetY, x = (b = Lh(h)).x * g + b.offsetX, b = b.y * y + b.offsetY; for (isFinite(i) && (l = Math.max(Math.abs(m - x) - d, 0)), isFinite(e) && (u = Math.max(Math.abs(v - b) - d, 0)), (d = Yi.alloc()).h(0, 0), t = Sh(t), b = 0; b < a; b++)(v = n[b]) === h || !v.visible && v !== t || (g = (y = v.margin).right + y.left, m = y.top + y.bottom, v.measure(l, u, 0, 0), y = v.measuredBounds, g = Math.max(y.width + g, 0), y = Math.max(y.height + m, 0), d.h(Math.max(g, d.width), Math.max(y, d.height))); if (1 === a) o.width = g, o.height = y, Yi.free(d); else { switch (v = Th(h), a = n = 0, (b = Lh(h)).x !== v.x && b.y !== v.y && (n = d.width / Math.abs(b.x - v.x), a = d.height / Math.abs(b.y - v.y)), Yi.free(d), d = 0, null !== p && (d = p.strokeWidth * p.scale, Wh(p) === qr && (n = a = Math.max(n, a))), n += Math.abs(v.offsetX) + Math.abs(b.offsetX) + d, a += Math.abs(v.offsetY) + Math.abs(b.offsetY) + d, (p = h.stretch) === Ur && (p = Js(h, !1)), p) { case Xr: s = r = 0; break; case Gr: isFinite(i) && (n = i), isFinite(e) && (a = e); break; case Kr: isFinite(i) && (n = i), s = 0; break; case Hr: r = 0, isFinite(e) && (a = e) }h.nm(), h.measure(n, a, r, s), o.width = h.measuredBounds.width + c, o.height = h.measuredBounds.height + f } }, lh.prototype.arrange = function (t, i) { var e = i.length, n = t.Ab(), o = n.measuredBounds, r = yi.alloc(); r.h(0, 0, 1, 1); var s = (a = n.margin).left, a = a.top, h = (l = t.padding).left, l = l.top; n.arrange(h + s, l + a, o.width, o.height); var u = Th(n), c = Lh(n), f = u.y * o.height + u.offsetY, d = c.x * o.width + c.offsetX, c = c.y * o.height + c.offsetY; for (r.x = u.x * o.width + u.offsetX, r.y = f, mi(r, d, c, 0, 0), r.x += s + h, r.y += a + l, o = 0; o < e; o++)(s = i[o]) !== n && (h = s.measuredBounds, a = s.margin, l = Math.max(h.width + a.right + a.left, 0), u = Math.max(h.height + a.top + a.bottom, 0), (f = s.alignment).Mb() && (f = t.defaultAlignment), f.gb() || (f = Zt), l = r.width * f.x + f.offsetX - l * f.x + a.left + r.x, a = r.height * f.y + f.offsetY - u * f.y + a.top + r.y, s.visible && (Et(r.x, r.y, r.width, r.height, l, a, h.width, h.height) ? s.arrange(l, a, h.width, h.height) : s.arrange(l, a, h.width, h.height, new yi(r.x, r.y, r.width, r.height)))); yi.free(r) }, h(uh, oh), uh.prototype.measure = function (t, i, e, n, o, r, s) { for (var a = n.length, h = zi(), l = zi(), u = 0; u < a; u++) { var c = n[u], f = c instanceof xh ? c : null; if (null === f || f.type !== xh.TableRow && f.type !== xh.TableColumn || !c.visible) h.push(c); else { l.push(f); for (var d = f.V.j, p = d.length, g = 0; g < p; g++) { var y = d[g]; f.type === xh.TableRow ? y.row = c.row : f.type === xh.TableColumn && (y.column = c.column), h.push(y) } } } 0 === (a = h.length) && (t.getRowDefinition(0), t.getColumnDefinition(0)); for (var m = [], v = 0; v < a; v++) { var x = h[v]; oa(x, !0), sa(x, !0), m[x.row] || (m[x.row] = []), m[x.row][x.column] || (m[x.row][x.column] = []), m[x.row][x.column].push(x) } Vi(h); for (var b = zi(), w = zi(), k = zi(), M = { count: 0 }, S = { count: 0 }, P = i, N = e, C = t.sb, a = C.length, T = 0; T < a; T++) { var L = C[T]; void 0 !== L && (L.actual = 0) } a = (C = t.ob).length; for (var A = 0; A < a; A++)void 0 !== (L = C[A]) && (L.actual = 0); for (var j = m.length, D = 0, F = 0; F < j; F++)m[F] && (D = Math.max(D, m[F].length)); for (var O = Math.min(t.topIndex, j - 1), B = Math.min(t.leftIndex, D - 1), I = 0, j = m.length, R = Sh(t), E = 0; E < j; E++)if (m[E]) { D = m[E].length; for (var z = t.getRowDefinition(E), V = z.actual = 0; V < D; V++)if (m[E][V]) { var Y = t.getColumnDefinition(V); void 0 === b[V] && (Y.actual = 0, b[V] = !0); for (var G = m[E][V], X = G.length, q = 0; q < X; q++) { var U, K, H, W, J, Z, $, Q, _, tt, it, et, nt, ot, rt = G[q]; !rt.visible && rt !== R || ((U = 1 < rt.rowSpan || 1 < rt.columnSpan) && (E < O || V < B || w.push(rt)), H = (K = rt.margin).right + K.left, W = K.top + K.bottom, Ni = Zs(rt, z, Y, !1), J = rt.desiredSize, Z = !isNaN(J.height), $ = !isNaN(J.width) && Z, U || Ni === Xr || $ || E < O || V < B || (void 0 !== M[V] || Ni !== Gr && Ni !== Kr || (M[V] = -1, M.count++), void 0 !== S[E] || Ni !== Gr && Ni !== Hr || (S[E] = -1, S.count++), k.push(rt)), rt.measure(1 / 0, 1 / 0, 0, 0), E < O || V < B || (Q = rt.measuredBounds, _ = Math.max(Q.width + H, 0), tt = Math.max(Q.height + W, 0), 1 !== rt.rowSpan || Ni !== Xr && Ni !== Kr || (it = (L = t.getRowDefinition(E)).uc(), N < (I = Math.max(tt - L.actual, 0)) + it && (I = Math.max(N - it, 0)), et = 0 === L.actual, L.actual = L.actual + I, N = Math.max(N - (I + (et ? it : 0)), 0)), 1 !== rt.columnSpan || Ni !== Xr && Ni !== Hr || (nt = (L = t.getColumnDefinition(V)).uc(), P < (I = Math.max(_ - L.actual, 0)) + nt && (I = Math.max(P - nt, 0)), ot = 0 === L.actual, L.actual = L.actual + I, P = Math.max(P - (I + (ot ? nt : 0)), 0)), U && rt.nm())) } } } Vi(b); var st = 0, at = 0; a = t.columnCount; for (var ht = 0; ht < a; ht++) { var lt = t.ob[ht]; void 0 !== lt && (st += lt.ha, 0 !== lt.ha && (st += lt.uc())) } a = t.rowCount; for (var ut = 0; ut < a; ut++) { var ct = t.sb[ut]; void 0 !== ct && (at += ct.ha, 0 !== ct.ha && (at += ct.uc())) } P = Math.max(i - st, 0); var ft = N = Math.max(e - at, 0), dt = P; a = k.length; for (var pt = 0; pt < a; pt++) { var gt = k[pt], yt = t.getRowDefinition(gt.row), mt = t.getColumnDefinition(gt.column), vt = gt.measuredBounds, xt = gt.margin, bt = xt.right + xt.left, wt = xt.top + xt.bottom; M[gt.column] = 0 === mt.actual && void 0 !== M[gt.column] ? Math.max(vt.width + bt, M[gt.column]) : null, S[gt.row] = 0 === yt.actual && void 0 !== S[gt.row] ? Math.max(vt.height + wt, S[gt.row]) : null } var kt, Mt = 0, St = 0; for (kt in S) "count" !== kt && (Mt += S[kt]); for (kt in M) "count" !== kt && (St += M[kt]); for (var Pt = Yi.alloc(), Nt = 0; Nt < a; Nt++) { var Ct = k[Nt]; if (Ct.visible || Ct === R) { var Tt = t.getRowDefinition(Ct.row), Lt = t.getColumnDefinition(Ct.column), At = 0, At = isFinite(Lt.width) ? Lt.width : (At = isFinite(P) && null !== M[Ct.column] ? 0 === St ? Lt.actual + P : M[Ct.column] / St * dt : null === M[Ct.column] && Lt.actual || P, Math.max(0, At - Lt.uc())), jt = 0, jt = isFinite(Tt.height) ? Tt.height : (jt = isFinite(N) && null !== S[Ct.row] ? 0 === Mt ? Tt.actual + N : S[Ct.row] / Mt * ft : null === S[Ct.row] && Tt.actual || N, Math.max(0, jt - Tt.uc())); switch (Pt.h(Math.max(Lt.minimum, Math.min(At, Lt.maximum)), Math.max(Tt.minimum, Math.min(jt, Tt.maximum))), Ni = Zs(Ct, Tt, Lt, !1)) { case Kr: Pt.height = Math.max(Pt.height, Tt.actual + N); break; case Hr: Pt.width = Math.max(Pt.width, Lt.actual + P) }var Dt = Ct.margin, Ft = Dt.right + Dt.left, Ot = Dt.top + Dt.bottom; Ct.nm(), Ct.measure(Pt.width, Pt.height, Lt.minimum, Tt.minimum); var Bt = Ct.measuredBounds, It = Math.max(Bt.width + Ft, 0), Rt = Math.max(Bt.height + Ot, 0); isFinite(P) && (It = Math.min(It, Pt.width)), isFinite(N) && (Rt = Math.min(Rt, Pt.height)); var Et = 0, Et = Tt.actual; Tt.actual = Math.max(Tt.actual, Rt), I = Tt.actual - Et, N = Math.max(N - I, 0), Et = Lt.actual, Lt.actual = Math.max(Lt.actual, It), I = Lt.actual - Et, P = Math.max(P - I, 0) } } Vi(k); var zt = Yi.alloc(), Vt = zi(), Yt = zi(); if (0 !== (a = w.length)) for (var Gt = 0; Gt < j; Gt++)if (m[Gt]) { D = m[Gt].length; var Xt = t.getRowDefinition(Gt); Vt[Gt] = Xt.actual; for (var qt, Ut = 0; Ut < D; Ut++) { m[Gt][Ut] && (qt = t.getColumnDefinition(Ut), Yt[Ut] = qt.actual) } } for (var Kt = 0; Kt < a; Kt++) { var Ht = w[Kt]; if (Ht.visible || Ht === R) { var Wt = t.getRowDefinition(Ht.row), Jt = t.getColumnDefinition(Ht.column); switch (Pt.h(Math.max(Jt.minimum, Math.min(i, Jt.maximum)), Math.max(Wt.minimum, Math.min(e, Wt.maximum))), Ni = Zs(Ht, Wt, Jt, !1)) { case Gr: 0 !== Yt[Jt.index] && (Pt.width = Math.min(Pt.width, Yt[Jt.index])), 0 !== Vt[Wt.index] && (Pt.height = Math.min(Pt.height, Vt[Wt.index])); break; case Kr: 0 !== Yt[Jt.index] && (Pt.width = Math.min(Pt.width, Yt[Jt.index])); break; case Hr: 0 !== Vt[Wt.index] && (Pt.height = Math.min(Pt.height, Vt[Wt.index])) }isFinite(Jt.width) && (Pt.width = Jt.width), isFinite(Wt.height) && (Pt.height = Wt.height), zt.h(0, 0); for (var Zt = 1; Zt < Ht.rowSpan && !(Ht.row + Zt >= t.rowCount); Zt++)L = t.getRowDefinition(Ht.row + Zt), I = 0, I = Ni === Gr || Ni === Hr ? Math.max(L.minimum, 0 === Vt[Ht.row + Zt] ? L.maximum : Math.min(Vt[Ht.row + Zt], L.maximum)) : Math.max(L.minimum, isNaN(L.Pc) ? L.maximum : Math.min(L.Pc, L.maximum)), zt.height += I; for (var $t = 1; $t < Ht.columnSpan && !(Ht.column + $t >= t.columnCount); $t++)L = t.getColumnDefinition(Ht.column + $t), I = 0, I = Ni === Gr || Ni === Kr ? Math.max(L.minimum, 0 === Yt[Ht.column + $t] ? L.maximum : Math.min(Yt[Ht.column + $t], L.maximum)) : Math.max(L.minimum, isNaN(L.Pc) ? L.maximum : Math.min(L.Pc, L.maximum)), zt.width += I; Pt.width += zt.width, Pt.height += zt.height; var Qt = Ht.margin, _t = Qt.right + Qt.left, ti = Qt.top + Qt.bottom; Ht.measure(Pt.width, Pt.height, r, s); for (var ii = Ht.measuredBounds, ei = Math.max(ii.width + _t, 0), ni = Math.max(ii.height + ti, 0), oi = 0, ri = 0; ri < Ht.rowSpan && !(Ht.row + ri >= t.rowCount); ri++)oi += (L = t.getRowDefinition(Ht.row + ri)).total || 0; if (oi < ni) { var si = ni - oi, ai = ni - oi; if (null !== Ht.spanAllocation) for (var hi = Ht.spanAllocation, li = 0; li < Ht.rowSpan && !(si <= 0) && !(Ht.row + li >= t.rowCount); li++) { var ui = (L = t.getRowDefinition(Ht.row + li)).ha || 0, ci = hi(Ht, L, ai); L.actual = Math.min(L.maximum, ui + ci), L.ha !== ui && (si -= L.ha - ui) } for (; 0 < si;) { var fi = L.ha || 0; if (isNaN(L.height) && L.maximum > fi && (L.actual = Math.min(L.maximum, fi + si), L.ha !== fi && (si -= L.ha - fi)), 0 === L.index) break; L = t.getRowDefinition(L.index - 1) } } for (var di = 0, pi = 0; pi < Ht.columnSpan && !(Ht.column + pi >= t.columnCount); pi++)di += (L = t.getColumnDefinition(Ht.column + pi)).total || 0; if (di < ei) { var gi = ei - di, yi = ei - di; if (null !== Ht.spanAllocation) for (var mi = Ht.spanAllocation, vi = 0; vi < Ht.columnSpan && !(gi <= 0) && !(Ht.column + vi >= t.columnCount); vi++) { var xi = (L = t.getColumnDefinition(Ht.column + vi)).ha || 0, bi = mi(Ht, L, yi); L.actual = Math.min(L.maximum, xi + bi), L.ha !== xi && (gi -= L.ha - xi) } for (; 0 < gi;) { var wi = L.ha || 0; if (isNaN(L.width) && L.maximum > wi && (L.actual = Math.min(L.maximum, wi + gi), L.ha !== wi && (gi -= L.ha - wi)), 0 === L.index) break; L = t.getColumnDefinition(L.index - 1) } } } } Vi(w), Yi.free(zt), Yi.free(Pt), void 0 !== Vt && Vi(Vt), void 0 !== Yt && Vi(Yt); var ki = 0, Mi = 0, Si = t.desiredSize, Pi = t.maxSize, Ni = Js(t, !0), Ci = at = st = 0, Ti = 0; a = t.columnCount; for (var Li = 0; Li < a; Li++)void 0 !== t.ob[Li] && (L = t.getColumnDefinition(Li), isFinite(L.width) ? (Ci += L.width, Ci += L.uc()) : Gh(L) === qh ? (Ci += L.ha, Ci += L.uc()) : 0 !== L.ha && (st += L.ha, st += L.uc())); ki = isFinite(Si.width) ? Math.min(Si.width, Pi.width) : Ni !== Xr && isFinite(i) ? i : st, ki = Math.max(ki, t.minSize.width), ki = Math.max(ki - Ci, 0); for (var Ai = 0 === st ? 1 : Math.max(ki / st, 1), ji = 0; ji < a; ji++)void 0 !== t.ob[ji] && (L = t.getColumnDefinition(ji), isFinite(L.width) || Gh(L) === qh || (L.actual = L.ha * Ai), L.position = o.width, 0 !== L.ha && (o.width += L.ha, o.width += L.uc())); a = t.rowCount; for (var Di = 0; Di < a; Di++)void 0 !== t.sb[Di] && (L = t.getRowDefinition(Di), isFinite(L.height) ? (Ti += L.height, Ti += L.uc()) : Gh(L) === qh ? (Ti += L.ha, Ti += L.uc()) : 0 !== L.ha && (at += L.ha, 0 !== L.ha && (at += L.uc()))); Mi = isFinite(Si.height) ? Math.min(Si.height, Pi.height) : Ni !== Xr && isFinite(e) ? e : at, Mi = Math.max(Mi, t.minSize.height), Mi = Math.max(Mi - Ti, 0); for (var Fi = 0 === at ? 1 : Math.max(Mi / at, 1), Oi = 0; Oi < a; Oi++)void 0 !== t.sb[Oi] && (L = t.getRowDefinition(Oi), isFinite(L.height) || Gh(L) === qh || (L.actual = L.ha * Fi), L.position = o.height, 0 !== L.ha && (o.height += L.ha, 0 !== L.ha && (o.height += L.uc()))); a = l.length; for (var Bi = 0; Bi < a; Bi++) { var Ii = l[Bi], Ri = 0, Ei = 0, Ei = Ii.type === xh.TableRow ? (Ri = o.width, (L = t.getRowDefinition(Ii.row)).actual) : (Ri = (L = t.getColumnDefinition(Ii.column)).actual, o.height); Ii.measuredBounds.h(0, 0, Ri, Ei), oa(Ii, !1), m[Ii.row] || (m[Ii.row] = []), m[Ii.row][Ii.column] || (m[Ii.row][Ii.column] = []), m[Ii.row][Ii.column].push(Ii) } Vi(l), t.sp = m }, uh.prototype.arrange = function (t, i, e) { for (var n = i.length, o = (r = t.padding).left, r = r.top, s = t.sp, a = s.length, h = 0, l = 0; l < a; l++)s[l] && (h = Math.max(h, s[l].length)); for (l = Math.min(t.topIndex, a - 1); l !== a && (void 0 === t.sb[l] || 0 === t.sb[l].ha);)l++; for (l = Math.min(l, a - 1), l = -t.sb[l].position, m = Math.min(t.leftIndex, h - 1); m !== h && (void 0 === t.ob[m] || 0 === t.ob[m].ha);)m++; m = Math.min(m, h - 1); for (var u = -t.ob[m].position, c = Yi.alloc(), f = 0; f < a; f++)if (s[f]) { h = s[f].length; var d = t.getRowDefinition(f), p = d.position + l + r; 0 !== d.ha && (p += d.mv()); for (var g = 0; g < h; g++)if (s[f][g]) { var y = t.getColumnDefinition(g), m = y.position + u + o; 0 !== y.ha && (m += y.mv()); for (var v = s[f][g], x = v.length, b = 0; b < x; b++) { var w = v[b], k = w.measuredBounds; if (null === (N = w instanceof xh ? w : null) || N.type !== xh.TableRow && N.type !== xh.TableColumn) { c.h(0, 0); for (var M = 1; M < w.rowSpan && !(f + M >= t.rowCount); M++)N = t.getRowDefinition(f + M), c.height += N.total; for (M = 1; M < w.columnSpan && !(g + M >= t.columnCount); M++)N = t.getColumnDefinition(g + M), c.width += N.total; var S = y.ha + c.width, P = d.ha + c.height, M = m, N = p, C = S, T = P, L = m, A = p, j = S, D = P; m + S > e.width && (j = Math.max(e.width - m, 0)), p + P > e.height && (D = Math.max(e.height - p, 0)); var F, O, B, I, R, E = w.alignment; E.Mb() ? ((E = t.defaultAlignment).gb() || (E = Zt), F = E.x, O = E.y, B = E.offsetX, E = E.offsetY, I = y.alignment, R = d.alignment, I.gb() && (F = I.x, B = I.offsetX), R.gb() && (O = R.y, E = R.offsetY)) : (F = E.x, O = E.y, B = E.offsetX, E = E.offsetY), (isNaN(F) || isNaN(O)) && (O = F = .5, E = B = 0), I = k.width, R = k.height; var z = w.margin, V = z.left + z.right, Y = z.top + z.bottom, G = Zs(w, d, y, !1); !isNaN(w.desiredSize.width) || G !== Gr && G !== Kr || (I = Math.max(S - V, 0)), !isNaN(w.desiredSize.height) || G !== Gr && G !== Hr || (R = Math.max(P - Y, 0)), S = w.maxSize, P = w.minSize, I = Math.min(S.width, I), R = Math.min(S.height, R), I = Math.max(P.width, I), S = (R = Math.max(P.height, R)) + Y, M += C * F - (I + V) * F + B + z.left, N += T * O - S * O + E + z.top, w.visible && (Et(L, A, j, D, M, N, k.width, k.height) ? w.arrange(M, N, I, R) : w.arrange(M, N, I, R, new yi(L, A, j, D))) } else w.ll(), w.actualBounds.ea(), C = w.actualBounds, M = yi.allocAt(C.x, C.y, C.width, C.height), C.x = N.type === xh.TableRow ? o : m, C.y = N.type === xh.TableColumn ? r : p, C.width = k.width, C.height = k.height, w.actualBounds.freeze(), sa(w, !1), Ot(M, C) || null !== (k = w.part) && (k.Gh(), w.Uo(k)), yi.free(M) } } } for (Yi.free(c), t = 0; t < n; t++)null === (o = (e = i[t]) instanceof xh ? e : null) || o.type !== xh.TableRow && o.type !== xh.TableColumn || (o = e.actualBounds, e.naturalBounds.ea(), e.naturalBounds.h(0, 0, o.width, o.height), e.naturalBounds.freeze()) }, h(ch, oh), ch.prototype.measure = function () { }, ch.prototype.arrange = function () { }, h(fh, oh), fh.prototype.measure = function () { }, fh.prototype.arrange = function () { }, h(dh, oh), dh.prototype.measure = function (t, i, e, n, o, r, s) { 1 < n.length && B("Viewbox Panel cannot contain more than one GraphObject."), (n = n[0]).ya = 1, n.nm(), n.measure(1 / 0, 1 / 0, r, s); var a, h, l, u, c, f = n.measuredBounds, d = (p = n.margin).right + p.left, p = p.top + p.bottom; (isFinite(i) || isFinite(e)) && (a = n.scale, h = f.width, f = f.height, l = Math.max(i - d, 0), u = Math.max(e - p, 0), c = 1, t.viewboxStretch === qr ? 0 !== h && 0 !== f && (c = Math.min(l / h, u / f)) : 0 !== h && 0 !== f && (c = Math.max(l / h, u / f)), 0 === c && (c = 1e-4), n.ya *= c, a !== n.scale && (oa(n, !0), n.measure(1 / 0, 1 / 0, r, s))), f = n.measuredBounds, o.width = isFinite(i) ? i : Math.max(f.width + d, 0), o.height = isFinite(e) ? e : Math.max(f.height + p, 0) }, dh.prototype.arrange = function (t, i, e) { var n = (i = i[0]).measuredBounds, o = i.margin, r = Math.max(n.width + (o.right + o.left), 0), o = Math.max(n.height + (o.top + o.bottom), 0), s = i.alignment; s.Mb() && (s = t.defaultAlignment), s.gb() || (s = Zt), i.arrange(e.width * s.x - r * s.x + s.offsetX, e.height * s.y - o * s.y + s.offsetY, n.width, n.height) }, h(ph, oh), ph.prototype.measure = function () { }, ph.prototype.arrange = function () { }, ph.prototype.bc = function (t, i, e) { (e = t.uf() * e.scale) <= 0 && (e = 1); var n = (o = t.gridCellSize).width, o = o.height, r = t.naturalBounds, s = t.actualBounds, a = r.width, h = r.height, l = Math.ceil(a / n), u = Math.ceil(h / o), c = t.gridOrigin; i.save(), i.beginPath(), i.rect(0, 0, a, h), i.clip(); for (var f = [], d = t.V.j, p = d.length, g = 0; g < p; g++) { var y = d[g], m = []; if (f.push(m), y.visible) { var v = y.interval; if (!(v < 0)) { y = Mh(y.figure); for (var x, b = 0; b < p; b++) { b !== g && (!(x = d[b]).visible || Mh(x.figure) !== y || v < (x = x.interval) && m.push(x)) } } } } for (p = (d = t.V.j).length, g = 0; g < p; g++) { var w = d[g]; if (w.visible && (m = w.interval, !(n * Math.abs(m) * e < 2))) { if ((y = 1) !== (v = w.opacity)) { if (0 === v) continue; y = i.globalAlpha, i.globalAlpha = y * v } b = f[g], x = !1; var k = w.strokeDashArray; if (null !== k && (x = !0, i.jt(k, w.strokeDashOffset)), "LineV" === w.figure && null !== w.stroke && 0 < w.strokeWidth) { for (i.lineWidth = w.strokeWidth, Us(t, i, w.stroke, !1, !1, r, s), i.beginPath(), k = w = Math.floor(-c.x / n); k <= w + l; k++) { var M = k * n + c.x; 0 <= M && M <= a && gh(k, m, b) && (i.moveTo(M, 0), i.lineTo(M, h)) } i.stroke() } else if ("LineH" === w.figure && null !== w.stroke && 0 < w.strokeWidth) { for (i.lineWidth = w.strokeWidth, Us(t, i, w.stroke, !1, !1, r, s), i.beginPath(), k = w = Math.floor(-c.y / o); k <= w + u; k++)0 <= (M = k * o + c.y) && M <= h && gh(k, m, b) && (i.moveTo(0, M), i.lineTo(a, M)); i.stroke() } else if ("BarV" === w.figure && null !== w.fill) for (Us(t, i, w.fill, !0, !1, r, s), w = w.width, isNaN(w) && (w = n), M = k = Math.floor(-c.x / n); M <= k + l; M++) { var S = M * n + c.x; 0 <= S && S <= a && gh(M, m, b) && i.fillRect(S, 0, w, h) } else if ("BarH" === w.figure && null !== w.fill) for (Us(t, i, w.fill, !0, !1, r, s), w = w.height, isNaN(w) && (w = o), M = k = Math.floor(-c.y / o); M <= k + u; M++)0 <= (S = M * o + c.y) && S <= h && gh(M, m, b) && i.fillRect(0, S, a, w); x && i.ht(), 1 !== v && (i.globalAlpha = y) } } i.restore(), i.sc(!1) }, h(yh, oh), yh.prototype.measure = function (t, i, e, n, o) { if (e = n.length, t instanceof du || t instanceof Fu) { var r = null, s = null, a = null; if (t instanceof Fu && (s = r = t), t instanceof du && (r = (a = t).adornedPart), r instanceof Fu) { var h = r; if (0 === e) jt(t.naturalBounds, 0, 0), t.measuredBounds.h(0, 0, 0, 0); else { var l = t instanceof du ? null : r.path, u = r.routeBounds; (i = t.sg).h(0, 0, u.width, u.height); var c = h.points, r = r.pointsCount; null !== a ? a.nk(!1) : null !== s && s.nk(!1); var f = u.width, d = u.height; t.location.h(u.x, u.y), t.l.length = 0, null !== l && (mh(t, f, d, l), a = l.measuredBounds, i.Hc(a), t.l.push(a)), a = Gi.alloc(); for (var p = gi.alloc(), g = gi.alloc(), y = 0; y < e; y++) { var m, v, x, b, w, k, M, S, P, N, C, T, L, A, j, D, F = n[y]; F !== l && (F.isPanelMain && F instanceof Kh ? (mh(t, f, d, F), k = F.measuredBounds, i.Hc(k), t.l.push(k)) : r < 2 ? (F.measure(1 / 0, 1 / 0, 0, 0), k = F.measuredBounds, i.Hc(k), t.l.push(k)) : (m = F.segmentIndex, v = F.segmentFraction, (x = F.alignmentFocus).jc() && (x = Zt), b = F.segmentOrientation, w = F.segmentOffset, isNaN(m) ? (N = h.ka, k = zi(), N.Dv(v, k), (M = gi.allocAt(k[0], k[1])).add(h.i(0)), N.type === ee || (N = N.figures.first()), M.offset(-N.startX, -N.startY), N = k[2], b !== ec && (C = h.computeAngle(F, b, N), F.Yb = C), C = M.x - u.x, S = M.y - u.y, gi.free(M), Vi(k)) : S = m < -r || r <= m ? (S = h.midPoint, N = h.midAngle, b !== ec && (C = h.computeAngle(F, b, N), F.Yb = C), C = S.x - u.x, S.y - u.y) : (k = (C = 0) <= m ? (S = c.L(m), m < r - 1 ? c.L(m + 1) : S) : (C = r + m, S = c.L(C), 0 < C ? c.L(C - 1) : S), N = S.Ma(k) ? (C = 0 <= m ? (N = 0 < m ? c.L(m - 1) : S, m < r - 2 ? c.L(m + 2) : k) : (N = C < r - 1 ? c.L(C + 1) : S, 1 < C ? c.L(C - 2) : k), M = N.Ce(S), (P = k.Ce(C)) + 10 < M ? 0 <= m ? N.Sa(S) : S.Sa(N) : M + 10 < P ? 0 <= m ? k.Sa(C) : C.Sa(k) : 0 <= m ? N.Sa(C) : C.Sa(N)) : 0 <= m ? S.Sa(k) : k.Sa(S), b !== ec && (C = h.computeAngle(F, b, N), F.Yb = C), C = S.x + (k.x - S.x) * v - u.x, S.y + (k.y - S.y) * v - u.y), F.measure(1 / 0, 1 / 0, 0, 0), k = F.measuredBounds, M = F.naturalBounds, T = 0, F instanceof Kh && (T = F.strokeWidth), P = M.width + T, L = M.height + T, a.reset(), a.translate(-k.x, -k.y), a.scale(F.scale, F.scale), a.rotate(b === ec ? F.angle : N, P / 2, L / 2), b !== uc && b !== pc || a.rotate(90, P / 2, L / 2), b !== cc && b !== gc || a.rotate(-90, P / 2, L / 2), b === yc && (45 < N && N < 135 || 225 < N && N < 315) && a.rotate(-N, P / 2, L / 2), M = new yi(0, 0, P, L), p.dj(M, x), a.ra(p), x = -p.x + T / 2 * F.scale, F = -p.y + T / 2 * F.scale, g.assign(w), T = isNaN(w.x), A = isNaN(w.y), T || A ? (P = P / 2 + 3, L = L / 2 + 3, j = 45 <= N && N <= 135, D = 225 <= N && N <= 315, b === ec && (j || D) ? (g.x = A ? P : w.y, g.y = T ? L : w.x, j ? 0 <= m || isNaN(m) && v < .5 || !T || (g.y = -L) : D && ((0 <= m || isNaN(m) && v < .5) && T && (g.y = -L), A && (g.x = -P))) : (T && (g.x = 0 <= m || isNaN(m) && v < .5 ? P : -P), A && (g.y = -L), g.rotate(N))) : g.rotate(N), C += g.x, S += g.y, M.set(k), M.h(C + x, S + F, k.width, k.height), t.l.push(M), i.Hc(M))) } if (null !== s) for (n = s.labelNodes; n.next();)n.value.measure(1 / 0, 1 / 0); t.sg = i, (t = t.location).h(t.x + i.x, t.y + i.y), jt(o, i.width || 0, i.height || 0), Gi.free(a), gi.free(p), gi.free(g) } } } }, yh.prototype.arrange = function (t, i) { var e = i.length; if (t instanceof du || t instanceof Fu) { var n = null, o = null, r = null; t instanceof Fu && (o = n = t), t instanceof du && (n = (r = t).adornedPart); var s = t instanceof du ? null : n.path; if (0 !== t.l.length) { var a = t.l, h = 0; for (null !== s && h < t.l.length && (P = a[h], h++, s.arrange(P.x - t.sg.x, P.y - t.sg.y, P.width, P.height)), P = 0; P < e; P++) { var l = i[P]; l !== s && h < t.l.length && (d = a[h], h++, l.arrange(d.x - t.sg.x, d.y - t.sg.y, d.width, d.height)) } } if (2 <= (e = (i = n.points).count) && t instanceof Fu) for (n = t.labelNodes; n.next();) { var u, c, f, d, p, g, y, m, v, x, b, w, k, M = t, a = (s = n.value).segmentIndex, h = s.segmentFraction, S = s.alignmentFocus, P = s.segmentOrientation, l = s.segmentOffset; isNaN(a) ? (d = M.ka, u = zi(), d.Dv(h, u), (p = gi.allocAt(u[0], u[1])).add(M.i(0)), d.type === ee || (d = d.figures.first()), p.offset(-d.startX, -d.startY), d = u[2], P !== ec && (M = M.computeAngle(s, P, d), s.angle = M), M = p.x, g = p.y, gi.free(p), Vi(u)) : g = a < -e || e <= a ? (g = M.midPoint, d = M.midAngle, P !== ec && (M = M.computeAngle(s, P, d), s.angle = M), M = g.x, g.y) : (g = (p = 0) <= a ? (u = i.j[a], a < e - 1 ? i.j[a + 1] : u) : (p = e + a, u = i.j[p], 0 < p ? i.j[p - 1] : u), d = u.Ma(g) ? (p = 0 <= a ? (d = 0 < a ? i.j[a - 1] : u, a < e - 2 ? i.j[a + 2] : g) : (d = p < e - 1 ? i.j[p + 1] : u, 1 < p ? i.j[p - 2] : g), c = d.Ce(u), (f = g.Ce(p)) + 10 < c ? 0 <= a ? d.Sa(u) : u.Sa(d) : c + 10 < f ? 0 <= a ? g.Sa(p) : p.Sa(g) : 0 <= a ? d.Sa(p) : p.Sa(d)) : 0 <= a ? u.Sa(g) : g.Sa(u), P !== ec && (M = M.computeAngle(s, P, d), s.angle = M), M = u.x + (g.x - u.x) * h, u.y + (g.y - u.y) * h), S.yt() ? s.location = new gi(M, g) : (S.jc() && (S = Zt), (u = Gi.alloc()).reset(), u.scale(s.scale, s.scale), u.rotate(s.angle, 0, 0), v = s.naturalBounds, p = yi.allocAt(0, 0, v.width, v.height), (c = gi.alloc()).dj(p, S), u.ra(c), S = -c.x, f = -c.y, y = v.width, m = v.height, (v = gi.alloc()).assign(l), x = isNaN(l.x), b = isNaN(l.y), x || b ? (y = y / 2 + 3, m = m / 2 + 3, w = 45 <= d && d <= 135, k = 225 <= d && d <= 315, P === ec && (w || k) ? (v.x = b ? y : l.y, v.y = x ? m : l.x, w ? 0 <= a || isNaN(a) && h < .5 || !x || (v.y = -m) : k && ((0 <= a || isNaN(a) && h < .5) && x && (v.y = -m), b && (v.x = -y))) : (x && (v.x = 0 <= a || isNaN(a) && h < .5 ? y : -y), b && (v.y = -m), v.rotate(d))) : v.rotate(d), M += v.x, g += v.y, u.tw(p), S += p.x, f += p.y, a = gi.allocAt(M + S, g + f), s.move(a), gi.free(a), gi.free(v), gi.free(c), yi.free(p), Gi.free(u)) } null !== r ? r.nk(!1) : null !== o && o.nk(!1) } }, h(vh, oh), vh.prototype.measure = function (t, i, e, n, o, r, s) { var a = t.Ab(); t.Wg = []; var h = a.margin, l = h.right + h.left, u = h.top + h.bottom; a.measure(i, e, r, s); var c = a.measuredBounds, f = new yi(-h.left, -h.top, Math.max(c.width + l, 0), Math.max(c.height + u, 0)); t.Wg.push(f), o.assign(f); for (var d = a.geometry, p = a.strokeWidth, g = d.flattenedSegments, y = d.flattenedLengths, m = d.flattenedTotalLength, v = g.length, x = 0, b = 0, w = zi(), k = 0; k < v; k++) { for (var M = g[k], S = [], b = x = 0, P = M.length, N = 0; N < P; N += 2) { var C, T = M[N], L = M[N + 1]; 0 !== N && ((C = 180 * Math.atan2(L - b, T - x) / Math.PI) < 0 && (C += 360), S.push(C)), x = T, b = L } w.push(S) } if (null === t.Xg) { for (var A = [], j = t.V.j, D = j.length, F = 0; F < D; F++) { var O = j[F], B = []; if (A.push(B), O.visible) { var I, R, E = O.interval; if (!(E < 0)) for (var z = 0; z < D; z++) { z !== F && (!(I = j[z]).visible || O.constructor !== I.constructor || E < (R = I.interval) && B.push(R)) } } } t.Xg = A } var V = t.Xg, Y = t.V.j, G = Y.length, X = 0, q = 0, U = m; t.uj = []; for (var K = 0; K < G; K++) { var H = Y[K], W = []; if (H.visible && H !== a) { var J = Math.abs(H.interval), Z = t.graduatedTickUnit; if (!(Z * J * m / t.graduatedRange < 2)) { var $, Q = y[0][0], _ = 0, tt = 0, q = m * H.graduatedStart - 1e-4, U = m * H.graduatedEnd + 1e-4, it = Z * J, et = t.graduatedTickBase; et < t.graduatedMin ? et += ($ = 0 == ($ = (t.graduatedMin - et) / it) % 1 ? $ : Math.floor($ + 1)) * it : et > t.graduatedMin + it && (et -= Math.floor((et - t.graduatedMin) / it) * it); for (var nt = V[K]; et <= t.graduatedMax;) { t: { for (var ot = nt.length, rt = 0; rt < ot; rt++)if (qi.$((et - t.graduatedTickBase) % (nt[rt] * t.graduatedTickUnit), 0)) { var st = !1; break t } st = !0 } if (st && (null === H.graduatedSkip || !H.graduatedSkip(et)) && (m < (X = (et - t.graduatedMin) * m / t.graduatedRange) && (X = m), q <= X && X <= U)) { for (var at = w[_][tt], ht = y[_][tt]; _ < y.length;) { for (; Q < X && tt < y[_].length - 1;)tt++, at = w[_][tt], Q += ht = y[_][tt]; if (X <= Q) break; tt = 0, at = w[++_][tt], Q += ht = y[_][tt] } var lt = g[_], ut = lt[2 * tt], ct = lt[2 * tt + 1], ft = (X - (Q - ht)) / ht, dt = new gi(ut + (lt[2 * tt + 2] - ut) * ft + p / 2 - d.bounds.x, ct + (lt[2 * tt + 3] - ct) * ft + p / 2 - d.bounds.y); dt.scale(a.scale, a.scale); var pt, gt = at, yt = w[_]; ft < 1e-4 ? 0 < tt ? gt = yt[tt - 1] : qi.$(lt[0], lt[lt.length - 2]) && qi.$(lt[1], lt[lt.length - 1]) && (gt = yt[yt.length - 1]) : .9999 < ft && (tt + 1 < yt.length ? gt = yt[tt + 1] : qi.$(lt[0], lt[lt.length - 2]) && qi.$(lt[1], lt[lt.length - 1]) && (gt = yt[0])), at !== gt && (180 < Math.abs(at - gt) && (at < gt ? at += 360 : gt += 360), at = (at + gt) / 2 % 360), H instanceof el ? (pt = "") !== (pt = null !== H.graduatedFunction ? null != (pt = H.graduatedFunction(et)) ? pt.toString() : "" : (+et.toFixed(2)).toString()) && W.push({ wm: dt, angle: at, text: pt }) : W.push({ wm: dt, angle: at }) } et += it } } } t.uj.push(W) } Vi(w); var mt = t.uj; if (null !== mt) for (var vt = n.length, xt = 0; xt < vt; xt++) { var bt = n[xt], wt = mt[xt]; if (bt.visible && bt !== a && 0 !== wt.length) { if (bt instanceof Kh) { var kt = t, Mt = o, St = bt.alignmentFocus; St.jc() && (St = vi); var Pt = bt.angle; bt.Yb = 0, bt.measure(1 / 0, 1 / 0, 0, 0), bt.Yb = Pt; var Nt = bt.measuredBounds, Ct = Nt.width, Tt = Nt.height, Lt = yi.allocAt(0, 0, Ct, Tt), At = gi.alloc(); At.dj(Lt, St), yi.free(Lt); for (var jt = -At.x, Dt = -At.y, Ft = new yi, Ot = wt.length, Bt = 0; Bt < Ot; Bt++)for (var It = wt[Bt], Rt = It.wm.x, Et = It.wm.y, zt = It.angle, Vt = 0; Vt < 4; Vt++) { switch (Vt) { case 0: At.h(jt, Dt); break; case 1: At.h(jt + Ct, Dt); break; case 2: At.h(jt, Dt + Tt); break; case 3: At.h(jt + Ct, Dt + Tt) }At.rotate(zt + bt.angle), At.offset(Rt, Et), 0 === Bt && 0 === Vt ? Ft.h(At.x, At.y, 0, 0) : Ft.Ie(At), At.offset(-Rt, -Et), At.rotate(-zt - bt.angle) } gi.free(At), null !== kt.Wg && kt.Wg.push(Ft), mi(Mt, Ft.x, Ft.y, Ft.width, Ft.height) } else if (bt instanceof el) { var Yt = t, Gt = o; null === Yt.sh && (Yt.sh = new el); var Xt = Yt.sh; nl(Xt, bt); var qt = bt.alignmentFocus; qt.jc() && (qt = vi); for (var Ut = bt.segmentOrientation, Kt = bt.segmentOffset, Ht = new yi, Wt = 0, Jt = 0, Zt = 0, $t = 0, Qt = 0, _t = wt.length, ti = 0; ti < _t; ti++) { var ii = wt[ti], Wt = ii.wm.x, Jt = ii.wm.y, Zt = ii.angle, Qt = $t = bt.angle; Ut !== ec && (Qt = Ut === lc || Ut === dc ? Zt + bt.angle : Zt, $t = Fu.computeAngle(Ut, Qt)), Xt.Yb = $t, Xt.text = ii.text || "", Xt.measure(1 / 0, 1 / 0, 0, 0); var ei = Xt.measuredBounds, ni = Xt.naturalBounds, oi = ni.width, ri = ni.height, si = Gi.alloc(); si.reset(), si.translate(-ei.x, -ei.y), si.scale(Xt.scale, Xt.scale), si.rotate(Qt, oi / 2, ri / 2), Ut !== uc && Ut !== pc || si.rotate(90, oi / 2, ri / 2), Ut !== cc && Ut !== gc || si.rotate(-90, oi / 2, ri / 2), Ut === yc && (45 < Zt && Zt < 135 || 225 < Zt && Zt < 315) && si.rotate(-Zt, oi / 2, ri / 2); var ai = yi.allocAt(0, 0, oi, ri), hi = gi.alloc(); hi.dj(ai, qt), si.ra(hi); var li = -hi.x, ui = -hi.y, ci = gi.alloc(); ci.assign(Kt), isNaN(ci.x) && (ci.x = oi / 2 + 3), isNaN(ci.y) && (ci.y = -(ri / 2 + 3)), ci.rotate(Zt); var fi = new yi(Wt += ci.x + li, Jt += ci.y + ui, ei.width, ei.height), di = new yi(ei.x, ei.y, ei.width, ei.height), pi = new yi(ni.x, ni.y, ni.width, ni.height); ii.Zz = $t, ii.lineCount = Xt.lineCount, ii.lines = [Xt.qb, Xt.ti, Xt.ie, Xt.ve, Xt.Qb, Xt.hb, Xt.ge], ii.actualBounds = fi, ii.measuredBounds = di, ii.naturalBounds = pi, 0 === ti ? Ht.assign(fi) : Ht.Hc(fi), gi.free(ci), gi.free(hi), yi.free(ai), Gi.free(si) } null !== Yt.Wg && Yt.Wg.push(Ht), mi(Gt, Ht.x, Ht.y, Ht.width, Ht.height) } oa(bt, !1) } } }, vh.prototype.arrange = function (t, i, e) { if (null !== t.Wg) { var n = t.Ab(), o = t.uj; if (null !== o) { var r = t.Wg, s = 0, a = r[s]; s++, null !== n && n.arrange(a.x - e.x, a.y - e.y, a.width, a.height); for (var h = i.length, l = 0; l < h; l++) { var u = i[l], a = o[l]; u.visible && u !== n && 0 !== a.length && (a = r[s], s++, u.arrange(a.x - e.x, a.y - e.y, a.width, a.height)) } t.Wg = null } } }, vh.prototype.bc = function (t, i, e) { var n = e.ni; e.ni = !0; var o = (r = t.naturalBounds).width, r = r.height; i.save(), i.beginPath(), i.rect(-1, -1, o + 1, r + 1), i.clip(), (o = t.Ab()).bc(i, e), (r = t.uf() * e.scale) <= 0 && (r = 1); for (var s = o.actualBounds, a = t.V.j, h = t.uj, l = a.length, u = 0; u < l; u++) { var c = a[u], f = h[u], d = f.length; if (c.visible && c !== o && 0 !== f.length) if (c instanceof Kh) { if (!(t.graduatedTickUnit * c.interval * o.geometry.flattenedTotalLength / t.graduatedRange * r < 2)) { var p = c.measuredBounds, g = c.strokeWidth * c.scale, y = c.alignmentFocus; y.jc() && (y = vi); for (var m = 0; m < d; m++) { var v = f[m].wm, x = f[m].angle, b = y, w = c.mb; w.reset(), w.translate(v.x + s.x, v.y + s.y), w.rotate(x + c.angle, 0, 0), w.translate(-p.width * b.x + b.offsetX + g / 2, -p.height * b.y + b.offsetY + g / 2), w.scale(c.scale, c.scale), ia(c, !1), c.Qh.set(c.mb), c.Wk = c.scale, ea(c, !1), c.bc(i, e), c.mb.reset() } } } else if (c instanceof el) for (null === t.sh && (t.sh = new el), nl(p = t.sh, c), c = 0; c < d; c++)(g = f[c]).actualBounds && g.measuredBounds && g.naturalBounds && (p.Tb = g.text || "", p.Yb = g.Zz || 0, p.Nc = g.lineCount || 0, void 0 !== (y = g.lines) && (p.qb = y[0], p.ti = y[1], p.ie = y[2], p.ve = y[3], p.Qb = y[4], p.hb = y[5], p.ge = y[6]), g.naturalBounds && (p.oc = g.naturalBounds), g.actualBounds && (y = g.actualBounds, p.arrange(y.x, y.y, y.width, y.height)), y = g.actualBounds, p.arrange(y.x, y.y, y.width, y.height), m = g.measuredBounds, g = g.naturalBounds, (v = p.mb).reset(), v.translate(y.x + s.x, y.y + s.y), v.translate(-m.x, -m.y), Hs(p, v, g.x, g.y, g.width, g.height), ia(p, !1), p.Qh.set(p.mb), p.Wk = p.scale, ea(p, !1), p.bc(i, e)) } e.ni = n, i.restore(), i.sc(!0) }, h(xh, Es), xh.prototype.cloneProtected = function (t) { if (Es.prototype.cloneProtected.call(this, t), t.pa = this.pa, t.eb = this.eb.G(), t.un = this.un.G(), t.Nf = this.Nf, t.pa === xh.Table) { t.nj = this.nj.G(), t.Og = this.Og, t.ii = this.ii, t.hi = this.hi, t.Ng = this.Ng, t.Mg = this.Mg, t.gi = this.gi; var i, e = []; if (0 < this.sb.length) for (var n = this.sb, o = n.length, r = 0; r < o; r++) { void 0 !== n[r] && ((i = n[r].copy()).cj(t), e[r] = i) } if (t.sb = e, e = [], 0 < this.ob.length) for (o = (n = this.ob).length, r = 0; r < o; r++)void 0 !== n[r] && ((i = n[r].copy()).cj(t), e[r] = i); t.ob = e, t.Mj = this.Mj, t.kj = this.kj, t.Ki = this.Ki, t.vi = this.vi } t.Zp = this.Zp, t.Tn = this.Tn.G(), t.Un = this.Un.G(), t.Qn = this.Qn, t.Pn = this.Pn, t.Sn = this.Sn, t.Rn = this.Rn, t.uj = this.uj, t.Xg = this.Xg, t.jb = this.jb, t.ci = this.ci, t.jo = this.jo, t.si = this.si, t.ne = this.ne, t.pl = this.pl, t.sg.assign(this.sg), t.Gg = this.Gg, null !== this.sp && (t.sp = this.sp) }, xh.prototype.sf = function (t) { Es.prototype.sf.call(this, t), t.V = this.V; for (var i = t.V.j, e = i.length, n = 0; n < e; n++)i[n].kg = t; t.Hi = null }, xh.prototype.copy = function () { var t = Es.prototype.copy.call(this); if (null === t) return null; for (var i = this.V.j, e = i.length, n = 0; n < e; n++) { var o = i[n].copy(); o.cj(t), o.Jj = null; var r, s = t.V, a = s.count; s.tb(a, o), null !== (s = t.part) && ((s.Fj = null) !== o.portId && s instanceof pu && (s.Fh = !0), null !== (r = t.diagram) && r.undoManager.isUndoingRedoing || s.Za(we, "elements", t, null, o, null, a)) } return t }, (t = xh.prototype).toString = function () { return "Panel(" + this.type + ")#" + tt(this) }, t.Uo = function (t) { Es.prototype.Uo.call(this, t); for (var i = this.V.j, e = i.length, n = 0; n < e; n++)i[n].Uo(t) }, t.Qi = function (t, i) { if (this.pa === xh.Grid) this.pa.bc(this, t, i); else if (this.pa === xh.Graduated) this.pa.bc(this, t, i); else { this.pa === xh.Table && (t.lineCap = "butt", kh(this, t, !0, this.sb, !0), kh(this, t, !1, this.ob, !0), wh(this, t, !0, this.sb), wh(this, t, !1, this.ob), kh(this, t, !0, this.sb, !1), kh(this, t, !1, this.ob, !1)); var e = this.isClipping && this.pa === xh.Spot; e && t.save(); for (var n = this.Ab(), o = this.V.j, r = o.length, s = 0; s < r; s++) { var a = o[s]; e && a === n && (t.clipInsteadOfFill = !0), a.bc(t, i), e && a === n && (t.clipInsteadOfFill = !1) } e && (t.restore(), t.sc(!0)) } }, t.hk = function (t, i, e, n, o) { var r = this.be(), s = this.transform, a = 1 / (s.m11 * s.m22 - s.m12 * s.m21), h = s.m22 * a, l = -s.m12 * a, u = -s.m21 * a, c = s.m11 * a, f = a * (s.m21 * s.dy - s.m22 * s.dx), d = a * (s.m12 * s.dx - s.m11 * s.dy); if (null !== this.areaBackground) return s = this.actualBounds, qi.Vc(s.left, s.top, s.right, s.bottom, t, i, e, n, o); if (null !== this.background) return r = t * h + i * u + f, a = t * l + i * c + d, t = e * h + n * u + f, h = e * l + n * c + d, o.h(0, 0), e = this.naturalBounds, r = qi.Vc(0, 0, e.width, e.height, r, a, t, h, o), o.transform(s), r; r || (u = l = 0, c = h = 1, d = f = 0), a = t * h + i * u + f, t = t * l + i * c + d, h = e * h + n * u + f, e = e * l + n * c + d, o.h(h, e), n = (h - a) * (h - a) + (e - t) * (e - t), l = !1, d = (c = this.V.j).length, u = gi.alloc(), i = 1 / 0; var p = f = null, g = this.isClipping && this.pa === xh.Spot; g && (p = gi.alloc(), (l = (f = this.Ab()).hk(a, t, h, e, p)) && (i = (a - p.x) * (a - p.x) + (t - p.y) * (t - p.y))); for (var y = 0; y < d; y++) { var m = c[y]; m.visible && m !== f && m.hk(a, t, h, e, u) && (l = !0, (m = (a - u.x) * (a - u.x) + (t - u.y) * (t - u.y)) < n && (n = m, o.set(u))) } return g && (n < i && o.set(p), gi.free(p)), gi.free(u), r && o.transform(s), l }, t.o = function (t) { if (!0 !== na(this)) { Es.prototype.o.call(this, t), t = null, this.pa !== xh.Auto && this.pa !== xh.Link || (t = this.Ab()); for (var i = this.V.j, e = i.length, n = 0; n < e; n++) { var o, r = i[n]; r !== t && !r.isPanelMain || r.o(!0), r.desiredSize.v() || (o = Js(r, !1), (r instanceof Du || r instanceof xh || r instanceof el || o !== Xr) && r.o(!0)) } } }, t.nm = function () { if (!1 === na(this)) { oa(this, !0), sa(this, !0); for (var t = this.V.j, i = t.length, e = 0; e < i; e++)t[e].nm() } }, t.ll = function () { if (0 != (2048 & this.F) == !1) { ia(this, !0), ea(this, !0); for (var t = this.V.j, i = t.length, e = 0; e < i; e++)t[e].Jv() } }, t.Jv = function () { ea(this, !0); for (var t = this.V.j, i = t.length, e = 0; e < i; e++)t[e].Jv() }, t.rm = function (t, i, e, n) { var o = this.sg; o.h(0, 0, 0, 0); var r = this.desiredSize, s = this.minSize; void 0 === e && (e = s.width, n = s.height), e = Math.max(e, s.width), n = Math.max(n, s.height); var a = this.maxSize; isNaN(r.width) || (t = Math.min(r.width, a.width)), isNaN(r.height) || (i = Math.min(r.height, a.height)), t = Math.max(e, t), i = Math.max(n, i); var h = this.eb; t = Math.max(t - h.left - h.right, 0), i = Math.max(i - h.top - h.bottom, 0); var l = this.V.j; 0 !== l.length && this.pa.measure(this, t, i, l, o, e, n), t = o.width + h.left + h.right, h = o.height + h.top + h.bottom, isFinite(r.width) && (t = r.width), isFinite(r.height) && (h = r.height), t = Math.min(a.width, t), h = Math.min(a.height, h), t = Math.max(s.width, t), h = Math.max(s.height, h), jt(o, t = Math.max(e, t), h = Math.max(n, h)), jt(this.naturalBounds, t, h), Ys(this, 0, 0, t, h) }, t.Ab = function () { if (null === this.Hi) { var t = this.V.j, i = t.length; if (0 === i) return null; for (var e = 0; e < i; e++) { var n = t[e]; if (!0 === n.isPanelMain) return this.Hi = n } this.Hi = t[0] } return this.Hi }, t.Ch = function (t, i, e, n) { var o = this.V.j; if (this.actualBounds.h(t, i, e, n), 0 !== o.length) { if (!this.desiredSize.v()) { t = Js(this, !0); var r = this.measuredBounds; i = r.width, r = r.height; var s = (a = this.bh).left + a.right, a = a.top + a.bottom; switch (i === e && r === n && (t = Xr), t) { case Xr: (e < i || n < r) && (this.o(), this.measure(e < i ? e : i, n < r ? n : r, 0, 0)); break; case Gr: this.o(!0), this.measure(e + s, n + a, 0, 0); break; case Kr: this.o(!0), this.measure(e + s, r + a, 0, 0); break; case Hr: this.o(!0), this.measure(i + s, n + a, 0, 0) } } this.pa.arrange(this, o, this.sg) } }, t.Eh = function (t) { var i = this.naturalBounds, e = Sh(this); if (Et(0, 0, i.width, i.height, t.x, t.y)) { for (var n = (i = this.V.j).length, o = gi.allocAt(0, 0); n--;) { var r = i[n]; if ((r.visible || r === e) && (ct(o.set(t), r.transform), r.aa(o))) return gi.free(o), !0 } return gi.free(o), null !== this.ib || null !== this.dc } return !1 }, t.kt = function (t) { if (this.Jk === t) return this; for (var i = this.V.j, e = i.length, n = 0; n < e; n++) { var o = i[n].kt(t); if (null !== o) return o } return null }, t.Jm = function (t, i) { if (i(this, t), t instanceof xh) for (var e = (t = t.V.j).length, n = 0; n < e; n++)this.Jm(t[n], i) }, t.gm = function (t) { return function t(i, e, n) { if (n(e)) return e; if (e instanceof xh) for (var o = (e = e.V.j).length, r = 0; r < o; r++) { var s = t(i, e[r], n); if (null !== s) return s } return null }(this, this, t) }, t.Ya = function (t) { if (this.name === t) return this; var i = this.V.j, e = i.length; null === this.si && null === this.ne || (e = Fh(this)); for (var n = 0; n < e; n++) { var o = i[n]; if (o instanceof xh) { var r = o.Ya(t); if (null !== r) return r } if (o.name === t) return o } return null }, t.be = function () { return !(this.type === xh.TableRow || this.type === xh.TableColumn) }, t.Ub = function (t, i, e) { if (!1 === this.pickable) return null; if (void 0 === i && (i = null), void 0 === e && (e = null), ra(this)) return null; var n = this.naturalBounds, o = 1 / this.uf(), r = this.be(), s = r ? t : ct(gi.allocAt(t.x, t.y), this.transform), a = 10, h = 5; if (null !== (u = this.diagram) && (h = (a = u.lm("extraTouchArea")) / 2), Et(-h * o, -h * o, n.width + a * o, n.height + a * o, s.x, s.y)) { if (!this.isAtomic) { var l = (o = this.V.j).length, u = gi.alloc(), h = (a = this.isClipping && this.pa === xh.Spot) ? this.Ab() : null; if (a && (h.be() ? ct(u.set(t), h.transform) : u.set(t), !h.aa(u))) return gi.free(u), r || gi.free(s), null; for (var c = Sh(this); l--;) { var f = o[l]; if ((f.visible || f === c) && (f.be() ? ct(u.set(t), f.transform) : u.set(t), !a || f !== h)) { var d = null; if (f instanceof xh ? d = f.Ub(u, i, e) : !0 === f.pickable && f.aa(u) && (d = f), null !== d && (null !== i && (d = i(d)), null !== d && (null === e || e(d)))) return gi.free(u), r || gi.free(s), d } } gi.free(u) } return null === this.background && null === this.areaBackground ? (r || gi.free(s), null) : (t = Et(0, 0, n.width, n.height, s.x, s.y) ? this : null, r || gi.free(s), t) } return r || gi.free(s), null }, t.Ti = function (t, i, e, n) { if (!1 === this.pickable) return !1; void 0 === i && (i = null), void 0 === e && (e = null); var o = this.naturalBounds, r = this.be(), s = r ? t : ct(gi.allocAt(t.x, t.y), this.transform), o = Et(0, 0, o.width, o.height, s.x, s.y); if (this.type === xh.TableRow || this.type === xh.TableColumn || o) { if (!this.isAtomic) { for (var a = this.V.j, h = a.length, l = gi.alloc(), u = Sh(this); h--;) { var c, f = a[h]; !f.visible && f !== u || (f.be() ? ct(l.set(t), f.transform) : l.set(t), (null !== (f = (c = f) instanceof xh ? f : null) ? f.Ti(l, i, e, n) : c.aa(l)) && !1 !== c.pickable && (null !== i && (c = i(c)), null === c || null !== e && !e(c) || n.add(c))) } gi.free(l) } return r || gi.free(s), o && (null !== this.background || null !== this.areaBackground) } return r || gi.free(s), !1 }, t.tf = function (t, i, e, n, o, r) { if (!1 === this.pickable) return !1; void 0 === i && (i = null), void 0 === e && (e = null); var s = r; if (void 0 === r && (s = Gi.alloc()).reset(), s.multiply(this.transform), this.Dh(t, s)) return Ch(this, i, e, o), void 0 === r && Gi.free(s), !0; if (this.Gc(t, s)) { if (!this.isAtomic) for (var a = Sh(this), h = this.V.j, l = h.length; l--;) { var u, c, f = h[l]; !f.visible && f !== a || (u = f.actualBounds, c = this.naturalBounds, u.x > c.width || u.y > c.height || u.x + u.width < 0 || u.y + u.height < 0 || (f = (u = f) instanceof xh ? f : null, (c = Gi.alloc()).set(s), (null !== f ? f.tf(t, i, e, n, o, c) : Gs(u, t, n, c)) && (null !== i && (u = i(u)), null === u || null !== e && !e(u) || o.add(u)), Gi.free(c))) } return void 0 === r && Gi.free(s), n } return void 0 === r && Gi.free(s), !1 }, t.xg = function (t, i, e, n, o, r) { if (!1 === this.pickable) return !1; void 0 === e && (e = null), void 0 === n && (n = null); var s = this.naturalBounds, a = this.be(), h = a ? t : ct(gi.allocAt(t.x, t.y), this.transform), l = a ? i : ct(gi.allocAt(i.x, i.y), this.transform), u = h.Ce(l), c = 0 < h.x && h.x < s.width && 0 < h.y && h.y < s.height || ft(h.x, h.y, 0, 0, 0, s.height) <= u || ft(h.x, h.y, 0, s.height, s.width, s.height) <= u || ft(h.x, h.y, s.width, s.height, s.width, 0) <= u || ft(h.x, h.y, s.width, 0, 0, 0) <= u, s = h.dd(0, 0) <= u && h.dd(0, s.height) <= u && h.dd(s.width, 0) <= u && h.dd(s.width, s.height) <= u; if (a || (gi.free(h), gi.free(l)), c) { if (!this.isAtomic) { h = gi.alloc(), l = gi.alloc(), u = Sh(this); for (var f = this.V.j, d = f.length; d--;) { var p, g, y = f[d]; !y.visible && y !== u || (p = y.actualBounds, g = this.naturalBounds, a && (p.x > g.width || p.y > g.height || p.x + p.width < 0 || p.y + p.height < 0) || (y.be() ? (p = y.transform, ct(h.set(t), p), ct(l.set(i), p)) : (h.set(t), l.set(i)), (null !== (y = (p = y) instanceof xh ? y : null) ? y.xg(h, l, e, n, o, r) : p.Nx(h, l, o)) && (null !== e && (p = e(p)), null === p || null !== n && !n(p) || r.add(p)))) } gi.free(h), gi.free(l) } return o ? c : s } return !1 }, t.add = function (t) { this.tb(this.V.count, t) }, t.L = function (t) { return this.V.L(t) }, t.tb = function (t, i) { i instanceof Hl && B("Cannot add a Part to a Panel: " + i + "; use a Panel instead"), this !== i && !this.Ag(i) || (this === i && B("Cannot make a Panel contain itself: " + this.toString()), B("Cannot make a Panel indirectly contain itself: " + this.toString() + " already contains " + i.toString())); var e = i.panel; null !== e && e !== this && B("Cannot add a GraphObject that already belongs to another Panel to this Panel: " + i.toString() + ", already contained by " + e.toString() + ", cannot be shared by this Panel: " + this.toString()), this.pa !== xh.Grid || i instanceof Kh || B("Can only add Shapes to a Grid Panel, not: " + i), this.pa !== xh.Graduated || i instanceof Kh || i instanceof el || B("Can only add Shapes or TextBlocks to a Graduated Panel, not: " + i), i.cj(this), (i.Jj = null) === this.itemArray || null !== (o = i.data) && "object" == typeof o && (null === this.Ld && (this.Ld = new at), this.Ld.add(o, i)); var n = this.V, o = -1; if (e === this) { for (var r = -1, s = this.V.j, a = s.length, h = 0; h < a; h++)if (s[h] === i) { r = h; break } if (-1 !== r) { if (r === t || r + 1 >= n.count && t >= n.count) return; n.$a(r), o = r } else B("element " + i.toString() + " has panel " + e.toString() + " but is not contained by it.") } (t < 0 || t > n.count) && (t = n.count), n.tb(t, i), 0 !== t && !i.isPanelMain || (this.Hi = null), na(this) || this.o(), i.o(!1), (null !== i.portId || i instanceof xh && !0 === i.Fh) && (this.Fh = !0), (this.Xg = null) !== (e = this.part) && (e.Fj = null, e.dh = NaN, this.Fh && e instanceof pu && (e.Fh = !0), e.Fh && e instanceof pu && (e.rc = null), null !== (n = this.diagram) && n.undoManager.isUndoingRedoing || (-1 !== o && e.Za(ke, "elements", this, i, null, o, null), e.Za(we, "elements", this, null, i, null, t), this.Bg() || Ih(this, i, !1))) }, t.remove = function (t) { for (var i = this.V.j, e = i.length, n = -1, o = 0; o < e; o++)if (i[o] === t) { n = o; break } -1 !== n && this.Fc(n, !0) }, t.$a = function (t) { 0 <= t && this.Fc(t, !0) }, t.Fc = function (t, e) { var i, n = this.V, o = n.L(t); o.Jj = null, o.cj(null), null === this.Ld || "object" == typeof (i = o.data) && this.Ld.remove(i), n.$a(t), oa(this, !1), this.o(), this.Hi === o && (this.Hi = null), this.Xg = null; var r = this.part; null !== r && (r.Fj = null, r.dh = NaN, r.Lb(), r instanceof pu && (o instanceof xh ? o.Jm(o, function (t, i) { Su(r, i, e) }) : Su(r, o, e)), null !== (n = this.diagram) && n.undoManager.isUndoingRedoing || r.Za(ke, "elements", this, o, null, t, null)) }, xh.prototype.getRowDefinition = function (t) { t < 0 && y(t, ">= 0", xh, "getRowDefinition:idx"), t = Math.round(t); var i, e = this.sb; return void 0 === e ? null : (void 0 === e[t] && ((i = new Yh).cj(this), i.isRow = !0, e[i.index = t] = i), e[t]) }, xh.prototype.bw = function (t) { t < 0 && y(t, ">= 0", xh, "removeRowDefinition:idx"), t = Math.round(t); var i = this.sb; void 0 !== i && (this.Za(ke, "coldefs", this, i[t], null, t, null), i[t] && delete i[t], this.o()) }, xh.prototype.getColumnDefinition = function (t) { t < 0 && y(t, ">= 0", xh, "getColumnDefinition:idx"), t = Math.round(t); var i, e = this.ob; return void 0 === e ? null : (void 0 === e[t] && ((i = new Yh).cj(this), i.isRow = !1, e[i.index = t] = i), e[t]) }, (t = xh.prototype).$v = function (t) { t < 0 && y(t, ">= 0", xh, "removeColumnDefinition:idx"), t = Math.round(t); var i = this.ob; void 0 !== i && (this.Za(ke, "coldefs", this, i[t], null, t, null), i[t] && delete i[t], this.o()) }, t.rz = function (t) { if (t < 0 || this.type !== xh.Table) return -1; for (var i = 0, e = this.sb, n = e.length, o = this.Ki; o < n; o++) { var r = e[o]; if (void 0 !== r && t < (i += r.total)) break } return o }, t.jz = function (t) { if (t < 0 || this.type !== xh.Table) return -1; for (var i = 0, e = this.ob, n = e.length, o = this.vi; o < n; o++) { var r = e[o]; if (void 0 !== r && t < (i += r.total)) break } return o }, t.Mz = function (t, i) { if (void 0 === i && (i = new gi(NaN, NaN)), this.type !== xh.Graduated) return i.h(NaN, NaN), i; t = Math.min(Math.max(t, this.graduatedMin), this.graduatedMax); var e = this.Ab(); return e.geometry.Cv((t - this.graduatedMin) / this.graduatedRange, i), e.transform.ra(i) }, t.Nz = function (t) { if (this.type !== xh.Graduated) return NaN; var i = this.Ab(); return i.transform.Wd(t), i.geometry.Rx(t) * this.graduatedRange + this.graduatedMin }, t.Yy = function () { var t = this.copy(); return Nh(t, function (i) { i instanceof xh && (i.ci = null, i.jb = null); var t = i.bb; null !== t && (i.bb = null, t.each(function (t) { i.bind(t.copy()) })), null !== (t = i.Hg) && (i.Hg = null, t.each(function (t) { la(i, t.value.copy()) })) }), t }, t.Ba = function (t) { var i = this.ci; if (null !== i) for (void 0 === t && (t = ""), i = i.iterator; i.next();) { var e = i.value, n = e.sourceProperty; if (("" === t || "" === n || n === t) && (n = e.targetProperty, null !== e.converter || "" !== n)) { n = this.data; var o, r = e.sourceName; if (null !== r ? n = "" === r || "/" === r || "." === r || ".." === r ? this : this.Ya(r) : null !== (o = this.diagram) && e.isToModel && (n = o.model.modelData), null !== n) { o = this; var s = e.gj; if (-1 !== s) { if (null === (o = this.kt(s))) continue } else null !== e.cd && (o = e.cd); if ("/" === r ? n = o.part : "." === r ? n = o : ".." === r && (n = o.panel), 0 !== (r = e.Rp)) { if (!(o instanceof xh)) continue; 1 === r ? o = o.getColumnDefinition(e.Ul) : 2 === r && (o = o.getRowDefinition(e.Ul)) } void 0 !== o && e.ww(o, n) } } } }, t.It = function () { for (var t = Fh(this); this.V.length > t;)this.Fc(this.V.length - 1, !1); if (null !== (t = this.itemArray)) for (var i = t.length, e = 0; e < i; e++)Oh(this, t[e], e) }, t.Mx = function (t) { return null == t || null === this.Ld ? null : this.Ld.H(t) }, l.Object.defineProperties(xh.prototype, { type: { get: function () { return this.pa }, set: function (t) { var i = this.pa; i !== t && (this.pa = t, this.pa === xh.Grid ? this.isAtomic = !0 : this.pa === xh.Table && bh(this), this.o(), this.g("type", i, t)) } }, elements: { get: function () { return this.V.iterator } }, naturalBounds: { get: function () { return this.oc } }, padding: { get: function () { return this.eb }, set: function (t) { "number" == typeof t ? (t < 0 && y(t, ">= 0", xh, "padding"), t = new Xt(t)) : (t.left < 0 && y(t.left, ">= 0", xh, "padding:value.left"), t.right < 0 && y(t.right, ">= 0", xh, "padding:value.right"), t.top < 0 && y(t.top, ">= 0", xh, "padding:value.top"), t.bottom < 0 && y(t.bottom, ">= 0", xh, "padding:value.bottom")); var i = this.eb; i.w(t) || (this.eb = t = t.G(), this.o(), this.g("padding", i, t)) } }, defaultAlignment: { get: function () { return this.un }, set: function (t) { var i = this.un; i.w(t) || (this.un = t = t.G(), this.o(), this.g("defaultAlignment", i, t)) } }, defaultStretch: { get: function () { return this.Nf }, set: function (t) { var i = this.Nf; i !== t && (this.Nf = t, this.o(), this.g("defaultStretch", i, t)) } }, defaultSeparatorPadding: { get: function () { return void 0 === this.nj ? ji : this.nj }, set: function (t) { var i; void 0 !== this.nj && ("number" == typeof t && (t = new Xt(t)), (i = this.nj).w(t) || (this.nj = t = t.G(), this.o(), this.g("defaultSeparatorPadding", i, t))) } }, defaultRowSeparatorStroke: { get: function () { return void 0 === this.ii ? null : this.ii }, set: function (t) { var i = this.ii; i !== t && (null === t || "string" == typeof t || t instanceof La) && (t instanceof La && t.freeze(), this.ii = t, this.M(), this.g("defaultRowSeparatorStroke", i, t)) } }, defaultRowSeparatorStrokeWidth: { get: function () { return void 0 === this.Og ? 1 : this.Og }, set: function (t) { var i; void 0 === this.Og || (i = this.Og) !== t && isFinite(t) && 0 <= t && (this.Og = t, this.o(), this.g("defaultRowSeparatorStrokeWidth", i, t)) } }, defaultRowSeparatorDashArray: { get: function () { return void 0 === this.hi ? null : this.hi }, set: function (t) { if (void 0 !== this.hi) { var i = this.hi; if (i !== t) { if (null !== t) { for (var e = t.length, n = 0, o = 0; o < e; o++) { var r = t[o]; "number" == typeof r && 0 <= r && isFinite(r) || B("defaultRowSeparatorDashArray value " + r + " at index " + o + " must be a positive number or zero."), n += r } if (0 === n) { if (null === i) return; t = null } } this.hi = t, this.M(), this.g("defaultRowSeparatorDashArray", i, t) } } } }, defaultColumnSeparatorStroke: { get: function () { return void 0 === this.Mg ? null : this.Mg }, set: function (t) { var i; void 0 === this.Mg || (i = this.Mg) !== t && (null === t || "string" == typeof t || t instanceof La) && (t instanceof La && t.freeze(), this.Mg = t, this.M(), this.g("defaultColumnSeparatorStroke", i, t)) } }, defaultColumnSeparatorStrokeWidth: { get: function () { return void 0 === this.Ng ? 1 : this.Ng }, set: function (t) { var i; void 0 === this.Ng || (i = this.Ng) !== t && isFinite(t) && 0 <= t && (this.Ng = t, this.o(), this.g("defaultColumnSeparatorStrokeWidth", i, t)) } }, defaultColumnSeparatorDashArray: { get: function () { return void 0 === this.gi ? null : this.gi }, set: function (t) { if (void 0 !== this.gi) { var i = this.gi; if (i !== t) { if (null !== t) { for (var e = t.length, n = 0, o = 0; o < e; o++) { var r = t[o]; "number" == typeof r && 0 <= r && isFinite(r) || B("defaultColumnSeparatorDashArray value " + r + " at index " + o + " must be a positive number or zero."), n += r } if (0 === n) { if (null === i) return; t = null } } this.gi = t, this.M(), this.g("defaultColumnSeparatorDashArray", i, t) } } } }, viewboxStretch: { get: function () { return this.Zp }, set: function (t) { var i = this.Zp; i !== t && (this.Zp = t, this.o(), this.g("viewboxStretch", i, t)) } }, gridCellSize: { get: function () { return this.Tn }, set: function (t) { var i, e = this.Tn; e.w(t) || (t.v() && 0 !== t.width && 0 !== t.height || B("Invalid Panel.gridCellSize: " + t), this.Tn = t.G(), null !== (i = this.diagram) && this === i.grid && wr(i), this.M(), this.g("gridCellSize", e, t)) } }, gridOrigin: { get: function () { return this.Un }, set: function (t) { var i, e = this.Un; e.w(t) || (t.v() || B("Invalid Panel.gridOrigin: " + t), this.Un = t.G(), null !== (i = this.diagram) && this === i.grid && wr(i), this.M(), this.g("gridOrigin", e, t)) } }, graduatedMin: { get: function () { return this.Qn }, set: function (t) { var i = this.Qn; i !== t && (this.Qn = t, this.o(), this.g("graduatedMin", i, t), !_s(this) || null !== (t = this.part) && Vs(this, t, "graduatedRange")) } }, graduatedMax: { get: function () { return this.Pn }, set: function (t) { var i = this.Pn; i !== t && (this.Pn = t, this.o(), this.g("graduatedMax", i, t), !_s(this) || null !== (t = this.part) && Vs(this, t, "graduatedRange")) } }, graduatedRange: { get: function () { return this.graduatedMax - this.graduatedMin } }, graduatedTickUnit: { get: function () { return this.Sn }, set: function (t) { var i = this.Sn; i !== t && 0 < t && (this.Sn = t, this.o(), this.g("graduatedTickUnit", i, t)) } }, graduatedTickBase: { get: function () { return this.Rn }, set: function (t) { var i = this.Rn; i !== t && (this.Rn = t, this.o(), this.g("graduatedTickBase", i, t)) } }, Fh: { get: function () { return 0 != (8388608 & this.F) }, set: function (t) { 0 != (8388608 & this.F) !== t && (this.F ^= 8388608) } }, rowCount: { get: function () { return void 0 === this.sb ? 0 : this.sb.length } }, columnCount: { get: function () { return void 0 === this.ob ? 0 : this.ob.length } }, rowSizing: { get: function () { return void 0 === this.Mj ? Uh : this.Mj }, set: function (t) { var i; void 0 === this.Mj || (i = this.Mj) !== t && (this.Mj = t, this.o(), this.g("rowSizing", i, t)) } }, columnSizing: { get: function () { return void 0 === this.kj ? Uh : this.kj }, set: function (t) { var i; void 0 === this.kj || (i = this.kj) !== t && (this.kj = t, this.o(), this.g("columnSizing", i, t)) } }, topIndex: { get: function () { return void 0 === this.Ki ? 0 : this.Ki }, set: function (t) { var i; void 0 === this.Ki || (i = this.Ki) !== t && ((!isFinite(t) || t < 0) && B("Panel.topIndex must be greater than zero and a real number, not: " + t), this.Ki = t, this.o(), this.g("topIndex", i, t)) } }, leftIndex: { get: function () { return void 0 === this.vi ? 0 : this.vi }, set: function (t) { var i; void 0 === this.vi || (i = this.vi) !== t && ((!isFinite(t) || t < 0) && B("Panel.leftIndex must be greater than zero and a real number, not: " + t), this.vi = t, this.o(), this.g("leftIndex", i, t)) } }, data: { get: function () { return this.jb }, set: function (t) { var i, e, n = this.jb; n !== t && (i = this instanceof Hl && !(this instanceof du), Dh(this), this.jb = t, null !== (e = this.diagram) && (i ? (i = e.partManager, this instanceof Fu ? (null !== n && i.Ne.remove(n), null !== t && i.Ne.add(t, this)) : this instanceof Hl && (null !== n && i.Oe.remove(n), null !== t && i.Oe.add(t, this))) : null !== (i = this.panel) && null !== i.Ld && (null !== n && i.Ld.remove(n), null !== t && i.Ld.add(t, this))), this.g("data", n, t), null !== e && e.undoManager.isUndoingRedoing || null !== t && this.Ba()) } }, itemIndex: { get: function () { return this.jo }, set: function (t) { var i = this.jo; i !== t && (this.jo = t, this.g("itemIndex", i, t)) } }, itemArray: { get: function () { return this.si }, set: function (t) { var i, e = this.si; (e !== t || null !== t && function (t, i) { for (var e = (t = t.V.j).length, n = i.length, o = 0, r = null; o < e && !((r = t[o]) instanceof xh && null !== r.data);)r = t[++o]; if (e - o !== n) return 1; if (null === r) return 0 < n; for (var s = 0; o < e && s < n;) { if (!((r = t[o]) instanceof xh) || r.data !== i[s]) return 1; o++, s++ } }(this, t)) && (i = this.diagram, e !== t && (null !== i && null !== e && uf(i.partManager, this, i), this.si = t, null !== i && null !== t && lf(i.partManager, this)), this.g("itemArray", e, t), null !== i && i.undoManager.isUndoingRedoing || this.It()) } }, itemTemplate: { get: function () { return null === this.ne ? null : this.ne.H("") }, set: function (t) { if (null === this.ne) { if (null === t) return; this.ne = new at } var i = this.ne.H(""); i !== t && ((t instanceof Hl || t.isPanelMain) && B("Panel.itemTemplate must not be a Part or be Panel.isPanelMain: " + t), this.ne.add("", t), this.g("itemTemplate", i, t), null !== (t = this.diagram) && t.undoManager.isUndoingRedoing || this.It()) } }, itemTemplateMap: { get: function () { return this.ne }, set: function (t) { var i = this.ne; if (i !== t) { for (var e = t.iterator; e.next();); this.ne = t, this.g("itemTemplateMap", i, t), null !== (t = this.diagram) && t.undoManager.isUndoingRedoing || this.It() } } }, itemCategoryProperty: { get: function () { return this.pl }, set: function (t) { var i = this.pl; i !== t && (this.pl = t, this.g("itemCategoryProperty", i, t)) } }, isAtomic: { get: function () { return 0 != (1048576 & this.F) }, set: function (t) { var i = 0 != (1048576 & this.F); i !== t && (this.F ^= 1048576, this.g("isAtomic", i, t)) } }, isClipping: { get: function () { return 0 != (2097152 & this.F) }, set: function (t) { var i = 0 != (2097152 & this.F); i !== t && (t && this.type !== xh.Spot && v("Warning: Panel.isClipping set on non-Spot Panel: " + this.toString()), this.F ^= 2097152, this.o(), this.g("isClipping", i, t)) } }, isOpposite: { get: function () { return 0 != (33554432 & this.F) }, set: function (t) { var i = 0 != (33554432 & this.F); i !== t && (this.F ^= 33554432, this.o(), this.g("isOpposite", i, t)) } }, isEnabled: { get: function () { return 0 != (4194304 & this.F) }, set: function (t) { var i, e = 0 != (4194304 & this.F); e !== t && (i = null === this.panel || this.panel.Bg(), this.F ^= 4194304, this.g("isEnabled", e, t), null !== (e = this.diagram) && e.undoManager.isUndoingRedoing || i && Ih(this, this, t)) } }, alignmentFocusName: { get: function () { return this.Gg }, set: function (t) { var i = this.Gg; i !== t && (this.Gg = t, this.o(), this.g("alignmentFocusName", i, t)) } } }), l.Object.defineProperties(xh, { Position: { get: function () { return Vh.H("Position") } }, Horizontal: { get: function () { return Vh.H("Horizontal") } }, Vertical: { get: function () { return Vh.H("Vertical") } }, Spot: { get: function () { return Vh.H("Spot") } }, Auto: { get: function () { return Vh.H("Auto") } }, Table: { get: function () { return Vh.H("Table") } }, Viewbox: { get: function () { return Vh.H("Viewbox") } }, TableRow: { get: function () { return Vh.H("TableRow") } }, TableColumn: { get: function () { return Vh.H("TableColumn") } }, Link: { get: function () { return Vh.H("Link") } }, Grid: { get: function () { return Vh.H("Grid") } }, Graduated: { get: function () { return Vh.H("Graduated") } } }), xh.prototype.findItemPanelForData = xh.prototype.Mx, xh.prototype.rebuildItemElements = xh.prototype.It, xh.prototype.updateTargetBindings = xh.prototype.Ba, xh.prototype.copyTemplate = xh.prototype.Yy, xh.prototype.graduatedValueForPoint = xh.prototype.Nz, xh.prototype.graduatedPointForValue = xh.prototype.Mz, xh.prototype.findColumnForLocalX = xh.prototype.jz, xh.prototype.findRowForLocalY = xh.prototype.rz, xh.prototype.removeColumnDefinition = xh.prototype.$v, xh.prototype.removeRowDefinition = xh.prototype.bw, xh.prototype.removeAt = xh.prototype.$a, xh.prototype.remove = xh.prototype.remove, xh.prototype.insertAt = xh.prototype.tb, xh.prototype.elt = xh.prototype.L, xh.prototype.add = xh.prototype.add, xh.prototype.findObject = xh.prototype.Ya, xh.prototype.findInVisualTree = xh.prototype.gm, xh.prototype.walkVisualTreeFrom = xh.prototype.Jm, xh.prototype.findMainElement = xh.prototype.Ab; var Eh = !1, zh = null, Vh = new at; function Yh() { Q(this), this.kg = null, this.Sr = !0, this.Oa = 0, this.Pc = NaN, this.fh = 0, this.eh = 1 / 0, this.wb = bi, this.ma = this.ha = 0, this.bb = null, this.Ip = Xh, this.xe = Ur, this.Cp = this.ng = null, this.Dp = NaN, this.ib = this.Nj = null, this.qn = !1 } function Gh(t) { if (t.sizing !== Xh) return t.sizing; var i = t.kg; return t.isRow ? i.rowSizing : i.columnSizing } xh.className = "Panel", (xh.definePanelLayout = Rh)("Position", new rh), Rh("Vertical", new ah), Rh("Auto", new lh), Rh("Link", new yh), Yh.prototype.copy = function () { var t = new Yh; return t.Sr = this.Sr, t.Oa = this.Oa, t.Pc = this.Pc, t.fh = this.fh, t.eh = this.eh, t.wb = this.wb, t.ha = this.ha, t.ma = this.ma, t.xe = this.xe, t.Ip = this.Ip, null === this.ng ? t.ng = null : t.ng = this.ng.G(), t.Cp = this.Cp, t.Dp = this.Dp, (t.Nj = null) !== this.Nj && (t.separatorDashArray = k(this.separatorDashArray)), t.ib = this.ib, t.qn = this.qn, t.bb = this.bb, t }, (t = Yh.prototype).gt = function (t) { t.isRow ? this.height = t.height : this.width = t.width, this.minimum = t.minimum, this.maximum = t.maximum, this.alignment = t.alignment, this.stretch = t.stretch, this.sizing = t.sizing, this.ng = null === t.separatorPadding ? null : t.separatorPadding.G(), this.separatorStroke = t.separatorStroke, this.separatorStrokeWidth = t.separatorStrokeWidth, this.Nj = null, t.separatorDashArray && (this.Nj = k(t.separatorDashArray)), this.background = t.background, this.coversSeparators = t.coversSeparators, this.bb = t.bb }, t.fb = function (t) { t.classType === Yh && (this.sizing = t) }, t.toString = function () { return "RowColumnDefinition " + (this.isRow ? "(Row " : "(Column ") + this.index + ") #" + tt(this) }, t.cj = function (t) { this.kg = t }, t.mv = function () { var t = 0, i = 0, e = this.kg, n = this.isRow; if (null !== e && e.type === xh.Table) for (var o = n ? e.sb.length : e.ob.length, r = 0; r < o; r++) { var s = n ? e.sb[r] : e.ob[r]; if (void 0 !== s) { i = s.index; break } } if (this.index !== i && (null === (i = this.separatorStroke) && null !== e && (i = this.isRow ? e.defaultRowSeparatorStroke : e.defaultColumnSeparatorStroke), null !== i && (t = this.separatorStrokeWidth, isNaN(t) && (t = null !== e ? this.isRow ? e.defaultRowSeparatorStrokeWidth : e.defaultColumnSeparatorStrokeWidth : 0))), null === (i = this.ng)) { if (null === e) return t; i = e.defaultSeparatorPadding } return t + (this.isRow ? i.top : i.left) }, t.uc = function () { var t = 0, i = this.kg, e = 0, n = this.isRow; if (null !== i && i.type === xh.Table) for (var o = n ? i.sb.length : i.ob.length, r = 0; r < o; r++) { var s = n ? i.sb[r] : i.ob[r]; if (void 0 !== s) { e = s.index; break } } if (this.index !== e && (null === (e = this.separatorStroke) && null !== i && (e = n ? i.defaultRowSeparatorStroke : i.defaultColumnSeparatorStroke), null !== e && (t = this.separatorStrokeWidth, isNaN(t) && (t = null !== i ? n ? i.defaultRowSeparatorStrokeWidth : i.defaultColumnSeparatorStrokeWidth : 0))), null === (n = this.ng)) { if (null === i) return t; n = i.defaultSeparatorPadding } return t + (this.isRow ? n.top + n.bottom : n.left + n.right) }, t.yb = function (t, i, e) { var n = this.kg; if (null !== n && (n.Za(be, t, this, i, e, void 0, void 0), null !== this.bb && (null !== (i = n.diagram) && !i.skipsModelSourceBindings && (null !== (n = n.Ui()) && null !== (i = n.data))))) for (e = this.bb.iterator; e.next();)e.value.Rq(this, i, t, n) }, t.bind = function (t) { var i, e = (t.cd = this).panel; null === e || null !== (i = e.Ui()) && jh(i) && B("Cannot add a Binding to a RowColumnDefinition that is already frozen: " + t + " on " + e), null === this.bb && (this.bb = new J), this.bb.add(t) }, l.Object.defineProperties(Yh.prototype, { panel: { get: function () { return this.kg } }, isRow: { get: function () { return this.Sr }, set: function (t) { this.Sr = t } }, index: { get: function () { return this.Oa }, set: function (t) { this.Oa = t } }, height: { get: function () { return this.Pc }, set: function (t) { var i = this.Pc; i !== t && (t < 0 && y(t, ">= 0", Yh, "height"), this.Pc = t, this.actual = this.ha, null !== this.panel && this.panel.o(), this.yb("height", i, t)) } }, width: { get: function () { return this.Pc }, set: function (t) { var i = this.Pc; i !== t && (t < 0 && y(t, ">= 0", Yh, "width"), this.Pc = t, this.actual = this.ha, null !== this.panel && this.panel.o(), this.yb("width", i, t)) } }, minimum: { get: function () { return this.fh }, set: function (t) { var i = this.fh; i !== t && ((t < 0 || !isFinite(t)) && y(t, ">= 0", Yh, "minimum"), this.fh = t, this.actual = this.ha, null !== this.panel && this.panel.o(), this.yb("minimum", i, t)) } }, maximum: { get: function () { return this.eh }, set: function (t) { var i = this.eh; i !== t && (t < 0 && y(t, ">= 0", Yh, "maximum"), this.eh = t, this.actual = this.ha, null !== this.panel && this.panel.o(), this.yb("maximum", i, t)) } }, alignment: { get: function () { return this.wb }, set: function (t) { var i = this.wb; i.w(t) || (this.wb = t.G(), null !== this.panel && this.panel.o(), this.yb("alignment", i, t)) } }, stretch: { get: function () { return this.xe }, set: function (t) { var i = this.xe; i !== t && (this.xe = t, null !== this.panel && this.panel.o(), this.yb("stretch", i, t)) } }, separatorPadding: { get: function () { return this.ng }, set: function (t) { "number" == typeof t && (t = new Xt(t)); var i = this.ng; null !== t && null !== i && i.w(t) || (null !== t && (t = t.G()), this.ng = t, null !== this.panel && this.panel.o(), this.yb("separatorPadding", i, t)) } }, separatorStroke: { get: function () { return this.Cp }, set: function (t) { var i = this.Cp; i !== t && (null !== t && Ya(t, "RowColumnDefinition.separatorStroke"), t instanceof La && t.freeze(), this.Cp = t, null !== this.panel && this.panel.o(), this.yb("separatorStroke", i, t)) } }, separatorStrokeWidth: { get: function () { return this.Dp }, set: function (t) { var i = this.Dp; i !== t && (this.Dp = t, null !== this.panel && this.panel.o(), this.yb("separatorStrokeWidth", i, t)) } }, separatorDashArray: { get: function () { return this.Nj }, set: function (t) { var i = this.Nj; if (i !== t) { if (null !== t) { for (var e = t.length, n = 0, o = 0; o < e; o++) { var r = t[o]; "number" == typeof r && 0 <= r && isFinite(r) || B("separatorDashArray value " + r + " at index " + o + " must be a positive number or zero."), n += r } if (0 === n) { if (null === i) return; t = null } } this.Nj = t, null !== this.panel && this.panel.M(), this.yb("separatorDashArray", i, t) } } }, background: { get: function () { return this.ib }, set: function (t) { var i = this.ib; i !== t && (null !== t && Ya(t, "RowColumnDefinition.background"), t instanceof La && t.freeze(), this.ib = t, null !== this.panel && this.panel.M(), this.yb("background", i, t)) } }, coversSeparators: { get: function () { return this.qn }, set: function (t) { var i = this.qn; i !== t && (this.qn = t, null !== this.panel && this.panel.M(), this.yb("coversSeparators", i, t)) } }, sizing: { get: function () { return this.Ip }, set: function (t) { var i = this.Ip; i !== t && (this.Ip = t, null !== this.panel && this.panel.o(), this.yb("sizing", i, t)) } }, actual: { get: function () { return this.ha }, set: function (t) { this.ha = isNaN(this.Pc) ? Math.max(Math.min(this.eh, t), this.fh) : Math.max(Math.min(this.eh, this.Pc), this.fh) } }, total: { get: function () { return this.ha + this.uc() }, set: function (t) { this.ha = isNaN(this.Pc) ? Math.max(Math.min(this.eh, t), this.fh) : Math.max(Math.min(this.eh, this.Pc), this.fh), this.ha = Math.max(0, this.ha - this.uc()) } }, position: { get: function () { return this.ma }, set: function (t) { this.ma = t } } }), Yh.prototype.bind = Yh.prototype.bind, Yh.prototype.computeEffectiveSpacing = Yh.prototype.uc, Yh.prototype.computeEffectiveSpacingTop = Yh.prototype.mv; var Xh = new V(Yh, "Default", 0), qh = new V(Yh, "None", 1), Uh = new V(Yh, "ProportionalExtra", 2); function Kh() { Es.call(this), this.vd = this.ka = null, this.Gn = "None", this.On = Ur, this.Dc = this.Zk = "black", this.qh = 1, this.Ql = "butt", this.Rl = "miter", this.Oj = 10, this.oh = null, this.ph = 0, this.jf = this.hf = bi, this.ap = this.$o = NaN, this.$n = !1, this.cp = null, this.$k = this.Xl = "None", this.Kd = 1, this.Hd = 0, this.Fd = 1, this.Gd = null } function Hh(t, i, e, n) { var o = e.length; if (!(o < 4)) { for (var r, s, a, h, l, u, c = n.measuredBounds, f = Math.max(1, c.width), c = c.height, d = e[0], p = e[1], g = 0, y = zi(), m = 2; m < o; m += 2)0 === (a = (r = e[m]) - d) && (a = .001), h = (d = (s = e[m + 1]) - p) / a, l = Math.atan2(d, a), u = Math.sqrt(a * a + d * d), y.push([a, l, h, u]), g += u, d = r, p = s; d = e[0], p = e[1], a = n.measuredBounds.width, n instanceof Kh && (a -= n.strokeWidth), a < 1 && (a = 1), o = e = a, s = 0 !== (r = f / 2), a = (u = y[m = 0])[0], l = u[1], h = u[2], u = u[3]; for (var v = 0; .1 <= g;) { if (0 === v && (s ? (o = e, o -= r, g -= r, s = !1) : o = e, 0 === o && (o = 1)), g < o) return void Vi(y); u < o ? (v = o - u, o = u) : v = 0; var x = Math.sqrt(o * o / (1 + h * h)); if (a < 0 && (x = -x), d += x, p += h * x, t.translate(d, p), t.rotate(l), t.translate(-f / 2, -c / 2), 0 === v && n.Qi(t, i), t.translate(f / 2, c / 2), t.rotate(-l), t.translate(-d, -p), g -= o, u -= o, 0 !== v) { if (++m === y.length) return void Vi(y); a = (u = y[m])[0], l = u[1], h = u[2], u = u[3], o = v } } Vi(y) } } function Wh(t) { var i = t.geometryStretch; return null !== t.vd ? i === Ur ? Gr : i : i === Ur ? il[t.figure].defaultStretch : i } function Jh(t, i, e, n, o) { return (i = (t = e.x - t) * t + (i = e.y - i) * i) < n ? (o.x = e.x, o.y = e.y, i) : n } function Zh(t, i, e, n, o, r, s, a, h) { var l = !1, u = (o - s) * (i - n) - (r - a) * (t - e); return 0 != u && (h.x = ((o * a - r * s) * (t - e) - (o - s) * (t * n - i * e)) / u, h.y = ((o * a - r * s) * (i - n) - (r - a) * (t * n - i * e)) / u, (e < t ? t - e : e - t) < (n < i ? i - n : n - i) ? (t = i < n ? i : n, i = i < n ? n : i, (h.y > t || qi.$(h.y, t)) && (h.y < i || qi.$(h.y, i)) && (l = !0)) : (i = t < e ? t : e, t = t < e ? e : t, (h.x > i || qi.$(h.x, i)) && (h.x < t || qi.$(h.x, t)) && (l = !0)), l) } function $h(t, i, e, n) { if (t.Vc(i, e, n)) { t = i.x, i = i.y; var o = e.x, r = e.y; return (e = n.x, n = n.y, t === o) ? (i < r ? (t = i, i = r) : t = r, t <= n && n <= i) : (t < o ? (n = t, t = o) : n = o, n <= e && e <= t) } } function Qh(t) { var i = t.diagram; null !== i && i.undoManager.isUndoingRedoing || (t.segmentOrientation = lc, "None" !== t.Xl ? (t.segmentIndex = -1, t.alignmentFocus = Ci) : "None" !== t.$k && (t.segmentIndex = 0, t.alignmentFocus = new Oi(1 - Ci.x, Ci.y))) } function _h(t) { var i = tl[t]; if (void 0 === i) { var e = t.toLowerCase(); if ("none" === e) return "None"; if (void 0 === (i = tl[e])) { var n, o = null; for (n in qi.Mm) if (n.toLowerCase() === e) { o = n; break } if (null !== o) return t = Wi(qi.Mm[o], !1), tl[o] = t, e !== o && (tl[e] = o), o } } return "string" == typeof i ? i : i instanceof Ui ? t : null } Yh.className = "RowColumnDefinition", Yh.Default = Xh, Yh.None = qh, Yh.ProportionalExtra = Uh, h(Kh, Es), Kh.prototype.cloneProtected = function (t) { Es.prototype.cloneProtected.call(this, t), t.ka = this.ka, t.Gn = this.Gn, t.On = this.On, t.vd = this.vd, t.Zk = this.Zk, t.Dc = this.Dc, t.qh = this.qh, t.Ql = this.Ql, t.Rl = this.Rl, t.Oj = this.Oj, null !== this.oh && (t.oh = k(this.oh)), t.ph = this.ph, t.hf = this.hf.G(), t.jf = this.jf.G(), t.$o = this.$o, t.ap = this.ap, t.$n = this.$n, t.cp = this.cp, t.Xl = this.Xl, t.$k = this.$k, t.Kd = this.Kd, t.Hd = this.Hd, t.Fd = this.Fd, t.Gd = this.Gd }, (t = Kh.prototype).fb = function (t) { t === Xr || t === qr || t === Wr || t === Ur ? this.geometryStretch = t : Es.prototype.fb.call(this, t) }, t.toString = function () { return "Shape(" + ("None" !== this.figure ? this.figure : "None" !== this.toArrow ? this.toArrow : this.fromArrow) + ")#" + tt(this) }, t.Qi = function (t, i) { var e = this.Dc, n = this.Zk; if (null !== e || null !== n) { var o = this.actualBounds, r = this.naturalBounds; null !== n && Us(this, t, n, !0, !1, r, o); var s = this.part, a = this.qh; if (null !== e && 0 === a && null !== s && (a = s.type === xh.Link && s instanceof du && "Selection" === s.category && s.adornedObject instanceof Kh && s.adornedPart.Ab() === s.adornedObject ? s.adornedObject.strokeWidth : 0), null !== e && 0 !== a && (Us(this, t, e, !1, !1, r, o), t.lineWidth = a, t.lineJoin = this.Rl, t.lineCap = this.Ql, t.miterLimit = this.Oj), o = !1, s && i.De("drawShadows") && (o = s.isShadowed), s = !0, null === e || null !== n && "transparent" !== n || (s = !1), r = !1, null !== (l = this.strokeDashArray) && (r = !0, t.jt(l, this.ph)), null !== (f = this.ka)) { if (f.type === ee) t.beginPath(), t.moveTo(f.startX, f.startY), t.lineTo(f.endX, f.endY), null !== n && t.Vd(n), 0 !== a && null !== e && t.fj(); else if (f.type === ne) { var h = f.startX, l = f.startY, u = f.endX, c = f.endY, f = Math.min(h, u), d = Math.min(l, c), h = Math.abs(u - h); l = Math.abs(c - l), t.beginPath(), t.rect(f, d, h, l), null !== n && t.Vd(n), null !== e && (s && o && Ma(t), 0 !== a && (0 !== h && 0 !== l || (t.beginPath(), t.rect(f, d, Math.max(h, .1), Math.max(l, .1))), t.fj()), s && o && Sa(t)) } else if (f.type === oe) h = f.startX, l = f.startY, u = f.endX, c = f.endY, f = Math.abs(u - h) / 2, d = Math.abs(c - l) / 2, h = Math.min(h, u) + f, l = Math.min(l, c) + d, t.beginPath(), t.moveTo(h, l - d), t.bezierCurveTo(h + qi.Fg * f, l - d, h + f, l - qi.Fg * d, h + f, l), t.bezierCurveTo(h + f, l + qi.Fg * d, h + qi.Fg * f, l + d, h, l + d), t.bezierCurveTo(h - qi.Fg * f, l + d, h - f, l + qi.Fg * d, h - f, l), t.bezierCurveTo(h - f, l - qi.Fg * d, h - qi.Fg * f, l - d, h, l - d), t.closePath(), null !== n && t.Vd(n), 0 !== a && null !== e && (s && o ? (Ma(t), t.fj(), Sa(t)) : t.fj()); else if (f.type === re) for (f = (l = f.figures).length, d = 0; d < f; d++) { h = l.j[d], t.beginPath(), t.moveTo(h.startX, h.startY), c = (u = h.segments.j).length; for (var p = null, g = 0; g < c; g++) { var y = u[g]; switch (y.type) { case ue: t.moveTo(y.endX, y.endY); break; case ce: t.lineTo(y.endX, y.endY); break; case fe: t.bezierCurveTo(y.point1X, y.point1Y, y.point2X, y.point2Y, y.endX, y.endY); break; case de: t.quadraticCurveTo(y.point1X, y.point1Y, y.endX, y.endY); break; case pe: if (y.radiusX === y.radiusY) { var m = Math.PI / 180; t.arc(y.point1X, y.point1Y, y.radiusX, y.startAngle * m, (y.startAngle + y.sweepAngle) * m, y.sweepAngle < 0, null !== p ? p.endX : h.startX, null !== p ? p.endY : h.startY) } else if (0 === (m = (p = he(y, h)).length)) t.lineTo(y.centerX, y.centerY); else for (var v = 0; v < m; v++) { var x = p[v]; 0 === v && t.lineTo(x[0], x[1]), t.bezierCurveTo(x[2], x[3], x[4], x[5], x[6], x[7]) } break; case ge: if (v = m = 0, null !== p && p.type === pe) { if (0 === (x = (p = he(p, h)).length)) { t.lineTo(y.centerX, y.centerY); break } null !== (p = p[x - 1] || null) && (m = p[6], v = p[7]) } else m = null !== p ? p.endX : h.startX, v = null !== p ? p.endY : h.startY; if (0 === (m = (p = le(y, h, m, v)).length)) { t.lineTo(y.centerX, y.centerY); break } for (v = 0; v < m; v++)x = p[v], t.bezierCurveTo(x[2], x[3], x[4], x[5], x[6], x[7]); break; default: B("Segment not of valid type: " + y.type) }y.isClosed && t.closePath(), p = y } o ? h.isShadowed ? (!0 === h.isFilled && "transparent" !== n && null !== n && t.Vd(n), 0 !== a && null !== e && (s && Ma(t), t.fj(), s && Sa(t))) : (s && Ma(t), !0 === h.isFilled && "transparent" !== n && null !== n && t.Vd(n), 0 !== a && null !== e && t.fj(), s && Sa(t)) : (!0 === h.isFilled && null !== n && t.Vd(n), 0 !== a && null !== e && t.fj()) } if (r && t.ht(), null !== this.pathPattern) { if ((e = this.pathPattern).measure(1 / 0, 1 / 0), n = e.measuredBounds, e.arrange(0, 0, n.width, n.height), a = this.geometry, t.save(), t.beginPath(), n = zi(), a.type === ee) n.push(a.startX), n.push(a.startY), n.push(a.endX), n.push(a.endY), Hh(t, i, n, e); else if (a.type === re) for (a = a.figures.iterator; a.next();) { for (o = a.value, n.length = 0, n.push(o.startX), n.push(o.startY), l = s = o.startX, f = r = o.startY, h = (d = o.segments.j).length, u = 0; u < h; u++) { switch ((c = d[u]).type) { case ue: Hh(t, i, n, e), n.length = 0, n.push(c.endX), n.push(c.endY), l = s = c.endX, f = r = c.endY; break; case ce: n.push(c.endX), n.push(c.endY), s = c.endX, r = c.endY; break; case fe: qi.Ae(s, r, c.point1X, c.point1Y, c.point2X, c.point2Y, c.endX, c.endY, .5, n), s = c.endX, r = c.endY; break; case de: qi.Dq(s, r, c.point1X, c.point1Y, c.endX, c.endY, .5, n), s = c.endX, r = c.endY; break; case pe: if (0 === (y = (g = he(c, o)).length)) { n.push(c.centerX), n.push(c.centerY), s = c.centerX, r = c.centerY; break } for (p = 0; p < y; p++)m = g[p], qi.Ae(s, r, m[2], m[3], m[4], m[5], m[6], m[7], .5, n), s = m[6], r = m[7]; break; case ge: if (0 === (y = (g = le(c, o, s, r)).length)) { n.push(c.centerX), n.push(c.centerY), s = c.centerX, r = c.centerY; break } for (p = 0; p < y; p++)m = g[p], qi.Ae(s, r, m[2], m[3], m[4], m[5], m[6], m[7], .5, n), s = m[6], r = m[7]; break; default: B("Segment not of valid type: " + c.type) }c.isClosed && (n.push(l), n.push(f), Hh(t, i, n, e)) } Hh(t, i, n, e) } else if (a.type === ne) n.push(a.startX), n.push(a.startY), n.push(a.endX), n.push(a.startY), n.push(a.endX), n.push(a.endY), n.push(a.startX), n.push(a.endY), n.push(a.startX), n.push(a.startY), Hh(t, i, n, e); else if (a.type === oe) { if ((r = new se).startX = a.endX, r.startY = (a.startY + a.endY) / 2, (s = new ae(pe)).startAngle = 0, s.sweepAngle = 360, s.centerX = (a.startX + a.endX) / 2, s.centerY = (a.startY + a.endY) / 2, s.radiusX = Math.abs(a.startX - a.endX) / 2, s.radiusY = Math.abs(a.startY - a.endY) / 2, r.add(s), 0 === (o = (a = he(s, r)).length)) n.push(s.centerX), n.push(s.centerY); else for (s = r.startX, r = r.startY, l = 0; l < o; l++)f = a[l], qi.Ae(s, r, f[2], f[3], f[4], f[5], f[6], f[7], .5, n), s = f[6], r = f[7]; Hh(t, i, n, e) } Vi(n), t.restore(), t.sc(!1) } } } }, t.ga = function (t, i) { var e, n; return void 0 === i && (i = new gi), t instanceof Oi ? (t.jc() && B("getDocumentPoint Spot must be a real, specific Spot, not: " + t.toString()), e = this.naturalBounds, n = this.strokeWidth, i.h(t.x * (e.width + n) - n / 2 + e.x + t.offsetX, t.y * (e.height + n) - n / 2 + e.y + t.offsetY)) : i.set(t), this.wd.ra(i), i }, t.km = function (t) { void 0 === t && (t = new yi); var i = this.naturalBounds, e = this.wd, i = yi.allocAt(i.x, i.y, i.width, i.height), n = this.strokeWidth; return i.Wc(n / 2, n / 2), n = gi.allocAt(i.x, i.y).transform(e), t.h(n.x, n.y, 0, 0), n.h(i.right, i.y).transform(e), mi(t, n.x, n.y, 0, 0), n.h(i.right, i.bottom).transform(e), mi(t, n.x, n.y, 0, 0), n.h(i.x, i.bottom).transform(e), mi(t, n.x, n.y, 0, 0), yi.free(i), gi.free(n), t }, t.Eh = function (t, i) { if (null === (a = this.geometry) || null === this.fill && null === this.stroke) return !1; var e = a.bounds, n = this.strokeWidth / 2; a.type !== ee || i || (n += 2); var o = yi.alloc(); if (o.assign(e), o.Wc(n + 2, n + 2), !o.aa(t)) return yi.free(o), !1; if (e = n + 1e-4, a.type === ee) return null !== this.stroke && (e = (a.endX - a.startX) * (t.x - a.startX) + (a.endY - a.startY) * (t.y - a.startY), !((a.startX - a.endX) * (t.x - a.endX) + (a.startY - a.endY) * (t.y - a.endY) < 0 || e < 0) && (yi.free(o), qi.Nb(a.startX, a.startY, a.endX, a.endY, n, t.x, t.y))); if (a.type === ne) { i = a.startX; var r = a.startY, s = a.endX, a = a.endY; if (o.x = Math.min(i, s), o.y = Math.min(r, a), o.width = Math.abs(s - i), o.height = Math.abs(a - r), null === this.fill) { if (o.Wc(-e, -e), o.aa(t)) return yi.free(o), !1; o.Wc(e, e) } return null !== this.stroke && o.Wc(n, n), t = o.aa(t), yi.free(o), t } if (a.type !== oe) return a.type === re ? (yi.free(o), null === this.fill ? _i(a, t.x, t.y, n) : $i(a, t, n, 1 < this.strokeWidth, i)) : (B("Unknown Geometry type: " + a.type), !1); r = a.startX, n = a.startY, s = a.endX; var h = a.endY; if (a = Math.min(r, s), i = Math.min(n, h), r = Math.abs(s - r) / 2, n = Math.abs(h - n) / 2, a = t.x - (a + r), i = t.y - (i + n), null === this.fill) { if (n -= e, (r -= e) <= 0 || n <= 0 || a * a / (r * r) + i * i / (n * n) <= 1) return yi.free(o), !1; r += e, n += e } return null !== this.stroke && (r += e, n += e), yi.free(o), !(r <= 0 || n <= 0) && a * a / (r * r) + i * i / (n * n) <= 1 }, t.rm = function (t, i, e, n) { var o, r, s, a, h = this.desiredSize, l = this.qh; t = Math.max(t, 0), i = Math.max(i, 0), r = (o = null !== this.vd ? this.geometry.bounds : (r = this.figure, void 0 === (s = il[r]) && ("string" == typeof (a = qi.Je[r]) && (a = qi.Je[a]), "function" == typeof a ? (s = a(null, 100, 100), il[r] = s) : B("Unsupported Figure: " + r)), s.bounds)).width, s = o.height, a = o.width; var u = o.height; switch (Js(this, !0)) { case Xr: n = e = 0; break; case Gr: a = Math.max(t - l, 0), u = Math.max(i - l, 0); break; case Kr: a = Math.max(t - l, 0), n = 0; break; case Hr: e = 0, u = Math.max(i - l, 0) }switch (isFinite(h.width) && (a = h.width), isFinite(h.height) && (u = h.height), h = this.maxSize, o = this.minSize, e = Math.max(e - l, o.width), n = Math.max(n - l, o.height), a = Math.min(h.width, a), u = Math.min(h.height, u), a = isFinite(a) ? Math.max(e, a) : Math.max(r, e), u = isFinite(u) ? Math.max(n, u) : Math.max(s, n), e = Wh(this)) { case Xr: break; case Gr: r = a, s = u; break; case qr: e = Math.min(a / r, u / s), isFinite(e) || (e = 1), r *= e, s *= e; break; default: B(e + " is not a valid geometryStretch.") }null !== this.vd ? (h = r = Math.max(r, .01), n = s = Math.max(s, .01), e = (o = null !== this.vd ? this.vd : this.ka).copy(), h /= (o = o.bounds).width, n /= o.height, isFinite(h) || (h = 1), isFinite(n) || (n = 1), 1 === h && 1 === n || e.scale(h, n), this.ka = e) : null !== this.ka && qi.$(this.ka.jl, t - l) && qi.$(this.ka.il, i - l) || (this.ka = Kh.makeGeometry(this, r, s)), o = this.ka.bounds, 1 / 0 === t || 1 / 0 === i ? Ys(this, o.x - l / 2, o.y - l / 2, 0 === t && 0 === r ? 0 : o.width + l, 0 === i && 0 === s ? 0 : o.height + l) : Ys(this, -l / 2, -l / 2, a + l, u + l) }, t.Ch = function (t, i, e, n) { Xs(this, t, i, e, n) }, t.Vc = function (t, i, e) { return this.hk(t.x, t.y, i.x, i.y, e) }, t.hk = function (t, i, e, n, o) { var r = 1 / ((f = this.transform).m11 * f.m22 - f.m12 * f.m21), s = f.m22 * r, a = -f.m12 * r, h = -f.m21 * r, l = f.m11 * r, u = r * (f.m21 * f.dy - f.m22 * f.dx), c = r * (f.m12 * f.dx - f.m11 * f.dy), f = t * s + i * h + u, r = t * a + i * l + c, s = e * s + n * h + u, a = e * a + n * l + c, u = this.qh / 2; if (null === (h = this.ka) && (this.measure(1 / 0, 1 / 0), h = this.ka), c = h.bounds, l = !1, h.type === ee) if (this.strokeWidth <= 1.5) l = qi.Fe(h.startX, h.startY, h.endX, h.endY, f, r, s, a, o); else { if (h.startX === h.endX ? (n = u, l = 0) : (i = (h.endY - h.startY) / (h.endX - h.startX), n = (l = u / Math.sqrt(1 + i * i)) * i), i = zi(), t = new gi, qi.Fe(h.startX + n, h.startY + l, h.endX + n, h.endY + l, f, r, s, a, t) && i.push(t), t = new gi, qi.Fe(h.startX - n, h.startY - l, h.endX - n, h.endY - l, f, r, s, a, t) && i.push(t), t = new gi, qi.Fe(h.startX + n, h.startY + l, h.startX - n, h.startY - l, f, r, s, a, t) && i.push(t), t = new gi, qi.Fe(h.endX + n, h.endY + l, h.endX - n, h.endY - l, f, r, s, a, t) && i.push(t), 0 === (s = i.length)) return Vi(i), !1; for (l = !0, a = 1 / 0, n = 0; n < s; n++)(e = ((t = i[n]).x - f) * (t.x - f) + (t.y - r) * (t.y - r)) < a && (a = e, o.x = t.x, o.y = t.y); Vi(i) } else if (h.type === ne) l = qi.Vc(c.x - u, c.y - u, c.x + c.width + u, c.y + c.height + u, f, r, s, a, o); else if (h.type === oe) { t: if (0 === (i = yi.allocAt(c.x, c.y, c.width, c.height).Wc(u, u)).width) l = qi.Fe(i.x, i.y, i.x, i.y + i.height, f, r, s, a, o); else if (0 === i.height) l = qi.Fe(i.x, i.y, i.x + i.width, i.y, f, r, s, a, o); else { if (t = i.width / 2, h = i.height / 2, n = i.x + t, l = i.y + h, e = 9999, f !== s && (e = (r - a) / (f - s)), Math.abs(e) < 9999) { if (t * t * e * e + h * h - (a = r - l - e * (f - n)) * a < 0) { o.x = NaN, o.y = NaN, l = !1; break t } s = (-t * t * e * a + t * h * (u = Math.sqrt(t * t * e * e + h * h - a * a))) / (h * h + t * t * e * e) + n, t = (-t * t * e * a - t * h * u) / (h * h + t * t * e * e) + n, h = e * (s - n) + a + l, a = e * (t - n) + a + l, Math.abs((f - s) * (f - s)) + Math.abs((r - h) * (r - h)) < Math.abs((f - t) * (f - t)) + Math.abs((r - a) * (r - a)) ? (o.x = s, o.y = h) : (o.x = t, o.y = a) } else { if (s = h * h, (s -= s / (t * t) * (a = f - n) * a) < 0) { o.x = NaN, o.y = NaN, l = !1; break t } s = l + (a = Math.sqrt(s)), a = l - a, Math.abs(s - r) < Math.abs(a - r) ? (o.x = f, o.y = s) : (o.x = f, o.y = a) } l = !0 } yi.free(i) } else if (h.type === re) { c = gi.alloc(); var d = s - f, p = a - r, g = d * d + p * p; o.x = s, o.y = a; for (var y = 0; y < h.figures.count; y++)for (var m = h.figures.j[y], v = m.segments, x = d = m.startX, b = p = m.startY, w = 0; w < v.count; w++) { var k = v.j[w], M = k.type, S = k.endX, P = k.endY, N = !1; switch (M) { case ue: x = S, b = P; break; case ce: N = Zh(d, p, S, P, f, r, s, a, c); break; case fe: N = qi.fq(d, p, k.point1X, k.point1Y, k.point2X, k.point2Y, S, P, f, r, s, a, .6, c); break; case de: N = qi.fq(d, p, (d + 2 * k.point1X) / 3, (p + 2 * k.point1Y) / 3, (2 * k.point1X + S) / 3, (2 * k.point1X + S) / 3, S, P, f, r, s, a, .6, c); break; case pe: case ge: var C = (M = k.type === pe ? he(k, m) : le(k, m, d, p)).length; if (0 === C) { N = Zh(d, p, k.centerX, k.centerY, f, r, s, a, c); break } for (P = null, S = 0; S < C; S++) { var T, P = M[S]; 0 !== S || !Zh(d, p, P[0], P[1], f, r, s, a, c) || (T = Jh(f, r, c, g, o)) < g && (g = T, l = !0), qi.fq(P[0], P[1], P[2], P[3], P[4], P[5], P[6], P[7], f, r, s, a, .6, c) && ((T = Jh(f, r, c, g, o)) < g && (g = T, l = !0)) } S = P[6], P = P[7]; break; default: B("Unknown Segment type: " + M) }d = S, p = P, N && ((N = Jh(f, r, c, g, o)) < g && (g = N, l = !0)), k.isClosed && (Zh(d, p, S = x, P = b, f, r, s, a, c) && ((k = Jh(f, r, c, g, o)) < g && (g = k, l = !0))) } f = e - t, r = n - i, 0 !== (s = Math.sqrt(f * f + r * r)) && (f /= s, r /= s), o.x -= f * u, o.y -= r * u, gi.free(c) } else B("Unknown Geometry type: " + h.type); return !!l && (this.transform.ra(o), !0) }, t.Dh = function (t, i) { if (void 0 === i) return t.Be(this.actualBounds); var e = this.ka; null === e && (this.measure(1 / 0, 1 / 0), e = this.ka), e = e.bounds; var n = this.strokeWidth / 2, o = !1, r = gi.alloc(); return r.h(e.x - n, e.y - n), t.aa(i.ra(r)) && (r.h(e.x - n, e.bottom + n), t.aa(i.ra(r)) && (r.h(e.right + n, e.bottom + n), t.aa(i.ra(r)) && (r.h(e.right + n, e.y - n), t.aa(i.ra(r)) && (o = !0)))), gi.free(r), o }, t.Gc = function (t, i) { if (this.Dh(t, i) || void 0 === i && (i = this.transform, t.Be(this.actualBounds))) return !0; var e = Gi.alloc(); e.set(i), e.vt(); var n = t.left, o = t.right, r = t.top; t = t.bottom; var s = gi.alloc(); if (s.h(n, r), e.ra(s), this.Eh(s, !0)) return gi.free(s), !0; if (s.h(o, r), e.ra(s), this.Eh(s, !0)) return gi.free(s), !0; if (s.h(n, t), e.ra(s), this.Eh(s, !0)) return gi.free(s), !0; if (s.h(o, t), e.ra(s), this.Eh(s, !0)) return gi.free(s), !0; var a = gi.alloc(), h = gi.alloc(); return e.set(i), e.Pv(this.transform), e.vt(), a.x = o, a.y = r, a.transform(e), s.x = n, s.y = r, s.transform(e), i = !1, $h(this, s, a, h) ? i = !0 : (s.x = o, s.y = t, s.transform(e), $h(this, s, a, h) ? i = !0 : (a.x = n, a.y = t, a.transform(e), $h(this, s, a, h) ? i = !0 : (s.x = n, s.y = r, s.transform(e), $h(this, s, a, h) && (i = !0)))), gi.free(s), Gi.free(e), gi.free(a), gi.free(h), i }, t.Nx = function (t, i, e) { function n(t, i) { for (var e = t.length, n = 0; n < e; n += 2)if (i.dd(t[n], t[n + 1]) > o) return !0; return !1 } if (e && null !== this.fill && this.Eh(t, !0)) return !0; var o = t.Ce(i), r = o; if (1.5 < this.strokeWidth && (o = this.strokeWidth / 2 + Math.sqrt(o), o *= o), null === (i = this.ka) && (this.measure(1 / 0, 1 / 0), null === (i = this.ka))) return !1; if (!e) { var s = (l = i.bounds).x, a = l.y, h = l.x + l.width, l = l.y + l.height; if (dt(t.x, t.y, s, a) <= o && dt(t.x, t.y, h, a) <= o && dt(t.x, t.y, s, l) <= o && dt(t.x, t.y, h, l) <= o) return !0 } if (s = i.startX, a = i.startY, h = i.endX, l = i.endY, i.type === ee) { if (e = (s - h) * (t.x - h) + (a - l) * (t.y - l), ft(t.x, t.y, s, a, h, l) <= (0 <= (h - s) * (t.x - s) + (l - a) * (t.y - a) && 0 <= e ? o : r)) return !0 } else { if (i.type === ne) return i = !1, e && (i = ft(t.x, t.y, s, a, s, l) <= o || ft(t.x, t.y, s, a, h, a) <= o || ft(t.x, t.y, h, a, h, l) <= o || ft(t.x, t.y, s, l, h, l) <= o), i; if (i.type === oe) { i = t.x - (s + h) / 2, r = t.y - (a + l) / 2; var u = Math.abs(h - s) / 2, c = Math.abs(l - a) / 2; if (0 === u || 0 === c) return ft(t.x, t.y, s, a, h, l) <= o; if (!e) return !(dt(i, r, -u, 0) >= o || dt(i, r, 0, -c) >= o || dt(i, r, 0, c) >= o || dt(i, r, u, 0) >= o); if ((t = qi.dz(u, c, i, r)) * t <= o) return !0 } else if (i.type === re) { if (r = (h = i.bounds).x, s = h.y, a = h.x + h.width, h = h.y + h.height, t.x > a && t.x < r && t.y > h && t.y < s && ft(t.x, t.y, r, s, r, h) > o && ft(t.x, t.y, r, s, a, s) > o && ft(t.x, t.y, a, h, r, h) > o && ft(t.x, t.y, a, h, a, s) > o) return !1; if (r = Math.sqrt(o), !e) { for (e = i.figures, i = 0; i < e.count; i++) { if (l = (r = e.j[i]).startX, u = r.startY, t.dd(l, u) > o) return !1; for (a = (s = r.segments.j).length, h = 0; h < a; h++)switch (c = s[h], c.type) { case ue: case ce: if (l = c.endX, u = c.endY, t.dd(l, u) > o) return !1; break; case fe: var f = zi(); if (qi.Ae(l, u, c.point1X, c.point1Y, c.point2X, c.point2Y, c.endX, c.endY, .8, f), l = n(f, t), Vi(f), l) return !1; if (l = c.endX, u = c.endY, t.dd(l, u) > o) return !1; break; case de: if (f = zi(), qi.Dq(l, u, c.point1X, c.point1Y, c.endX, c.endY, .8, f), l = n(f, t), Vi(f), l) return !1; if (l = c.endX, u = c.endY, t.dd(l, u) > o) return !1; break; case pe: case ge: var d = (f = c.type === pe ? he(c, r) : le(c, r, l, u)).length; if (0 === d) { if (l = c.centerX, u = c.centerY, t.dd(l, u) > o) return !1; break } c = null; for (var p = zi(), g = 0; g < d; g++)if (c = f[g], p.length = 0, qi.Ae(c[0], c[1], c[2], c[3], c[4], c[5], c[6], c[7], .8, p), n(p, t)) return Vi(p), !1; Vi(p), null !== c && (l = c[6], u = c[7]); break; default: B("Unknown Segment type: " + c.type) } } return !0 } if (null === this.fill ? _i(i, t.x, t.y, r) : $i(i, t, r, !0, !1)) return !0 } } return !1 }, t.cc = function () { this.ka = null }, Kh.makeGeometry = function (t, i, e) { var n, o; return "None" !== t.toArrow ? n = tl[t.toArrow] : "None" !== t.fromArrow ? n = tl[t.fromArrow] : ("string" == typeof (n = qi.Je[t.figure]) && (n = qi.Je[n]), void 0 === n && B("Unknown Shape.figure: " + t.figure), (n = n(t, i, e)).jl = i, n.il = e), null !== n || "function" == typeof (o = qi.Je.Rectangle) && (n = o(t, i, e)), n }, l.Object.defineProperties(Kh.prototype, { geometry: { get: function () { return null !== this.ka ? this.ka : this.vd }, set: function (t) { var i, e = this.ka, n = this.vd; e !== t && (this.vd = this.ka = null !== t ? t.freeze() : null, null !== (i = this.part) && (i.dh = NaN), this.o(), this.g("geometry", e || n, t), !_s(this) || null !== (t = this.part) && Vs(this, t, "geometryString")) } }, geometryString: { get: function () { return null === this.geometry ? "" : this.geometry.toString() }, set: function (t) { var i = (t = Wi(t)).normalize(); this.geometry = t, this.position = t = gi.allocAt(-i.x, -i.y), gi.free(t) } }, isGeometryPositioned: { get: function () { return this.$n }, set: function (t) { var i = this.$n; i !== t && (this.$n = t, this.o(), this.g("isGeometryPositioned", i, t)) } }, fill: { get: function () { return this.Zk }, set: function (t) { var i = this.Zk; i !== t && (null !== t && Ya(t, "Shape.fill"), t instanceof La && t.freeze(), this.Zk = t, this.M(), this.g("fill", i, t)) } }, stroke: { get: function () { return this.Dc }, set: function (t) { var i = this.Dc; i !== t && (null !== t && Ya(t, "Shape.stroke"), t instanceof La && t.freeze(), this.Dc = t, this.M(), this.g("stroke", i, t)) } }, strokeWidth: { get: function () { return this.qh }, set: function (t) { var i, e = this.qh; e !== t && (0 <= t ? (this.qh = t, this.o(), null !== (i = this.part) && (i.dh = NaN), this.g("strokeWidth", e, t)) : y(t, "value >= 0", Kh, "strokeWidth:value")) } }, strokeCap: { get: function () { return this.Ql }, set: function (t) { var i = this.Ql; i !== t && ("string" != typeof t || "butt" !== t && "round" !== t && "square" !== t ? y(t, '"butt", "round", or "square"', Kh, "strokeCap") : (this.Ql = t, this.M(), this.g("strokeCap", i, t))) } }, strokeJoin: { get: function () { return this.Rl }, set: function (t) { var i = this.Rl; i !== t && ("string" != typeof t || "miter" !== t && "bevel" !== t && "round" !== t ? y(t, '"miter", "bevel", or "round"', Kh, "strokeJoin") : (this.Rl = t, this.M(), this.g("strokeJoin", i, t))) } }, strokeMiterLimit: { get: function () { return this.Oj }, set: function (t) { var i, e = this.Oj; e !== t && 1 <= t && (this.Oj = t, this.M(), null !== (i = this.part) && (i.dh = NaN), this.g("strokeMiterLimit", e, t)) } }, strokeDashArray: { get: function () { return this.oh }, set: function (t) { var i = this.oh; if (i !== t) { if (null !== t) { for (var e = t.length, n = 0, o = 0; o < e; o++) { var r = t[o]; 0 <= r && isFinite(r) || B("strokeDashArray:value " + r + " at index " + o + " must be a positive number or zero."), n += r } if (0 === n) { if (null === i) return; t = null } } this.oh = t, this.M(), this.g("strokeDashArray", i, t) } } }, strokeDashOffset: { get: function () { return this.ph }, set: function (t) { var i = this.ph; i !== t && 0 <= t && (this.ph = t, this.M(), this.g("strokeDashOffset", i, t)) } }, figure: { get: function () { return this.Gn }, set: function (t) { var i, e = this.Gn; e !== t && ("function" == typeof (i = qi.Je[t]) ? i = t : (i = qi.Je[t.toLowerCase()]) || B("Unknown Shape.figure: " + t), e !== i && (null !== (t = this.part) && (t.dh = NaN), this.Gn = i, this.vd = null, this.cc(), this.o(), this.g("figure", e, i))) } }, toArrow: { get: function () { return this.Xl }, set: function (t) { var i, e = this.Xl; !0 === t ? t = "Standard" : !1 === t && (t = ""), e !== t && (null === (i = _h(t)) ? B("Unknown Shape.toArrow: " + t) : e !== i && (this.Xl = i, this.vd = null, this.cc(), this.o(), Qh(this), this.g("toArrow", e, i))) } }, fromArrow: { get: function () { return this.$k }, set: function (t) { var i, e = this.$k; !0 === t ? t = "Standard" : !1 === t && (t = ""), e !== t && (null === (i = _h(t)) ? B("Unknown Shape.fromArrow: " + t) : e !== i && (this.$k = i, this.vd = null, this.cc(), this.o(), Qh(this), this.g("fromArrow", e, i))) } }, spot1: { get: function () { return this.hf }, set: function (t) { var i = this.hf; i.w(t) || (this.hf = t = t.G(), this.o(), this.g("spot1", i, t)) } }, spot2: { get: function () { return this.jf }, set: function (t) { var i = this.jf; i.w(t) || (this.jf = t = t.G(), this.o(), this.g("spot2", i, t)) } }, parameter1: { get: function () { return this.$o }, set: function (t) { var i = this.$o; i !== t && (this.$o = t, this.cc(), this.o(), this.g("parameter1", i, t)) } }, parameter2: { get: function () { return this.ap }, set: function (t) { var i = this.ap; i !== t && (this.ap = t, this.cc(), this.o(), this.g("parameter2", i, t)) } }, naturalBounds: { get: function () { if (null !== this.ka) return this.oc.assign(this.ka.bounds), this.oc; var t = this.desiredSize; return new yi(0, 0, t.width, t.height) } }, pathPattern: { get: function () { return this.cp }, set: function (t) { var i = this.cp; i !== t && (this.cp = t, this.M(), this.g("pathPattern", i, t)) } }, geometryStretch: { get: function () { return this.On }, set: function (t) { var i = this.On; i !== t && (this.On = t, this.g("geometryStretch", i, t)) } }, interval: { get: function () { return this.Kd }, set: function (t) { var i, e = this.Kd; e !== (t = Math.round(t)) && 0 !== t && isFinite(t) && (this.Kd = t, null !== (i = this.diagram) && this.panel === i.grid && wr(i), this.o(), null !== (i = this.panel) && (i.Xg = null), this.g("interval", e, t)) } }, graduatedStart: { get: function () { return this.Hd }, set: function (t) { var i = this.Hd; i !== t && (t < 0 ? t = 0 : 1 < t && (t = 1), this.Hd = t, this.o(), this.g("graduatedStart", i, t)) } }, graduatedEnd: { get: function () { return this.Fd }, set: function (t) { var i = this.Fd; i !== t && (t < 0 ? t = 0 : 1 < t && (t = 1), this.Fd = t, this.o(), this.g("graduatedEnd", i, t)) } }, graduatedSkip: { get: function () { return this.Gd }, set: function (t) { var i = this.Gd; i !== t && (this.Gd = t, this.o(), this.g("graduatedSkip", i, t)) } } }), Kh.prototype.intersectsRect = Kh.prototype.Gc, Kh.prototype.containedInRect = Kh.prototype.Dh, Kh.prototype.getNearestIntersectionPoint = Kh.prototype.Vc, Kh.prototype.getDocumentBounds = Kh.prototype.km, Kh.prototype.getDocumentPoint = Kh.prototype.ga; var tl = new X, il = new X; function el() { Es.call(this), Cl || (Nl = es ? new Pa(null).context : null, Cl = !0), this.kx = this.Tb = "", this.Dc = "black", this.he = "13px sans-serif", this.Ii = "start", this.Ed = Xr, this.Mi = Mi, this.xj = !0, this.pi = this.ri = !1, this.ig = ml, this.tg = gl, this.bs = this.qb = this.Nc = 0, this.Iu = this.Ju = null, this.Dn = !1, this.zc = this.en = this.Sp = this.Ji = this.Tp = null, this.gf = this.ff = 0, this.pe = 1 / 0, this.ti = 0, this.ie = null, this.ve = 0, this.ge = this.hb = this.Qb = null, this.Kd = 1, this.Hd = 0, this.Fd = 1, this.Gd = this.tj = null } function nl(t, i) { t.F = 6144 | i.F, t.rb = i.opacity, t.ib = i.background, t.dc = i.areaBackground, t.Lc = i.desiredSize.G(), t.bg = i.minSize.G(), t.ag = i.maxSize.G(), t.Zf = i.Zf.copy(), t.ya = i.scale, t.Yb = i.angle, t.xe = i.stretch, t.bh = i.margin.G(), t.wb = i.alignment.G(), t.Fk = i.alignmentFocus.G(), t.Gl = i.segmentFraction, t.Hl = i.segmentOffset.G(), t.Il = i.segmentOrientation, null !== i.md && (t.md = i.md.copy()), t.Kl = i.shadowVisible, i instanceof el && (t.Tb = i.Tb, t.Dc = i.Dc, t.he = i.he, t.Ii = i.Ii, t.Ed = i.Ed, t.Mi = i.Mi, t.xj = i.xj, t.ri = i.ri, t.pi = i.pi, t.ig = i.ig, t.tg = i.tg, t.ie = null, t.ff = i.ff, t.gf = i.gf, t.pe = i.pe, t.ti = i.ti, t.Kd = i.Kd, t.Hd = i.Hd, t.Fd = i.Fd, t.tj = i.tj, t.Gd = i.Gd) } function ol(t, i, e) { null === t.ge ? (t.ge = i, t.qb = e) : (null !== t.hb && null !== t.Qb || (t.hb = [], t.Qb = [], t.hb.push(t.ge), t.Qb.push(t.qb)), t.hb.push(i), t.Qb.push(e)) } function rl(t, i, e, n) { i = i.trim(); var o = 0, r = t.he, s = t.ff + t.gf, s = Math.max(0, hl(t) + s), a = t.ig === vl ? ll(r) : 0; if (t.Nc >= t.pe) null !== n && n.h(0, s); else { var h = i; if (t.tg === dl) if (t.ve = 1, r = al(i), 0 === a || r <= e) t.qb = Math.max(t.qb, r), ol(t, i, t.qb), null !== n && n.h(r, s); else { for (r = al((o = sl(t, h)) + (i = sl(t, h = h.substr(o.length)))); 0 < i.length && r <= e;)r = al(((o += i) + (i = sl(t, h = h.substr(i.length)))).trim()); for (o += i.trim(), e = Math.max(1, e - a); al(o) > e && 1 < o.length;)o = o.substr(0, o.length - 1); i = al(o += Sl), t.qb = i, ol(t, o, i), null !== n && n.h(i, s) } else { for ((a = 0) === h.length && (a = 1, ol(t, h, 0)); 0 < h.length;) { for (var l = sl(t, h), h = h.substr(l.length); al(l) > e;) { var u, c = 1, r = al(l.substr(0, c)); for (i = 0; r <= e;)c++, i = r, r = al(l.substr(0, c)); if (o = 1 === c ? (u = r, Math.max(o, r)) : (u = i, Math.max(o, i)), --c < 1 && (c = 1), ol(t, l.substr(0, c), u), a++, l = l.substr(c), t.Nc + a > t.pe) break } for (r = al(l + (i = sl(t, h))); 0 < i.length && r <= e;)r = al(((l += i) + (i = sl(t, h = h.substr(i.length)))).trim()); if ("" !== (l = l.trim()) && ("­" === l[l.length - 1] && (l = l.substring(0, l.length - 1) + "‐"), o = 0 === i.length ? (c = r, Math.max(o, r)) : (c = i = al(l), Math.max(o, i)), ol(t, l, c), a++, t.Nc + a > t.pe)) break } t.ve = Math.min(t.pe, a), t.qb = Math.max(t.qb, o), null !== n && n.h(t.qb, s * t.ve) } } } function sl(t, i) { if (t.tg === yl) return i.substr(0, 1); t = i.length; for (var e = 0, n = xl; e < t && !n.test(i.charAt(e));)e++; for (; e < t && n.test(i.charAt(e));)e++; return t <= e ? i : i.substr(0, e) } function al(t) { return null === Nl ? 8 * t.length : Nl.measureText(t).width } function hl(t) { if (null !== t.ie) return t.ie; var i = t.he; if (null !== Nl) return void 0 !== bl[i] && wl < 5e3 ? e = bl[i] : (e = 1.3 * Nl.measureText("M").width, bl[i] = e, wl++), t.ie = e; var e = 16; return t.ie = e } function ll(t) { return null === Nl ? 6 : (void 0 !== kl[t] && Ml < 5e3 ? i = kl[t] : (i = Nl.measureText(Sl).width, kl[t] = i, Ml++), i); var i } function ul(t, i) { var e, n = t.Tb.replace(/\r\n/g, "\n").replace(/\r/g, "\n"), o = t.ff + t.gf, o = Math.max(0, hl(t) + o); if (0 === n.length) return t.qb = 0, t.Nc = 1, o; t.isMultiline || 0 <= (e = n.indexOf("\n", 0)) && (n = n.substr(0, e)), e = 0; for (var r, s, a = t.Nc = 0, h = !1; !h;) { -1 === (s = n.indexOf("\n", a)) && (s = n.length, h = !0), a <= s && (a = n.substr(a, s - a), t.tg !== dl ? (t.ve = 0, rl(t, a, i, r = Yi.alloc()), e += r.height, Yi.free(r), t.Nc += t.ve) : (rl(t, a, i, null), e += o, t.Nc++), t.Nc === t.pe && (h = !0)), a = s + 1 } return t.bs = e } Kh.className = "Shape", Kh.getFigureGenerators = function () { var t, i = new at; for (t in qi.Je) t !== t.toLowerCase() && i.add(t, qi.Je[t]); return i.freeze(), i }, Kh.defineFigureGenerator = function (t, i) { var e = t.toLowerCase(), n = qi.Je; n[t] = i, n[e] = t }, Kh.getArrowheadGeometries = function () { var t, i, e = new at; for (i in qi.Mm) { void 0 === tl[i] && (t = Wi(qi.Mm[i], !1), tl[i] = t, (t = i.toLowerCase()) !== i && (tl[t] = i)) } for (var n in tl) { n === n.toLowerCase() || (i = tl[n]) instanceof Ui && e.add(n, i) } return e.freeze(), e }, Kh.defineArrowheadGeometry = function (t, i) { var e = null, e = "string" == typeof i ? Wi(i, !1) : i; "none" !== (i = t.toLowerCase()) && t !== i || B("Shape.defineArrowheadGeometry name must not be empty or None or all-lower-case: " + t); var n = tl; n[t] = e, n[i] = t }, h(el, Es), el.prototype.cloneProtected = function (t) { Es.prototype.cloneProtected.call(this, t), t.Tb = this.Tb, t.kx = this.kx, t.Dc = this.Dc, t.he = this.he, t.Ii = this.Ii, t.Ed = this.Ed, t.Mi = this.Mi, t.xj = this.xj, t.ri = this.ri, t.pi = this.pi, t.ig = this.ig, t.tg = this.tg, t.Nc = this.Nc, t.bs = this.bs, t.qb = this.qb, t.Ju = this.Ju, t.Iu = this.Iu, t.Dn = this.Dn, t.Tp = this.Tp, t.Ji = this.Ji, t.Sp = this.Sp, t.en = this.en, t.zc = this.zc, t.ff = this.ff, t.gf = this.gf, t.pe = this.pe, t.ie = this.ie, t.ve = this.ve, t.Qb = this.Qb, t.hb = this.hb, t.ge = this.ge, t.ti = this.ti, t.Kd = this.Kd, t.Hd = this.Hd, t.Fd = this.Fd, t.tj = this.tj, t.Gd = this.Gd }, (t = el.prototype).fb = function (t) { t.classType === el ? this.wrap = t : Es.prototype.fb.call(this, t) }, t.toString = function () { return 22 < this.Tb.length ? 'TextBlock("' + this.Tb.substring(0, 20) + '"...)' : 'TextBlock("' + this.Tb + '")' }, t.o = function () { Es.prototype.o.call(this), this.Iu = this.Ju = null }, t.Qi = function (t, i) { if (null !== this.Dc && 0 !== this.Tb.length && null !== this.he) { var e = this.naturalBounds, n = this.actualBounds, o = e.width, r = e.height, s = hl(this), a = t.textAlign = this.Ii, h = i.ml; "start" === a ? a = h ? "right" : "left" : "end" === a && (a = h ? "left" : "right"), h = this.ri; var l = this.pi; Us(this, t, this.Dc, !0, !1, e, n), (h || l) && Us(this, t, this.Dc, !1, !1, e, n), e = !1; var u = gi.allocAt(n = 0, 0); this.wd.ra(u); var c = gi.allocAt(0, s); this.wd.ra(c); var f = u.Ce(c); switch (gi.free(u), gi.free(c), f * (u = i.scale) * u < 8 && (e = !0), i.Eb !== t && (e = !1), !1 === i.De("textGreeking") && (e = !1), i = this.ff, f = this.gf, this.flip) { case Zr: t.translate(o, 0), t.scale(-1, 1); break; case Jr: t.translate(0, r), t.scale(1, -1); break; case $r: t.translate(o, r), t.scale(-1, -1) }if ((c = (i + s + f) * (u = this.Nc)) < r && (n = (n = this.Mi).y * r - n.y * c + n.offsetY), 1 === u && null !== this.ge) o < (f = this.qb) && (f = o), this.Pi(this.ge, t, 0, n + i, o, s, f, e, a, h, l); else if (null !== this.Qb && null !== this.hb) for (c = 0; c < u; c++) { var d = this.Qb[c]; o < d && (d = o), n += i, this.Pi(this.hb[c], t, 0, n, o, s, d, e, a, h, l), n += s + f } switch (this.flip) { case Zr: t.scale(-1, 1), t.translate(-o, 0); break; case Jr: t.scale(1, -1), t.translate(0, -r); break; case $r: t.scale(-1, -1), t.translate(-o, -r) } } }, t.Pi = function (t, i, e, n, o, r, s, a, h, l, u) { var c = 0; a ? ("left" === h ? c = 0 : "right" === h ? c = o - s : "center" === h && (c = (o - s) / 2), i.fillRect(e + c, n + .25 * r, s, 1)) : ("left" === h ? c = 0 : "right" === h ? c = o : "center" === h && (c = o / 2), o = null !== cl ? cl(this, r) : .75 * r, i.fillText(t, e + c, n + o), 0 === (t = r / 20 | 0) && (t = 1), "right" === h ? c -= s : "center" === h && (c -= s / 2), l && (h = null !== fl ? fl(this, r) : .8 * r, i.beginPath(), i.lineWidth = t, i.moveTo(e + c, n + h), i.lineTo(e + c + s, n + h), i.stroke()), u && (i.beginPath(), n = n + r - r / 2.2 | 0, 0 != (i.lineWidth = t) % 2 && (n += .5), i.moveTo(e + c, n), i.lineTo(e + c + s, n), i.stroke())) }, t.rm = function (t, i, e, n) { this.ti = t; var o, r = this.he; if (null !== Nl && Pl !== r && (Pl = Nl.font = r), this.qb = this.ve = 0, this.ge = this.hb = this.Qb = this.ie = null, isNaN(this.desiredSize.width)) { if (0 === (r = this.Tb.replace(/\r\n/g, "\n").replace(/\r/g, "\n")).length) r = 0; else if (this.isMultiline) { for (var s = o = 0, a = !1; !a;) { var h = r.indexOf("\n", s); -1 === h && (h = r.length, a = !0), o = Math.max(o, al(r.substr(s, h - s).trim())), s = h + 1 } r = o } else 0 <= (o = r.indexOf("\n", 0)) && (r = r.substr(0, o)), r = al(r); r = Math.min(r, t / this.scale), r = Math.max(8, r) } else r = this.desiredSize.width; if (null !== this.panel && (r = Math.min(r, this.panel.maxSize.width)), o = ul(this, r), s = o = isNaN(this.desiredSize.height) ? Math.min(o, i / this.scale) : this.desiredSize.height, 0 !== this.qb && null !== this.Qb && null !== this.hb && this.ig === vl && (i = this.he, i = this.ig === vl ? ll(i) : 0, a = this.ff + this.gf, a = Math.max(0, hl(this) + a), !((s = Math.min(this.maxLines - 1, Math.max(Math.floor(s / a + .01) - 1, 0))) + 1 >= this.hb.length))) { for (a = this.hb[s], i = Math.max(1, t - i); al(a) > i && 1 < a.length;)a = a.substr(0, a.length - 1); i = al(a += Sl), this.hb[s] = a, this.hb = this.hb.slice(0, s + 1), this.Qb[s] = i, this.Qb = this.Qb.slice(0, s + 1), this.ve = this.hb.length, this.qb = Math.max(this.qb, i), this.Nc = this.ve, 1 === this.Nc && (this.ge = this.hb[0]) } this.wrap !== pl && !isNaN(this.desiredSize.width) || (r = isNaN(t) ? this.qb : Math.min(t, this.qb), isNaN(this.desiredSize.width) && (r = Math.max(8, r))), r = Math.max(e, r), o = Math.max(n, o), jt(this.oc, r, o), Ys(this, 0, 0, r, o) }, t.Ch = function (t, i, e, n) { Xs(this, t, i, e, n) }, l.Object.defineProperties(el.prototype, { font: { get: function () { return this.he }, set: function (t) { var i = this.he; i !== t && (this.he = t, this.ie = null, this.o(), this.g("font", i, t)) } }, text: { get: function () { return this.Tb }, set: function (t) { var i = this.Tb; i !== (t = null != t ? t.toString() : "") && (this.Tb = t, this.o(), this.g("text", i, t)) } }, textAlign: { get: function () { return this.Ii }, set: function (t) { var i = this.Ii; i === t || "start" !== t && "end" !== t && "left" !== t && "right" !== t && "center" !== t || (this.Ii = t, this.M(), this.g("textAlign", i, t)) } }, flip: { get: function () { return this.Ed }, set: function (t) { var i = this.Ed; i !== t && (this.Ed = t, this.M(), this.g("flip", i, t)) } }, verticalAlignment: { get: function () { return this.Mi }, set: function (t) { var i = this.Mi; i.w(t) || (this.Mi = t = t.G(), Ws(this), this.g("verticalAlignment", i, t)) } }, naturalBounds: { get: function () { var t, i, e; return this.oc.v() || (t = Yi.alloc(), rl(this, this.Tb, 999999, t), i = t.width, Yi.free(t), t = ul(this, i), e = this.desiredSize, isNaN(e.width) || (i = e.width), isNaN(e.height) || (t = e.height), jt(this.oc, i, t)), this.oc } }, isMultiline: { get: function () { return this.xj }, set: function (t) { var i = this.xj; i !== t && (this.xj = t, this.o(), this.g("isMultiline", i, t)) } }, isUnderline: { get: function () { return this.ri }, set: function (t) { var i = this.ri; i !== t && (this.ri = t, this.M(), this.g("isUnderline", i, t)) } }, isStrikethrough: { get: function () { return this.pi }, set: function (t) { var i = this.pi; i !== t && (this.pi = t, this.M(), this.g("isStrikethrough", i, t)) } }, wrap: { get: function () { return this.tg }, set: function (t) { var i = this.tg; i !== t && (this.tg = t, this.o(), this.g("wrap", i, t)) } }, overflow: { get: function () { return this.ig }, set: function (t) { var i = this.ig; i !== t && (this.ig = t, this.o(), this.g("overflow", i, t)) } }, stroke: { get: function () { return this.Dc }, set: function (t) { var i = this.Dc; i !== t && (null !== t && Ya(t, "TextBlock.stroke"), t instanceof La && t.freeze(), this.Dc = t, this.M(), this.g("stroke", i, t)) } }, lineCount: { get: function () { return this.Nc } }, editable: { get: function () { return this.Dn }, set: function (t) { var i = this.Dn; i !== t && (this.Dn = t, this.g("editable", i, t)) } }, textEditor: { get: function () { return this.Tp }, set: function (t) { var i = this.Tp; i !== t && (this.Tp = t, this.g("textEditor", i, t)) } }, errorFunction: { get: function () { return this.zc }, set: function (t) { var i = this.zc; i !== t && (this.zc = t, this.g("errorFunction", i, t)) } }, interval: { get: function () { return this.Kd }, set: function (t) { var i, e = this.Kd; e !== (t = Math.round(t)) && 0 !== t && isFinite(t) && (this.Kd = t, this.o(), null !== (i = this.panel) && (i.Xg = null), this.g("interval", e, t)) } }, graduatedStart: { get: function () { return this.Hd }, set: function (t) { var i = this.Hd; i !== t && (t < 0 ? t = 0 : 1 < t && (t = 1), this.Hd = t, this.o(), this.g("graduatedStart", i, t)) } }, graduatedEnd: { get: function () { return this.Fd }, set: function (t) { var i = this.Fd; i !== t && (t < 0 ? t = 0 : 1 < t && (t = 1), this.Fd = t, this.o(), this.g("graduatedEnd", i, t)) } }, graduatedFunction: { get: function () { return this.tj }, set: function (t) { var i = this.tj; i !== t && (this.tj = t, this.o(), this.g("graduatedFunction", i, t)) } }, graduatedSkip: { get: function () { return this.Gd }, set: function (t) { var i = this.Gd; i !== t && (this.Gd = t, this.o(), this.g("graduatedSkip", i, t)) } }, textValidation: { get: function () { return this.Ji }, set: function (t) { var i = this.Ji; i !== t && (this.Ji = t, this.g("textValidation", i, t)) } }, textEdited: { get: function () { return this.Sp }, set: function (t) { var i = this.Sp; i !== t && (this.Sp = t, this.g("textEdited", i, t)) } }, spacingAbove: { get: function () { return this.ff }, set: function (t) { var i = this.ff; i !== t && (this.ff = t, this.g("spacingAbove", i, t)) } }, spacingBelow: { get: function () { return this.gf }, set: function (t) { var i = this.gf; i !== t && (this.gf = t, this.g("spacingBelow", i, t)) } }, maxLines: { get: function () { return this.pe }, set: function (t) { var i = this.pe; i !== t && ((t = Math.floor(t)) <= 0 && y(t, "> 0", el, "maxLines"), this.pe = t, this.g("maxLines", i, t), this.o()) } }, metrics: { get: function () { return { arrSize: null !== this.Qb ? this.Qb : [this.qb], arrText: null !== this.hb ? this.hb : [this.ge], maxLineWidth: this.qb, fontHeight: this.ie } } }, choices: { get: function () { return this.en }, set: function (t) { var i = this.en; i !== t && (this.en = t, this.g("choices", i, t)) } } }); var cl = null, fl = null, dl = new V(el, "None", 0), pl = new V(el, "WrapFit", 1), gl = new V(el, "WrapDesiredSize", 2), yl = new V(el, "WrapBreakAll", 3), ml = new V(el, "OverflowClip", 0), vl = new V(el, "OverflowEllipsis", 1), xl = /[ \u200b\u00ad]/, bl = new X, wl = 0, kl = new X, Ml = 0, Sl = "...", Pl = "", Nl = null, Cl = !1; function Tl() { this.Qb = [], this.hb = [] } function Ll() { Es.call(this), this.Sg = null, this.Kp = "", this.nh = Yt, this.el = Gr, this.kf = this.zc = null, this.dl = Zt, this.Ed = Xr, this.Tl = null, this.wu = !1, this.Fr = !0, this.ul = !1, this.Ml = null } function Al(t) { void 0 === t && (t = ""), "" !== t ? Fl[t] && (delete Fl[t], Ol--) : (Fl = new X, Ol = 0) } function jl(t, i) { t.Qr = !0, t.al = !1; for (var e = L(), n = e.length, o = 0; o < n; o++) { var r = e[o], s = t.getAttribute("src"), a = r.Ci.H(s); if (null !== a) for (var h = a.length, l = 0; l < h; l++)s = a[l], r.ts.add(s), r.Pb(), void 0 === t.Su && (t.Su = i, null !== s.kf && s.kf(s, i)) } } function Dl(t, i) { t.al = i; for (var e = L(), n = e.length, o = 0; o < n; o++) { var r, s = e[o], a = t.getAttribute("src"); if (null !== (r = s.Ci.H(a))) { s = r.length, a = zi(); for (var h = 0; h < s; h++)a.push(r[h]); for (h = 0; h < s; h++)null !== (r = a[h]).zc && r.zc(r, i); Vi(a) } } } el.className = "TextBlock", el.getEllipsis = function () { return Sl }, el.setEllipsis = function (t) { Sl = t, kl = new X, Ml = 0 }, el.getBaseline = function () { return cl }, el.setBaseline = function (t) { cl = t; for (var i = (t = L()).length, e = 0; e < i; e++)t[e].Zd() }, el.getUnderline = function () { return fl }, el.setUnderline = function (t) { fl = t; for (var i = (t = L()).length, e = 0; e < i; e++)t[e].Zd() }, el.isValidFont = function (t) { if (Cl || (Nl = es ? new Pa(null).context : null, Cl = !0), null === Nl) return !0; var i = Nl.font; if (t === i || "10px sans-serif" === t) return !0; Nl.font = "10px sans-serif", Nl.font = t; var e = Nl.font; if ("10px sans-serif" !== e) return Nl.font = i, !0; Nl.font = "19px serif"; var n = Nl.font; return Nl.font = t, e = Nl.font, Nl.font = i, e !== n }, el.None = dl, el.WrapFit = pl, el.WrapDesiredSize = gl, el.WrapBreakAll = yl, el.OverflowClip = ml, el.OverflowEllipsis = vl, Tl.prototype.reset = function () { this.Qb = [], this.hb = [] }, Tl.prototype.gt = function (t) { this.Qb = k(t.Qb), this.hb = k(t.hb) }, Tl.className = "TextBlockMetrics", h(Ll, Es), Ll.prototype.cloneProtected = function (t) { Es.prototype.cloneProtected.call(this, t), t.element = this.Sg, t.Kp = this.Kp, t.nh = this.nh.G(), t.el = this.el, t.Ed = this.Ed, t.zc = this.zc, t.kf = this.kf, t.dl = this.dl.G(), t.Fr = this.Fr, t.Ml = this.Ml }, (t = Ll.prototype).fb = function (t) { t === Xr || t === qr || t === Wr ? this.imageStretch = t : Es.prototype.fb.call(this, t) }, t.toString = function () { return "Picture(" + this.source + ")#" + tt(this) }, t.mA = function () { var t; "" !== this.source && (Al(this.source), t = this.source, this.source = "", this.source = t) }, t.Zd = function () { this.M() }, t.Qi = function (t, i) { var e = this.Sg; if (null !== e) { var n = e.getAttribute("src"); if (e instanceof HTMLImageElement && (null === n || "" === n) && B('Element has no source ("src") attribute: ' + e), !(e.al instanceof Event)) { n = this.naturalBounds; var o = 0, r = 0, s = (a = this.wu) ? +e.width : e.naturalWidth, a = a ? +e.height : e.naturalHeight; if (void 0 === s && e.videoWidth && (s = e.videoWidth), void 0 === a && e.videoHeight && (a = e.videoHeight), s = s || n.width, a = a || n.height, 0 !== s && 0 !== a) { var h = s, l = a; this.sourceRect.v() && (o = this.nh.x, r = this.nh.y, s = this.nh.width, a = this.nh.height); var u = s, c = a, f = this.el, d = this.dl; switch (f) { case Xr: if (this.sourceRect.v()) break; u >= n.width && (o = o + d.offsetX + (u * d.x - n.width * d.x)), c >= n.height && (r = r + d.offsetY + (c * d.y - n.height * d.y)), s = Math.min(n.width, u), a = Math.min(n.height, c); break; case Gr: u = n.width, c = n.height; break; case qr: case Wr: f === qr ? (u *= f = Math.min(n.height / c, n.width / u), c *= f) : f === Wr && (c *= f = Math.max(n.height / c, n.width / u), (u *= f) >= n.width && (o = (o + d.offsetX + (u * d.x - n.width * d.x) / u) * s), c >= n.height && (r = (r + d.offsetY + (c * d.y - n.height * d.y) / c) * a), s *= 1 / (u / n.width), a *= 1 / (c / n.height), u = n.width, c = n.height) }var p = u * (f = this.uf() * i.scale) * c * f, g = s * a / p, y = e.__goCache, f = null; if (e.Qr && void 0 !== y && 4 < p && Bl * Bl < g) for (null === y.Oi && (Rl(y, 4, h, l, e), Rl(y, 16, h, l, e)), l = (h = y.Oi).length, p = 0; p < l && h[p].ratio * h[p].ratio < g; p++)f = h[p]; if (!i.Xk) { if (null === this.Tl) if (null === this.Sg) this.Tl = !1; else { (h = new Pa(null).context).drawImage(this.Sg, 0, 0); try { h.getImageData(0, 0, 1, 1).data[3] && (this.Tl = !1), this.Tl = !1 } catch (t) { this.Tl = !0 } } if (this.Tl) return } switch (h = 0, u < n.width && (h = d.offsetX + (n.width * d.x - u * d.x)), l = 0, c < n.height && (l = d.offsetY + (n.height * d.y - c * d.y)), this.flip) { case Zr: t.translate(Math.min(n.width, u), 0), t.scale(-1, 1); break; case Jr: t.translate(0, Math.min(n.height, c)), t.scale(1, -1); break; case $r: t.translate(Math.min(n.width, u), Math.min(n.height, c)), t.scale(-1, -1) }if (i.De("pictureRatioOptimization") && !i.ni && void 0 !== y && null !== f && 1 !== f.ratio) { t.save(), i = f.ratio; try { t.drawImage(f.source, o / i, r / i, Math.min(f.source.width, s / i), Math.min(f.source.height, a / i), h, l, Math.min(n.width, u), Math.min(n.height, c)) } catch (t) { this.Fr = !1 } t.restore() } else try { t.drawImage(e, o, r, s, a, h, l, Math.min(n.width, u), Math.min(n.height, c)) } catch (t) { this.Fr = !1 } switch (this.flip) { case Zr: t.scale(-1, 1), t.translate(-Math.min(n.width, u), 0); break; case Jr: t.scale(1, -1), t.translate(0, -Math.min(n.height, c)); break; case $r: t.scale(-1, -1), t.translate(-Math.min(n.width, u), -Math.min(n.height, c)) } } } } }, t.rm = function (t, i, e, n) { var o = this.desiredSize, r = Js(this, !0), s = this.Sg, a = this.wu; (a || !this.ul && s && s.complete) && (this.ul = !0), null === s && (isFinite(o.width) || (t = 0), isFinite(o.height) || (i = 0)), isFinite(o.width) || r === Gr || r === Kr ? (isFinite(t) || (t = this.sourceRect.v() ? this.sourceRect.width : a ? +s.width : s.naturalWidth), e = 0) : null !== s && !1 !== this.ul && (t = this.sourceRect.v() ? this.sourceRect.width : a ? +s.width : s.naturalWidth), isFinite(o.height) || r === Gr || r === Hr ? (isFinite(i) || (i = this.sourceRect.v() ? this.sourceRect.height : a ? +s.height : s.naturalHeight), n = 0) : null !== s && !1 !== this.ul && (i = this.sourceRect.v() ? this.sourceRect.height : a ? +s.height : s.naturalHeight), isFinite(o.width) && (t = o.width), isFinite(o.height) && (i = o.height), o = this.maxSize, r = this.minSize, e = Math.max(e, r.width), n = Math.max(n, r.height), t = Math.min(o.width, t), i = Math.min(o.height, i), t = Math.max(e, t), i = Math.max(n, i), null === s || s.complete || (isFinite(t) || (t = 0), isFinite(i) || (i = 0)), jt(this.oc, t, i), Ys(this, 0, 0, t, i) }, t.Ch = function (t, i, e, n) { Xs(this, t, i, e, n) }, l.Object.defineProperties(Ll.prototype, { element: { get: function () { return this.Sg }, set: function (i) { var e, t = this.Sg; t !== i && (null === i || i instanceof HTMLImageElement || i instanceof HTMLVideoElement || i instanceof HTMLCanvasElement || B("Picture.element must be an instance of Image, Canvas, or Video, not: " + i), this.wu = i instanceof HTMLCanvasElement, null !== (this.Sg = i) && (i instanceof HTMLCanvasElement || !0 === i.complete ? (i.al instanceof Event && null !== this.zc && this.zc(this, i.al), !0 === i.Qr && null !== this.kf && this.kf(this, i.Su), i.Qr = !0, this.desiredSize.v() || (oa(this, !1), this.o())) : (e = this, i.Xw || (i.addEventListener("load", function (t) { jl(i, t), e.desiredSize.v() || (oa(e, !1), e.o()) }), i.addEventListener("error", function (t) { Dl(i, t) }), i.Xw = !0))), this.g("element", t, i), this.M()) } }, source: { get: function () { return this.Kp }, set: function (t) { var i, e, n, o, r, s = this.Kp; s !== t && (this.Kp = t, i = Fl, e = this.diagram, n = null, void 0 !== i[t] ? n = i[t] : (30 < Ol && (Al(), i = Fl), n = p("img"), o = this, n.addEventListener("load", function (t) { jl(n, t), o.desiredSize.v() || (oa(o, !1), o.o()) }), n.addEventListener("error", function (t) { Dl(n, t) }), n.Xw = !0, null !== (r = this.Ml) && (n.crossOrigin = r(this)), i[n.src = t] = n, Ol++), null !== e && Pr(e, this), this.element = n, null !== e && Sr(e, this), void 0 === n.__goCache && (n.__goCache = new Il), this.o(), this.M(), this.g("source", s, t)) } }, sourceCrossOrigin: { get: function () { return this.Ml }, set: function (t) { var i; this.Ml !== t && (this.Ml = t, null !== this.element) && (i = this.element.getAttribute("src"), null === t && "string" == typeof i ? this.element.crossOrigin = null : null !== t && (this.element.crossOrigin = t(this)), this.element.src = i) } }, sourceRect: { get: function () { return this.nh }, set: function (t) { var i = this.nh; i.w(t) || (this.nh = t = t.G(), this.M(), this.g("sourceRect", i, t)) } }, imageStretch: { get: function () { return this.el }, set: function (t) { var i = this.el; i !== t && (this.el = t, this.M(), this.g("imageStretch", i, t)) } }, flip: { get: function () { return this.Ed }, set: function (t) { var i = this.Ed; i !== t && (this.Ed = t, this.M(), this.g("flip", i, t)) } }, imageAlignment: { get: function () { return this.dl }, set: function (t) { var i = this.dl; i.w(t) || (this.dl = t = t.G(), this.o(), this.g("imageAlignment", i, t)) } }, errorFunction: { get: function () { return this.zc }, set: function (t) { var i = this.zc; i !== t && (this.zc = t, this.g("errorFunction", i, t)) } }, successFunction: { get: function () { return this.kf }, set: function (t) { var i = this.kf; i !== t && (this.kf = t, this.g("successFunction", i, t)) } }, naturalBounds: { get: function () { return this.oc } } }), Ll.prototype.redraw = Ll.prototype.Zd, Ll.prototype.reloadSource = Ll.prototype.mA; var Fl = null, Ol = 0, Bl = 4; function Il() { this.Oi = null } function Rl(t, i, e, n, o) { null === t.Oi && (t.Oi = []); var r = new Pa(null), s = r.context, a = 1 / i; r.width = e / i, r.height = n / i, 0 !== r.width && 0 !== r.height && (i = new El(r.Ea, i), e = 1, 0 < t.Oi.length && (o = (e = t.Oi[t.Oi.length - 1]).source, e = e.ratio), s.setTransform(a * e, 0, 0, a * e, 0, 0), s.drawImage(o, 0, 0), t.Oi.push(i)) } function El(t, i) { this.source = t, this.ratio = i } function zl() { this.ot = new Ui, this.fc = null } function Vl(t, i, e, n, o) { t.fc = new se, t.fc.startX = i, t.fc.startY = e, t.fc.isFilled = n, t.ot.figures.add(t.fc), void 0 !== o && (t.fc.isShadowed = o) } function Yl(t, i, e, n, o, r, s) { var a; void 0 === a && (a = !1); var h = new ae(fe); h.point1X = i, h.point1Y = e, h.point2X = n, h.point2Y = o, h.endX = r, h.endY = s, a && h.close(), t.fc.segments.add(h) } function Gl(t, i, e, n, o) { var r; void 0 === r && (r = !1); var s = new ae(de); s.point1X = i, s.point1Y = e, s.endX = n, s.endY = o, r && s.close(), t.fc.segments.add(s) } function Xl(t, i, e, n, o, r, s, a) { var h; void 0 === h && (h = !1), i = new ae(ge, s, a, i, e, n, o, r), h && i.close(), t.fc.segments.add(i) } function ql(t) { var i = Ul; return null !== i ? (Ul = null, i.reset(t)) : (i = new zl).reset(t), i } Ll.className = "Picture", Fl = new X, Ll.clearCache = Al, Il.className = "PictureCacheArray", El.className = "PictureCacheInstance", (t = zl.prototype).reset = function (t) { null !== t ? (t.ea(), (this.ot = t).figures.clear()) : this.ot = new Ui, this.fc = null }, t.Mq = function (t) { this.fc.isShadowed = t }, t.moveTo = function (t, i, e) { void 0 === e && (e = !1); var n = new ae(ue); n.endX = t, n.endY = i, e && n.close(), this.fc.segments.add(n) }, t.lineTo = function (t, i, e) { void 0 === e && (e = !1); var n = new ae(ce); n.endX = t, n.endY = i, e && n.close(), this.fc.segments.add(n) }, t.arcTo = function (t, i, e, n, o, r, s) { void 0 === r && (r = 0), void 0 === s && (s = !1); var a = new ae(pe); a.startAngle = t, a.sweepAngle = i, a.centerX = e, a.centerY = n, a.radiusX = o, a.radiusY = 0 !== r ? r : o, s && a.close(), this.fc.segments.add(a) }; var Ul = null; function Kl(t, i) { var e = t.toLowerCase(), n = qi.Je; n[t] = i, n[e] = t } function Hl(t) { xh.call(this, t), this.D = 2408959, this.ah = this.If = "", this.np = this.jp = this.zp = this.no = null, this.Bp = "", this.Ef = this.Xn = this.Ap = this.mh = null, this.lp = "", this.kp = wt, this.Tb = this.op = "", this.ui = this.hn = this.di = null, this.$f = new gi(NaN, NaN).freeze(), this.uo = "", this.Xe = null, this.vo = Ht, this.pp = bi, this.Eo = Mt, this.wo = St, this.An = null, this.oo = 127, this.Fp = Pt, this.Ep = "gray", this.df = 4, this.Zw = -1, this.bq = NaN, this.Ay = new yi, this.Fj = null, this.dh = NaN } function Wl(t) { 0 != (16384 & t.D) != !1 && (t.updateAdornments(), ou(t, !1)) } function Jl(t) { var i; !1 === ru(t) && (su(t, !0), t.ll(), null !== (i = t.diagram) && (i.od.add(t), i.Pb())) } function Zl(t) { var i, e, n; t.D |= 2097152, !1 !== ru(t) && (i = t.position, (e = t.location).v() && i.v() || _l(t, i, e), e = t.vb, n = yi.alloc().assign(e), e.ea(), e.x = i.x, e.y = i.y, e.freeze(), t.Gt(n, e), yi.free(n), su(t, !1)) } function $l(t, i) { var e = t.Ay; isNaN(t.dh) && (t.dh = function t(i) { for (var e = (i = i.V.j).length, n = 0, o = 0; o < e; o++) { var r = i[o]; r instanceof xh ? n = Math.max(n, t(r)) : r instanceof Kh && (n = Math.max(n, r.qh / 2 * r.Oj * r.uf())) } return n }(t)); var n = t.dh, o = 2 * n; if (!t.isShadowed) return e.h(i.x - 1 - n, i.y - 1 - n, i.width + 2 + o, i.height + 2 + o), e; n = i.x, o = i.y; var r = i.width; i = i.height; var s = t.shadowBlur; return r += s, i += s, n -= s / 2, o -= s / 2, 0 < (t = t.shadowOffset).x ? r += t.x : (n += t.x, r -= t.x), 0 < t.y ? i += t.y : (o += t.y, i -= t.y), e.h(n - 1, o - 1, r + 2, i + 2), e } function Ql(t, i, e, n) { null === i || t instanceof du || (i = i.animationManager).Ze && io(i, t, n.copy(), e.copy()) } function _l(t, i, e) { var n = gi.alloc(), o = t.locationSpot, r = t.locationObject; o.jc() && B("determineOffset: Part's locationSpot must be real: " + o.toString()); var s = r.naturalBounds, a = r instanceof Kh ? r.strokeWidth : 0; if (n.xk(0, 0, s.width + a, s.height + a, o), r !== t) for (n.offset(-a / 2, -a / 2), r.transform.ra(n), o = r.panel; null !== o && o !== t;)o.transform.ra(n), o = o.panel; t.Zf.ra(n), n.offset(-t.nc.x, -t.nc.y), o = t.diagram, r = e.v(), s = i.v(), r && s ? (0 != (2097152 & t.D) ? tu : iu)(t, i, e, o, n) : r ? tu(t, i, e, o, n) : s && iu(t, i, e, o, n), t.D |= 2097152, gi.free(n), t.ll() } function tu(t, i, e, n, o) { var r = i.x, s = i.y; i.h(e.x - o.x, e.y - o.y), null !== n && ((o = (e = n.animationManager).isAnimating) || !e.Ze || t instanceof du || io(e, t, new gi(r, s), i), o || i.x === r && i.y === s || (e = n.skipsUndoManager, n.skipsUndoManager = !0, t.g("position", new gi(r, s), i), n.skipsUndoManager = e)) } function iu(t, i, e, n, o) { var r = e.copy(); e.h(i.x + o.x, i.y + o.y), e.w(r) || null === n || (i = n.skipsUndoManager, n.skipsUndoManager = !0, t.g("location", r, e.copy()), n.skipsUndoManager = i) } function eu(t, i, e) { au(t, !1), t instanceof pu && Er(e, t), t.layer.isTemporary || i || e.Na(), i = t.vb; var n = e.viewportBounds; n.v() ? hu(t) ? (Rt(i, n) || t.Ad(!1), t.updateAdornments()) : i.Gc(n) ? (t.Ad(!0), t.updateAdornments()) : t.Lb() : e.mi = !0 } function nu(t, i, e, n) { i.constructor === t.constructor || fu || (fu = !0, v('Should not change the class of the Part when changing category from "' + e + '" to "' + n + '"'), v("  Old class: " + P(t.constructor) + ", new class: " + P(i.constructor) + ", part: " + t.toString())), t.Yj(); var o = t.data; e = t.layerName; var r = t.isSelected, s = t.isHighlighted, a = !0, h = !0, l = !1; t instanceof pu && (a = t.isTreeLeaf, h = t.isTreeExpanded, l = t.wasTreeExpanded), i.sf(t), i.cloneProtected(t), t.If = n, t.o(), t.M(), n = !0, null !== (i = t.diagram) && (n = i.skipsUndoManager, i.skipsUndoManager = !0), t.jb = o, t.D = r ? 4096 | t.D : -4097 & t.D, t.D = s ? 524288 | t.D : -524289 & t.D, t instanceof pu && (t.P = a ? 4 | t.P : -5 & t.P, t.P = h ? 1 | t.P : -2 & t.P, t.P = l ? 2 | t.P : -3 & t.P), null !== o && t.Ba(), (o = t.layerName) !== e && (t.ah = e, t.layerName = o), null !== i && (i.skipsUndoManager = n), t.Wb() && t.C(64) } function ou(t, i) { t.D = i ? 16384 | t.D : -16385 & t.D } function ru(t) { return 0 != (32768 & t.D) } function su(t, i) { t.D = i ? 32768 | t.D : -32769 & t.D } function au(t, i) { t.D = i ? 65536 | t.D : -65537 & t.D } function hu(t) { return 0 != (131072 & t.D) } function lu(t, i) { t.D = i ? 1048576 | t.D : -1048577 & t.D } function uu(t) { return t.isVisible() && (null === (t = t.layer) || !t.isTemporary) } function cu(t, i, e, n, o, r) { if (void 0 === r && (r = null), !(t.contains(i) || null !== r && !r(i) || i instanceof du)) if (t.add(i), i instanceof pu) { if (e && i instanceof Lu) for (var s = i.memberParts; s.next();)cu(t, s.value, e, n, o, r); if (!1 !== o) for (s = i.linksConnected; s.next();) { var a, h, l = s.value; t.contains(l) || (a = l.fromNode, h = l.toNode, a = null === a || t.contains(a), h = null === h || t.contains(h), (o ? a && h : a || h) && cu(t, l, e, n, o, r)) } if (1 < n) for (i = i.zv(); i.next();)cu(t, i.value, e, n - 1, o, r) } else if (i instanceof Fu) for (i = i.labelNodes; i.next();)cu(t, i.value, e, n, o, r) } zl.className = "StreamGeometryContext", Kl("Rectangle", function (t, i, e) { t = "r" + i + "," + e; var n = qi.Mh[t]; return void 0 !== n || ((n = new Ui(ne)).endX = i, n.endY = e, qi.Nh < 50 && (qi.Mh[t] = n, qi.Nh++)), n }), Kl("Square", function (t, i, e) { t = "s" + i + "," + e; var n = qi.Mh[t]; return void 0 !== n || ((n = new Ui(ne)).endX = i, n.endY = e, n.defaultStretch = qr, qi.Nh < 50 && (qi.Mh[t] = n, qi.Nh++)), n }), Kl("RoundedRectangle", function (t, i, e) { var n = t ? t.parameter1 : NaN; return (isNaN(n) || n < 0) && (n = 5), n = Math.min(n, i / 3), t = (n = Math.min(n, e / 3)) * qi.Fg, i = (new Ui).add(new se(n, 0, !0).add(new ae(ce, i - n, 0)).add(new ae(fe, i, n, i - t, 0, i, t)).add(new ae(ce, i, e - n)).add(new ae(fe, i - n, e, i, e - t, i - t, e)).add(new ae(ce, n, e)).add(new ae(fe, 0, e - n, t, e, 0, e - t)).add(new ae(ce, 0, n)).add(new ae(fe, n, 0, 0, t, t, 0).close())), 1 < t && (i.spot1 = new Oi(0, 0, t, t), i.spot2 = new Oi(1, 1, -t, -t)), i }), Kl("Border", "RoundedRectangle"), Kl("Ellipse", function (t, i, e) { t = "e" + i + "," + e; var n = qi.Mh[t]; return void 0 !== n || ((n = new Ui(oe)).endX = i, n.endY = e, n.spot1 = Li, n.spot2 = Ai, qi.Nh < 50 && (qi.Mh[t] = n, qi.Nh++)), n }), Kl("Circle", function (t, i, e) { t = "c" + i + "," + e; var n = qi.Mh[t]; return void 0 !== n || ((n = new Ui(oe)).endX = i, n.endY = e, n.spot1 = Li, n.spot2 = Ai, n.defaultStretch = qr, qi.Nh < 50 && (qi.Mh[t] = n, qi.Nh++)), n }), Kl("TriangleRight", function (t, i, e) { return (new Ui).add(new se(0, 0).add(new ae(ce, i, .5 * e)).add(new ae(ce, 0, e).close())).Im(0, .25, .5, .75) }), Kl("TriangleDown", function (t, i, e) { return (new Ui).add(new se(0, 0).add(new ae(ce, i, 0)).add(new ae(ce, .5 * i, e).close())).Im(.25, 0, .75, .5) }), Kl("TriangleLeft", function (t, i, e) { return (new Ui).add(new se(i, e).add(new ae(ce, 0, .5 * e)).add(new ae(ce, i, 0).close())).Im(.5, .25, 1, .75) }), Kl("TriangleUp", function (t, i, e) { return (new Ui).add(new se(i, e).add(new ae(ce, 0, e)).add(new ae(ce, .5 * i, 0).close())).Im(.25, .5, .75, 1) }), Kl("Triangle", "TriangleUp"), Kl("Diamond", function (t, i, e) { return (new Ui).add(new se(.5 * i, 0).add(new ae(ce, 0, .5 * e)).add(new ae(ce, .5 * i, e)).add(new ae(ce, i, .5 * e).close())).Im(.25, .25, .75, .75) }), Kl("LineH", function (t, i, e) { return (t = new Ui(ee)).startX = 0, t.startY = e / 2, t.endX = i, t.endY = e / 2, t }), Kl("LineV", function (t, i, e) { return (t = new Ui(ee)).startX = i / 2, t.startY = 0, t.endX = i / 2, t.endY = e, t }), Kl("None", "Rectangle"), Kl("BarH", "Rectangle"), Kl("BarV", "Rectangle"), Kl("MinusLine", "LineH"), Kl("PlusLine", function (t, i, e) { return (new Ui).add(new se(0, e / 2, !1).add(new ae(ce, i, e / 2)).add(new ae(ue, i / 2, 0)).add(new ae(ce, i / 2, e))) }), Kl("XLine", function (t, i, e) { return (new Ui).add(new se(0, e, !1).add(new ae(ce, i, 0)).add(new ae(ue, 0, 0)).add(new ae(ce, i, e))) }), qi.Mm = { "": "", Standard: "F1 m 0,0 l 8,4 -8,4 2,-4 z", Backward: "F1 m 8,0 l -2,4 2,4 -8,-4 z", Triangle: "F1 m 0,0 l 8,4.62 -8,4.62 z", BackwardTriangle: "F1 m 8,4 l 0,4 -8,-4 8,-4 0,4 z", Boomerang: "F1 m 0,0 l 8,4 -8,4 4,-4 -4,-4 z", BackwardBoomerang: "F1 m 8,0 l -8,4 8,4 -4,-4 4,-4 z", SidewaysV: "m 0,0 l 8,4 -8,4 0,-1 6,-3 -6,-3 0,-1 z", BackwardV: "m 8,0 l -8,4 8,4 0,-1 -6,-3 6,-3 0,-1 z", OpenTriangle: "m 0,0 l 8,4 -8,4", BackwardOpenTriangle: "m 8,0 l -8,4 8,4", OpenTriangleLine: "m 0,0 l 8,4 -8,4 m 8.5,0 l 0,-8", BackwardOpenTriangleLine: "m 8,0 l  -8,4 8,4 m -8.5,0 l 0,-8", OpenTriangleTop: "m 0,0 l 8,4 m 0,4", BackwardOpenTriangleTop: "m 8,0 l -8,4 m 0,4", OpenTriangleBottom: "m 0,8 l 8,-4", BackwardOpenTriangleBottom: "m 0,4 l 8,4", HalfTriangleTop: "F1 m 0,0 l 0,4 8,0 z m 0,8", BackwardHalfTriangleTop: "F1 m 8,0 l 0,4 -8,0 z m 0,8", HalfTriangleBottom: "F1 m 0,4 l 0,4 8,-4 z", BackwardHalfTriangleBottom: "F1 m 8,4 l 0,4 -8,-4 z", ForwardSemiCircle: "m 4,0 b 270 180 0 4 4", BackwardSemiCircle: "m 4,8 b 90 180 0 -4 4", Feather: "m 0,0 l 3,4 -3,4", BackwardFeather: "m 3,0 l -3,4 3,4", DoubleFeathers: "m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4", BackwardDoubleFeathers: "m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4", TripleFeathers: "m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4 m 3,-8 l 3,4 -3,4", BackwardTripleFeathers: "m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4 m 3,-8 l -3,4 3,4", ForwardSlash: "m 0,8 l 5,-8", BackSlash: "m 0,0 l 5,8", DoubleForwardSlash: "m 0,8 l 4,-8 m -2,8 l 4,-8", DoubleBackSlash: "m 0,0 l 4,8 m -2,-8 l 4,8", TripleForwardSlash: "m 0,8 l 4,-8 m -2,8 l 4,-8 m -2,8 l 4,-8", TripleBackSlash: "m 0,0 l 4,8 m -2,-8 l 4,8 m -2,-8 l 4,8", Fork: "m 0,4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4", BackwardFork: "m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4", LineFork: "m 0,0 l 0,8 m 0,-4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4", BackwardLineFork: "m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4 m 8,-8 l 0,8", CircleFork: "F1 m 6,4 b 0 360 -3 0 3 z m 0,0 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4", BackwardCircleFork: "F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 6,0 b 0 360 -3 0 3", CircleLineFork: "F1 m 6,4 b 0 360 -3 0 3 z m 1,-4 l 0,8 m 0,-4 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4", BackwardCircleLineFork: "F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 0,-4 l 0,8 m 7,-4 b 0 360 -3 0 3", Circle: "F1 m 8,4 b 0 360 -4 0 4 z", Block: "F1 m 0,0 l 0,8 8,0 0,-8 z", StretchedDiamond: "F1 m 0,3 l 5,-3 5,3 -5,3 -5,-3 z", Diamond: "F1 m 0,4 l 4,-4 4,4 -4,4 -4,-4 z", Chevron: "F1 m 0,0 l 5,0 3,4 -3,4 -5,0 3,-4 -3,-4 z", StretchedChevron: "F1 m 0,0 l 8,0 3,4 -3,4 -8,0 3,-4 -3,-4 z", NormalArrow: "F1 m 0,2 l 4,0 0,-2 4,4 -4,4 0,-2 -4,0 z", X: "m 0,0 l 8,8 m 0,-8 l -8,8", TailedNormalArrow: "F1 m 0,0 l 2,0 1,2 3,0 0,-2 2,4 -2,4 0,-2 -3,0 -1,2 -2,0 1,-4 -1,-4 z", DoubleTriangle: "F1 m 0,0 l 4,4 -4,4 0,-8 z  m 4,0 l 4,4 -4,4 0,-8 z", BigEndArrow: "F1 m 0,0 l 5,2 0,-2 3,4 -3,4 0,-2 -5,2 0,-8 z", ConcaveTailArrow: "F1 m 0,2 h 4 v -2 l 4,4 -4,4 v -2 h -4 l 2,-2 -2,-2 z", RoundedTriangle: "F1 m 0,1 a 1,1 0 0 1 1,-1 l 7,3 a 0.5,1 0 0 1 0,2 l -7,3 a 1,1 0 0 1 -1,-1 l 0,-6 z", SimpleArrow: "F1 m 1,2 l -1,-2 2,0 1,2 -1,2 -2,0 1,-2 5,0 0,-2 2,2 -2,2 0,-2 z", AccelerationArrow: "F1 m 0,0 l 0,8 0.2,0 0,-8 -0.2,0 z m 2,0 l 0,8 1,0 0,-8 -1,0 z m 3,0 l 2,0 2,4 -2,4 -2,0 0,-8 z", BoxArrow: "F1 m 0,0 l 4,0 0,2 2,0 0,-2 2,4 -2,4 0,-2 -2,0 0,2 -4,0 0,-8 z", TriangleLine: "F1 m 8,4 l -8,-4 0,8 8,-4 z m 0.5,4 l 0,-8", CircleEndedArrow: "F1 m 10,4 l -2,-3 0,2 -2,0 0,2 2,0 0,2 2,-3 z m -4,0 b 0 360 -3 0 3 z", DynamicWidthArrow: "F1 m 0,3 l 2,0 2,-1 2,-2 2,4 -2,4 -2,-2 -2,-1 -2,0 0,-2 z", EquilibriumArrow: "m 0,3 l 8,0 -3,-3 m 3,5 l -8,0 3,3", FastForward: "F1 m 0,0 l 3.5,4 0,-4 3.5,4 0,-4 1,0 0,8 -1,0 0,-4 -3.5,4 0,-4 -3.5,4 0,-8 z", Kite: "F1 m 0,4 l 2,-4 6,4 -6,4 -2,-4 z", HalfArrowTop: "F1 m 0,0 l 4,4 4,0 -8,-4 z m 0,8", HalfArrowBottom: "F1 m 0,8 l 4,-4 4,0 -8,4 z", OpposingDirectionDoubleArrow: "F1 m 0,4 l 2,-4 0,2 4,0 0,-2 2,4 -2,4 0,-2 -4,0 0,2 -2,-4 z", PartialDoubleTriangle: "F1 m 0,0 4,3 0,-3 4,4 -4,4 0,-3 -4,3 0,-8 z", LineCircle: "F1 m 0,0 l 0,8 m 7 -4 b 0 360 -3 0 3 z", DoubleLineCircle: "F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z", TripleLineCircle: "F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z", CircleLine: "F1 m 6 4 b 0 360 -3 0 3 z m 1,-4 l 0,8", DiamondCircle: "F1 m 8,4 l -4,4 -4,-4 4,-4 4,4 m 8,0 b 0 360 -4 0 4 z", PlusCircle: "F1 m 8,4 b 0 360 -4 0 4 l -8 0 z m -4 -4 l 0 8", OpenRightTriangleTop: "m 8,0 l 0,4 -8,0 m 0,4", OpenRightTriangleBottom: "m 8,8 l 0,-4 -8,0", Line: "m 0,0 l 0,8", DoubleLine: "m 0,0 l 0,8 m 2,0 l 0,-8", TripleLine: "m 0,0 l 0,8 m 2,0 l 0,-8 m 2,0 l 0,8", PentagonArrow: "F1 m 8,4 l -4,-4 -4,0 0,8 4,0 4,-4 z" }, h(Hl, xh), Hl.prototype.cloneProtected = function (t) { xh.prototype.cloneProtected.call(this, t), t.D = -4097 & this.D | 49152, t.If = this.If, t.ah = this.ah, t.no = this.no, t.zp = this.zp, t.jp = this.jp, t.np = this.np, t.Bp = this.Bp, t.Ap = this.Ap, t.Xn = this.Xn, t.Ef = null, t.lp = this.lp, t.kp = this.kp.G(), t.op = this.op, t.pp = this.pp.G(), t.Tb = this.Tb, t.hn = this.hn, t.$f.assign(this.$f), t.uo = this.uo, t.vo = this.vo.G(), t.Eo = this.Eo.G(), t.wo = this.wo.G(), t.An = this.An, t.oo = this.oo, t.Fp = this.Fp.G(), t.Ep = this.Ep, t.df = this.df, t.bq = this.bq }, Hl.prototype.sf = function (t) { xh.prototype.sf.call(this, t), t.Gh(), t.mh = null, t.Xe = null, t.Fj = null }, Hl.prototype.toString = function () { var t = P(this.constructor) + "#" + tt(this); return null !== this.data && (t += "(" + N(this.data) + ")"), t }, Hl.prototype.vk = function (t, i, e, n, o, r, s) { var a = this.diagram; null !== a && (t === we && "elements" === i ? o instanceof xh ? Ph(o, function (t) { lf(a.partManager, t), Mr(a, t) }) : Sr(a, o) : t === ke && "elements" === i && (o instanceof xh ? Ph(o, function (t) { uf(a.partManager, t, a) }) : Pr(a, o)), a.Za(t, i, e, n, o, r, s)) }, Hl.prototype.Ba = function (t) { if (xh.prototype.Ba.call(this, t), null !== this.data) { for (var i = this.V.j, e = i.length, n = 0; n < e; n++) { var o = i[n]; o instanceof xh && Ph(o, function (t) { null !== t.data && t.Ba() }) } for (i = this.adornments; i.next();)i.value.Ba(t) } }, Hl.prototype.updateRelationshipsFromData = function () { null !== this.data && this.diagram.partManager.updateRelationshipsFromData(this) }, Hl.prototype.fk = function (t) { var i = this.Ef; return null === i ? null : i.H(t) }, Hl.prototype.zh = function (t, i) { var e, n, o; null !== i && ((e = null) !== (n = this.Ef) && (e = n.H(t)), e !== i && (null === e || null !== (o = e.diagram) && o.remove(e), null === n && (this.Ef = n = new at), i.If !== t && (i.category = t), n.add(t, i), null !== (t = this.diagram) && (t.add(i), null === (t = i.adornedObject) || null !== (t = t.Ui()) && (i.data = t.data)))) }, Hl.prototype.zf = function (t) { var i, e, n = this.Ef; null !== n && (null === (i = n.H(t)) || null !== (e = i.diagram) && e.remove(i), n.remove(t), 0 === n.count && (this.Ef = null)) }, Hl.prototype.Yj = function () { if (null !== (i = this.Ef)) { for (var t = zi(), i = i.iterator; i.next();)t.push(i.key); i = t.length; for (var e = 0; e < i; e++)this.zf(t[e]); Vi(t) } }, Hl.prototype.updateAdornments = function () { var i, t, e = this.diagram; if (null !== e) { for (var n = this.adornments; n.next();) { var o = n.value; o.o(), o.placeholder && o.placeholder.o() } t: { if (this.isSelected && this.selectionAdorned && (null !== (n = this.selectionObject) && this.actualBounds.v() && this.isVisible() && n.yf() && n.actualBounds.v())) { if (null === (o = this.fk("Selection"))) { if (null === (o = this.selectionAdornmentTemplate) && (o = this.Hh() ? e.linkSelectionAdornmentTemplate : this instanceof Lu ? e.groupSelectionAdornmentTemplate : e.nodeSelectionAdornmentTemplate), !(o instanceof du)) break t; Dh(o), null !== (o = o.copy()) && (this.Hh() && this.selectionObject === this.path && (o.type = xh.Link), o.adornedObject = n) } if (null !== o) { o.type === xh.Link && o.o(), this.zh("Selection", o); break t } } this.zf("Selection") } for (i = this, (t = e).toolManager.mouseDownTools.each(function (t) { t.isEnabled && t.updateAdornments(i) }), t.toolManager.updateAdornments(i), n = this.adornments; n.next();)n.value.Ba() } }, Hl.prototype.Lb = function () { var t = this.diagram; null !== t && (ar(t), 0 != (16384 & this.D) != !0 && (ou(this, !0), t.Pb())) }, Hl.prototype.move = function (t, i) { !0 === i ? this.location = t : this.position = t }, Hl.prototype.moveTo = function (t, i, e) { t = gi.allocAt(t, i), this.move(t, e), gi.free(t) }, Hl.prototype.isVisible = function () { if (!this.visible) return !1; var t = this.layer; if (null !== t) { if (!t.visible) return !1; if (null !== (t = t.diagram) && t.animationManager.Ft(this)) return !0 } return !!(null === (t = this.containingGroup) || t.isSubGraphExpanded && t.isVisible()) }, (t = Hl.prototype).Ob = function (t) { var i = this.diagram; t ? (this.C(4), this.Lb(), null !== i && i.od.add(this)) : (this.C(8), this.Yj()), this.Gh(), null !== i && (i.Na(), i.M()) }, t.Ya = function (t) { if (this.name === t) return this; var i = this.Fj; if (null === i && (this.Fj = i = new at), null !== i.H(t)) return i.H(t); var e = xh.prototype.Ya.call(this, t); return null !== e ? (i.set(t, e), e) : (i.set(t, null), null) }, t.vf = function (t, i, e) { void 0 === e && (e = new gi), i = i.jc() ? Zt : i; var n = t.naturalBounds; if (e.h(n.width * i.x + i.offsetX, n.height * i.y + i.offsetY), null === t || t === this) return e; for (t.transform.ra(e), t = t.panel; null !== t && t !== this;)t.transform.ra(e), t = t.panel; return this.Zf.ra(e), e.offset(-this.nc.x, -this.nc.y), e }, t.km = function (t) { return void 0 === t && (t = new yi), t.assign(this.actualBounds) }, t.zb = function () { !0 === na(this) && this.measure(1 / 0, 1 / 0), this.arrange() }, Hl.prototype.arrange = function () { var t, i, e, n; !1 === ra(this) ? Zl(this) : (t = this.vb, (i = yi.alloc()).assign(t), t.ea(), e = hu(this), this.Ch(0, 0, this.nc.width, this.nc.height), _l(this, n = this.position, this.location), t.x = n.x, t.y = n.y, t.freeze(), this.Gt(i, t), sa(this, !1), i.w(t) ? this.Ad(e) : !this.Wb() || qi.A(i.width, t.width) && qi.A(i.height, t.height) || 0 <= this.Zw && this.C(16), yi.free(i), su(this, !1)) }, (t = Hl.prototype).Gt = function (t, i) { var e, n, o = this.diagram; null !== o && ((e = !1) === o.ki && t.v() && ((n = yi.alloc()).assign(o.documentBounds), n.nw(o.padding), t.x > n.x && t.y > n.y && t.right < n.right && t.bottom < n.bottom && i.x > n.x && i.y > n.y && i.right < n.right && i.bottom < n.bottom && (e = !0), yi.free(n)), 0 != (65536 & this.D) != !0 && t.w(i) || eu(this, e, o), o.M(), Ot(t, i) || (this instanceof pu && !o.undoManager.isUndoingRedoing && this.fd(), this.Gh())) }, t.kw = function (t, i) { if (this.Hh() || !t.v()) return !1; var e, n = this.diagram; return null !== n && (Ql(this, n, t, i), !0 === n.undoManager.isUndoingRedoing) || (this.ma = t, this.D &= -2097153, (n = this.$f).v() && (e = n.copy(), n.h(n.x + (t.x - i.x), n.y + (t.y - i.y)), this.g("location", e, n.copy())), !1 === ru(this) && !1 === ra(this) && (Jl(this), Zl(this))), !0 }, t.Lq = function (t, i, e) { var n = this.$f, o = this.ma; if (e) { if (n.x === t && n.y === i) return; ru(this) || ra(this) ? o.h(NaN, NaN) : o.h(o.x + t - n.x, o.y + i - n.y), n.h(t, i) } else { if (o.x === t && o.y === i) return; ru(this) || ra(this) ? this.Qt() : n.h(n.x + t - o.x, n.y + i - o.y), o.h(t, i) } Jl(this) }, t.Qt = function () { this.D &= -2097153, Jl(this) }, t.bj = function () { return !0 }, t.Wb = function () { return !0 }, t.Hh = function () { return !1 }, t.xf = function () { return !0 }, Hl.prototype.canCopy = function () { if (!this.copyable) return !1; var t = this.layer; return null === t || !!t.allowCopy && (null === (t = t.diagram) || !!t.allowCopy) }, Hl.prototype.canDelete = function () { if (!this.deletable) return !1; var t = this.layer; return null === t || !!t.allowDelete && (null === (t = t.diagram) || !!t.allowDelete) }, Hl.prototype.canEdit = function () { if (!this.textEditable) return !1; var t = this.layer; return null === t || !!t.allowTextEdit && (null === (t = t.diagram) || !!t.allowTextEdit) }, Hl.prototype.canGroup = function () { if (!this.groupable) return !1; var t = this.layer; return null === t || !!t.allowGroup && (null === (t = t.diagram) || !!t.allowGroup) }, Hl.prototype.canMove = function () { if (!this.movable) return !1; var t = this.layer; return null === t || !!t.allowMove && (null === (t = t.diagram) || !!t.allowMove) }, Hl.prototype.canReshape = function () { if (!this.reshapable) return !1; var t = this.layer; return null === t || !!t.allowReshape && (null === (t = t.diagram) || !!t.allowReshape) }, Hl.prototype.canResize = function () { if (!this.resizable) return !1; var t = this.layer; return null === t || !!t.allowResize && (null === (t = t.diagram) || !!t.allowResize) }, Hl.prototype.canRotate = function () { if (!this.rotatable) return !1; var t = this.layer; return null === t || !!t.allowRotate && (null === (t = t.diagram) || !!t.allowRotate) }, Hl.prototype.canSelect = function () { if (!this.selectable) return !1; var t = this.layer; return null === t || !!t.allowSelect && (null === (t = t.diagram) || !!t.allowSelect) }, (t = Hl.prototype).Ad = function (t) { this.D = t ? 131072 | this.D : -131073 & this.D }, t.Gh = function () { var t = this.containingGroup; null !== t && (t.o(), null !== t.placeholder && t.placeholder.o(), t.fd()) }, t.M = function () { var t = this.diagram; null !== t && !ra(this) && !ru(this) && this.isVisible() && this.vb.v() && t.M($l(this, this.vb)) }, t.o = function () { xh.prototype.o.call(this); var t = this.diagram; null !== t && (t.od.add(this), this instanceof pu && null !== this.labeledLink && Ws(this.labeledLink), t.Pb(!0)) }, t.rq = function (t) { t || null !== (t = this.di) && Au(t, this) }, t.sq = function (t) { t || null !== (t = this.di) && ju(t, this) }, t.dk = function () { var t, i = this.data; null !== i && (null === (t = this.diagram) || null !== (t = t.model) && t.zm(i)) }, t.sz = function () { return function t(i, e) { var n = e.containingGroup; return null !== n ? 1 + t(i, n) : e instanceof pu && (e = e.labeledLink, null !== e) ? t(i, e) : 0 }(this, this) }, t.wz = function () { return function t(i, e) { var n = e.containingGroup; return null !== n || e instanceof pu && (n = e.labeledLink, null !== n) ? t(i, n) : e }(this, this) }, t.Xd = function (t) { return t instanceof Lu && function t(i, e, n) { if (e === n || null === n) return !1; var o = e.containingGroup; return !(null === o || o !== n && !t(i, o, n)) || e instanceof pu && (e = e.labeledLink, null !== e) && t(i, e, n) }(this, this, t) }, t.Kx = function (t) { if (null === t) return null; if (this === t) return this.containingGroup; for (var i, e = this; null !== e;) { e instanceof Lu && lu(e, !0), e instanceof pu && (null !== (i = e.labeledLink) && (e = i)), e = e.containingGroup } for (i = null, e = t; null !== e;) { if (0 != (1048576 & e.D)) { i = e; break } e instanceof pu && (null !== (t = e.labeledLink) && (e = t)), e = e.containingGroup } for (e = this; null !== e;)e instanceof Lu && lu(e, !1), e instanceof pu && (null !== (t = e.labeledLink) && (e = t)), e = e.containingGroup; return i }, Hl.prototype.canLayout = function () { if (!this.isLayoutPositioned || !this.isVisible()) return !1; var t = this.layer; return !(null !== t && t.isTemporary || this instanceof pu && this.isLinkLabel) }, Hl.prototype.C = function (t) { var i, e; void 0 === t && (t = 16777215), (i = !(!this.isLayoutPositioned || 0 == (t & this.layoutConditions)) && (!(null !== (i = this.layer) && i.isTemporary || this instanceof pu && this.isLinkLabel) && (null === (i = this.diagram) || !i.undoManager.isUndoingRedoing))) && (null !== (i = this.di) ? null !== (e = i.layout) ? e.C() : i.C(t) : null === (t = this.diagram) || null !== (t = t.layout) && t.C()) }, l.Object.defineProperties(Hl.prototype, { key: { get: function () { var t = this.diagram; if (null !== t) return t.model.ja(this.data) } }, adornments: { get: function () { return null === this.Ef ? U : this.Ef.iteratorValues } }, layer: { get: function () { return this.ui } }, diagram: { get: function () { var t = this.ui; return null !== t ? t.diagram : null } }, layerName: { get: function () { return this.ah }, set: function (t) { var i, e, n, o = this.ah; o !== t && (null !== (i = this.diagram) && (null === i.hm(t) || i.partManager.addsToTemporaryLayer) || (this.ah = t, null !== i && i.Na(), this.g("layerName", o, t), null !== (o = this.layer) && o.name !== t && (null !== (i = o.diagram) && (null !== (t = i.hm(t)) && t !== o)) && (0 <= (e = o.Fc(-1, this, !0)) && i.Za(ke, "parts", o, this, null, e, !0), e = t.aj(99999999, this, !0), o.visible !== t.visible && this.Ob(t.visible), 0 <= e && i.Za(we, "parts", t, null, this, !0, e), null !== (e = this.layerChanged) && (n = i.Z, i.Z = !0, e(this, o, t), i.Z = n)))) } }, layerChanged: { get: function () { return this.no }, set: function (t) { var i = this.no; i !== t && (this.no = t, this.g("layerChanged", i, t)) } }, zOrder: { get: function () { return this.bq }, set: function (t) { var i, e = this.bq; e !== t && (this.bq = t, null !== (i = this.layer) && To(i, -1, this), this.g("zOrder", e, t), null !== (t = this.diagram) && t.M()) } }, locationObject: { get: function () { var t; return null === this.Xe && ("" !== (t = this.locationObjectName) ? (t = this.Ya(t), this.Xe = null !== t ? t : this) : this instanceof du && this.type !== xh.Link && null !== this.placeholder ? this.Xe = this.placeholder : this.Xe = this), this.Xe.visible ? this.Xe : this } }, minLocation: { get: function () { return this.Eo }, set: function (t) { var i = this.Eo; i.w(t) || (this.Eo = t = t.G(), this.g("minLocation", i, t)) } }, maxLocation: { get: function () { return this.wo }, set: function (t) { var i = this.wo; i.w(t) || (this.wo = t = t.G(), this.g("maxLocation", i, t)) } }, locationObjectName: { get: function () { return this.uo }, set: function (t) { var i = this.uo; i !== t && (this.uo = t, this.Xe = null, this.o(), this.g("locationObjectName", i, t)) } }, locationSpot: { get: function () { return this.vo }, set: function (t) { var i = this.vo; i.w(t) || (this.vo = t = t.G(), this.o(), this.g("locationSpot", i, t)) } }, location: { get: function () { return this.$f }, set: function (t) { var i = t.x, e = t.y, n = this.$f, o = n.x, r = n.y; (o === i || isNaN(o) && isNaN(i)) && (r === e || isNaN(r) && isNaN(e)) || (o = t = t.copy(), (i = !this.Hh() && (this.$f = o, this.D |= 2097152, !1 === ra(this) && (Jl(this), (i = this.ma).v() && (e = i.copy(), i.h(i.x + (o.x - n.x), i.y + (o.y - n.y)), Ql(this, this.diagram, i, e), null !== (o = this.diagram) ? (r = o.skipsUndoManager, o.skipsUndoManager = !0, this.g("position", e, i), o.skipsUndoManager = r) : this.g("position", e, i))), !0)) && this.g("location", n.copy(), t.copy())) } }, category: { get: function () { return this.If }, set: function (t) { var i, e, n, o, r = this.If; r !== t && (i = this.diagram, e = this.data, (n = null) === i || null === e || this instanceof du || (o = i.model.undoManager).isEnabled && !o.isUndoingRedoing && (n = this.clone()).V.addAll(this.V), this.If = t, this.g("category", r, t), null === i || null === e || this instanceof du ? this instanceof du && (null !== (n = this.adornedPart) && (null !== (t = n.Ef) && t.remove(r), n.zh(this.category, this))) : (o = i.model).undoManager.isUndoingRedoing || (this.Hh() ? (i.partManager.setLinkCategoryForData(e, t), null !== (i = i.partManager.findLinkTemplateForCategory(t)) && (Dh(i), null !== (i = i.copy()) && nu(this, i, r, t))) : (null !== o && o.Kq(e, t), null !== (i = sf(i.partManager, e, t)) && (Dh(i), null === (i = i.copy()) || i instanceof Fu || (e = this.location.copy(), nu(this, i, r, t), this.location.v() || (this.location = e)))), null !== n && ((r = this.clone()).V.addAll(this.V), this.g("self", n, r)))) } }, self: { get: function () { return this }, set: function (t) { nu(this, t, this.category, t.category) } }, copyable: { get: function () { return 0 != (1 & this.D) }, set: function (t) { var i = 0 != (1 & this.D); i !== t && (this.D ^= 1, this.g("copyable", i, t)) } }, deletable: { get: function () { return 0 != (2 & this.D) }, set: function (t) { var i = 0 != (2 & this.D); i !== t && (this.D ^= 2, this.g("deletable", i, t)) } }, textEditable: { get: function () { return 0 != (4 & this.D) }, set: function (t) { var i = 0 != (4 & this.D); i !== t && (this.D ^= 4, this.g("textEditable", i, t), this.Lb()) } }, groupable: { get: function () { return 0 != (8 & this.D) }, set: function (t) { var i = 0 != (8 & this.D); i !== t && (this.D ^= 8, this.g("groupable", i, t)) } }, movable: { get: function () { return 0 != (16 & this.D) }, set: function (t) { var i = 0 != (16 & this.D); i !== t && (this.D ^= 16, this.g("movable", i, t)) } }, selectionAdorned: { get: function () { return 0 != (32 & this.D) }, set: function (t) { var i = 0 != (32 & this.D); i !== t && (this.D ^= 32, this.g("selectionAdorned", i, t), this.Lb()) } }, isInDocumentBounds: { get: function () { return 0 != (64 & this.D) }, set: function (t) { var i, e = 0 != (64 & this.D); e !== t && (this.D ^= 64, null !== (i = this.diagram) && i.Na(), this.g("isInDocumentBounds", e, t)) } }, isLayoutPositioned: { get: function () { return 0 != (128 & this.D) }, set: function (t) { var i = 0 != (128 & this.D); i !== t && (this.D ^= 128, this.g("isLayoutPositioned", i, t), this.C(t ? 4 : 8)) } }, selectable: { get: function () { return 0 != (256 & this.D) }, set: function (t) { var i = 0 != (256 & this.D); i !== t && (this.D ^= 256, this.g("selectable", i, t), this.Lb()) } }, reshapable: { get: function () { return 0 != (512 & this.D) }, set: function (t) { var i = 0 != (512 & this.D); i !== t && (this.D ^= 512, this.g("reshapable", i, t), this.Lb()) } }, resizable: { get: function () { return 0 != (1024 & this.D) }, set: function (t) { var i = 0 != (1024 & this.D); i !== t && (this.D ^= 1024, this.g("resizable", i, t), this.Lb()) } }, rotatable: { get: function () { return 0 != (2048 & this.D) }, set: function (t) { var i = 0 != (2048 & this.D); i !== t && (this.D ^= 2048, this.g("rotatable", i, t), this.Lb()) } }, isSelected: { get: function () { return 0 != (4096 & this.D) }, set: function (t) { var i, e, n, o = 0 != (4096 & this.D); o !== t && (i = this.diagram, t && (!this.canSelect() || null !== i && i.selection.count >= i.maxSelectionCount) || (this.D ^= 4096, e = !1, null !== i && (e = i.skipsUndoManager, i.skipsUndoManager = !0, (n = i.selection).ea(), t ? n.add(this) : n.remove(this), n.freeze()), this.g("isSelected", o, t), this.Lb(), null !== (t = this.selectionChanged) && t(this), null !== i && (i.Pb(), i.skipsUndoManager = e))) } }, isHighlighted: { get: function () { return 0 != (524288 & this.D) }, set: function (t) { var i, e = 0 != (524288 & this.D); e !== t && (this.D ^= 524288, null !== (i = this.diagram) && ((i = i.highlighteds).ea(), t ? i.add(this) : i.remove(this), i.freeze()), this.g("isHighlighted", e, t), this.M(), null !== (t = this.highlightedChanged) && t(this)) } }, isShadowed: { get: function () { return 0 != (8192 & this.D) }, set: function (t) { var i = 0 != (8192 & this.D); i !== t && (this.D ^= 8192, this.g("isShadowed", i, t), this.M()) } }, isAnimated: { get: function () { return 0 != (262144 & this.D) }, set: function (t) { var i = 0 != (262144 & this.D); i !== t && (this.D ^= 262144, this.g("isAnimated", i, t)) } }, highlightedChanged: { get: function () { return this.Xn }, set: function (t) { var i = this.Xn; i !== t && (this.Xn = t, this.g("highlightedChanged", i, t)) } }, selectionObjectName: { get: function () { return this.Bp }, set: function (t) { var i = this.Bp; i !== t && (this.Bp = t, this.mh = null, this.g("selectionObjectName", i, t)) } }, selectionAdornmentTemplate: { get: function () { return this.zp }, set: function (t) { var i = this.zp; i !== t && (this.zp = t, this.g("selectionAdornmentTemplate", i, t)) } }, selectionObject: { get: function () { var t; return null === this.mh && (null !== (t = this.selectionObjectName) && "" !== t ? (t = this.Ya(t), this.mh = null !== t ? t : this) : this instanceof Fu ? (t = this.path, this.mh = null !== t ? t : this) : this.mh = this), this.mh } }, selectionChanged: { get: function () { return this.Ap }, set: function (t) { var i = this.Ap; i !== t && (this.Ap = t, this.g("selectionChanged", i, t)) } }, resizeAdornmentTemplate: { get: function () { return this.jp }, set: function (t) { var i = this.jp; i !== t && (this.jp = t, this.g("resizeAdornmentTemplate", i, t)) } }, resizeObjectName: { get: function () { return this.lp }, set: function (t) { var i = this.lp; i !== t && (this.lp = t, this.g("resizeObjectName", i, t)) } }, resizeObject: { get: function () { var t = this.resizeObjectName; return "" !== t && null !== (t = this.Ya(t)) ? t : this } }, resizeCellSize: { get: function () { return this.kp }, set: function (t) { var i = this.kp; i.w(t) || (this.kp = t = t.G(), this.g("resizeCellSize", i, t)) } }, rotateAdornmentTemplate: { get: function () { return this.np }, set: function (t) { var i = this.np; i !== t && (this.np = t, this.g("rotateAdornmentTemplate", i, t)) } }, rotateObjectName: { get: function () { return this.op }, set: function (t) { var i = this.op; i !== t && (this.op = t, this.g("rotateObjectName", i, t)) } }, rotateObject: { get: function () { var t = this.rotateObjectName; return "" !== t && null !== (t = this.Ya(t)) ? t : this } }, rotationSpot: { get: function () { return this.pp }, set: function (t) { var i = this.pp; i.w(t) || (this.pp = t = t.G(), this.g("rotationSpot", i, t)) } }, text: { get: function () { return this.Tb }, set: function (t) { var i = this.Tb; i !== t && (this.Tb = t, this.g("text", i, t)) } }, containingGroup: { get: function () { return this.di }, set: function (t) { if (this.Wb()) { var i = this.di; if (i !== t) { null === t || this !== t && !t.Xd(this) || (this === t && B("Cannot make a Group a member of itself: " + this.toString()), B("Cannot make a Group indirectly contain itself: " + this.toString() + " already contains " + t.toString())), this.C(2); var e, n, o, r = this.diagram; if (null !== i ? ju(i, this) : this instanceof Lu && null !== r && r.wh.remove(this), null !== (this.di = t) ? Au(t, this) : this instanceof Lu && null !== r && r.wh.add(this), this.C(1), null !== r && r.Z && (e = this.data, n = r.model, null !== e && n.jk() && (o = n.ja(null !== t ? t.data : null), n.Ot(e, o))), null !== (e = this.containingGroupChanged) && (n = !0, null !== r && (n = r.Z, r.Z = !0), e(this, i, t), null !== r && (r.Z = n)), this instanceof Lu) for (cu(r = new $, this, !0, 0, !0), r = r.iterator; r.next();)if ((e = r.value) instanceof pu) for (e = e.linksConnected; e.next();)Ou(e.value); if (this instanceof pu) { for (r = this.linksConnected; r.next();)Ou(r.value); null !== (r = this.labeledLink) && Ou(r) } this.g("containingGroup", i, t), null !== t && (null !== (i = t.layer) && To(i, -1, t)) } } else B("cannot set the Part.containingGroup of a Link or Adornment") } }, containingGroupChanged: { get: function () { return this.hn }, set: function (t) { var i = this.hn; i !== t && (this.hn = t, this.g("containingGroupChanged", i, t)) } }, isTopLevel: { get: function () { return !(null !== this.containingGroup || this instanceof pu && null !== this.labeledLink) } }, layoutConditions: { get: function () { return this.oo }, set: function (t) { var i = this.oo; i !== t && (this.oo = t, this.g("layoutConditions", i, t)) } }, dragComputation: { get: function () { return this.An }, set: function (t) { var i = this.An; i !== t && (this.An = t, this.g("dragComputation", i, t)) } }, shadowOffset: { get: function () { return this.Fp }, set: function (t) { var i = this.Fp; i.w(t) || (this.Fp = t = t.G(), this.M(), this.g("shadowOffset", i, t)) } }, shadowColor: { get: function () { return this.Ep }, set: function (t) { var i = this.Ep; i !== t && (this.Ep = t, this.M(), this.g("shadowColor", i, t)) } }, shadowBlur: { get: function () { return this.df }, set: function (t) { var i = this.df; i !== t && (this.df = t, this.M(), this.g("shadowBlur", i, t)) } } }), Hl.prototype.invalidateLayout = Hl.prototype.C, Hl.prototype.findCommonContainingGroup = Hl.prototype.Kx, Hl.prototype.isMemberOf = Hl.prototype.Xd, Hl.prototype.findTopLevelPart = Hl.prototype.wz, Hl.prototype.findSubGraphLevel = Hl.prototype.sz, Hl.prototype.ensureBounds = Hl.prototype.zb, Hl.prototype.getDocumentBounds = Hl.prototype.km, Hl.prototype.getRelativePoint = Hl.prototype.vf, Hl.prototype.findObject = Hl.prototype.Ya, Hl.prototype.moveTo = Hl.prototype.moveTo, Hl.prototype.invalidateAdornments = Hl.prototype.Lb, Hl.prototype.clearAdornments = Hl.prototype.Yj, Hl.prototype.removeAdornment = Hl.prototype.zf, Hl.prototype.addAdornment = Hl.prototype.zh, Hl.prototype.findAdornment = Hl.prototype.fk, Hl.prototype.updateTargetBindings = Hl.prototype.Ba; var fu = !1; function du(t) { Hl.call(this, t), this.D &= -257, this.ah = "Adornment", this.ce = null, this.ex = 0, this.tx = !1, this.l = [], this.Ra = null } function pu(t) { Hl.call(this, t), this.P = 13, this.Xa = new J, this.Xp = this.ql = this.xi = this.qo = this.po = null, this.Ik = Di, this.rc = this.Me = null, this.gp = Cu, this.xh = !1 } function gu(t, i) { null !== i && (null === t.Me && (t.Me = new $), t.Me.add(i)) } function yu(t, i, e, n) { if (null === i || null === t.Me) return null; for (var o = t.Me.iterator; o.next();) { var r = o.value; if (r.Dt === t && r.Qv === i && r.ay === e && r.by === n || r.Dt === i && r.Qv === t && r.ay === n && r.by === e) return r } return null } function mu(t, i) { for (var e = t.linksConnected; e.next();) { var n = e.value; n.fromPort !== i && n.toPort !== i || (vu(t, n.fromPort), vu(t, n.toPort), n.Ta()) } } function vu(t, i) { null !== i && (null !== (i = i.fp) && i.mm(), null === (t = t.containingGroup) || t.isSubGraphExpanded || vu(t, t.port)) } function xu(t, i, e) { vu(t, e); var n, o, r, s = t.Xa.contains(i); s || t.Xa.add(i), s && i.fromNode !== i.toNode || null !== (n = t.linkConnected) && (o = !0, null !== (r = t.diagram) && (o = r.Z, r.Z = !0), n(t, i, e), null !== r && (r.Z = o)), !s && i.isTreeLink && (e = i.fromNode, i = i.toNode, null !== e && null !== i && e !== i && (s = !0, null !== (t = t.diagram) && (s = t.isTreePathToChildren), o = s ? e : i, (n = s ? i : e).xh || (n.xh = o), !o.isTreeLeaf || null !== t && t.undoManager.isUndoingRedoing || (s ? e === o && (o.isTreeLeaf = !1) : i === o && (o.isTreeLeaf = !1)))) } function bu(t, i, e) { vu(t, e); var n, o, r = t.Xa.remove(i), s = null; !r && i.toNode !== i.fromNode || (n = t.linkDisconnected, s = t.diagram, null !== n && (o = !0, null !== s && (o = s.Z, s.Z = !0), n(t, i, e), null !== s && (s.Z = o))), r && i.isTreeLink && (e = !0, null !== s && (e = s.isTreePathToChildren), t = e ? i.toNode : i.fromNode, i = e ? i.fromNode : i.toNode, null !== t && (t.xh = !1), null === i || i.isTreeLeaf || (0 === i.Xa.count ? (i.xh = null) !== s && s.undoManager.isUndoingRedoing || (i.isTreeLeaf = !0) : wu(i))) } function wu(t) { if (t.xh = !1, 0 !== t.Xa.count) { var i = !0, e = t.diagram; if (null === e || !e.undoManager.isUndoingRedoing) { for (null !== e && (i = e.isTreePathToChildren), e = t.Xa.iterator; e.next();) { var n = e.value; if (n.isTreeLink) if (i) { if (n.fromNode === t) return void (t.isTreeLeaf = !1) } else if (n.toNode === t) return void (t.isTreeLeaf = !1) } t.isTreeLeaf = !0 } } } function ku(t) { null === t.rc ? t.rc = new at : t.rc.clear(), t.Jm(t, function (t, i) { Mu(t, i) }), 0 === t.rc.count && t.rc.add("", t) } function Mu(t, i) { var e = i.portId; null !== e && null !== t.rc && t.rc.add(e, i) } function Su(t, i, e) { var n = i.portId; if (null !== n && (null !== t.rc && t.rc.remove(n), null !== (i = t.diagram) && e)) { for (e = null, t = t.findLinksConnected(n); t.next();)n = t.value, null === e && (e = zi()), e.push(n); if (null !== e) { for (t = 0; t < e.length; t++)i.remove(e[t]); Vi(e) } } } function Pu(t, i, e, n, o, r) { for (var s = o === t || t.isTreeExpanded, a = e ? t.mq() : t.xd(); a.next();) { var h, l = a.value; l.isTreeLink && (null !== (l = l.rt(t)) && l !== t) && ((h = i.contains(l)) || i.add(l), s && (r && n.Tj(l, o), l.Gh(), l.Ob(!1)), l.isTreeExpanded && (l.wasTreeExpanded = l.isTreeExpanded, h || Pu(l, i, e, n, o, r))) } t.isTreeExpanded = !1 } Hl.className = "Part", Hl.LayoutNone = 0, Hl.LayoutAdded = 1, Hl.LayoutRemoved = 2, Hl.LayoutShown = 4, Hl.LayoutHidden = 8, Hl.LayoutNodeSized = 16, Hl.LayoutGroupLayout = 32, Hl.LayoutNodeReplaced = 64, Hl.LayoutStandard = 127, Hl.LayoutAll = 16777215, h(du, Hl), du.prototype.toString = function () { var t = this.adornedPart; return "Adornment(" + this.category + ")" + (null !== t ? t.toString() : "") }, du.prototype.updateRelationshipsFromData = function () { }, du.prototype.nk = function (t) { var i = this.adornedObject.part; if (i instanceof Fu && this.adornedObject instanceof Kh) { var e = i.path; i.nk(t), t = e.geometry, e = (i = this.V.j).length; for (var n = 0; n < e; n++) { var o = i[n]; o.isPanelMain && o instanceof Kh && (o.ka = t) } } }, du.prototype.bj = function () { var t = this.ce; return null === t || (null === (t = t.part) || !ra(t)) }, du.prototype.Wb = function () { return !1 }, du.prototype.vk = function (t, i, e, n, o, r, s) { var a; t === we && "elements" === i ? o instanceof Du ? null === this.Ra && (this.Ra = o) : o instanceof xh && ((a = o.gm(function (t) { return t instanceof Du })) instanceof Du && null === this.Ra && (this.Ra = a)) : t === ke && "elements" === i && null !== this.Ra && (n === this.Ra || n instanceof xh && this.Ra.Ag(n)) && (this.Ra = null), Hl.prototype.vk.call(this, t, i, e, n, o, r, s) }, du.prototype.updateAdornments = function () { }, du.prototype.dk = function () { }, l.Object.defineProperties(du.prototype, { placeholder: { get: function () { return this.Ra } }, adornedObject: { get: function () { return this.ce }, set: function (t) { var i = this.adornedPart, e = null; null !== t && (e = t.part), null === i || null !== t && i === e || i.zf(this.category), this.ce = t, null !== e && e.zh(this.category, this) } }, adornedPart: { get: function () { var t = this.ce; return null !== t ? t.part : null } }, containingGroup: { get: function () { return null } } }), du.className = "Adornment", h(pu, Hl), pu.prototype.cloneProtected = function (t) { Hl.prototype.cloneProtected.call(this, t), t.P = this.P, t.P = -17 & this.P, t.po = this.po, t.qo = this.qo, t.xi = this.xi, t.Xp = this.Xp, t.Ik = this.Ik.G(), t.gp = this.gp }, (t = pu.prototype).sf = function (t) { Hl.prototype.sf.call(this, t), t.fd(), t.Me = this.Me, t.rc = null }, t.Tz = function (t, i, e) { null == i && (i = ""), null == e && (e = ""), null !== (t = yu(this, t, i, e)) && t.mm() }, t.vk = function (t, i, e, n, o, r, s) { (t === we && "elements" === i || t === ke && "elements" === i) && (this.rc = null), Hl.prototype.vk.call(this, t, i, e, n, o, r, s) }, t.fd = function (t) { void 0 === t && (t = null); for (var i = this.linksConnected; i.next();) { var e = i.value; null !== t && t.contains(e) || (vu(this, e.fromPort), vu(this, e.toPort), e.Ta()) } }, t.bj = function () { return !0 }, pu.prototype.getAvoidableRect = function (t) { return t.set(this.actualBounds), t.eq(this.Ik), t }, pu.prototype.findVisibleNode = function () { for (var t = this; null !== t && !t.isVisible();)t = t.containingGroup; return t }, pu.prototype.isVisible = function () { if (!Hl.prototype.isVisible.call(this)) return !1; var t = !0, i = ys, e = this.diagram; if (null !== e) { if (e.animationManager.Ft(this)) return !0; t = e.isTreePathToChildren, i = e.treeCollapsePolicy } if (i === ys) { if (null !== (t = this.yg()) && !t.isTreeExpanded) return !1 } else if (i === ms) { if (0 < (t = t ? this.wv() : this.xv()).count && t.all(function (t) { return !t.isTreeExpanded })) return !1 } else if (i === vs && (0 < (t = t ? this.wv() : this.xv()).count && t.any(function (t) { return !t.isTreeExpanded }))) return !1; return null === (t = this.labeledLink) || t.isVisible() }, pu.prototype.Ob = function (t) { Hl.prototype.Ob.call(this, t); for (var i = this.linksConnected; i.next();)i.value.Ob(t) }, pu.prototype.Lx = function () { var t = new $, i = new $; return function i(e, n, o, r) { { var s, t; o.has(n) || (o.add(n), s = !0, null !== (t = e.diagram) && (s = t.isTreePathToChildren), n.linksConnected.each(function (t) { t.isTreeLink ? (s ? t.fromNode === n : t.toNode === n) && i(e, s ? t.toNode : t.fromNode, o, r) : r.add(t) })) } }(this, this, t, i), i.iterator }, pu.prototype.findLinksConnected = function (i) { if (void 0 === i && (i = null), null === i) return this.Xa.iterator; var t = new H(this.Xa), e = this; return t.predicate = function (t) { return t.fromNode === e && t.fromPortId === i || t.toNode === e && t.toPortId === i }, t }, (t = pu.prototype).mq = function (i) { void 0 === i && (i = null); var t = new H(this.Xa), e = this; return t.predicate = function (t) { return t.fromNode === e && (null === i || t.fromPortId === i) }, t }, t.xd = function (i) { void 0 === i && (i = null); var t = new H(this.Xa), e = this; return t.predicate = function (t) { return t.toNode === e && (null === i || t.toPortId === i) }, t }, t.vv = function (t) { void 0 === t && (t = null); for (var i = null, e = null, n = this.Xa.iterator; n.next();) { var o = n.value; o.fromNode === this ? null !== t && o.fromPortId !== t || (o = o.toNode, null !== i ? i.add(o) : null !== e && e !== o ? ((i = new $).add(e), i.add(o)) : e = o) : o.toNode !== this || null !== t && o.toPortId !== t || (o = o.fromNode, null !== i ? i.add(o) : null !== e && e !== o ? ((i = new $).add(e), i.add(o)) : e = o) } return null !== i ? i.iterator : null !== e ? new K(e) : U }, t.xv = function (t) { void 0 === t && (t = null); for (var i = null, e = null, n = this.Xa.iterator; n.next();) { var o = n.value; o.fromNode !== this || null !== t && o.fromPortId !== t || (o = o.toNode, null !== i ? i.add(o) : null !== e && e !== o ? ((i = new $).add(e), i.add(o)) : e = o) } return null !== i ? i.iterator : null !== e ? new K(e) : U }, t.wv = function (t) { void 0 === t && (t = null); for (var i = null, e = null, n = this.Xa.iterator; n.next();) { var o = n.value; o.toNode !== this || null !== t && o.toPortId !== t || (o = o.fromNode, null !== i ? i.add(o) : null !== e && e !== o ? ((i = new $).add(e), i.add(o)) : e = o) } return null !== i ? i.iterator : null !== e ? new K(e) : U }, t.nz = function (i, e, n) { void 0 === e && (e = null), void 0 === n && (n = null); var t = new H(this.Xa), o = this; return t.predicate = function (t) { return !(t.fromNode !== o || t.toNode !== i || null !== e && t.fromPortId !== e || null !== n && t.toPortId !== n) || !(t.fromNode !== i || t.toNode !== o || null !== n && t.fromPortId !== n || null !== e && t.toPortId !== e) }, t }, t.oz = function (i, e, n) { void 0 === e && (e = null), void 0 === n && (n = null); var t = new H(this.Xa), o = this; return t.predicate = function (t) { return !(t.fromNode !== o || t.toNode !== i || null !== e && t.fromPortId !== e || null !== n && t.toPortId !== n) }, t }, pu.prototype.updateRelationshipsFromData = function () { var t = this.diagram; null !== t && t.partManager.updateRelationshipsFromData(this) }, (t = pu.prototype).rq = function (t) { Hl.prototype.rq.call(this, t), t || (wu(this), null !== (t = this.ql) && Bu(t, this)) }, t.sq = function (t) { Hl.prototype.sq.call(this, t), t || null !== (t = this.ql) && null !== t.bd && (t.bd.remove(this), t.o()) }, t.dk = function () { if (0 < this.Xa.count) { var t = this.diagram; if (null !== t) for (var i = null === t.commandHandler || t.commandHandler.deletesConnectedLinks, e = this.Xa.copy().iterator; e.next();) { var n = e.value; i ? t.remove(n) : (n.fromNode === this && (n.fromNode = null), n.toNode === this && (n.toNode = null)) } } this.labeledLink = null, Hl.prototype.dk.call(this) }, t.nt = function (t) { if (null === this.rc) { if ("" === t && !1 === this.Fh) return this; ku(this) } var i = this.rc.H(t); return null !== i || "" !== t && null !== (i = this.rc.H("")) ? i : this }, t.Vz = function (t) { if (null === t || t === this) return !1; var i = !0, e = this.diagram; if (null !== e && (i = e.isTreePathToChildren), e = this, i) for (; e !== t;) { i = null; for (var n = e.Xa.iterator; n.next();) { var o = n.value; if (o.isTreeLink && ((i = o.fromNode) !== e && i !== this)) break } if (i === this || null === i || i === e) return !1; e = i } else for (; e !== t;) { for (i = null, n = e.Xa.iterator; n.next() && (!(o = n.value).isTreeLink || ((i = o.toNode) === e || i === this));); if (i === this || null === i || i === e) return !1; e = i } return !0 }, t.Az = function () { var t = !0, i = this.diagram; if (null !== i && (t = i.isTreePathToChildren), i = this, t) for (; ;) { t = null; for (var e = i.Xa.iterator; e.next();) { var n = e.value; if (n.isTreeLink && ((t = n.fromNode) !== i && t !== this)) break } if (t === this) return this; if (null === t || t === i) return i; i = t } else for (; ;) { for (t = null, e = i.Xa.iterator; e.next() && (!(n = e.value).isTreeLink || ((t = n.toNode) === i || t === this));); if (t === this) return this; if (null === t || t === i) return i; i = t } }, t.kz = function (t) { if (null === t) return null; if (this === t) return this; for (var i = this; null !== i;)lu(i, !0), i = i.yg(); for (var e = null, i = t; null !== i;) { if (0 != (1048576 & i.D)) { e = i; break } i = i.yg() } for (i = this; null !== i;)lu(i, !1), i = i.yg(); return e }, t.Vi = function () { var t = !0, i = this.diagram; if (null !== i && (t = i.isTreePathToChildren), i = this.Xa.iterator, t) { for (; i.next();)if ((t = i.value).isTreeLink && t.fromNode !== this) return t } else for (; i.next();)if ((t = i.value).isTreeLink && t.toNode !== this) return t; return null }, t.yg = function () { var t = this.xh; if (null === t) return null; if (t instanceof pu) return t; var i = !0; if (null !== (t = this.diagram) && (i = t.isTreePathToChildren), t = this.Xa.iterator, i) { for (; t.next();)if ((i = t.value).isTreeLink && (i = i.fromNode) !== this) return this.xh = i } else for (; t.next();)if ((i = t.value).isTreeLink && (i = i.toNode) !== this) return this.xh = i; return this.xh = null }, t.yz = function () { var t = new $; return function t(i, e) { var n; null !== i && (e.add(i), null !== (n = i.Vi()) && (e.add(n), t(i.yg(), e))) }(this, t), t }, t.xz = function () { return function t(i, e) { e = e.yg(); return null === e ? 0 : 1 + t(i, e) }(this, this) }, t.oq = function () { var t = !0, i = this.diagram; null !== i && (t = i.isTreePathToChildren), i = new H(this.Xa); var e = this; return i.predicate = t ? function (t) { return !(!t.isTreeLink || t.fromNode !== e) } : function (t) { return !(!t.isTreeLink || t.toNode !== e) }, i }, t.zv = function () { var t = !0, i = this.diagram; null !== i && (t = i.isTreePathToChildren); var e = i = null, n = this.Xa.iterator; if (t) for (; n.next();)(t = n.value).isTreeLink && t.fromNode === this && (t = t.toNode, null !== i ? i.add(t) : null !== e && e !== t ? ((i = new J).add(e), i.add(t)) : e = t); else for (; n.next();)(t = n.value).isTreeLink && t.toNode === this && (t = t.fromNode, null !== i ? i.add(t) : null !== e && e !== t ? ((i = new J).add(e), i.add(t)) : e = t); return null !== i ? i.iterator : null !== e ? new K(e) : U }, t.zz = function (t) { void 0 === t && (t = 1 / 0); var i = new $; return cu(i, this, !1, t, !0), i }, pu.prototype.collapseTree = function (t) { void 0 === t && (t = 1), t < 1 && (t = 1); var i, e = this.diagram; null === e || e.Ee || (e.Ee = !0, (i = new $).add(this), function t(i, e, n, o, r, s, a) { if (1 < o) for (var h = n ? i.mq() : i.xd(); h.next();) { var l = h.value; l.isTreeLink && (null === (l = l.rt(i)) || l === i || e.contains(l) || (e.add(l), t(l, e, n, o - 1, r, s, a))) } else Pu(i, e, n, r, s, a) }(this, i, e.isTreePathToChildren, t, e, this, e.treeCollapsePolicy === ys), e.Ee = !1) }, pu.prototype.expandTree = function (t) { void 0 === t && (t = 2), t < 2 && (t = 2); var i, e = this.diagram; null === e || e.Ee || (e.Ee = !0, (i = new $).add(this), function t(i, e, n, o, r, s, a) { for (var h = s !== i && i.isTreeExpanded, l = n ? i.mq() : i.xd(); l.next();) { var u = l.value; u.isTreeLink && (h || u.ld || u.Ta(), null !== (u = u.rt(i)) && u !== i && !e.contains(u) && (e.add(u), h || (u.Ob(!0), u.Gh(), a && r.Vj(u, s)), 2 < o || u.wasTreeExpanded)) && (u.wasTreeExpanded = !1, t(u, e, n, o - 1, r, s, a)) } i.isTreeExpanded = !0 }(this, i, e.isTreePathToChildren, t, e, this, e.treeCollapsePolicy === ys), e.Ee = !1) }, l.Object.defineProperties(pu.prototype, { portSpreading: { get: function () { return this.gp }, set: function (t) { var i = this.gp; i !== t && (this.gp = t, this.g("portSpreading", i, t), null !== (t = this.diagram) && t.undoManager.isUndoingRedoing || this.fd()) } }, avoidable: { get: function () { return 0 != (8 & this.P) }, set: function (t) { var i, e = 0 != (8 & this.P); e !== t && (this.P ^= 8, null !== (i = this.diagram) && Er(i, this), this.g("avoidable", e, t)) } }, avoidableMargin: { get: function () { return this.Ik }, set: function (t) { "number" == typeof t && (t = new Xt(t)); var i, e = this.Ik; e.w(t) || (this.Ik = t = t.G(), null !== (i = this.diagram) && Er(i, this), this.g("avoidableMargin", e, t)) } }, linksConnected: { get: function () { return this.Xa.iterator } }, linkConnected: { get: function () { return this.po }, set: function (t) { var i = this.po; i !== t && (this.po = t, this.g("linkConnected", i, t)) } }, linkDisconnected: { get: function () { return this.qo }, set: function (t) { var i = this.qo; i !== t && (this.qo = t, this.g("linkDisconnected", i, t)) } }, linkValidation: { get: function () { return this.xi }, set: function (t) { var i = this.xi; i !== t && (this.xi = t, this.g("linkValidation", i, t)) } }, isLinkLabel: { get: function () { return null !== this.ql } }, labeledLink: { get: function () { return this.ql }, set: function (t) { var i, e, n, o, r, s = this.ql; s !== t && (i = this.diagram, e = this.data, null !== s && (null !== s.bd && (s.bd.remove(this), s.o()), null === i || null === e || i.undoManager.isUndoingRedoing || (n = s.data, o = i.model, null === n || !o.om() || void 0 !== (r = o.ja(e)) && o.ey(n, r)), this.containingGroup = null), null !== (this.ql = t) && (Bu(t, this), null === i || null === e || i.undoManager.isUndoingRedoing || (n = t.data, i = i.model, null === n || !i.om() || void 0 !== (e = i.ja(e)) && i.hv(n, e)), this.containingGroup = t.containingGroup), Ws(this), this.g("labeledLink", s, t)) } }, port: { get: function () { return this.nt("") } }, ports: { get: function () { return null === this.rc && ku(this), this.rc.iteratorValues } }, isTreeExpanded: { get: function () { return 0 != (1 & this.P) }, set: function (t) { var i, e, n = 0 != (1 & this.P); n !== t && (this.P ^= 1, i = this.diagram, this.g("isTreeExpanded", n, t), null !== (n = this.treeExpandedChanged) && (e = !0, null !== i && (e = i.Z, i.Z = !0), n(this), null !== i && (i.Z = e)), null !== i && i.undoManager.isUndoingRedoing ? this.Ob(t) : t ? this.expandTree() : this.collapseTree()) } }, wasTreeExpanded: { get: function () { return 0 != (2 & this.P) }, set: function (t) { var i = 0 != (2 & this.P); i !== t && (this.P ^= 2, this.g("wasTreeExpanded", i, t)) } }, treeExpandedChanged: { get: function () { return this.Xp }, set: function (t) { var i = this.Xp; i !== t && (this.Xp = t, this.g("treeExpandedChanged", i, t)) } }, isTreeLeaf: { get: function () { return 0 != (4 & this.P) }, set: function (t) { var i = 0 != (4 & this.P); i !== t && (this.P ^= 4, this.g("isTreeLeaf", i, t)) } } }), pu.prototype.expandTree = pu.prototype.expandTree, pu.prototype.collapseTree = pu.prototype.collapseTree, pu.prototype.findTreeParts = pu.prototype.zz, pu.prototype.findTreeChildrenNodes = pu.prototype.zv, pu.prototype.findTreeChildrenLinks = pu.prototype.oq, pu.prototype.findTreeLevel = pu.prototype.xz, pu.prototype.findTreeParentChain = pu.prototype.yz, pu.prototype.findTreeParentNode = pu.prototype.yg, pu.prototype.findTreeParentLink = pu.prototype.Vi, pu.prototype.findCommonTreeParent = pu.prototype.kz, pu.prototype.findTreeRoot = pu.prototype.Az, pu.prototype.isInTreeOf = pu.prototype.Vz, pu.prototype.findPort = pu.prototype.nt, pu.prototype.findLinksTo = pu.prototype.oz, pu.prototype.findLinksBetween = pu.prototype.nz, pu.prototype.findNodesInto = pu.prototype.wv, pu.prototype.findNodesOutOf = pu.prototype.xv, pu.prototype.findNodesConnected = pu.prototype.vv, pu.prototype.findLinksInto = pu.prototype.xd, pu.prototype.findLinksOutOf = pu.prototype.mq, pu.prototype.findExternalTreeLinksConnected = pu.prototype.Lx, pu.prototype.invalidateConnectedLinks = pu.prototype.fd, pu.prototype.invalidateLinkBundle = pu.prototype.Tz; var Nu = new V(pu, "SpreadingNone", 10), Cu = new V(pu, "SpreadingEvenly", 11), Tu = new V(pu, "SpreadingPacked", 12); function Lu(t) { pu.call(this, t), this.P |= 4608, this.Ao = new $, this.yl = new $, this.Ra = this.Op = this.yi = this.Bo = this.zo = null, this.ic = new Ic, this.ic.group = this } function Au(t, i) { var e, n, o; t.Ao.add(i) && (i instanceof Lu && t.yl.add(i), null !== (e = t.memberAdded) && (n = !0, null !== (o = t.diagram) && (n = o.Z, o.Z = !0), e(t, i), null !== o && (o.Z = n)), t.isVisible() && t.isSubGraphExpanded || i.Ob(!1)), i instanceof Fu && !t.computesBoundsIncludingLinks || (null === (i = t.Ra) && (i = t), i.o()) } function ju(t, i) { var e, n, o; t.Ao.remove(i) && (i instanceof Lu && t.yl.remove(i), null !== (e = t.memberRemoved) && (n = !0, null !== (o = t.diagram) && (n = o.Z, o.Z = !0), e(t, i), null !== o && (o.Z = n)), t.isVisible() && t.isSubGraphExpanded || i.Ob(!0)), i instanceof Fu && !t.computesBoundsIncludingLinks || (null === (i = t.Ra) && (i = t), i.o()) } function Du() { Es.call(this), this.eb = ji, this.vp = new yi(NaN, NaN, NaN, NaN) } function Fu() { Hl.call(this, xh.Link), this.Pa = 8, this.Qe = null, this.Re = "", this.lf = this.Nn = null, this.mf = "", this.Wp = null, this.Dk = ec, this.pn = 0, this.rn = ec, this.sn = NaN, this.Lj = Qu, this.Jp = .5, this.bd = null, this.xb = (new J).freeze(), this.lh = this.gh = null, this.Dl = new yi, this.ka = new Ui, this.Zn = !0, this.I = this.u = this.Hf = this.Qf = null, this.l = [], this.Zu = new gi, this.Hr = this.ox = this.nx = null, this.tu = NaN, this.O = null } function Ou(t) { var i, e, n, o = t.fromNode, r = t.toNode, s = null, o = s = null !== o ? null !== r ? o.Kx(r) : o.containingGroup : null !== r ? r.containingGroup : null; if ((r = t.di) !== o && (null !== r && ju(r, t), null !== (t.di = o) && Au(o, t), null !== (i = t.containingGroupChanged) && (e = !0, null !== (n = t.diagram) && (e = n.Z, n.Z = !0), i(t, r, o), null !== n && (n.Z = e)), !t.ld || t.nx !== r && t.ox !== r || t.Ta()), t.isLabeledLink) for (t = t.labelNodes; t.next();)t.value.containingGroup = s } function Bu(t, i) { null === t.bd && (t.bd = new $), t.bd.add(i), t.o() } function Iu(t, i, e) { if (0 !== i || 0 !== e) { for (var n = t.ld, o = new J, r = t.xb.iterator; r.next();) { var s = r.value; o.add(new gi(s.x + i, s.y + e).freeze()) } o.freeze(), r = t.xb, t.xb = o, s = t.diagram, isNaN(i) || isNaN(e) || null !== s && s.animationManager.qc ? t.o() : (t.$f.h(t.$f.x + i, t.$f.y + e), t.ma.h(t.ma.x + i, t.ma.y + e), Ws(t)), n && Ru(t), null !== s && s.animationManager.qc && (t.lh = o), t.g("points", r, o) } } function Ru(t) { 0 === t.xb.count ? t.ld = !1 : (t.ld = !0, t.Hr = null, t.tu = NaN, t.defaultFromPoint = t.i(0), t.defaultToPoint = t.i(t.pointsCount - 1), Wu(t, !1)) } function Eu(t, i) { return Math.abs(i.x - t.x) > Math.abs(i.y - t.y) ? (i.x >= t.x ? i.x = t.x + 9e9 : i.x = t.x - 9e9, i.y = t.y) : (i.y >= t.y ? i.y = t.y + 9e9 : i.y = t.y - 9e9, i.x = t.x), i } function zu(t, i) { var e = i.fp; return null === e && ((e = new jc).port = i, e.node = i.part, i.fp = e), Fc(e, t) } function Vu(t) { return t === Kt || .5 === t.x && .5 === t.y } function Yu(t) { if (null !== t.diagram && t.isAvoiding && Br(t.diagram)) { var i = t.points.j, e = i.length; if (!(e < 4)) { t = Ir(t.diagram, !0, t.containingGroup, null); for (var n = 1; n < e - 2; n++) { var o = i[n], r = i[n + 1]; if (!t.lk(Math.min(o.x, r.x), Math.min(o.y, r.y), Math.abs(o.x - r.x), Math.abs(o.y - r.y))) return 1 } } } } function Gu(t, i, e, n) { return t = e - t, isNaN(t) || 1 / 0 === t || -1 / 0 === t ? NaN : (t < 0 && (t = -t), i = n - i, isNaN(i) || 1 / 0 === i || -1 / 0 === i ? NaN : (i < 0 && (i = -i), qi.$(t, 0) ? i : qi.$(i, 0) ? t : Math.sqrt(t * t + i * i))) } function Xu(t, i, e, n) { var o = t.pointsCount; if (o < 2) return i; if (e) { var r = t.i(1); if (e = r.x - n.x, r = r.y - n.y, 0 === (n = Gu(i.x, i.y, e, r))) return i; (o = 2 === o ? .5 * n : n) < (t = t.computeShortLength(!0)) && (t = o), o = t * (r - i.y) / n, i.x += t * (e - i.x) / n, i.y += o } else { if (e = (r = t.i(o - 2)).x - n.x, r = r.y - n.y, 0 === (n = Gu(i.x, i.y, e, r))) return i; (o = 2 === o ? .5 * n : n) < (t = t.computeShortLength(!1)) && (t = o), o = t * (i.y - r) / n, i.x -= t * (i.x - e) / n, i.y -= o } return i } function qu(t, i, e, n) { for (var o = t.pointsCount, r = i; qi.$(i.x, r.x) && qi.$(i.y, r.y);) { if (o <= e) return o - 1; r = t.i(e++) } if (!qi.$(i.x, r.x) && !qi.$(i.y, r.y)) return e - 1; for (var s = r; qi.$(i.x, r.x) && qi.$(r.x, s.x) && (!n || (i.y >= r.y ? r.y >= s.y : r.y <= s.y)) || qi.$(i.y, r.y) && qi.$(r.y, s.y) && (!n || (i.x >= r.x ? r.x >= s.x : r.x <= s.x));) { if (o <= e) return o - 1; s = t.i(e++) } return e - 2 } function Uu(t, i, e, n, o, r, s) { if (!s && Hu(t)) { s = []; var a = 0; if (t.isVisible() && (a = function (t, i, e, n) { var o = t.diagram; if (null === o || i.w(e)) return 0; for (o = o.layers; o.next();) { var r = o.value; if (null !== r && r.visible) for (var s = (r = r.Ca.j).length, a = 0; a < s; a++) { var h, l = r[a]; if (l instanceof Fu) { if (l === t) return 0 < n.length && n.sort(function (t, i) { return t - i }), n.length; l.isVisible() && Hu(l) && (!(h = l.routeBounds).v() || !t.routeBounds.Gc(h) || t.usesSamePort(l) || null !== (h = l.path) && h.yf() && Ku(i, e, n, l)) } } } return 0 < n.length && n.sort(function (t, i) { return t - i }), n.length }(t, o, r, s)), 0 < a) if (qi.A(o.y, r.y)) if (o.x < r.x) for (var h = 0; h < a;) { var l = Math.max(o.x, Math.min(s[h++] - 5, r.x - 10)); i.lineTo(l + e, r.y + n); for (var u = l + e, c = Math.min(l + 10, r.x); h < a && (l = s[h]) < c + 10;)h++, c = Math.min(l + 5, r.x); l = r.y - 10 + n, c += e; var f = r.y + n; t.curve === oc ? Vl(i, c, f, !1) : Yl(i, u, l, c, l, c, f) } else for (--a; 0 <= a;) { for (h = Math.min(o.x, Math.max(s[a--] + 5, r.x + 10)), i.lineTo(h + e, r.y + n), u = h + e, l = Math.max(h - 10, r.x); 0 <= a && l - 10 < (h = s[a]);)a--, l = Math.max(h - 5, r.x); h = r.y - 10 + n, l += e, c = r.y + n, t.curve === oc ? Vl(i, l, c, !1) : Yl(i, u, h, l, h, l, c) } else if (qi.A(o.x, r.x)) if (o.y < r.y) for (h = 0; h < a;) { for (l = Math.max(o.y, Math.min(s[h++] - 5, r.y - 10)), i.lineTo(r.x + e, l + n), u = l + n, l = Math.min(l + 10, r.y); h < a && (c = s[h]) < l + 10;)h++, l = Math.min(c + 5, r.y); c = r.x - 10 + e, f = r.x + e, l += n, t.curve === oc ? Vl(i, f, l, !1) : Yl(i, c, u, c, l, f, l) } else for (--a; 0 <= a;) { for (h = Math.min(o.y, Math.max(s[a--] + 5, r.y + 10)), i.lineTo(r.x + e, h + n), u = h + n, h = Math.max(h - 10, r.y); 0 <= a && h - 10 < (l = s[a]);)a--, h = Math.max(l - 5, r.y); l = r.x - 10 + e, c = r.x + e, h += n, t.curve === oc ? Vl(i, c, h, !1) : Yl(i, l, u, l, h, c, h) } } i.lineTo(r.x + e, r.y + n) } function Ku(t, i, e, n) { for (var o = qi.A(t.y, i.y), r = n.pointsCount, s = n.i(0), a = gi.alloc(), h = 1; h < r; h++) { var l = n.i(h); if (h < r - 1) { var u = n.i(h + 1); if (s.y === l.y && l.y === u.y) { if (l.x > s.x && u.x >= l.x || l.x < s.x && u.x <= l.x) continue } else if (s.x === l.x && l.x === u.x && (l.y > s.y && u.y >= l.y || l.y < s.y && u.y <= l.y)) continue } t: { u = t.x; var c = t.y, f = i.x, d = i.y, p = s.x, s = s.y, g = l.x, y = l.y; if (qi.A(u, f)) { if (!qi.A(c, d) && qi.A(s, y) && Math.min(c, d) < s && Math.max(c, d) > s && Math.min(p, g) < u && Math.max(p, g) > u && !qi.A(p, g)) { a.x = u, a.y = s, u = !0; break t } } else if (qi.A(c, d) && qi.A(p, g) && Math.min(u, f) < p && Math.max(u, f) > p && Math.min(s, y) < c && Math.max(s, y) > c && !qi.A(s, y)) { a.x = p, a.y = c, u = !0; break t } a.x = 0, a.y = 0, u = !1 } u && (o ? e.push(a.x) : e.push(a.y)), s = l } gi.free(a) } function Hu(t) { return (t = t.curve) === rc || t === oc } function Wu(t, i) { (i || Hu(t)) && (null === (i = t.diagram) || i.animationManager.isTicking || i.Pg.contains(t) || 0 === t.Dl.width && 0 === t.Dl.height || i.Pg.add(t, t.Dl.copy())) } function Ju(t, i, e) { var n; null === i || null === i.ka || !Hu(i) || (n = i.routeBounds).v() && (t.routeBounds.Gc(n) || e.Gc(n)) && (t.usesSamePort(i) || i.cc()) } function Zu(t) { var i = t.Qe; if (null !== i) { var e = t.lf; if (null !== e) { for (var n = t.Re, o = t.mf, r = t = null, s = i.Xa.j, a = s.length, h = 0; h < a; h++) { var l = s[h]; (l.Qe === i && l.Re === n && l.lf === e && l.mf === o || l.Qe === e && l.Re === o && l.lf === i && l.mf === n) && (null === r ? r = l : (null === t && (t = []).push(r), t.push(l))) } if (null !== t) { for (null === (r = yu(i, e, n, o)) && (gu(i, r = new mc(i, n, e, o)), gu(e, r)), r.links = t, i = 0; i < t.length; i++)t[i].Hf = r; r.mm() } } } } function $u(t) { var i = t.Hf; null !== i && (t.Hf = null, 0 <= (t = i.links.indexOf(t)) && (S(i.links, t), i.mm())) } pu.className = "Node", pu.SpreadingNone = Nu, pu.SpreadingEvenly = Cu, pu.SpreadingPacked = Tu, h(Lu, pu), Lu.prototype.cloneProtected = function (t) { pu.prototype.cloneProtected.call(this, t), this.P = -32769 & this.P, t.zo = this.zo, t.Bo = this.Bo, t.yi = this.yi, t.Op = this.Op; var i = t.gm(function (t) { return t instanceof Du }); t.Ra = i instanceof Du ? i : null, null !== this.ic ? (t.ic = this.ic.copy(), t.ic.group = t) : (null !== t.ic && (t.ic.group = null), t.ic = null) }, (t = Lu.prototype).sf = function (t) { pu.prototype.sf.call(this, t); var i = t.gk(); for (t = t.memberParts; t.next();) { var e = t.value; if (e.o(), e.C(8), e.Yj(), e instanceof pu) e.fd(i); else if (e instanceof Fu) for (e = e.labelNodes; e.next();)e.value.fd(i) } }, t.vk = function (t, i, e, n, o, r, s) { var a; t === we && "elements" === i ? o instanceof Du ? null === this.Ra ? this.Ra = o : this.Ra !== o && B("Cannot insert a second Placeholder into the visual tree of a Group.") : o instanceof xh && ((a = o.gm(function (t) { return t instanceof Du })) instanceof Du && (null === this.Ra ? this.Ra = a : this.Ra !== a && B("Cannot insert a second Placeholder into the visual tree of a Group."))) : t === ke && "elements" === i && null !== this.Ra && (n === this.Ra || n instanceof xh && this.Ra.Ag(n)) && (this.Ra = null), pu.prototype.vk.call(this, t, i, e, n, o, r, s) }, t.Ch = function (t, i, e, n) { this.Xe = this.Ra, pu.prototype.Ch.call(this, t, i, e, n) }, t.zb = function () { this.memberParts.each(function (t) { t.zb() }), pu.prototype.zb.call(this) }, t.bj = function () { if (!pu.prototype.bj.call(this)) return !1; for (var t = this.memberParts; t.next();) { var i = t.value; if (i instanceof pu) { if (i.isVisible() && ra(i)) return !1 } else if (i instanceof Fu && i.isVisible() && ra(i) && i.fromNode !== this && i.toNode !== this) return !1 } return !0 }, t.dk = function () { if (0 < this.Ao.count) { var t = this.diagram; if (null !== t) for (var i = this.Ao.copy().iterator; i.next();)t.remove(i.value) } pu.prototype.dk.call(this) }, Lu.prototype.canAddMembers = function (t) { var i = this.diagram; if (null === i) return !1; for (i = i.commandHandler, t = Rs(t).iterator; t.next();)if (!i.isValidMember(this, t.value)) return !1; return !0 }, Lu.prototype.addMembers = function (t, i) { var e = this.diagram; if (null === e) return !1; e = e.commandHandler; var n = !0; for (t = Rs(t).iterator; t.next();) { var o = t.value; !i || e.isValidMember(this, o) ? o.containingGroup = this : n = !1 } return n }, Lu.prototype.canUngroup = function () { if (!this.ungroupable) return !1; var t = this.layer; return !(null !== t && !t.allowUngroup) && !(null !== (t = t.diagram) && !t.allowUngroup) }, (t = Lu.prototype).fd = function (t) { void 0 === t && (t = null); var i = 0 != (65536 & this.P); if (pu.prototype.fd.call(this, t), !i) for (0 != (65536 & this.P) != !0 && (this.P = 65536 ^ this.P), i = this.uv(); i.next();) { var e, n = i.value; null !== t && t.contains(n) || (null !== (e = n.fromNode) && e !== this && e.Xd(this) && !e.isVisible() ? (vu(e, n.fromPort), vu(e, n.toPort), n.Ta()) : null !== (e = n.toNode) && e !== this && e.Xd(this) && !e.isVisible() && (vu(e, n.fromPort), vu(e, n.toPort), n.Ta())) } }, t.uv = function () { var t = this.gk(); t.add(this); for (var i = new $, e = t.iterator; e.next();) { var n = e.value; if (n instanceof pu) for (n = n.linksConnected; n.next();) { var o = n.value; t.contains(o) || i.add(o) } } return i.iterator }, t.mz = function () { var t = this.gk(); t.add(this); for (var i = new $, e = t.iterator; e.next();) { var n = e.value; if (n instanceof pu) for (n = n.linksConnected; n.next();) { var o = n.value, r = o.fromNode; t.contains(r) && r !== this || i.add(r), o = o.toNode, t.contains(o) && o !== this || i.add(o) } } return i.iterator }, t.lz = function () { var t = new $; return function t(i, e) { null !== i && (e.add(i), t(i.containingGroup, e)) }(this, t), t }, t.gk = function () { var t = new $; return cu(t, this, !0, 0, !0), t.remove(this), t }, t.Ob = function (t) { pu.prototype.Ob.call(this, t); for (var i = this.memberParts; i.next();)i.value.Ob(t) }, Lu.prototype.collapseSubGraph = function () { var t, i = this.diagram; null === i || i.Ee || (i.Ee = !0, t = this.gk(), function t(i, e, n, o) { for (var r = i.memberParts; r.next();) { var s = r.value; if (s.Ob(!1), s instanceof Lu && s.isSubGraphExpanded && (s.wasSubGraphExpanded = s.isSubGraphExpanded, t(s, e, n, o)), s instanceof pu) s.fd(e), n.Tj(s, o); else if (s instanceof Fu) for (s = s.labelNodes; s.next();)s.value.fd(e) } i.isSubGraphExpanded = !1 }(this, t, i, this), i.Ee = !1) }, Lu.prototype.expandSubGraph = function () { var t, i = this.diagram; null === i || i.Ee || (i.Ee = !0, t = this.gk(), function t(i, e, n, o) { for (var r = i.memberParts; r.next();) { var s = r.value; if (s.Ob(!0), s instanceof Lu && s.wasSubGraphExpanded && (s.wasSubGraphExpanded = !1, t(s, e, n, o)), s instanceof pu) s.fd(e), n.Vj(s, o); else if (s instanceof Fu) for (s = s.labelNodes; s.next();)s.value.fd(e) } i.isSubGraphExpanded = !0 }(this, t, i, this), i.Ee = !1) }, Lu.prototype.move = function (t, i) { void 0 === i && (i = !1); var e, n, o = (r = i ? this.location : this.position).x, r = r.y, s = t.x, a = t.y; if (!(o === s || isNaN(o) && isNaN(s)) || !(r === a || isNaN(r) && isNaN(a))) { for (o = s - (isNaN(o) ? 0 : o), r = a - (isNaN(r) ? 0 : r), a = gi.alloc(), pu.prototype.move.call(this, t, i), t = new $, i = this.gk().iterator; i.next();)(s = i.value) instanceof Fu && (s.suspendsRouting && t.add(s), s.ld || s.fromNode !== this && s.toNode !== this) && (s.suspendsRouting = !0); for (i.reset(); i.next();) { (s = i.value).Hh() || s instanceof pu && s.isLinkLabel || (e = s.position, n = s.location, e.v() ? (a.x = e.x + o, a.y = e.y + r, s.position = a) : n.v() && (a.x = n.x + o, a.y = n.y + r, s.location = a)) } for (i.reset(); i.next();)(s = i.value) instanceof Fu && (s.suspendsRouting = t.contains(s), s.ld || s.fromNode !== this && s.toNode !== this) && (e = s.position, a.x = e.x + o, a.y = e.y + r, a.v() ? s.move(a) : s.Ta(), Yu(s) && s.Ta()); gi.free(a) } }, l.Object.defineProperties(Lu.prototype, { placeholder: { get: function () { return this.Ra } }, computesBoundsAfterDrag: { get: function () { return 0 != (2048 & this.P) }, set: function (t) { var i = 0 != (2048 & this.P); i !== t && (this.P ^= 2048, this.g("computesBoundsAfterDrag", i, t)) } }, computesBoundsIncludingLinks: { get: function () { return 0 != (4096 & this.P) }, set: function (t) { var i = 0 != (4096 & this.P); i !== t && (this.P ^= 4096, this.g("computesBoundsIncludingLinks", i, t)) } }, computesBoundsIncludingLocation: { get: function () { return 0 != (8192 & this.P) }, set: function (t) { var i = 0 != (8192 & this.P); i !== t && (this.P ^= 8192, this.g("computesBoundsIncludingLocation", i, t)) } }, handlesDragDropForMembers: { get: function () { return 0 != (16384 & this.P) }, set: function (t) { var i = 0 != (16384 & this.P); i !== t && (this.P ^= 16384, this.g("handlesDragDropForMembers", i, t)) } }, memberParts: { get: function () { return this.Ao.iterator } }, layout: { get: function () { return this.ic }, set: function (t) { var i, e = this.ic; e !== t && (null !== e && (e.diagram = null, e.group = null), this.ic = t, i = this.diagram, null !== t && (t.diagram = i, t.group = this), null !== i && (i.Ff = !0), this.g("layout", e, t), null !== i && i.Pb()) } }, memberAdded: { get: function () { return this.zo }, set: function (t) { var i = this.zo; i !== t && (this.zo = t, this.g("memberAdded", i, t)) } }, memberRemoved: { get: function () { return this.Bo }, set: function (t) { var i = this.Bo; i !== t && (this.Bo = t, this.g("memberRemoved", i, t)) } }, memberValidation: { get: function () { return this.yi }, set: function (t) { var i = this.yi; i !== t && (this.yi = t, this.g("memberValidation", i, t)) } }, ungroupable: { get: function () { return 0 != (256 & this.P) }, set: function (t) { var i = 0 != (256 & this.P); i !== t && (this.P ^= 256, this.g("ungroupable", i, t)) } }, isSubGraphExpanded: { get: function () { return 0 != (512 & this.P) }, set: function (t) { var i, e, n = 0 != (512 & this.P); n !== t && (this.P ^= 512, i = this.diagram, this.g("isSubGraphExpanded", n, t), null !== (n = this.subGraphExpandedChanged) && (e = !0, null !== i && (e = i.Z, i.Z = !0), n(this), null !== i && (i.Z = e)), null !== i && i.undoManager.isUndoingRedoing ? (null !== this.Ra && this.Ra.o(), this.memberParts.each(function (t) { t.updateAdornments() })) : t ? this.expandSubGraph() : this.collapseSubGraph()) } }, wasSubGraphExpanded: { get: function () { return 0 != (1024 & this.P) }, set: function (t) { var i = 0 != (1024 & this.P); i !== t && (this.P ^= 1024, this.g("wasSubGraphExpanded", i, t)) } }, subGraphExpandedChanged: { get: function () { return this.Op }, set: function (t) { var i = this.Op; i !== t && (this.Op = t, this.g("subGraphExpandedChanged", i, t)) } }, uk: { get: function () { return 0 != (32768 & this.P) }, set: function (t) { 0 != (32768 & this.P) !== t && (this.P ^= 32768) } } }), Lu.prototype.expandSubGraph = Lu.prototype.expandSubGraph, Lu.prototype.collapseSubGraph = Lu.prototype.collapseSubGraph, Lu.prototype.findSubGraphParts = Lu.prototype.gk, Lu.prototype.findContainingGroupChain = Lu.prototype.lz, Lu.prototype.findExternalNodesConnected = Lu.prototype.mz, Lu.prototype.findExternalLinksConnected = Lu.prototype.uv, Lu.prototype.ensureBounds = Lu.prototype.zb, Lu.className = "Group", h(Du, Es), Du.prototype.cloneProtected = function (t) { Es.prototype.cloneProtected.call(this, t), t.eb = this.eb.G(), t.vp = this.vp.copy() }, Du.prototype.Eh = function (t) { if (null === this.background && null === this.areaBackground) return !1; var i = this.naturalBounds; return Et(0, 0, i.width, i.height, t.x, t.y) }, Du.prototype.rm = function () { var t = this.part; if (null !== t && (t instanceof Lu || t instanceof du) || B("Placeholder is not inside a Group or Adornment."), t instanceof Lu) { var i = this.computeBorder(this.vp), e = this.minSize, n = this.oc; for (jt(n, (isFinite(e.width) ? Math.max(e.width, i.width) : i.width) || 0, (isFinite(e.height) ? Math.max(e.height, i.height) : i.height) || 0), Ys(this, 0, 0, n.width, n.height), n = t.memberParts, e = !1; n.next();)if (n.value.isVisible()) { e = !0; break } n = t.diagram, !e || null === n || n.animationManager.Kv(t) || isNaN(i.x) || isNaN(i.y) || ((e = gi.alloc()).dj(i, t.locationSpot), e.w(t.location) || (t.location = new gi(e.x, e.y)), gi.free(e)) } else { i = this.oc, n = (e = this.eb).left + e.right; var o = e.top + e.bottom, r = t.adornedObject; t.angle = r.Xi(); var s = 0; r instanceof Kh && (s = r.strokeWidth); var a = r.uf(), h = r.naturalBounds, l = (h.width + s) * a, s = (h.height + s) * a; t.type !== xh.Link && (r = r.ga("Selection" === t.category ? Ht : t.locationSpot, gi.alloc()), t.location = r, gi.free(r)), isNaN(l) || isNaN(s) ? (l = (t = t.adornedObject).ga(Ht, gi.alloc()), (r = yi.allocAt(l.x, l.y, 0, 0)).Ie(t.ga(ti, l)), r.Ie(t.ga(Wt, l)), r.Ie(t.ga(Qt, l)), jt(i, r.width + n || 0, r.height + o || 0), Ys(this, -e.left, -e.top, i.width, i.height), gi.free(l), yi.free(r)) : (jt(i, l + n || 0, s + o || 0), Ys(this, -e.left, -e.top, i.width, i.height)) } }, Du.prototype.Ch = function (t, i, e, n) { this.actualBounds.h(t, i, e, n) }, Du.prototype.computeBorder = function (t) { var i = this.part, e = i.diagram; if (null !== e && i instanceof Lu && !i.layer.isTemporary && i.computesBoundsAfterDrag && this.vp.v()) { var n = e.toolManager.findTool("Dragging"); if (n === e.currentTool && null !== (e = n.computeBorder(i, this.vp, t))) return e } e = yi.alloc(), n = this.computeMemberBounds(e); var o = this.eb; return i instanceof Lu && !i.isSubGraphExpanded ? t.h(n.x - o.left, n.y - o.top, 0, 0) : t.h(n.x - o.left, n.y - o.top, Math.max(n.width + o.left + o.right, 0), Math.max(n.height + o.top + o.bottom, 0)), yi.free(e), i instanceof Lu && i.computesBoundsIncludingLocation && i.location.v() && t.Ie(i.location), t }, Du.prototype.computeMemberBounds = function (t) { if (!(this.part instanceof Lu)) return t.h(0, 0, 0, 0), t; for (var i = this.part, e = 1 / 0, n = 1 / 0, o = -1 / 0, r = -1 / 0, s = i.memberParts; s.next();) { var a = s.value; if (a.isVisible()) { if (a instanceof Fu) { if (!i.computesBoundsIncludingLinks) continue; if (na(a)) continue; if (a.fromNode === i || a.toNode === i) continue } (a = a.actualBounds).left < e && (e = a.left), a.top < n && (n = a.top), a.right > o && (o = a.right), a.bottom > r && (r = a.bottom) } } return isFinite(e) && isFinite(n) ? t.h(e, n, o - e, r - n) : (i = i.location, t.h(i.x, i.y, 0, 0)), t }, l.Object.defineProperties(Du.prototype, { padding: { get: function () { return this.eb }, set: function (t) { "number" == typeof t && (t = new Xt(t)); var i = this.eb; i.w(t) || (this.eb = t = t.G(), this.g("padding", i, t)) } } }), Du.className = "Placeholder", h(Fu, Hl), Fu.prototype.cloneProtected = function (t) { Hl.prototype.cloneProtected.call(this, t), t.Pa = -113 & this.Pa, t.Re = this.Re, t.Nn = this.Nn, t.mf = this.mf, t.Wp = this.Wp, t.Dk = this.Dk, t.pn = this.pn, t.rn = this.rn, t.sn = this.sn, t.Lj = this.Lj, t.Jp = this.Jp, null !== this.O && (t.O = this.O.copy()) }, (t = Fu.prototype).sf = function (t) { Hl.prototype.sf.call(this, t), this.Re = t.Re, this.mf = t.mf, t.gh = null, t.Ta(), t.Hf = this.Hf; var i = t.fromPort; null !== i && vu(t.fromNode, i), null !== (i = t.toPort) && vu(t.toNode, i) }, t.fb = function (t) { t.classType === Fu ? 2 == (2 & t.value) ? this.routing = t : t === nc || t === oc || t === rc ? this.curve = t : t === sc || t === ac || t === hc ? this.adjusting = t : t !== Qu && t !== ec && B("Unknown Link enum value for a Link property: " + t) : Hl.prototype.fb.call(this, t) }, t.Ec = function () { null === this.O && (this.O = new Bc) }, t.bj = function () { var t = this.fromNode; if (null !== t) { var i = t.findVisibleNode(); if (null !== i && (t = i), ra(t) || ru(t)) return !1 } return null === (t = this.toNode) || (null !== (i = t.findVisibleNode()) && (t = i), !ra(t) && !ru(t)) }, t.kw = function () { return !1 }, t.Qt = function () { }, t.Wb = function () { return !1 }, Fu.prototype.computeAngle = function (t, i, e) { return Fu.computeAngle(i, e) }, Fu.computeAngle = function (t, i) { switch (t) { default: case ec: t = 0; break; case lc: t = i; break; case uc: t = i + 90; break; case cc: t = i - 90; break; case fc: t = i + 180; break; case dc: 90 < (t = qi.Aq(i)) && t < 270 && (t -= 180); break; case pc: 90 < (t = qi.Aq(i + 90)) && t < 270 && (t -= 180); break; case gc: 90 < (t = qi.Aq(i - 90)) && t < 270 && (t -= 180); break; case yc: if (45 < (t = qi.Aq(i)) && t < 135 || 225 < t && t < 315) return 0; 90 < t && t < 270 && (t -= 180) }return qi.Aq(t) }, (t = Fu.prototype).Gh = function () { var t = this.containingGroup; null !== t && this.fromNode !== t && this.toNode !== t && t.computesBoundsIncludingLinks && Hl.prototype.Gh.call(this) }, t.rt = function (t) { var i = this.fromNode; return t === i ? this.toNode : i }, t.Hz = function (t) { var i = this.fromPort; return t === i ? this.toPort : i }, t.rq = function (t) { var i, e, n; Hl.prototype.rq.call(this, t), Hu(this) && this.uq(this.actualBounds), t || ((i = null) !== (t = this.Qe) && xu(t, this, i = this.fromPort), null !== (e = this.lf) && (n = this.toPort, e === t && n === i || xu(e, this, n)), Zu(this)) }, t.sq = function (t) { var i, e, n; Hl.prototype.sq.call(this, t), Hu(this) && this.uq(this.actualBounds), t || ((i = null) !== (t = this.Qe) && bu(t, this, i = this.fromPort), null !== (e = this.lf) && (n = this.toPort, e === t && n === i || bu(e, this, n)), $u(this)) }, t.dk = function () { if (this.ld = !0, null !== this.bd) { var t = this.diagram; if (null !== t) for (var i = this.bd.copy().iterator; i.next();)t.remove(i.value) } null === this.data || null !== (t = this.diagram) && t.partManager.removeDataForLink(this) }, Fu.prototype.updateRelationshipsFromData = function () { var t; null === this.data || null !== (t = this.diagram) && t.partManager.updateRelationshipsFromData(this) }, Fu.prototype.move = function (t, i) { var e = i ? this.location : this.position, n = e.x; isNaN(n) && (n = 0); var o = e.y; for (isNaN(o) && (o = 0), n = t.x - n, o = t.y - o, !0 === i ? Hl.prototype.move.call(this, t, !1) : (t = gi.allocAt(e.x + n, e.y + o), Hl.prototype.move.call(this, t, !1), gi.free(t)), Iu(this, n, o), t = this.labelNodes; t.next();)e = (i = t.value).position, i.moveTo(e.x + n, e.y + o) }, Fu.prototype.canRelinkFrom = function () { if (!this.relinkableFrom) return !1; var t = this.layer; return null === t || !!t.allowRelink && !(null !== (t = t.diagram) && !t.allowRelink) }, Fu.prototype.canRelinkTo = function () { if (!this.relinkableTo) return !1; var t = this.layer; return null === t || !!t.allowRelink && !(null !== (t = t.diagram) && !t.allowRelink) }, Fu.prototype.computeMidPoint = function (t) { var i, e, n = this.pointsCount; if (0 === n) return t.assign(Nt), t; if (1 === n) return t.assign(this.i(0)), t; if (2 === n) { var o = this.i(0), r = this.i(1); return t.h((o.x + r.x) / 2, (o.y + r.y) / 2), t } if (this.isOrthogonal && (15 <= this.computeCorner() || this.computeCurve() === nc)) return this.ka.Cv(.5, t), t.add(this.i(0)), o = this.ka.figures.first(), t.offset(-o.startX, -o.startY), t; if (this.computeCurve() === nc) return 3 === n ? this.i(1) : (o = 3 * ((r = (n - 1) / 3 | 0) / 2 | 0), 1 == r % 2 ? (r = this.i(o), i = this.i(o + 1), e = this.i(o + 2), o = this.i(o + 3), qi.Sy(r.x, r.y, i.x, i.y, e.x, e.y, o.x, o.y, t)) : t.assign(this.i(o)), t); var s = this.flattenedLengths; for (o = this.flattenedTotalLength, i = e = r = 0; r < o / 2 && e < n && !(o / 2 < r + (i = s[e]));)r += i, e++; return n = this.i(e), e = this.i(e + 1), Math.abs(n.x - e.x) < 1 ? n.y > e.y ? t.h(n.x, n.y - (o / 2 - r)) : t.h(n.x, n.y + (o / 2 - r)) : Math.abs(n.y - e.y) < 1 ? n.x > e.x ? t.h(n.x - (o / 2 - r), n.y) : t.h(n.x + (o / 2 - r), n.y) : (o = (o / 2 - r) / i, t.h(n.x + o * (e.x - n.x), n.y + o * (e.y - n.y))), t }, Fu.prototype.computeMidAngle = function () { var t = this.pointsCount; if (t < 2) return NaN; if (2 === t) return this.i(0).Sa(this.i(1)); if (this.isOrthogonal && (15 <= this.computeCorner() || this.computeCurve() === nc)) return this.ka.Qx(.5); if (this.computeCurve() === nc && 4 <= t) { var i = (t - 1) / 3 | 0, e = 3 * (i / 2 | 0); if (1 == i % 2) { e = Math.floor(e), t = this.i(e), i = this.i(e + 1); var n = this.i(e + 2), e = this.i(e + 3); return qi.Ry(t.x, t.y, i.x, i.y, n.x, n.y, e.x, e.y) } if (0 < e && e + 1 < t) return this.i(e - 1).Sa(this.i(e + 1)) } i = this.flattenedLengths, n = this.flattenedTotalLength; var o, r = 0; for (e = 0; r < n / 2 && e < t && !(n / 2 < r + (o = i[e]));)r += o, e++; if (i = this.i(e), n = this.i(e + 1), Math.abs(i.x - n.x) < 1 && Math.abs(i.y - n.y) < 1) { if (0 < e && e + 2 < t) return this.i(e - 1).Sa(this.i(e + 2)) } else { if (Math.abs(i.x - n.x) < 1) return i.y > n.y ? 270 : 90; if (Math.abs(i.y - n.y) < 1) return i.x > n.x ? 180 : 0 } return i.Sa(n) }, (t = Fu.prototype).i = function (t) { return this.xb.j[t] }, t.jd = function (t, i) { this.xb.hd(t, i) }, t.K = function (t, i, e) { this.xb.hd(t, new gi(i, e)) }, t.Rz = function (t, i) { this.xb.tb(t, i) }, t.m = function (t, i, e) { this.xb.tb(t, new gi(i, e)) }, t.ze = function (t) { this.xb.add(t) }, t.qf = function (t, i) { this.xb.add(new gi(t, i)) }, t.aw = function (t) { this.xb.$a(t) }, t.Zj = function () { this.xb.clear() }, t.Kh = function () { null === this.gh && (this.gh = this.xb, this.xb = this.xb.copy()) }, t.rf = function () { if (null !== this.gh) { for (var t = this.gh, i = this.xb, e = 1 / 0, n = 1 / 0, o = t.j, r = o.length, s = 0; s < r; s++)var a = o[s], e = Math.min(a.x, e), n = Math.min(a.y, n); a = s = 1 / 0; for (var h = i.j, l = h.length, u = 0; u < l; u++) { var c = h[u], s = Math.min(c.x, s), a = Math.min(c.y, a); c.freeze() } if (i.freeze(), l === r) { for (r = 0; r < l; r++)if (u = o[r], c = h[r], u.x - e != c.x - s || u.y - n != c.y - a) { this.o(), this.cc(); break } } else this.o(), this.cc(); (this.gh = null) !== (e = this.diagram) && e.animationManager.qc && (this.lh = i), Ru(this), this.g("points", t, i) } }, t.hy = function () { null !== this.gh && (this.xb = this.gh, this.gh = null) }, t.Ta = function () { if (!this.suspendsRouting) { var t = this.diagram; if (t) { if (t.At.contains(this) || t.undoManager.isUndoingRedoing) return; if ((t = t.animationManager).isTicking && !t.isAnimating) return; null !== this.lh && !t.isTicking && t.isAnimating && (this.lh = null) } null !== (t = this.path) && (this.ld = !1, this.o(), t.o()) } }, t.hj = function () { if (!this.ld && !this.nv) { var t = !0; try { this.nv = !0, this.Kh(), t = this.computePoints() } finally { this.nv = !1, t ? this.rf() : this.hy() } } }, Fu.prototype.computePoints = function () { if (null === (s = this.diagram)) return !1; var t = this.fromNode, i = null; if (null === t ? (s.jh || (s.El = new Kh, s.El.desiredSize = gt, s.El.strokeWidth = 0, s.jh = new pu, s.jh.add(s.El), s.jh.zb()), this.defaultFromPoint && (s.jh.position = s.jh.location = this.defaultFromPoint, s.jh.zb(), t = s.jh, i = s.El)) : i = this.fromPort, null === i || t.isVisible() || (null !== (r = t.findVisibleNode()) && r !== t ? i = (t = r).port : t = r), null === (this.nx = t) || !t.location.v()) return !1; for (; !(null === i || i.actualBounds.v() && i.yf());)i = i.panel; if (null === i) return !1; var e = this.toNode, n = null; if (null === e ? (s.kh || (s.Fl = new Kh, s.Fl.desiredSize = gt, s.Fl.strokeWidth = 0, s.kh = new pu, s.kh.add(s.Fl), s.kh.zb()), this.defaultToPoint && (s.kh.position = s.kh.location = this.defaultToPoint, s.kh.zb(), e = s.kh, n = s.Fl)) : n = this.toPort, null === n || e.isVisible() || (null !== (s = e.findVisibleNode()) && s !== e ? n = (e = s).port : e = s), null === (this.ox = e) || !e.location.v()) return !1; for (; !(null === n || n.actualBounds.v() && n.yf());)n = n.panel; if (null === n) return !1; var o = this.pointsCount, r = this.computeSpot(!0, i), s = this.computeSpot(!1, n), a = Vu(r), h = Vu(s), l = i === n && null !== i, u = this.isOrthogonal, c = this.curve === nc; this.Qf = !(!l || u) && (c = !0); var f, d, p, g, y, m, v, x, b, w = this.computeAdjusting() === ec || l; return !u && !l && a && h ? (a = !1, !w && 3 <= o && (w = this.getLinkPoint(t, i, r, !0, !1, e, n), h = this.getLinkPoint(e, n, s, !1, !1, t, i), a = this.adjustPoints(0, w, o - 1, h)) && (w = this.getLinkPoint(t, i, r, !0, !1, e, n), h = this.getLinkPoint(e, n, s, !1, !1, t, i), this.adjustPoints(0, w, o - 1, h)), a || (this.Zj(), c ? (o = this.getLinkPoint(t, i, r, !0, !1, e, n), a = (w = this.getLinkPoint(e, n, s, !1, !1, t, i)).x - o.x, h = w.y - o.y, l = this.computeCurviness(), c = u = 0, f = p = o.x + a / 3, d = g = o.y + h / 3, d = qi.A(h, 0) ? 0 < a ? d - l : d + l : (u = -a / h, c = Math.sqrt(l * l / (u * u + 1)), l < 0 && (c = -c), u * ((f = (h < 0 ? -1 : 1) * c + p) - p) + g), y = p = o.x + 2 * a / 3, m = g = o.y + 2 * h / 3, m = qi.A(h, 0) ? 0 < a ? m - l : m + l : u * ((y = (h < 0 ? -1 : 1) * c + p) - p) + g, this.Zj(), this.ze(o), this.qf(f, d), this.qf(y, m), this.ze(w), this.jd(0, this.getLinkPoint(t, i, r, !0, !1, e, n)), this.jd(3, this.getLinkPoint(e, n, s, !1, !1, t, i))) : (r = this.getLinkPoint(t, i, r, !0, !1, e, n), s = this.getLinkPoint(e, n, s, !1, !1, t, i), this.hasCurviness() ? (w = s.x - r.x, e = s.y - r.y, n = this.computeCurviness(), o = t = r.x + w / 2, a = i = r.y + e / 2, a = qi.A(e, 0) ? 0 < w ? a - n : a + n : (w = -w / e, o = Math.sqrt(n * n / (w * w + 1)), n < 0 && (o = -o), w * ((o = (e < 0 ? -1 : 1) * o + t) - t) + i), this.ze(r), this.qf(o, a)) : this.ze(r), this.ze(s)))) : (c = this.isAvoiding, w && (u && c || l) && this.Zj(), v = l ? this.computeCurviness() : 0, c = this.getLinkPoint(t, i, r, !0, u, e, n), p = f = g = 0, !u && a && !l || (d = this.computeEndSegmentLength(t, i, r, !0), p = this.getLinkDirection(t, i, c, r, !0, u, e, n), l && (a || r.w(s) || !u && 1 === r.x + s.x && 1 === r.y + s.y) && (p -= u ? 90 : 30, v < 0 && (p -= 180)), p < 0 ? p += 360 : 360 <= p && (p -= 360), l && (d += Math.abs(v) * (u ? 1 : 2)), 0 === p ? g = d : 90 === p ? f = d : 180 === p ? g = -d : f = 270 === p ? -d : (g = d * Math.cos(p * Math.PI / 180), d * Math.sin(p * Math.PI / 180)), r.jc() && l && (d = i.ga(Zt, gi.alloc()), y = gi.allocAt(d.x + 1e3 * g, d.y + 1e3 * f), this.getLinkPointFromPoint(t, i, d, y, !0, c), gi.free(d), gi.free(y))), d = this.getLinkPoint(e, n, s, !1, u, t, i), b = m = y = 0, !u && h && !l || (x = this.computeEndSegmentLength(e, n, s, !1), b = this.getLinkDirection(e, n, d, s, !1, u, t, i), l && (h || r.w(s) || !u && 1 === r.x + s.x && 1 === r.y + s.y) && (b += u ? 0 : 30, v < 0 && (b += 180)), b < 0 ? b += 360 : 360 <= b && (b -= 360), l && (x += Math.abs(v) * (u ? 1 : 2)), 0 === b ? y = x : 90 === b ? m = x : 180 === b ? y = -x : m = 270 === b ? -x : (y = x * Math.cos(b * Math.PI / 180), x * Math.sin(b * Math.PI / 180)), s.jc() && l && (s = n.ga(Zt, gi.alloc()), r = gi.allocAt(s.x + 1e3 * y, s.y + 1e3 * m), this.getLinkPointFromPoint(e, n, s, r, !1, d), gi.free(s), gi.free(r))), s = c, !u && a && !l || (s = new gi(c.x + g, c.y + f)), r = d, !u && h && !l || (r = new gi(d.x + y, d.y + m)), !w && !u && a && 3 < o && this.adjustPoints(0, c, o - 2, r) ? this.jd(o - 1, d) : !w && !u && h && 3 < o && this.adjustPoints(1, s, o - 1, d) ? this.jd(0, c) : !w && (u ? 6 <= o : 4 < o) && this.adjustPoints(1, s, o - 2, r) ? (this.jd(0, c), this.jd(o - 1, d)) : (this.Zj(), this.ze(c), !u && a && !l || this.ze(s), u && this.addOrthoPoints(s, p, r, b, t, e), !u && h && !l || this.ze(r), this.ze(d))), !0 }, Fu.prototype.getLinkPointFromPoint = function (t, i, e, n, o, r) { return void 0 === r && (r = new gi), null === t || null === i ? r.assign(e) : (t.isVisible() || null !== (o = t.findVisibleNode()) && o !== t && (i = o.port), (t = null) === (o = i.panel) || o.be() || (o = o.panel), e = null === o ? (o = n.x, n = n.y, s = e.x, e.y) : (o = 1 / ((t = o.wd).m11 * t.m22 - t.m12 * t.m21), s = t.m22 * o, a = -t.m12 * o, h = -t.m21 * o, l = t.m11 * o, u = o * (t.m21 * t.dy - t.m22 * t.dx), c = o * (t.m12 * t.dx - t.m11 * t.dy), o = n.x * s + n.y * h + u, n = n.x * a + n.y * l + c, s = e.x * s + e.y * h + u, e.x * a + e.y * l + c), i.hk(o, n, s, e, r), null !== t && r.transform(t)), r; var s, a, h, l, u, c }, Fu.prototype.getLinkPoint = function (t, i, e, n, o, r, s, a) { if (void 0 === a && (a = new gi), e.gb() && !Vu(e)) return i.ga(e, a), a; if (e.gd()) { var h, l, u, c = zu(this, i); if (null !== c) return a.assign(c.xq), !o || this.routing !== ic || null !== (h = zu(this, s)) && c.dm < h.dm && (c = gi.alloc(), h = gi.alloc(), l = new yi(i.ga(Ht, c), i.ga(ti, h)), u = this.computeSpot(!n, s), t = this.getLinkPoint(r, s, u, !n, o, t, i, h), (e.wf(ei) || e.wf(ni)) && t.y >= l.y && t.y <= l.y + l.height ? a.y = t.y : (e.wf(ii) || e.wf(oi)) && t.x >= l.x && t.x <= l.x + l.width && (a.x = t.x), gi.free(c), gi.free(h)), a } return e = i.ga(.5 === e.x && .5 === e.y ? e : Zt, gi.alloc()), this.pointsCount > (o ? 6 : 2) ? (s = n ? this.i(1) : this.i(this.pointsCount - 2), o && (s = Eu(e, s.copy()))) : (c = this.computeSpot(!n, s), r = gi.alloc(), s = s.ga(.5 === c.x && .5 === c.y ? c : Zt, r), o && (s = Eu(e, s)), gi.free(r)), this.getLinkPointFromPoint(t, i, e, s, n, a), gi.free(e), a }, Fu.prototype.getLinkDirection = function (t, i, e, n, o, r, s, a) { t: if (n.gb()) var h = n.x > n.y ? n.x > 1 - n.y ? 0 : n.x < 1 - n.y ? 270 : 315 : n.x < n.y ? n.x > 1 - n.y ? 90 : n.x < 1 - n.y ? 180 : 135 : n.x < .5 ? 225 : .5 < n.x ? 45 : 0; else { if (n.gd() && null !== (h = zu(this, i))) switch (h.yc) { case 1: h = 270; break t; case 2: h = 180; break t; default: case 4: h = 0; break t; case 8: h = 90; break t }h = i.ga(Zt, gi.alloc()), this.pointsCount > (r ? 6 : 2) ? (a = o ? this.i(1) : this.i(this.pointsCount - 2), a = r ? Eu(h, a.copy()) : e) : (e = gi.alloc(), a = a.ga(Zt, e), gi.free(e)), e = Math.abs(a.x - h.x) > Math.abs(a.y - h.y) ? a.x >= h.x ? 0 : 180 : a.y >= h.y ? 90 : 270, gi.free(h), h = e } return n.jc() && s.Xd(t) && (360 <= (h += 180) && (h -= 360)), Vu(n) || 0 === (t = i.Xi()) || (45 <= t && t < 135 ? h += 90 : 135 <= t && t < 225 ? h += 180 : 225 <= t && t < 315 && (h += 270), 360 <= h && (h -= 360)), h }, Fu.prototype.computeEndSegmentLength = function (t, i, e, n) { return null !== i && e.gd() && null !== (t = zu(this, i)) ? t.sv : (t = n ? this.fromEndSegmentLength : this.toEndSegmentLength, null !== i && isNaN(t) && (t = n ? i.fromEndSegmentLength : i.toEndSegmentLength), isNaN(t) && (t = 10), t) }, Fu.prototype.computeSpot = function (t, i) { return void 0 === i && (i = null), t = t ? null === (t = i || this.fromPort) ? Zt : ((i = this.fromSpot).Mb() && (i = t.fromSpot), i === bi ? Kt : i) : null === (t = i || this.toPort) ? Zt : ((i = this.toSpot).Mb() && (i = t.toSpot), i === bi ? Kt : i) }, Fu.prototype.computeOtherPoint = function (t, i) { return this.computeAdjusting() !== ec && 4 < this.pointsCount ? this.computeMidPoint(new gi) : (t = i.ga(Zt), null !== (i = null !== (i = i.fp) ? Fc(i, this) : null) && (t = i.xq), t) }, Fu.prototype.computeShortLength = function (t) { var i; return t ? (t = this.fromShortLength, !isNaN(t) || null !== (i = this.fromPort) && (t = i.fromShortLength)) : (t = this.toShortLength, !isNaN(t) || null !== (i = this.toPort) && (t = i.toShortLength)), isNaN(t) ? 0 : t }, Fu.prototype.tf = function (t, i, e, n, o, r) { if (!1 === this.pickable) return !1; void 0 === i && (i = null), void 0 === e && (e = null); var s = r; if (void 0 === r && (s = Gi.alloc()).reset(), s.multiply(this.transform), this.Dh(t, s)) return Ch(this, i, e, o), void 0 === r && Gi.free(s), !0; if (this.Gc(t, s)) { var a = !1; if (!this.isAtomic) for (var h = this.V.j, l = h.length; l--;) { var u = h[l]; if (u.visible || u === this.locationObject) { var c = u.actualBounds, f = this.naturalBounds; if (!(c.x > f.width || c.y > f.height || c.x + c.width < 0 || c.y + c.height < 0)) { if ((c = Gi.alloc()).set(s), u instanceof xh) a = u.tf(t, i, e, n, o, c); else if (this.path === u) { if (u instanceof Kh) if (a = t, f = n, !1 === u.pickable) a = !1; else if (c.multiply(u.transform), f) t: { var d = a, p = c; if (u.Dh(d, p)) a = !0; else { if (void 0 === p && (p = u.transform, d.Be(u.actualBounds))) { a = !0; break t } a = d.left, f = d.right; var g = d.top, d = d.bottom, y = gi.alloc(), m = gi.alloc(), v = gi.alloc(), x = Gi.alloc(); x.set(p), x.Pv(u.transform), x.vt(), m.x = f, m.y = g, m.transform(x), y.x = a, y.y = g, y.transform(x), p = !1, $h(u, y, m, v) ? p = !0 : (y.x = f, y.y = d, y.transform(x), $h(u, y, m, v) ? p = !0 : (m.x = a, m.y = d, m.transform(x), $h(u, y, m, v) ? p = !0 : (y.x = a, y.y = g, y.transform(x), $h(u, y, m, v) && (p = !0)))), Gi.free(x), gi.free(y), gi.free(m), gi.free(v), a = p } } else a = u.Dh(a, c) } else a = Gs(u, t, n, c); a && (f = u, null !== i && (f = i(u)), f && (null === e || e(f)) && o.add(f)), Gi.free(c) } } } return void 0 === r && Gi.free(s), a || null !== this.background || null !== this.areaBackground } return void 0 === r && Gi.free(s), !1 }, Fu.prototype.computeCurve = function () { var t, i; return null === this.Qf && (t = this.fromPort, i = this.isOrthogonal, this.Qf = null !== t && t === this.toPort && !i), this.Qf ? nc : this.curve }, Fu.prototype.computeCorner = function () { if (this.curve === nc) return 0; var t = this.corner; return (isNaN(t) || t < 0) && (t = 10), t }, Fu.prototype.findMidLabel = function () { for (var t = this.path, i = this.V.j, e = i.length, n = 0; n < e; n++) { var o = i[n]; if (o !== t && !o.isPanelMain && (-1 / 0 === o.segmentIndex || isNaN(o.segmentIndex))) return o } for (t = this.labelNodes; t.next();)if (-1 / 0 === (i = t.value).segmentIndex || isNaN(i.segmentIndex)) return i; return null }, Fu.prototype.computeSpacing = function () { if (!this.isVisible()) return 0; var t, i, e, n, o = Math.max(14, this.computeThickness()), r = this.fromPort, s = this.toPort; return null === r || null === s || null !== (n = this.findMidLabel()) && (e = n.naturalBounds, t = n.margin, i = isNaN(e.width) ? 30 : e.width * n.scale + t.left + t.right, e = isNaN(e.height) ? 14 : e.height * n.scale + t.top + t.bottom, o = (n = n.segmentOrientation) === lc || n === dc || n === fc ? Math.max(o, e) : n === cc || n === gc || n === uc || n === pc ? Math.max(o, i) : (r = r.ga(Zt).Sa(s.ga(Zt)) / 180 * Math.PI, Math.max(o, Math.abs(Math.sin(r) * i) + Math.abs(Math.cos(r) * e) + 1)), this.curve === nc && (o *= 1.333)), o }, Fu.prototype.arrangeBundledLinks = function (t, i) { if (i) for (i = 0; i < t.length; i++) { var e = t[i]; e.computeAdjusting() === ec && e.Ta() } }, Fu.prototype.computeCurviness = function () { var t = this.curviness; if (isNaN(t)) { t = 16; var i = this.Hf; if (null !== i) { for (var e = zi(), n = 0, o = i.links, r = 0; r < o.length; r++) { var s = o[r].computeSpacing(); e.push(s), n += s } for (n = -n / 2, r = 0; r < o.length; r++) { if (o[r] === this) { t = n + e[r] / 2; break } n += e[r] } i.Dt === this.fromNode && (t = -t), Vi(e) } } return t }, Fu.prototype.computeThickness = function () { if (!this.isVisible()) return 0; var t = this.path; return null !== t ? Math.max(t.strokeWidth, 1) : 1 }, Fu.prototype.hasCurviness = function () { return !isNaN(this.curviness) || null !== this.Hf }, Fu.prototype.adjustPoints = function (t, i, e, n) { var o = this.computeAdjusting(); if (this.isOrthogonal) { if (o === ac) return !1; o === hc && (o = sc) } switch (o) { case ac: var r = this.i(t), s = this.i(e); if (!r.Ma(i) || !s.Ma(n)) { o = r.x, r = r.y; var a, h = s.x - o, l = s.y - r, u = Math.sqrt(h * h + l * l); if (!qi.$(u, 0)) { qi.$(h, 0) ? a = l < 0 ? -Math.PI / 2 : Math.PI / 2 : (a = Math.atan(l / Math.abs(h)), h < 0 && (a = Math.PI - a)), s = i.x; var c = i.y, h = n.x - s, f = n.y - c, l = Math.sqrt(h * h + f * f); for (qi.$(h, 0) ? f = f < 0 ? -Math.PI / 2 : Math.PI / 2 : (f = Math.atan(f / Math.abs(h)), h < 0 && (f = Math.PI - f)), u = l / u, a = f - a, this.jd(t, i), t += 1; t < e; t++)h = (i = this.i(t)).x - o, l = i.y - r, i = Math.sqrt(h * h + l * l), qi.$(i, 0) || (qi.$(h, 0) ? l = l < 0 ? -Math.PI / 2 : Math.PI / 2 : (l = Math.atan(l / Math.abs(h)), h < 0 && (l = Math.PI - l)), h = l + a, i *= u, this.K(t, s + i * Math.cos(h), c + i * Math.sin(h))); this.jd(e, n) } } return !0; case hc: if (r = this.i(t), c = this.i(e), !r.Ma(i) || !c.Ma(n)) { o = r.x, r = r.y, u = ((s = c.x) - o) * (s - o) + ((c = c.y) - r) * (c - r), h = i.x, a = i.y, l = n.x, f = n.y; var d, p = 1; for (0 != l - h ? (d = (f - a) / (l - h), p = Math.sqrt(1 + 1 / (d * d))) : d = 9e9, this.jd(t, i), t += 1; t < e; t++) { var g = (i = this.i(t)).x, y = i.y, m = .5; 0 !== u && (m = ((o - g) * (o - s) + (r - y) * (r - c)) / u); var v = o + m * (s - o), x = r + m * (c - r); i = Math.sqrt((g - v) * (g - v) + (y - x) * (y - x)), y < d * (g - v) + x && (i = -i), 0 < d && (i = -i), g = h + m * (l - h), m = a + m * (f - a), 0 !== d ? (i = g + i / p, this.K(t, i, m - (i - g) / d)) : this.K(t, g, m + i) } this.jd(e, n) } return !0; case sc: return e = this.isOrthogonal && (o = this.i(t), r = this.i(t + 1), s = this.i(t + 2), c = h = r.x, u = a = r.y, qi.A(o.y, r.y) ? qi.A(r.x, s.x) ? a = i.y : qi.A(r.y, s.y) && (h = i.x) : qi.A(o.x, r.x) && (qi.A(r.y, s.y) ? h = i.x : qi.A(r.x, s.x) && (a = i.y)), this.K(t + 1, h, a), o = this.i(e), r = this.i(e - 1), s = this.i(e - 2), l = h = r.x, f = a = r.y, qi.A(o.y, r.y) ? qi.A(r.x, s.x) ? a = n.y : qi.A(r.y, s.y) && (h = n.x) : qi.A(o.x, r.x) && (qi.A(r.y, s.y) ? h = n.x : qi.A(r.x, s.x) && (a = n.y)), this.K(e - 1, h, a), Yu(this)) ? (this.K(t + 1, c, u), this.K(e - 1, l, f), !1) : (this.jd(t, i), this.jd(e, n), !0); default: return !1 } }, Fu.prototype.addOrthoPoints = function (t, i, e, n, o, r) { i = -45 <= i && i < 45 ? 0 : 45 <= i && i < 135 ? 90 : 135 <= i && i < 225 ? 180 : 270, n = -45 <= n && n < 45 ? 0 : 45 <= n && n < 135 ? 90 : 135 <= n && n < 225 ? 180 : 270; var s, a, h, l, u, c, f, d, p, g = o.actualBounds.copy(), y = r.actualBounds.copy(); g.v() && y.v() && (g.Wc(8, 8), y.Wc(8, 8), g.Ie(t), y.Ie(e), 0 === i ? e.x > t.x || 270 === n && e.y < t.y && y.right > t.x || 90 === n && e.y > t.y && y.right > t.x ? (s = new gi(e.x, t.y), a = new gi(e.x, (t.y + e.y) / 2), 180 === n ? (s.x = this.computeMidOrthoPosition(t.x, t.y, e.x, e.y, !1), a.x = s.x, a.y = e.y) : 270 === n && e.y < t.y || 90 === n && e.y > t.y ? (s.x = t.x < y.left ? this.computeMidOrthoPosition(t.x, t.y, y.left, e.y, !1) : t.x < y.right && (270 === n && t.y < y.top || 90 === n && t.y > y.bottom) ? this.computeMidOrthoPosition(t.x, t.y, e.x, e.y, !1) : y.right, a.x = s.x, a.y = e.y) : 0 === n && t.x < y.left && t.y > y.top && t.y < y.bottom && (s.x = t.x, s.y = t.y < e.y ? Math.min(e.y, y.top) : Math.max(e.y, y.bottom), a.y = s.y)) : (s = new gi(t.x, e.y), a = new gi((t.x + e.x) / 2, e.y), (180 === n || 90 === n && e.y < g.top || 270 === n && e.y > g.bottom) && (180 === n && (y.aa(t) || g.aa(e)) ? s.y = this.computeMidOrthoPosition(t.x, t.y, e.x, e.y, !0) : e.y < t.y && (180 === n || 90 === n) ? s.y = this.computeMidOrthoPosition(t.x, g.top, e.x, Math.max(e.y, y.bottom), !0) : e.y > t.y && (180 === n || 270 === n) && (s.y = this.computeMidOrthoPosition(t.x, g.bottom, e.x, Math.min(e.y, y.top), !0)), a.x = e.x, a.y = s.y), s.y > g.top && s.y < g.bottom && (e.x >= g.left && e.x <= t.x || t.x <= y.right && t.x >= e.x ? 90 !== n && 270 !== n || (s = new gi(Math.max((t.x + e.x) / 2, t.x), t.y), a = new gi(s.x, e.y)) : (s.y = 270 === n || (0 === n || 180 === n) && e.y < t.y ? Math.min(e.y, 0 === n ? g.top : Math.min(g.top, y.top)) : Math.max(e.y, 0 === n ? g.bottom : Math.max(g.bottom, y.bottom)), a.x = e.x, a.y = s.y))) : 180 === i ? e.x < t.x || 270 === n && e.y < t.y && y.left < t.x || 90 === n && e.y > t.y && y.left < t.x ? (s = new gi(e.x, t.y), a = new gi(e.x, (t.y + e.y) / 2), 0 === n ? (s.x = this.computeMidOrthoPosition(t.x, t.y, e.x, e.y, !1), a.x = s.x, a.y = e.y) : 270 === n && e.y < t.y || 90 === n && e.y > t.y ? (s.x = t.x > y.right ? this.computeMidOrthoPosition(t.x, t.y, y.right, e.y, !1) : t.x > y.left && (270 === n && t.y < y.top || 90 === n && t.y > y.bottom) ? this.computeMidOrthoPosition(t.x, t.y, e.x, e.y, !1) : y.left, a.x = s.x, a.y = e.y) : 180 === n && t.x > y.right && t.y > y.top && t.y < y.bottom && (s.x = t.x, s.y = t.y < e.y ? Math.min(e.y, y.top) : Math.max(e.y, y.bottom), a.y = s.y)) : (s = new gi(t.x, e.y), a = new gi((t.x + e.x) / 2, e.y), (0 === n || 90 === n && e.y < g.top || 270 === n && e.y > g.bottom) && (0 === n && (y.aa(t) || g.aa(e)) ? s.y = this.computeMidOrthoPosition(t.x, t.y, e.x, e.y, !0) : e.y < t.y && (0 === n || 90 === n) ? s.y = this.computeMidOrthoPosition(t.x, g.top, e.x, Math.max(e.y, y.bottom), !0) : e.y > t.y && (0 === n || 270 === n) && (s.y = this.computeMidOrthoPosition(t.x, g.bottom, e.x, Math.min(e.y, y.top), !0)), a.x = e.x, a.y = s.y), s.y > g.top && s.y < g.bottom && (e.x <= g.right && e.x >= t.x || t.x >= y.left && t.x <= e.x ? 90 !== n && 270 !== n || (s = new gi(Math.min((t.x + e.x) / 2, t.x), t.y), a = new gi(s.x, e.y)) : (s.y = 270 === n || (0 === n || 180 === n) && e.y < t.y ? Math.min(e.y, 180 === n ? g.top : Math.min(g.top, y.top)) : Math.max(e.y, 180 === n ? g.bottom : Math.max(g.bottom, y.bottom)), a.x = e.x, a.y = s.y))) : 90 === i ? e.y > t.y || 180 === n && e.x < t.x && y.bottom > t.y || 0 === n && e.x > t.x && y.bottom > t.y ? (s = new gi(t.x, e.y), a = new gi((t.x + e.x) / 2, e.y), 270 === n ? (s.y = this.computeMidOrthoPosition(t.x, t.y, e.x, e.y, !0), a.x = e.x, a.y = s.y) : 180 === n && e.x < t.x || 0 === n && e.x > t.x ? (s.y = t.y < y.top ? this.computeMidOrthoPosition(t.x, t.y, e.x, y.top, !0) : t.y < y.bottom && (180 === n && t.x < y.left || 0 === n && t.x > y.right) ? this.computeMidOrthoPosition(t.x, t.y, e.x, e.y, !0) : y.bottom, a.x = e.x, a.y = s.y) : 90 === n && t.y < y.top && t.x > y.left && t.x < y.right && (s.x = t.x < e.x ? Math.min(e.x, y.left) : Math.max(e.x, y.right), s.y = t.y, a.x = s.x)) : (s = new gi(e.x, t.y), a = new gi(e.x, (t.y + e.y) / 2), (270 === n || 0 === n && e.x < g.left || 180 === n && e.x > g.right) && (270 === n && (y.aa(t) || g.aa(e)) ? s.x = this.computeMidOrthoPosition(t.x, t.y, e.x, e.y, !1) : e.x < t.x && (270 === n || 0 === n) ? s.x = this.computeMidOrthoPosition(g.left, t.y, Math.max(e.x, y.right), e.y, !1) : e.x > t.x && (270 === n || 180 === n) && (s.x = this.computeMidOrthoPosition(g.right, t.y, Math.min(e.x, y.left), e.y, !1)), a.x = s.x, a.y = e.y), s.x > g.left && s.x < g.right && (e.y >= g.top && e.y <= t.y || t.y <= y.bottom && t.y >= e.y ? 0 !== n && 180 !== n || (s = new gi(t.x, Math.max((t.y + e.y) / 2, t.y)), a = new gi(e.x, s.y)) : (s.x = 180 === n || (90 === n || 270 === n) && e.x < t.x ? Math.min(e.x, 90 === n ? g.left : Math.min(g.left, y.left)) : Math.max(e.x, 90 === n ? g.right : Math.max(g.right, y.right)), a.x = s.x, a.y = e.y))) : e.y < t.y || 180 === n && e.x < t.x && y.top < t.y || 0 === n && e.x > t.x && y.top < t.y ? (s = new gi(t.x, e.y), a = new gi((t.x + e.x) / 2, e.y), 90 === n ? (s.y = this.computeMidOrthoPosition(t.x, t.y, e.x, e.y, !0), a.x = e.x, a.y = s.y) : 180 === n && e.x < t.x || 0 === n && e.x >= t.x ? (s.y = t.y > y.bottom ? this.computeMidOrthoPosition(t.x, t.y, e.x, y.bottom, !0) : t.y > y.top && (180 === n && t.x < y.left || 0 === n && t.x > y.right) ? this.computeMidOrthoPosition(t.x, t.y, e.x, e.y, !0) : y.top, a.x = e.x, a.y = s.y) : 270 === n && t.y > y.bottom && t.x > y.left && t.x < y.right && (s.x = t.x < e.x ? Math.min(e.x, y.left) : Math.max(e.x, y.right), s.y = t.y, a.x = s.x)) : (s = new gi(e.x, t.y), a = new gi(e.x, (t.y + e.y) / 2), (90 === n || 0 === n && e.x < g.left || 180 === n && e.x > g.right) && (90 === n && (y.aa(t) || g.aa(e)) ? s.x = this.computeMidOrthoPosition(t.x, t.y, e.x, e.y, !1) : e.x < t.x && (90 === n || 0 === n) ? s.x = this.computeMidOrthoPosition(g.left, t.y, Math.max(e.x, y.right), e.y, !1) : e.x > t.x && (90 === n || 180 === n) && (s.x = this.computeMidOrthoPosition(g.right, t.y, Math.min(e.x, y.left), e.y, !1)), a.x = s.x, a.y = e.y), s.x > g.left && s.x < g.right && (e.y <= g.bottom && e.y >= t.y || t.y >= y.top && t.y <= e.y ? 0 !== n && 180 !== n || (s = new gi(t.x, Math.min((t.y + e.y) / 2, t.y)), a = new gi(e.x, s.y)) : (s.x = 180 === n || (90 === n || 270 === n) && e.x < t.x ? Math.min(e.x, 270 === n ? g.left : Math.min(g.left, y.left)) : Math.max(e.x, 270 === n ? g.right : Math.max(g.right, y.right)), a.x = s.x, a.y = e.y))), h = s, l = a, u = e, (i = !!this.isAvoiding && (!(null === (c = this.diagram) || !Br(c) || g.aa(u) && !r.Xd(o) || y.aa(t) && !o.Xd(r) || o === r || this.layer.isTemporary) && (f = Ir(c, !0, this.containingGroup, null), !(17 !== this.segmentIndex && f.lk(Math.min(t.x, h.x), Math.min(t.y, h.y), Math.abs(t.x - h.x), Math.abs(t.y - h.y)) && f.lk(Math.min(h.x, l.x), Math.min(h.y, l.y), Math.abs(h.x - l.x), Math.abs(h.y - l.y)) && f.lk(Math.min(l.x, u.x), Math.min(l.y, u.y), Math.abs(l.x - u.x), Math.abs(l.y - u.y))) && (o = t, r = u, d = e = null, c.isVirtualized && ((c = f.bounds.copy()).Wc(-f.cm, -f.bm), p = gi.alloc(), xc(f, t.x, t.y) || (qi.Vc(c.x, c.y, c.x + c.width, c.y + c.height, t.x, t.y, h.x, h.y, p) ? (e = t = p.copy(), i = p.Sa(h)) : qi.Vc(c.x, c.y, c.x + c.width, c.y + c.height, h.x, h.y, l.x, l.y, p) ? (e = t = p.copy(), i = p.Sa(l)) : qi.Vc(c.x, c.y, c.x + c.width, c.y + c.height, l.x, l.y, u.x, u.y, p) && (e = t = p.copy(), i = p.Sa(u))), xc(f, u.x, u.y) || (qi.Vc(c.x, c.y, c.x + c.width, c.y + c.height, u.x, u.y, l.x, l.y, p) ? (d = u = p.copy(), n = l.Sa(p)) : qi.Vc(c.x, c.y, c.x + c.width, c.y + c.height, l.x, l.y, h.x, h.y, p) ? (d = u = p.copy(), n = h.Sa(p)) : qi.Vc(c.x, c.y, c.x + c.width, c.y + c.height, h.x, h.y, t.x, t.y, p) && (d = u = p.copy(), n = t.Sa(p))), gi.free(p)), g = g.copy().Hc(y), y = f.wA, g.Wc(f.cm * y, f.bm * y), Nc(f, t, i, u, n, g), y = bc(f, u.x, u.y), !f.abort && Lc <= y && (kc(f), y = f.$z, g.Wc(f.cm * y, f.bm * y), Nc(f, t, i, u, n, g), y = bc(f, u.x, u.y)), !f.abort && Lc <= y && f.DA && (kc(f), Nc(f, t, i, u, n, f.bounds), y = bc(f, u.x, u.y)), !f.abort && y < Lc && bc(f, u.x, u.y) !== Cc && (function t(i, e, n, o, r, s) { var a = e.cm, h = e.bm, l = bc(e, n, o), u = n, c = o; for (0 === r ? u += a : 90 === r ? c += h : 180 === r ? u -= a : c -= h; Tc < l && bc(e, u, c) === l - 1;)n = u, o = c, 0 === r ? u += a : 90 === r ? c += h : 180 === r ? u -= a : c -= h, --l; s ? Tc < l && (180 === r || 0 === r ? n = Math.floor(n / a) * a + a / 2 : 90 !== r && 270 !== r || (o = Math.floor(o / h) * h + h / 2)) : (n = Math.floor(n / a) * a + a / 2, o = Math.floor(o / h) * h + h / 2); Tc < l && (s = r, u = n, c = o, 0 === r ? (s = 90, c += h) : 90 === r ? (s = 180, u -= a) : 180 === r ? (s = 270, c -= h) : 270 === r && (s = 0, u += a), bc(e, u, c) === l - 1 ? t(i, e, u, c, s, !1) : (u = n, c = o, 0 === r ? (s = 270, c -= h) : 90 === r ? (s = 0, u += a) : 180 === r ? (s = 90, c += h) : 270 === r && (s = 180, u -= a), bc(e, u, c) === l - 1 && t(i, e, u, c, s, !1))); i.qf(n, o) }(this, f, u.x, u.y, n, !0), g = this.i(2), this.pointsCount < 4 ? (0 === i || 180 === i ? (g.x = t.x, g.y = u.y) : (g.x = u.x, g.y = t.y), this.K(2, g.x, g.y), this.m(3, g.x, g.y)) : (u = this.i(3), 0 === i || 180 === i ? qi.A(g.x, u.x) ? (g = 0 === i ? Math.max(g.x, t.x) : Math.min(g.x, t.x), this.K(2, g, t.y), this.K(3, g, u.y)) : qi.A(g.y, u.y) ? (Math.abs(t.y - g.y) <= f.bm / 2 && (this.K(2, g.x, t.y), this.K(3, u.x, t.y)), this.m(2, g.x, t.y)) : this.K(2, t.x, g.y) : 90 !== i && 270 !== i || (qi.A(g.y, u.y) ? (g = 90 === i ? Math.max(g.y, t.y) : Math.min(g.y, t.y), this.K(2, t.x, g), this.K(3, u.x, g)) : qi.A(g.x, u.x) ? (Math.abs(t.x - g.x) <= f.cm / 2 && (this.K(2, t.x, g.y), this.K(3, t.x, u.y)), this.m(2, t.x, g.y)) : this.K(2, g.x, t.y))), null !== e && (t = this.i(1), u = this.i(2), t.x !== u.x && t.y !== u.y ? 0 === i || 180 === i ? this.m(2, t.x, u.y) : this.m(2, u.x, t.y) : 0 === i || 180 === i ? this.m(2, o.x, e.y) : this.m(2, e.x, o.y)), null !== d && (0 === n || 180 === n ? this.qf(r.x, d.y) : this.qf(d.x, r.y)), !0))))) || (this.ze(s), this.ze(a))) }, Fu.prototype.computeMidOrthoPosition = function (t, i, e, n, o) { var r = 0; return this.hasCurviness() && (r = this.computeCurviness()), o ? (i + n) / 2 + r : (t + e) / 2 + r }, Fu.prototype.iz = function (t) { var i = t.x; t = t.y; for (var e = this.i(0), n = this.i(1), o = ft(i, t, e.x, e.y, n.x, n.y), r = 0, s = 1; s < this.pointsCount - 1; s++) { e = this.i(s + 1); var a = ft(i, t, n.x, n.y, e.x, e.y), n = e; a < o && (r = s, o = a) } return r }, Fu.prototype.cc = function () { this.Zn = !0 }, Fu.prototype.nk = function (t) { if (!t) { if (!1 === this.ld) return; if (t = this.Ab(), !this.Zn && (null === t || null !== t.geometry)) return } if (this.ka = this.makeGeometry(), null !== (t = this.path)) { t.ka = this.ka; for (var i = this.V.j, e = i.length, n = 0; n < e; n++) { var o = i[n]; o !== t && o.isPanelMain && o instanceof Kh && (o.ka = this.ka) } } }, Fu.prototype.makeGeometry = function () { var t = this.ka, i = this.pointsCount; if (i < 2) return t.type = ee, this.Zn = !1, t; var e = !1; null !== (a = this.diagram) && Hu(this) && a.Pg.contains(this) && (0 !== this.Dl.width || 0 !== this.Dl.height) && (e = !0); var n = this.i(0).copy(), o = n.copy(); a = this.xb.j; var r = this.computeCurve(); if (r === nc && 3 <= i && !qi.$(this.smoothness, 0)) if (3 === i) { var s = this.i(1), a = Math.min(n.x, s.x), h = Math.min(n.y, s.y), s = this.i(2); a = Math.min(a, s.x), h = Math.min(h, s.y) } else { if (this.isOrthogonal) for (h = 0; h < i; h++)s = a[h], o.x = Math.min(s.x, o.x), o.y = Math.min(s.y, o.y); else for (a = 3; a < i; a += 3)i <= a + 3 && (a = i - 1), h = this.i(a), o.x = Math.min(h.x, o.x), o.y = Math.min(h.y, o.y); a = o.x, h = o.y } else { for (h = 0; h < i; h++)s = a[h], o.x = Math.min(s.x, o.x), o.y = Math.min(s.y, o.y); a = o.x, h = o.y } if (a -= this.Zu.x, h -= this.Zu.y, n.x -= a, n.y -= h, 2 !== i || Hu(this)) { if (t.type = re, s = ql(t), 0 !== this.computeShortLength(!0) && (n = Xu(this, n, !0, o)), Vl(s, n.x, n.y, !1), r === nc && 3 <= i && !qi.$(this.smoothness, 0)) if (3 === i) i = (e = this.i(1)).x - a, e = e.y - h, (n = this.i(2).copy()).x -= a, n.y -= h, 0 !== this.computeShortLength(!1) && (n = Xu(this, n, !1, o)), Yl(s, i, e, i, e, n.x, n.y); else if (this.isOrthogonal) { o = new gi(a, h), n = this.i(1).copy(), r = new gi(a, h), i = new gi(a, h), e = this.i(0); for (var l = this.smoothness / 3, u = 1; u < this.pointsCount - 1; u++) { var c, f, d, p, g = e, y = b = this.i(u), m = this.i(qu(this, b, u, !1)); qi.$(g.x, y.x) && qi.$(y.x, m.x) || qi.$(g.y, y.y) && qi.$(y.y, m.y) || (c = l, isNaN(c) && (c = this.smoothness / 3), w = g.x, g = g.y, f = y.x, y = y.y, d = m.x, m = m.y, p = c * Gu(w, g, f, y), c *= Gu(f, y, d, m), qi.$(g, y) && qi.$(f, d) && (w < f ? y < m ? (r.x = f - p, r.y = y - p, i.x = f + c, i.y = y + c) : (r.x = f - p, r.y = y + p, i.x = f + c, i.y = y - c) : y < m ? (r.x = f + p, r.y = y - p, i.x = f - c, i.y = y + c) : (r.x = f + p, r.y = y + p, i.x = f - c, i.y = y - c)), qi.$(w, f) && qi.$(y, m) && (g < y ? (f < d ? (r.x = f - p, r.y = y - p, i.x = f + c) : (r.x = f + p, r.y = y - p, i.x = f - c), i.y = y + c) : (f < d ? (r.x = f - p, r.y = y + p, i.x = f + c) : (r.x = f + p, r.y = y + p, i.x = f - c), i.y = y - c)), (qi.$(w, f) && qi.$(f, d) || qi.$(g, y) && qi.$(y, m)) && (w = .5 * (w + d), g = .5 * (g + m), r.x = w, r.y = g, i.x = w, i.y = g), (1 === u || 2 === u && qi.$(e.x, this.i(0).x) && qi.$(e.y, this.i(0).y)) && (n.x = .5 * (e.x + b.x), n.y = .5 * (e.y + b.y)), Yl(s, n.x - a, n.y - h, r.x - a, r.y - h, b.x - a, b.y - h), o.set(r), n.set(i), e = b) } o = e.x, e = e.y, n = this.i(this.pointsCount - 1), 0 !== this.computeShortLength(!1) && (n = Xu(this, n.copy(), !1, kt)), o = .5 * (o + n.x), e = .5 * (e + n.y), Yl(s, i.x - a, i.y - h, o - a, e - h, n.x - a, n.y - h) } else for (e = 3; e < i; e += 3)o = this.i(e - 2), i <= e + 3 && (e = i - 1), n = this.i(e - 1), r = this.i(e), e === i - 1 && 0 !== this.computeShortLength(!1) && (r = Xu(this, r.copy(), !1, kt)), Yl(s, o.x - a, o.y - h, n.x - a, n.y - h, r.x - a, r.y - h); else { for ((o = gi.alloc()).assign(this.i(0)), (n = gi.alloc()).assign(o), r = this.computeCorner(), u = 1, b = 0; u < i;) { if (u = qu(this, o, u, 1 < u), l = this.i(u), i - 1 <= u) { if (o.w(l)) { if (0 === b) for (u = 1; u < i;)n.assign(o), l = this.i(u++), Uu(this, s, -a, -h, o, l, e), o.assign(l) } else 0 !== this.computeShortLength(!1) && (l = Xu(this, l.copy(), !1, kt)), Uu(this, s, -a, -h, o, l, e); break } var v, x, b = qu(this, l, u + 1, u < i - 3), u = -a, w = -h; g = l, c = this.i(b), f = e, qi.A(o.y, g.y) && qi.A(g.x, c.x) ? (y = Math.min(r, Math.abs(g.x - n.x) / 2), y = d = Math.min(y, Math.abs(c.y - g.y) / 2), qi.A(y, 0) ? (Uu(this, s, u, w, o, g, f), o.assign(g)) : (v = m = g.x, x = p = g.y, m = g.x > o.x ? g.x - y : g.x + y, x = c.y > g.y ? g.y + d : g.y - d, Uu(this, s, u, w, o, new gi(m, p), f), Gl(s, g.x + u, g.y + w, v + u, x + w), o.h(v, x))) : qi.A(o.x, g.x) && qi.A(g.y, c.y) ? (y = Math.min(r, Math.abs(g.y - n.y) / 2), y = d = Math.min(y, Math.abs(c.x - g.x) / 2), qi.A(d, 0) ? (Uu(this, s, u, w, o, g, f), o.assign(g)) : (v = m = g.x, x = p = g.y, p = g.y > o.y ? g.y - y : g.y + y, v = c.x > g.x ? g.x + d : g.x - d, Uu(this, s, u, w, o, new gi(m, p), f), Gl(s, g.x + u, g.y + w, v + u, x + w), o.h(v, x))) : (Uu(this, s, u, w, o, g, f), o.assign(g)), n.assign(l), u = b } gi.free(o) } Ul = s } else (s = this.i(1).copy()).x -= a, s.y -= h, 0 !== this.computeShortLength(!0) && (n = Xu(this, n, !0, o)), 0 !== this.computeShortLength(!1) && (s = Xu(this, s, !1, o)), t.type = ee, t.startX = n.x, t.startY = n.y, t.endX = s.x, t.endY = s.y; return this.Zn = !1, t }, Fu.prototype.uq = function (t) { var i = this.layer; if (null !== i && i.visible && !i.isTemporary && (null !== (n = i.diagram) && !n.animationManager.isAnimating)) for (var e = !1, n = n.layers; n.next();) { var o = n.value; if (o.visible) if (o === i) for (var r = !(e = !0), s = (o = o.Ca.j).length, a = 0; a < s; a++) { var h = o[a]; h instanceof Fu && (h === this ? r = !0 : r && Ju(this, h, t)) } else if (e) for (o = (r = o.Ca.j).length, s = 0; s < o; s++)(a = r[s]) instanceof Fu && Ju(this, a, t) } }, Fu.prototype.usesSamePort = function (t) { var i = this.pointsCount, e = t.pointsCount; if (0 < i && 0 < e) { var n = this.i(0), o = t.i(0); if (n.Ma(o)) return !0; if (i = this.i(i - 1), t = t.i(e - 1), i.Ma(t) || n.Ma(t) || i.Ma(o)) return !0 } else if (this.fromNode === t.fromNode || this.toNode === t.toNode || this.fromNode === t.toNode || this.toNode === t.fromNode) return !0; return !1 }, Fu.prototype.isVisible = function () { if (!Hl.prototype.isVisible.call(this)) return !1; var t = this.containingGroup, i = !0, e = this.diagram; if (null !== e && (i = e.isTreePathToChildren), null !== (e = this.fromNode)) { if (this.isTreeLink && i && !e.isTreeExpanded) return !1; if (e === t) return !0; for (var n = e; null !== n;) { if (n.labeledLink === this) return !0; n = n.containingGroup } if (null === (e = e.findVisibleNode()) || e === t) return !1 } if (null !== (e = this.toNode)) { if (this.isTreeLink && !i && !e.isTreeExpanded) return !1; if (e === t) return !0; for (i = e; null !== i;) { if (i.labeledLink === this) return !0; i = i.containingGroup } if (null === (i = e.findVisibleNode()) || i === t) return !1 } return !0 }, Fu.prototype.Ob = function (t) { if (Hl.prototype.Ob.call(this, t), null !== this.Hf && this.Hf.mm(), null !== this.bd) for (var i = this.bd.iterator; i.next();)i.value.Ob(t) }, Fu.prototype.computeAdjusting = function () { return null !== this.diagram && this.diagram.animationManager.isAnimating ? sc : this.Dk }, Fu.prototype.Hh = function () { return !0 }, l.Object.defineProperties(Fu.prototype, { fromNode: { get: function () { return this.Qe }, set: function (t) { var i, e, n, o, r, s = this.Qe; s !== t && (i = this.fromPort, null !== s && (this.lf !== s && bu(s, this, i), $u(this), this.C(2)), null !== (this.Qe = t) && this.Ob(t.isVisible()), this.Qf = null, this.Ta(), null !== (e = this.diagram) && e.Z && e.partManager.setFromNodeForLink(this, t, s), n = this.fromPort, null !== (o = this.fromPortChanged) && (r = !0, null !== e && (r = e.Z, e.Z = !0), o(this, i, n), null !== e && (e.Z = r)), null !== t && (this.lf !== t && xu(t, this, n), Zu(this), this.C(1)), this.g("fromNode", s, t), Ou(this)) } }, fromPortId: { get: function () { return this.Re }, set: function (t) { var i, e, n, o, r, s = this.Re; s !== t && (null !== (i = this.fromPort) && vu(this.fromNode, i), $u(this), this.Re = t, null !== (e = this.fromPort) && vu(this.fromNode, e), null !== (n = this.diagram) && (o = this.data, r = n.model, null !== o && r.om() && r.ly(o, t)), i !== e && (this.Qf = null, this.Ta(), null !== (o = this.fromPortChanged) && (r = !0, null !== n && (r = n.Z, n.Z = !0), o(this, i, e), null !== n && (n.Z = r))), Zu(this), this.g("fromPortId", s, t)) } }, fromPort: { get: function () { var t = this.Qe; return null === t ? null : t.nt(this.Re) } }, fromPortChanged: { get: function () { return this.Nn }, set: function (t) { var i = this.Nn; i !== t && (this.Nn = t, this.g("fromPortChanged", i, t)) } }, toNode: { get: function () { return this.lf }, set: function (t) { var i, e, n, o, r, s = this.lf; s !== t && (i = this.toPort, null !== s && (this.Qe !== s && bu(s, this, i), $u(this), this.C(2)), null !== (this.lf = t) && this.Ob(t.isVisible()), this.Qf = null, this.Ta(), null !== (e = this.diagram) && e.Z && e.partManager.setToNodeForLink(this, t, s), n = this.toPort, null !== (o = this.toPortChanged) && (r = !0, null !== e && (r = e.Z, e.Z = !0), o(this, i, n), null !== e && (e.Z = r)), null !== t && (this.Qe !== t && xu(t, this, n), Zu(this), this.C(1)), this.g("toNode", s, t), Ou(this)) } }, toPortId: { get: function () { return this.mf }, set: function (t) { var i, e, n, o, r, s = this.mf; s !== t && (null !== (i = this.toPort) && vu(this.toNode, i), $u(this), this.mf = t, null !== (e = this.toPort) && vu(this.toNode, e), null !== (n = this.diagram) && (o = this.data, r = n.model, null !== o && r.om() && r.py(o, t)), i !== e && (this.Qf = null, this.Ta(), null !== (o = this.toPortChanged) && (r = !0, null !== n && (r = n.Z, n.Z = !0), o(this, i, e), null !== n && (n.Z = r))), Zu(this), this.g("toPortId", s, t)) } }, toPort: { get: function () { var t = this.lf; return null === t ? null : t.nt(this.mf) } }, toPortChanged: { get: function () { return this.Wp }, set: function (t) { var i = this.Wp; i !== t && (this.Wp = t, this.g("toPortChanged", i, t)) } }, fromSpot: { get: function () { return null !== this.O ? this.O.Vg : bi }, set: function (t) { this.Ec(); var i = this.O.Vg; i.w(t) || (t = t.G(), this.O.Vg = t, this.g("fromSpot", i, t), !i.gd() && !t.gd() || null !== (t = this.fromNode) && vu(t, this.fromPort), this.Ta()) } }, fromEndSegmentLength: { get: function () { return null !== this.O ? this.O.Tg : NaN }, set: function (t) { this.Ec(); var i = this.O.Tg; i !== t && (t < 0 && y(t, ">= 0", Fu, "fromEndSegmentLength"), this.O.Tg = t, this.g("fromEndSegmentLength", i, t), this.Ta()) } }, fromShortLength: { get: function () { return null !== this.O ? this.O.Ug : NaN }, set: function (t) { this.Ec(); var i = this.O.Ug; i !== t && (this.O.Ug = t, this.g("fromShortLength", i, t), this.cc()) } }, toSpot: { get: function () { return null !== this.O ? this.O.vh : bi }, set: function (t) { this.Ec(); var i = this.O.vh; i.w(t) || (t = t.G(), this.O.vh = t, this.g("toSpot", i, t), !i.gd() && !t.gd() || null !== (t = this.toNode) && vu(t, this.toPort), this.Ta()) } }, toEndSegmentLength: { get: function () { return null !== this.O ? this.O.th : NaN }, set: function (t) { this.Ec(); var i = this.O.th; i !== t && (t < 0 && y(t, ">= 0", Fu, "toEndSegmentLength"), this.O.th = t, this.g("toEndSegmentLength", i, t), this.Ta()) } }, toShortLength: { get: function () { return null !== this.O ? this.O.uh : NaN }, set: function (t) { this.Ec(); var i = this.O.uh; i !== t && (this.O.uh = t, this.g("toShortLength", i, t), this.cc()) } }, isLabeledLink: { get: function () { return null !== this.bd && 0 < this.bd.count } }, labelNodes: { get: function () { return null === this.bd ? U : this.bd.iterator } }, relinkableFrom: { get: function () { return 0 != (1 & this.Pa) }, set: function (t) { var i = 0 != (1 & this.Pa); i !== t && (this.Pa ^= 1, this.g("relinkableFrom", i, t), this.Lb()) } }, relinkableTo: { get: function () { return 0 != (2 & this.Pa) }, set: function (t) { var i = 0 != (2 & this.Pa); i !== t && (this.Pa ^= 2, this.g("relinkableTo", i, t), this.Lb()) } }, resegmentable: { get: function () { return 0 != (4 & this.Pa) }, set: function (t) { var i = 0 != (4 & this.Pa); i !== t && (this.Pa ^= 4, this.g("resegmentable", i, t), this.Lb()) } }, isTreeLink: { get: function () { return 0 != (8 & this.Pa) }, set: function (t) { var i = 0 != (8 & this.Pa); i !== t && (this.Pa ^= 8, this.g("isTreeLink", i, t), null !== this.fromNode && wu(this.fromNode), null !== this.toNode && wu(this.toNode)) } }, path: { get: function () { var t = this.Ab(); return t instanceof Kh ? t : null } }, routeBounds: { get: function () { this.hj(); var t = this.Dl, i = 1 / 0, e = 1 / 0, n = this.pointsCount; if (0 === n) t.h(NaN, NaN, 0, 0); else { if (1 === n) n = this.i(0), i = Math.min(n.x, i), e = Math.min(n.y, e), t.h(n.x, n.y, 0, 0); else if (2 === n) { n = this.i(0); var o = this.i(1), i = Math.min(n.x, o.x), e = Math.min(n.y, o.y); t.h(n.x, n.y, 0, 0), t.Ie(o) } else if (this.computeCurve() === nc && 3 <= n && !this.isOrthogonal) if (i = (o = this.i(0)).x, e = o.y, t.h(i, e, 0, 0), 3 === n) { n = this.i(1), i = Math.min(n.x, i), e = Math.min(n.y, e); var r = this.i(2); i = Math.min(r.x, i), e = Math.min(r.y, e), qi.am(o.x, o.y, n.x, n.y, n.x, n.y, r.x, r.y, .5, t) } else for (r = 3; r < n; r += 3) { var s = this.i(r - 2); n <= r + 3 && (r = n - 1); var a = this.i(r - 1), h = this.i(r); qi.am(o.x, o.y, s.x, s.y, a.x, a.y, h.x, h.y, .5, t), i = Math.min(h.x, i), e = Math.min(h.y, e), o = h } else for (o = this.i(0), r = this.i(1), i = Math.min(o.x, r.x), e = Math.min(o.y, r.y), t.h(o.x, o.y, 0, 0), t.Ie(r), o = 2; o < n; o++)r = this.i(o), i = Math.min(r.x, i), e = Math.min(r.y, e), t.Ie(r); this.Zu.h(i - t.x, e - t.y) } return t } }, midPoint: { get: function () { return this.hj(), this.computeMidPoint(new gi) } }, midAngle: { get: function () { return this.hj(), this.computeMidAngle() } }, flattenedLengths: { get: function () { if (null === this.Hr) { this.ld || Ru(this); for (var t = this.Hr = [], i = this.pointsCount, e = 0; e < i - 1; e++) { var n = this.i(e), o = this.i(e + 1); qi.$(n.x, o.x) ? (n = o.y - n.y) < 0 && (n = -n) : qi.$(n.y, o.y) ? (n = o.x - n.x) < 0 && (n = -n) : n = Math.sqrt(n.Ce(o)), t.push(n) } } return this.Hr } }, flattenedTotalLength: { get: function () { var t = this.tu; if (isNaN(t)) { for (var i = this.flattenedLengths, e = i.length, n = t = 0; n < e; n++)t += i[n]; this.tu = t } return t } }, points: { get: function () { return this.xb }, set: function (t) { var i = this.xb; if (i !== t) { var e = null; if (Array.isArray(t)) { var n = 0 == t.length % 2; if (n) for (var o = 0; o < t.length; o++)if ("number" != typeof t[o] || isNaN(t[o])) { n = !1; break } if (n) for (e = new J, n = 0; n < t.length / 2; n++)o = new gi(t[2 * n], t[2 * n + 1]).freeze(), e.add(o); else { for (n = !0, o = 0; o < t.length; o++) { var r = t[o]; if (!b(r) || "number" != typeof r.x || isNaN(r.x) || "number" != typeof r.y || isNaN(r.y)) { n = !1; break } } if (n) for (e = new J, n = 0; n < t.length; n++)o = t[n], e.add(new gi(o.x, o.y).freeze()) } } else if (t instanceof J) for (t = (e = t.copy()).iterator; t.next();)t.value.freeze(); else B("Link.points value is not an instance of List or Array: " + t); e.freeze(), this.xb = e, this.cc(), this.o(), Ru(this), null !== (t = this.diagram) && (t.kk || t.undoManager.isUndoingRedoing || t.At.add(this), t.animationManager.qc && (this.lh = e)), this.g("points", i, e) } } }, pointsCount: { get: function () { return this.xb.count } }, ld: { get: function () { return 0 != (16 & this.Pa) }, set: function (t) { 0 != (16 & this.Pa) !== t && (this.Pa ^= 16) } }, suspendsRouting: { get: function () { return 0 != (32 & this.Pa) }, set: function (t) { 0 != (32 & this.Pa) !== t && (this.Pa ^= 32) } }, nv: { get: function () { return 0 != (64 & this.Pa) }, set: function (t) { 0 != (64 & this.Pa) !== t && (this.Pa ^= 64) } }, defaultFromPoint: { get: function () { return this.u }, set: function (t) { this.u = t.copy() } }, defaultToPoint: { get: function () { return this.I }, set: function (t) { this.I = t.copy() } }, isOrthogonal: { get: function () { return 2 == (2 & this.Lj.value) } }, isAvoiding: { get: function () { return 4 == (4 & this.Lj.value) } }, geometry: { get: function () { return this.Zn && (this.hj(), this.ka = this.makeGeometry()), this.ka } }, firstPickIndex: { get: function () { return !(this.pointsCount <= 2) && (this.isOrthogonal || !Vu(this.computeSpot(!0))) ? 1 : 0 } }, lastPickIndex: { get: function () { var t = this.pointsCount; return 0 === t ? 0 : !(t <= 2) && (this.isOrthogonal || !Vu(this.computeSpot(!1))) ? t - 2 : t - 1 } }, adjusting: { get: function () { return this.Dk }, set: function (t) { var i = this.Dk; i !== t && (this.Dk = t, this.g("adjusting", i, t)) } }, corner: { get: function () { return this.pn }, set: function (t) { var i = this.pn; i !== t && (this.pn = t, this.cc(), this.g("corner", i, t)) } }, curve: { get: function () { return this.rn }, set: function (t) { var i = this.rn; i !== t && (this.rn = t, this.Ta(), this.cc(), Wu(this, i === oc || i === rc || t === oc || t === rc), this.g("curve", i, t)) } }, curviness: { get: function () { return this.sn }, set: function (t) { var i = this.sn; i !== t && (this.sn = t, this.Ta(), this.cc(), this.g("curviness", i, t)) } }, routing: { get: function () { return this.Lj }, set: function (t) { var i = this.Lj; i !== t && (this.Lj = t, this.Qf = null, this.Ta(), Wu(this, 2 == (2 & i.value) || 2 == (2 & t.value)), this.g("routing", i, t)) } }, smoothness: { get: function () { return this.Jp }, set: function (t) { var i = this.Jp; i !== t && (this.Jp = t, this.cc(), this.g("smoothness", i, t)) } }, key: { get: function () { var t = this.diagram; if (null !== t && t.model.om()) return t.model.Vb(this.data) } } }), Fu.prototype.invalidateOtherJumpOvers = Fu.prototype.uq, Fu.prototype.findClosestSegment = Fu.prototype.iz, Fu.prototype.updateRoute = Fu.prototype.hj, Fu.prototype.invalidateRoute = Fu.prototype.Ta, Fu.prototype.rollbackRoute = Fu.prototype.hy, Fu.prototype.commitRoute = Fu.prototype.rf, Fu.prototype.startRoute = Fu.prototype.Kh, Fu.prototype.clearPoints = Fu.prototype.Zj, Fu.prototype.removePoint = Fu.prototype.aw, Fu.prototype.addPointAt = Fu.prototype.qf, Fu.prototype.addPoint = Fu.prototype.ze, Fu.prototype.insertPointAt = Fu.prototype.m, Fu.prototype.insertPoint = Fu.prototype.Rz, Fu.prototype.setPointAt = Fu.prototype.K, Fu.prototype.setPoint = Fu.prototype.jd, Fu.prototype.getPoint = Fu.prototype.i, Fu.prototype.getOtherPort = Fu.prototype.Hz, Fu.prototype.getOtherNode = Fu.prototype.rt; var Qu = new V(Fu, "Normal", 1), _u = new V(Fu, "Orthogonal", 2), tc = new V(Fu, "AvoidsNodes", 6), ic = new V(Fu, "AvoidsNodesStraight", 7), ec = new V(Fu, "None", 0), nc = new V(Fu, "Bezier", 9), oc = new V(Fu, "JumpGap", 10), rc = new V(Fu, "JumpOver", 11), sc = new V(Fu, "End", 17), ac = new V(Fu, "Scale", 18), hc = new V(Fu, "Stretch", 19), lc = new V(Fu, "OrientAlong", 21), uc = new V(Fu, "OrientPlus90", 22), cc = new V(Fu, "OrientMinus90", 23), fc = new V(Fu, "OrientOpposite", 24), dc = new V(Fu, "OrientUpright", 25), pc = new V(Fu, "OrientPlus90Upright", 26), gc = new V(Fu, "OrientMinus90Upright", 27), yc = new V(Fu, "OrientUpright45", 28); function mc(t, i, e, n) { Q(this), this.me = this.Or = !1, this.Dt = t, this.ay = i, this.Qv = e, this.by = n, this.links = [] } function vc() { Q(this), this.qy = this.group = null, this.ut = !0, this.abort = !1, this.Pd = this.Od = 1, this.yo = this.xo = -1, this.lc = this.kc = 8, this.Cb = [[]], this.Sj = this.Rj = 0, this.DA = !1, this.wA = 22, this.$z = 111 } function xc(t, i, e) { return t.Od <= i && i <= t.xo && t.Pd <= e && e <= t.yo } function bc(t, i, e) { return xc(t, i, e) ? (i -= t.Od, i /= t.kc, e -= t.Pd, e /= t.lc, t.Cb[0 | i][0 | e]) : Ac } function wc(t, i, e) { xc(t, i, e) && (i -= t.Od, i /= t.kc, e -= t.Pd, e /= t.lc, t.Cb[0 | i][0 | e] = Cc) } function kc(t) { if (null !== t.Cb) for (var i = 0; i <= t.Rj; i++)for (var e = 0; e <= t.Sj; e++)t.Cb[i][e] >= Tc && (t.Cb[i][e] = Ac) } function Mc(t, i, e, n, o, r, s, a, h) { if (!(i < r || s < i || e < a || h < e)) { var l = 0 | i, u = 0 | e, c = t.Cb[l][u]; if (Tc <= c && c < Lc) for (o ? u += n : l += n, c += 1; r <= l && l <= s && a <= u && u <= h && !(c >= t.Cb[l][u]);)t.Cb[l][u] = c, c += 1, o ? u += n : l += n; if (l = o ? u : l, o) if (0 < n) for (e += n; e < l; e += n)Mc(t, i, e, 1, !o, r, s, a, h), Mc(t, i, e, -1, !o, r, s, a, h); else for (e += n; l < e; e += n)Mc(t, i, e, 1, !o, r, s, a, h), Mc(t, i, e, -1, !o, r, s, a, h); else if (0 < n) for (i += n; i < l; i += n)Mc(t, i, e, 1, !o, r, s, a, h), Mc(t, i, e, -1, !o, r, s, a, h); else for (i += n; l < i; i += n)Mc(t, i, e, 1, !o, r, s, a, h), Mc(t, i, e, -1, !o, r, s, a, h) } } function Sc(t, i, e, n, o, r, s, a, h) { i |= 0, e |= 0; var l = Cc, u = Tc; for (t.Cb[i][e] = u; l === Cc && r < i && i < s && a < e && e < h;)u += 1, t.Cb[i][e] = u, o ? e += n : i += n, l = t.Cb[i][e] } function Pc(t, i, e, n, o, r, s, a, h) { i |= 0, e |= 0; var l = Cc, u = Lc; for (t.Cb[i][e] = u; l === Cc && r < i && i < s && a < e && e < h;)t.Cb[i][e] = u, o ? e += n : i += n, l = t.Cb[i][e] } function Nc(t, i, e, n, o, r) { var s, a, h, l, u, c; null !== t.Cb && (t.abort = !1, xc(t, s = i.x, a = i.y) && (s -= t.Od, s /= t.kc, a -= t.Pd, a /= t.lc, xc(t, i = n.x, n = n.y)) && (i -= t.Od, i /= t.kc, n -= t.Pd, n /= t.lc, Math.abs(s - i) <= 1 && Math.abs(a - n) <= 1 ? t.abort = !0 : (h = r.x, l = r.y, u = r.x + r.width, c = r.y + r.height, h -= t.Od, h /= t.kc, l -= t.Pd, l /= t.lc, u -= t.Od, u /= t.kc, c -= t.Pd, c /= t.lc, r = Math.max(0, Math.min(t.Rj, 0 | h)), u = Math.min(t.Rj, Math.max(0, 0 | u)), l = Math.max(0, Math.min(t.Sj, 0 | l)), c = Math.min(t.Sj, Math.max(0, 0 | c)), s |= 0, a |= 0, i |= 0, n |= 0, h = 0 === e || 90 === e ? 1 : -1, e = 90 === e || 270 === e, t.Cb[s][a] === Cc ? (Sc(t, s, a, h, e, r, u, l, c), Sc(t, s, a, 1, !e, r, u, l, c), Sc(t, s, a, -1, !e, r, u, l, c)) : Sc(t, s, a, h, e, s, a, s, a), t.Cb[i][n] === Cc ? (Pc(t, i, n, 0 === o || 90 === o ? 1 : -1, 90 === o || 270 === o, r, u, l, c), Pc(t, i, n, 1, !(90 === o || 270 === o), r, u, l, c), Pc(t, i, n, -1, !(90 === o || 270 === o), r, u, l, c)) : Pc(t, i, n, h, e, i, n, i, n), t.abort || (Mc(t, s, a, 1, !1, r, u, l, c), Mc(t, s, a, -1, !1, r, u, l, c), Mc(t, s, a, 1, !0, r, u, l, c), Mc(t, s, a, -1, !0, r, u, l, c))))) } Fu.className = "Link", Fu.Normal = Qu, Fu.Orthogonal = _u, Fu.AvoidsNodes = tc, Fu.AvoidsNodesStraight = ic, Fu.None = ec, Fu.Bezier = nc, Fu.JumpGap = oc, Fu.JumpOver = rc, Fu.End = sc, Fu.Scale = ac, Fu.Stretch = hc, Fu.OrientAlong = lc, Fu.OrientPlus90 = uc, Fu.OrientMinus90 = cc, Fu.OrientOpposite = fc, Fu.OrientUpright = dc, Fu.OrientPlus90Upright = pc, Fu.OrientMinus90Upright = gc, Fu.OrientUpright45 = yc, mc.prototype.mm = function () { var t; this.Or || 0 < (t = this.links).length && (null !== (t = t[0].diagram) && (t.vu.add(this), this.me = t.undoManager.isUndoingRedoing)), this.Or = !0 }, mc.prototype.xw = function () { var t, i, e; this.Or && (this.Or = !1, 0 < (t = this.links).length && (e = null === (e = (i = t[0]).diagram) || e.kk && !this.me, this.me = !1, i.arrangeBundledLinks(t, e), 1 === t.length && (i.Hf = null, t.length = 0)), 0 === t.length && (t = this.Dt, null !== this && null !== t.Me && t.Me.remove(this), t = this.Qv, null !== this && null !== t.Me && t.Me.remove(this))) }, mc.className = "LinkBundle", vc.prototype.initialize = function (t) { if (!(t.width <= 0 || t.height <= 0)) { var i = t.y, e = t.x + t.width, n = t.y + t.height; if (this.Od = Math.floor((t.x - this.kc) / this.kc) * this.kc, this.Pd = Math.floor((i - this.lc) / this.lc) * this.lc, this.xo = Math.ceil((e + 2 * this.kc) / this.kc) * this.kc, this.yo = Math.ceil((n + 2 * this.lc) / this.lc) * this.lc, t = 1 + (0 | Math.ceil((this.xo - this.Od) / this.kc)), i = 1 + (0 | Math.ceil((this.yo - this.Pd) / this.lc)), null === this.Cb || this.Rj < t - 1 || this.Sj < i - 1) { for (e = [], n = 0; n <= t; n++)e[n] = []; this.Cb = e, this.Rj = t - 1, this.Sj = i - 1 } if (t = Ac, null !== this.Cb) for (i = 0; i <= this.Rj; i++)for (e = 0; e <= this.Sj; e++)this.Cb[i][e] = t } }, vc.prototype.lk = function (t, i, e, n) { if (t > this.xo || t + e < this.Od || i > this.yo || i + n < this.Pd) return !0; t = (t - this.Od) / this.kc | 0, i = (i - this.Pd) / this.lc | 0, e = Math.max(0, e) / this.kc + 1 | 0; var o = Math.max(0, n) / this.lc + 1 | 0; if (t < 0 && (e += t, t = 0), i < 0 && (o += i, i = 0), e < 0 || o < 0) return !0; for (n = 0 | Math.min(t + e - 1, this.Rj), e = 0 | Math.min(i + o - 1, this.Sj); t <= n; t++)for (o = i; o <= e; o++)if (this.Cb[t][o] === Cc) return !1; return !0 }, l.Object.defineProperties(vc.prototype, { bounds: { get: function () { return new yi(this.Od, this.Pd, this.xo - this.Od, this.yo - this.Pd) } }, cm: { get: function () { return this.kc }, set: function (t) { 0 < t && t !== this.kc && (this.kc = t, this.initialize(this.bounds)) } }, bm: { get: function () { return this.lc }, set: function (t) { 0 < t && t !== this.lc && (this.lc = t, this.initialize(this.bounds)) } } }); var Cc = 0, Tc = 1, Lc = 999999, Ac = Lc + 1; function jc() { Q(this), this.port = this.node = null, this.Yd = [], this.zq = !1 } function Dc(t, i, e, n) { switch (i = i.offsetY) { case 8: return 90; case 2: return 180; case 1: return 270; case 4: return 0 }switch (i) { case 9: return 180 < e ? 270 : 90; case 6: return 90 < e && e <= 270 ? 180 : 0 }switch (t = 180 * Math.atan2(t.height, t.width) / Math.PI, i) { case 3: return t < e && e <= 180 + t ? 180 : 270; case 5: return 180 - t < e && e <= 360 - t ? 270 : 0; case 12: return t < e && e <= 180 + t ? 90 : 0; case 10: return 180 - t < e && e <= 360 - t ? 180 : 90; case 7: return 90 < e && e <= 180 + t ? 180 : 180 + t < e && e <= 360 - t ? 270 : 0; case 13: return 180 < e && e <= 360 - t ? 270 : t < e && e <= 180 ? 90 : 0; case 14: return t < e && e <= 180 - t ? 90 : 180 - t < e && e <= 270 ? 180 : 0; case 11: return 180 - t < e && e <= 180 + t ? 180 : 180 + t < e ? 270 : 90 }return n && 15 !== i && ((e -= 15) < 0 && (e += 360)), t < e && e < 180 - t ? 90 : 180 - t <= e && e <= 180 + t ? 180 : 180 + t < e && e < 360 - t ? 270 : 0 } function Fc(t, i) { var e = t.Yd; if (0 === e.length) { t: if (!t.zq) { e = t.zq, t.zq = !0; var n = null, o = t.node, r = o instanceof Lu ? o : null; if (null === r || r.isSubGraphExpanded) var s = o.isTreeExpanded ? o.findLinksConnected(t.port.portId) : o.Lx(); else { if (!r.actualBounds.v()) { t.zq = e; break t } s = (n = r).uv() } r = t.Yd.length = 0; var a = t.port.ga(Ht, gi.alloc()), h = t.port.ga(ti, gi.alloc()); for ((o = yi.allocAt(a.x, a.y, 0, 0)).Ie(h), gi.free(a), gi.free(h), a = gi.allocAt(o.x + o.width / 2, o.y + o.height / 2), h = t.port.Xi(), s = s.iterator; s.next();) { var l, u, c, f, d = s.value; d.isVisible() && d.fromPort !== d.toPort && (l = d.fromPort === t.port || null !== d.fromNode && d.fromNode.Xd(n), !(u = d.computeSpot(l, t.port)).gd() || null === (l = l ? d.toPort : d.fromPort) || null !== (c = l.part) && (null !== (f = c.findVisibleNode()) && f !== c && (l = (c = f).port), l = d.computeOtherPoint(c, l), c = a.Sa(l), (c -= h) < 0 && (c += 360), 0 === (u = Dc(o, u, c, d.isOrthogonal)) ? (u = 4, 180 < c && (c -= 360)) : u = 90 === u ? 8 : 180 === u ? 2 : 1, void 0 === (f = t.Yd[r]) ? (f = new Oc(d, c, u), t.Yd[r] = f) : (f.link = d, f.angle = c, f.yc = u), f.Uv.set(l), r++)) } for (gi.free(a), t.Yd.sort(jc.prototype.l), h = t.Yd.length, n = -1, r = a = 0; r < h; r++)void 0 !== (s = t.Yd[r]) && (s.yc !== n && (n = s.yc, a = 0), s.qq = a, a++); for (n = -1, a = 0, r = h - 1; 0 <= r; r--)void 0 !== (h = t.Yd[r]) && (h.yc !== n && (n = h.yc, a = h.qq + 1), h.dm = a); if (r = t.Yd, u = t.port, n = t.node.portSpreading, a = gi.alloc(), h = gi.alloc(), s = gi.alloc(), d = gi.alloc(), u.ga(Ht, a), u.ga(Wt, h), u.ga(ti, s), u.ga(Qt, d), f = c = l = u = 0, n === Tu) for (var p = 0; p < r.length; p++) { var g = r[p]; if (null !== g) { var y = g.link.computeThickness(); switch (g.yc) { case 8: c += y; break; case 2: f += y; break; case 1: u += y; break; default: l += y } } } for (var m = p = 0, v = 1, x = g = 0, y = 0; y < r.length; y++) { var b = r[y]; if (null !== b) { if (p !== b.yc) { switch (p = b.yc) { case 8: var w = s, m = d; break; case 2: w = d, m = a; break; case 1: w = a, m = h; break; default: w = h, m = s }switch (g = m.x - w.x, x = m.y - w.y, p) { case 8: c > Math.abs(g) ? (v = Math.abs(g) / c, c = Math.abs(g)) : v = 1; break; case 2: f > Math.abs(x) ? (v = Math.abs(x) / f, f = Math.abs(x)) : v = 1; break; case 1: u > Math.abs(g) ? (v = Math.abs(g) / u, u = Math.abs(g)) : v = 1; break; default: l > Math.abs(x) ? (v = Math.abs(x) / l, l = Math.abs(x)) : v = 1 }m = 0 } var k = b.xq; if (n === Tu) { switch (b = b.link.computeThickness(), b *= v, k.set(w), p) { case 8: k.x = w.x + g / 2 + c / 2 - m - b / 2; break; case 2: k.y = w.y + x / 2 + f / 2 - m - b / 2; break; case 1: k.x = w.x + g / 2 - u / 2 + m + b / 2; break; default: k.y = w.y + x / 2 - l / 2 + m + b / 2 }m += b } else { var M = .5; n === Cu && (M = (b.qq + 1) / (b.dm + 1)), k.x = w.x + g * M, k.y = w.y + x * M } } } for (gi.free(a), gi.free(h), gi.free(s), gi.free(d), w = t.Yd, r = 0; r < w.length; r++)null !== (n = w[r]) && (n.sv = t.computeEndSegmentLength(n)); t.zq = e, yi.free(o) } e = t.Yd } for (t = 0; t < e.length; t++)if (null !== (o = e[t]) && o.link === i) return o; return null } function Oc(t, i, e) { this.link = t, this.angle = i, this.yc = e, this.Uv = new gi, this.dm = this.qq = 0, this.xq = new gi, this.sv = 0 } function Bc() { this.vh = this.Vg = bi, this.uh = this.Ug = this.th = this.Tg = NaN, this.Up = this.Ln = null, this.Vp = this.Mn = 1 / 0 } function Ic() { Q(this), this.I = this.B = null, this.oi = this.bo = !0, this.io = !1, this.Wm = new gi(0, 0).freeze(), this.eo = !0, this.co = null, this.Sw = "", this.u = null, this.ho = !1, this.l = null } function Rc(t, i, e, n, o, r, s, a) { for (e = e.iterator; e.next();) { var h = e.value; n && !h.isTopLevel || null !== o && !o(h) || !h.canLayout() || (r && h instanceof pu ? h.isLinkLabel || (h instanceof Lu && null === h.layout ? Rc(t, i, h.memberParts, !1, o, r, s, a) : (Ec(h), i.add(h))) : s && h instanceof Fu ? i.add(h) : !a || !h.Wb() || h instanceof pu || (Ec(h), i.add(h))) } } function Ec(t) { var i = t.actualBounds; (0 === i.width || 0 === i.height || isNaN(i.width) || isNaN(i.height)) && t.zb() } function zc(t) { Q(this), this.ic = t, this.nf = new $, this.fe = new $, this.Et = new at, this.zt = new at } function Vc(t, i) { if (null !== i) { var e = t.nf.remove(i); return e && (null !== (i = i.node) && t.Et.remove(i)), e } } function Yc(t, i) { var e; null !== i && (t.fe.add(i), null !== (e = i.link) && null === t.lq(e) && t.zt.add(e, i), i.network = t) } function Gc(t, i) { null !== i && t.fe.remove(i) && (null !== (i = i.link) && t.zt.remove(i)) } function Xc(t, i, e) { if (null !== e && e.network !== i) { Vc(t, e), i.Bh(e); for (var n = e.sourceEdges; n.next();) { var o = n.value; o.network !== i && (Gc(t, o), Yc(i, o), Xc(t, i, o.fromVertex)) } for (n = e.destinationEdges; n.next();)(e = n.value).network !== i && (Gc(t, e), Yc(i, e), Xc(t, i, e.toVertex)) } } function qc(t) { Q(this), this.Zc = t, this.l = new yi(0, 0, 10, 10).freeze(), this.u = new gi(5, 5).freeze(), this.zi = this.jb = null, this.Dg = new J, this.vg = new J } function Uc(t, i) { return t = t.zi, i = i.zi, t ? i ? (t = t.text) < (i = i.text) ? -1 : i < t ? 1 : 0 : 1 : null !== i ? -1 : 0 } function Kc(t) { Q(this), this.kd = t, this.qg = this.Sf = this.tl = this.jb = null } function Hc() { Ic.call(this), this.isViewportSized = !0, this.$p = this.aq = NaN, this.Kg = new Yi(NaN, NaN).freeze(), this.ef = new Yi(10, 10).freeze(), this.wb = Zc, this.Bb = $c, this.Qc = ef, this.Kc = Wc } function Wc(t, i) { return (t = t.text) < (i = i.text) ? -1 : i < t ? 1 : 0 } vc.className = "PositionArray", jc.prototype.toString = function () { for (var t = this.Yd, i = this.node.toString() + " " + t.length.toString() + ":", e = 0; e < t.length; e++) { var n = t[e]; null !== n && (i += "\n  " + n.toString()) } return i }, jc.prototype.mm = function () { this.Yd.length = 0 }, jc.prototype.l = function (t, i) { return t === i ? 0 : null === t ? -1 : null === i ? 1 : t.yc < i.yc ? -1 : t.yc > i.yc ? 1 : t.angle < i.angle ? -1 : t.angle > i.angle ? 1 : 0 }, jc.prototype.computeEndSegmentLength = function (t) { var i = t.link, e = i.computeEndSegmentLength(this.node, this.port, Kt, i.fromPort === this.port), n = t.qq; if (n < 0) return e; var o = t.dm; if (o <= 1 || !i.isOrthogonal) return e; i = t.Uv; var r = t.xq; return 2 !== t.yc && 8 !== t.yc || (n = o - 1 - n), ((t = 2 === t.yc || 4 === t.yc) ? i.y < r.y : i.x < r.x) ? e + 8 * n : (t ? i.y === r.y : i.x === r.x) ? e : e + 8 * (o - 1 - n) }, jc.className = "Knot", Oc.prototype.toString = function () { return this.link.toString() + " " + this.angle.toString() + " " + this.yc.toString() + ":" + this.qq.toString() + "/" + this.dm.toString() + " " + this.xq.toString() + " " + this.sv.toString() + " " + this.Uv.toString() }, Oc.className = "LinkInfo", Bc.prototype.copy = function () { var t = new Bc; return t.Vg = this.Vg.G(), t.vh = this.vh.G(), t.Tg = this.Tg, t.th = this.th, t.Ug = this.Ug, t.uh = this.uh, t.Ln = this.Ln, t.Up = this.Up, t.Mn = this.Mn, t.Vp = this.Vp, t }, Bc.className = "LinkSettings", Ic.prototype.cloneProtected = function (t) { t.bo = this.bo, t.oi = this.oi, t.io = this.io, t.Wm.assign(this.Wm), t.eo = this.eo, t.co = this.co, t.Sw = this.Sw, t.ho = !0 }, Ic.prototype.copy = function () { var t = new this.constructor; return this.cloneProtected(t), t }, Ic.prototype.fb = function () { }, Ic.prototype.toString = function () { var t = P(this.constructor); return t += "(", null !== this.group && (t += " in " + this.group), null !== this.diagram && (t += " for " + this.diagram), t + ")" }, Ic.prototype.C = function () { var t, i; this.isValidLayout && (null === (t = this.diagram) || t.undoManager.isUndoingRedoing || !(i = t.animationManager).isTicking && (i.defaultAnimation.isAnimating && i.Yc(), this.isOngoing && t.kk || this.isInitial && !t.kk) && (this.isValidLayout = !1, t.Pb())) }, Ic.prototype.createNetwork = function () { return new zc(this) }, Ic.prototype.makeNetwork = function (t) { var i = this.createNetwork(); return t instanceof Lo ? (i.ug(t.nodes, !0), i.ug(t.links, !0)) : t instanceof Lu ? i.ug(t.memberParts) : i.ug(t.iterator), i }, Ic.prototype.updateParts = function () { var t = this.diagram; if (null === t && null !== this.network) for (var i = this.network.vertexes.iterator; i.next();) { var e = i.value.node; if (null !== e && null !== (t = e.diagram)) break } this.isValidLayout = !0; try { null !== t && t.ua("Layout"), this.commitLayout() } finally { null !== t && t.Va("Layout") } }, Ic.prototype.commitLayout = function () { if (null !== this.network) { for (var t = this.network.vertexes.iterator; t.next();)t.value.commit(); if (this.isRouting) for (t = this.network.edges.iterator; t.next();)t.value.commit() } }, Ic.prototype.doLayout = function (t) { var i = new $; t instanceof Lo ? (Rc(this, i, t.nodes, !0, this.uk, !0, !1, !0), Rc(this, i, t.parts, !0, this.uk, !0, !1, !0)) : t instanceof Lu ? Rc(this, i, t.memberParts, !1, this.uk, !0, !1, !0) : i.addAll(t.iterator); var e = i.count; if (0 < e) { null !== (t = this.diagram) && t.ua("Layout"), e = Math.ceil(Math.sqrt(e)), this.arrangementOrigin = this.initialOrigin(this.arrangementOrigin); for (var n = this.arrangementOrigin.x, o = n, r = this.arrangementOrigin.y, s = 0, a = 0, i = i.iterator; i.next();) { var h = i.value; Ec(h); var l = (u = h.measuredBounds).width, u = u.height; h.moveTo(o, r), h instanceof Lu && (h.uk = !1), o += Math.max(l, 50) + 20, a = Math.max(a, Math.max(u, 50)), e - 1 <= s ? (o = n, r += a + 20, a = s = 0) : s++ } null !== t && t.Va("Layout") } this.isValidLayout = !0 }, Ic.prototype.uk = function (t) { return !(t.location.v() && !(t instanceof Lu && t.uk)) }, Ic.prototype.Zi = function (t, i) { var e = this.boundsComputation; return null !== e ? e(t, this, i = i || new yi) : i ? (i.set(t.actualBounds), i) : t.actualBounds }, Ic.prototype.Ax = function (t) { var i = new $; return t instanceof Lo ? (Rc(this, i, t.nodes, !0, null, !0, !0, !0), Rc(this, i, t.links, !0, null, !0, !0, !0), Rc(this, i, t.parts, !0, null, !0, !0, !0)) : Rc(this, i, t instanceof Lu ? t.memberParts : t.iterator, !1, null, !0, !0, !0), i }, Ic.prototype.initialOrigin = function (t) { var i = this.group; if (null === i) return t; var e = i.position.copy(); return (isNaN(e.x) || isNaN(e.y)) && e.set(t), null !== (i = i.placeholder) && (e = i.ga(Ht), (isNaN(e.x) || isNaN(e.y)) && e.set(t), t = i.padding, e.x += t.left, e.y += t.top), e }, l.Object.defineProperties(Ic.prototype, { diagram: { get: function () { return this.B }, set: function (t) { this.B = t } }, group: { get: function () { return this.I }, set: function (t) { this.I !== t && (null !== (this.I = t) && (this.B = t.diagram)) } }, isOngoing: { get: function () { return this.bo }, set: function (t) { this.bo !== t && (this.bo = t) } }, isInitial: { get: function () { return this.oi }, set: function (t) { (this.oi = t) || (this.ho = !0) } }, isViewportSized: { get: function () { return this.io }, set: function (t) { this.io !== t && (this.io = t) && this.C() } }, isRouting: { get: function () { return this.eo }, set: function (t) { this.eo !== t && (this.eo = t) } }, isRealtime: { get: function () { return this.co }, set: function (t) { this.co !== t && (this.co = t) } }, isValidLayout: { get: function () { return this.ho }, set: function (t) { this.ho !== t && ((this.ho = t) || null !== (t = this.diagram) && (t.Ff = !0)) } }, network: { get: function () { return this.l }, set: function (t) { this.l !== t && (null !== (this.l = t) && (t.layout = this)) } }, boundsComputation: { get: function () { return this.u }, set: function (t) { this.u !== t && (this.u = t, this.C()) } }, arrangementOrigin: { get: function () { return this.Wm }, set: function (t) { this.Wm.w(t) || (this.Wm.assign(t), this.C()) } } }), Ic.prototype.collectParts = Ic.prototype.Ax, Ic.prototype.getLayoutBounds = Ic.prototype.Zi, Ic.prototype.invalidateLayout = Ic.prototype.C, Ic.className = "Layout", zc.prototype.clear = function () { if (this.nf) for (var t = this.nf.iterator; t.next();)t.value.clear(); if (this.fe) for (t = this.fe.iterator; t.next();)t.value.clear(); this.nf = new $, this.fe = new $, this.Et = new at, this.zt = new at }, zc.prototype.toString = function (t) { void 0 === t && (t = 0); var i = "LayoutNetwork" + (null !== this.layout ? "(" + this.layout.toString() + ")" : ""); if (t <= 0) return i; if (i += " vertexes: " + this.nf.count + " edges: " + this.fe.count, 1 < t) { for (var e = this.nf.iterator; e.next();)i += "\n    " + e.value.toString(t - 1); for (e = this.fe.iterator; e.next();)i += "\n    " + e.value.toString(t - 1) } return i }, zc.prototype.createVertex = function () { return new qc(this) }, zc.prototype.createEdge = function () { return new Kc(this) }, zc.prototype.ug = function (t, i, e) { if (null !== t) { for (void 0 === i && (i = !1), void 0 === e && (e = null), null === e && (e = function (t) { if (t instanceof pu) return !t.isLinkLabel; if (t instanceof Fu) { var i = t.fromNode; return null === i || i.isLinkLabel ? !1 : null !== (t = t.toNode) && !t.isLinkLabel } return !1 }), t = t.iterator; t.next();) { var n = t.value; n instanceof pu && (!i || n.isTopLevel) && n.canLayout() && e(n) && (n instanceof Lu && null === n.layout ? this.ug(n.memberParts, !1) : null === this.Wi(n) && ((r = this.createVertex()).node = n, this.Bh(r))) } for (t.reset(); t.next();) { var o, r; (n = t.value) instanceof Fu && (!i || n.isTopLevel) && n.canLayout() && e(n) && null === this.lq(n) && (o = n.fromNode, r = n.toNode, null !== o && null !== r && o !== r && (o = this.findGroupVertex(o), r = this.findGroupVertex(r), null !== o && null !== r && this.mk(o, r, n))) } } }, zc.prototype.findGroupVertex = function (t) { if (null === t) return null; var i = t.findVisibleNode(); if (null === i) return null; if (null !== (t = this.Wi(i))) return t; for (i = i.containingGroup; null !== i;) { if (null !== (t = this.Wi(i))) return t; i = i.containingGroup } return null }, (t = zc.prototype).Bh = function (t) { var i; null !== t && (this.nf.add(t), null !== (i = t.node) && this.Et.add(i, t), t.network = this) }, t.$l = function (t) { if (null === t) return null; var i = this.Wi(t); return null === i && ((i = this.createVertex()).node = t, this.Bh(i)), i }, t.rv = function (t) { if (null !== t && Vc(this, t)) { for (var i = t.Dg, e = i.count - 1; 0 <= e; e--) { var n = i.L(e); this.ek(n) } for (t = (i = t.vg).count - 1; 0 <= t; t--)e = i.L(t), this.ek(e) } }, t.cz = function (t) { null !== t && (null !== (t = this.Wi(t)) && this.rv(t)) }, t.Wi = function (t) { return null === t ? null : this.Et.H(t) }, t.cq = function (t) { var i; null !== t && (Yc(this, t), null !== (i = t.toVertex) && i.iv(t), null !== (i = t.fromVertex) && i.gv(t)) }, t.Jy = function (t) { if (null === t) return null; var i = t.fromNode, e = t.toNode, n = this.lq(t); return null === n ? ((n = this.createEdge()).link = t, null !== i && (n.fromVertex = this.$l(i)), null !== e && (n.toVertex = this.$l(e)), this.cq(n)) : (n.fromVertex = null !== i ? this.$l(i) : null, n.toVertex = null !== e ? this.$l(e) : null), n }, t.ek = function (t) { var i; null !== t && (null !== (i = t.toVertex) && i.qv(t), null !== (i = t.fromVertex) && i.pv(t), Gc(this, t)) }, t.bz = function (t) { null !== t && (null !== (t = this.lq(t)) && this.ek(t)) }, t.lq = function (t) { return null === t ? null : this.zt.H(t) }, t.mk = function (t, i, e) { if (null === t || null === i) return null; if (t.network !== this || i.network !== this) return null; var n = this.createEdge(); return n.link = e, n.fromVertex = t, n.toVertex = i, this.cq(n), n }, t.Dm = function (t) { var i, e; null !== t && (i = t.fromVertex, e = t.toVertex, null !== i && null !== e && (i.pv(t), e.qv(t), t.Dm(), i.iv(t), e.gv(t))) }, t.jq = function () { for (var t = zi(), i = this.fe.iterator; i.next();) { var e = i.value; e.fromVertex === e.toVertex && t.push(e) } for (i = t.length, e = 0; e < i; e++)this.ek(t[e]); Vi(t) }, zc.prototype.deleteArtificialVertexes = function () { for (var t = zi(), i = this.nf.iterator; i.next();) { var e = i.value; null === e.node && t.push(e) } for (e = t.length, i = 0; i < e; i++)this.rv(t[i]); for (i = zi(), e = this.fe.iterator; e.next();) { var n = e.value; null === n.link && i.push(n) } for (e = i.length, n = 0; n < e; n++)this.ek(i[n]); Vi(t), Vi(i) }, zc.prototype.sy = function (t) { void 0 === t && (t = !0), t && (this.deleteArtificialVertexes(), function (t) { for (var i = zi(), e = t.fe.iterator; e.next();) { var n = e.value; null !== n.fromVertex && null !== n.toVertex || i.push(n) } for (e = i.length, n = 0; n < e; n++)t.ek(i[n]); Vi(i) }(this), this.jq()), t = new J; for (var i = !0; i;) { i = !1; for (var e = this.nf.iterator; e.next();) { var n = e.value; if (0 < n.Dg.count || 0 < n.vg.count) { i = this.layout.createNetwork(), t.add(i), Xc(this, i, n), i = !0; break } } } return t.sort(function (t, i) { return null === t || null === i || t === i ? 0 : i.vertexes.count - t.vertexes.count }), t }, zc.prototype.hz = function () { for (var t = new $, i = this.nf.iterator; i.next();)t.add(i.value.node); for (i = this.fe.iterator; i.next();)t.add(i.value.link); return t }, l.Object.defineProperties(zc.prototype, { layout: { get: function () { return this.ic }, set: function (t) { null !== t && (this.ic = t) } }, vertexes: { get: function () { return this.nf } }, edges: { get: function () { return this.fe } } }), zc.prototype.findAllParts = zc.prototype.hz, zc.prototype.splitIntoSubNetworks = zc.prototype.sy, zc.prototype.deleteSelfEdges = zc.prototype.jq, zc.prototype.reverseEdge = zc.prototype.Dm, zc.prototype.linkVertexes = zc.prototype.mk, zc.prototype.findEdge = zc.prototype.lq, zc.prototype.deleteLink = zc.prototype.bz, zc.prototype.deleteEdge = zc.prototype.ek, zc.prototype.addLink = zc.prototype.Jy, zc.prototype.addEdge = zc.prototype.cq, zc.prototype.findVertex = zc.prototype.Wi, zc.prototype.deleteNode = zc.prototype.cz, zc.prototype.deleteVertex = zc.prototype.rv, zc.prototype.addNode = zc.prototype.$l, zc.prototype.addVertex = zc.prototype.Bh, zc.prototype.addParts = zc.prototype.ug, zc.className = "LayoutNetwork", qc.prototype.clear = function () { this.zi = this.jb = null, this.Dg = new J, this.vg = new J }, qc.prototype.toString = function (t) { void 0 === t && (t = 0); var i = "LayoutVertex#" + tt(this); if (0 < t && (i += null !== this.node ? "(" + this.node.toString() + ")" : "", 1 < t)) { for (var e = !(t = ""), n = this.Dg.iterator; n.next();) { var o = n.value; e ? e = !1 : t += ",", t += o.toString(0) } for (e = !(o = ""), n = this.vg.iterator; n.next();) { e ? e = !1 : o += ",", o += n.value.toString(0) } i += " sources: " + t + " destinations: " + o } return i }, qc.prototype.commit = function () { var t = this.jb; if (null !== t) { var i = this.bounds, e = t.bounds; b(e) ? (e.x = i.x, e.y = i.y, e.width = i.width, e.height = i.height) : t.bounds = i.copy() } else if (null !== (t = this.node)) { if (i = this.bounds, !(t instanceof Lu)) { e = yi.alloc(); var n = this.network.layout.Zi(t, e), o = t.locationObject.ga(Zt); if (n.v() && o.v()) return t.moveTo(i.x + this.focusX - (o.x - n.x), i.y + this.focusY - (o.y - n.y)), void yi.free(e); yi.free(e) } t.moveTo(i.x, i.y) } }, qc.prototype.iv = function (t) { null !== t && (this.Dg.contains(t) || this.Dg.add(t)) }, qc.prototype.qv = function (t) { null !== t && this.Dg.remove(t) }, qc.prototype.gv = function (t) { null !== t && (this.vg.contains(t) || this.vg.add(t)) }, qc.prototype.pv = function (t) { null !== t && this.vg.remove(t) }, l.Object.defineProperties(qc.prototype, { sourceEdgesArrayAccess: { get: function () { return this.Dg._dataArray } }, destinationEdgesArrayAccess: { get: function () { return this.vg._dataArray } }, data: { get: function () { return this.jb }, set: function (t) { var i, e, n; null !== (this.jb = t) && (t = (n = t.bounds).x, i = n.y, e = n.width, n = n.height, this.u.h(e / 2, n / 2), this.l.h(t, i, e, n)) } }, node: { get: function () { return this.zi }, set: function (t) { if (this.zi !== t) { (this.zi = t).zb(); var i = this.network.layout, e = yi.alloc(), i = (r = i.Zi(t, e)).x, n = r.y, o = r.width, r = r.height; if (isNaN(i) && (i = 0), isNaN(n) && (n = 0), this.l.h(i, n, o, r), yi.free(e), !(t instanceof Lu) && (t = t.locationObject.ga(Zt)).v()) return void this.u.h(t.x - i, t.y - n); this.u.h(o / 2, r / 2) } } }, bounds: { get: function () { return this.l }, set: function (t) { this.l.w(t) || this.l.assign(t) } }, focus: { get: function () { return this.u }, set: function (t) { this.u.w(t) || this.u.assign(t) } }, centerX: { get: function () { return this.l.x + this.u.x }, set: function (t) { var i = this.l; i.x + this.u.x !== t && (i.ea(), i.x = t - this.u.x, i.freeze()) } }, centerY: { get: function () { return this.l.y + this.u.y }, set: function (t) { var i = this.l; i.y + this.u.y !== t && (i.ea(), i.y = t - this.u.y, i.freeze()) } }, focusX: { get: function () { return this.u.x }, set: function (t) { var i = this.u; i.x !== t && (i.ea(), i.x = t, i.freeze()) } }, focusY: { get: function () { return this.u.y }, set: function (t) { var i = this.u; i.y !== t && (i.ea(), i.y = t, i.freeze()) } }, x: { get: function () { return this.l.x }, set: function (t) { var i = this.l; i.x !== t && (i.ea(), i.x = t, i.freeze()) } }, y: { get: function () { return this.l.y }, set: function (t) { var i = this.l; i.y !== t && (i.ea(), i.y = t, i.freeze()) } }, width: { get: function () { return this.l.width }, set: function (t) { var i = this.l; i.width !== t && (i.ea(), i.width = t, i.freeze()) } }, height: { get: function () { return this.l.height }, set: function (t) { var i = this.l; i.height !== t && (i.ea(), i.height = t, i.freeze()) } }, network: { get: function () { return this.Zc }, set: function (t) { this.Zc = t } }, sourceVertexes: { get: function () { for (var t = new $, i = this.sourceEdges; i.next();)t.add(i.value.fromVertex); return t.iterator } }, destinationVertexes: { get: function () { for (var t = new $, i = this.destinationEdges; i.next();)t.add(i.value.toVertex); return t.iterator } }, vertexes: { get: function () { for (var t = new $, i = this.sourceEdges; i.next();)t.add(i.value.fromVertex); for (i = this.destinationEdges; i.next();)t.add(i.value.toVertex); return t.iterator } }, sourceEdges: { get: function () { return this.Dg.iterator } }, destinationEdges: { get: function () { return this.vg.iterator } }, edges: { get: function () { for (var t = new J, i = this.sourceEdges; i.next();)t.add(i.value); for (i = this.destinationEdges; i.next();)t.add(i.value); return t.iterator } }, edgesCount: { get: function () { return this.Dg.count + this.vg.count } } }), qc.prototype.deleteDestinationEdge = qc.prototype.pv, qc.prototype.addDestinationEdge = qc.prototype.gv, qc.prototype.deleteSourceEdge = qc.prototype.qv, qc.prototype.addSourceEdge = qc.prototype.iv, qc.className = "LayoutVertex", qc.standardComparer = Uc, qc.smartComparer = function (t, i) { if (null === t) return null !== i ? -1 : 0; if (null === i) return 1; t = t.zi; var e = i.zi; if (null === t) return null !== e ? -1 : 0; if (null === e) return 1; for (i = t.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/), t = e.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/), e = 0; e < i.length; e++)if ("" !== t[e] && void 0 !== t[e]) { var n = parseFloat(i[e]), o = parseFloat(t[e]); if (isNaN(n)) { if (!isNaN(o)) return 1; if (0 !== i[e].localeCompare(t[e])) return i[e].localeCompare(t[e]) } else { if (isNaN(o)) return -1; if (0 != n - o) return n - o } } else if ("" !== i[e]) return 1; return "" !== t[e] && void 0 !== t[e] ? -1 : 0 }, Kc.prototype.clear = function () { this.qg = this.Sf = this.tl = this.jb = null }, Kc.prototype.toString = function (t) { void 0 === t && (t = 0); var i = "LayoutEdge#" + tt(this); return 0 < t && (i += null !== this.tl ? "(" + this.tl.toString() + ")" : "", 1 < t && (i += " " + (this.Sf ? this.Sf.toString() : "null") + " --\x3e " + (this.qg ? this.qg.toString() : "null"))), i }, Kc.prototype.Dm = function () { var t = this.Sf; this.Sf = this.qg, this.qg = t }, Kc.prototype.commit = function () { }, Kc.prototype.Sx = function (t) { return this.qg === t ? this.Sf : this.Sf === t ? this.qg : null }, l.Object.defineProperties(Kc.prototype, { network: { get: function () { return this.kd }, set: function (t) { this.kd = t } }, data: { get: function () { return this.jb }, set: function (t) { this.jb !== t && (this.jb = t) } }, link: { get: function () { return this.tl }, set: function (t) { this.tl !== t && (this.tl = t) } }, fromVertex: { get: function () { return this.Sf }, set: function (t) { this.Sf !== t && (this.Sf = t) } }, toVertex: { get: function () { return this.qg }, set: function (t) { this.qg !== t && (this.qg = t) } } }), Kc.prototype.getOtherVertex = Kc.prototype.Sx, Kc.className = "LayoutEdge", h(Hc, Ic), Hc.prototype.cloneProtected = function (t) { Ic.prototype.cloneProtected.call(this, t), t.aq = this.aq, t.$p = this.$p, t.Kg.assign(this.Kg), t.ef.assign(this.ef), t.wb = this.wb, t.Bb = this.Bb, t.Qc = this.Qc, t.Kc = this.Kc }, Hc.prototype.fb = function (t) { t.classType === Hc ? t === ef || t === nf || t === _c || t === tf ? this.sorting = t : t === $c || t === Qc ? this.arrangement = t : t === Zc || t === Jc ? this.alignment = t : B("Unknown enum value: " + t) : Ic.prototype.fb.call(this, t) }, Hc.prototype.doLayout = function (t) { this.arrangementOrigin = this.initialOrigin(this.arrangementOrigin); var i = this.Ax(t); t = this.diagram; for (var e = i.copy().iterator; e.next();) { var n = e.value; if (!n.Hh() || null === n.fromNode && null === n.toNode) { if (n.zb(), n instanceof Lu) for (n = n.memberParts; n.next();)i.remove(n.value) } else i.remove(n) } var o = i.na(); if (0 !== o.length) { switch (this.sorting) { case tf: o.reverse(); break; case ef: o.sort(this.comparer); break; case nf: o.sort(this.comparer), o.reverse() }var r = this.wrappingColumn; isNaN(r) && (r = 0); var s = this.wrappingWidth, s = isNaN(s) && null !== t ? (i = t.padding, Math.max(t.viewportBounds.width - i.left - i.right, 0)) : Math.max(this.wrappingWidth, 0); switch (r <= 0 && s <= 0 && (r = 1), i = this.spacing.width, isFinite(i) || (i = 0), e = this.spacing.height, isFinite(e) || (e = 0), null !== t && t.ua("Layout"), n = [], this.alignment) { case Jc: var a = i, h = e, l = yi.alloc(), u = Math.max(this.cellSize.width, 1); if (!isFinite(u)) for (var c = u = 0; c < o.length; c++)var f = this.Zi(o[c], l), u = Math.max(u, f.width); if (u = Math.max(u + a, 1), c = Math.max(this.cellSize.height, 1), !isFinite(c)) for (f = c = 0; f < o.length; f++)var d = this.Zi(o[f], l), c = Math.max(c, d.height); c = Math.max(c + h, 1), f = this.arrangement; for (var p = d = this.arrangementOrigin.x, g = this.arrangementOrigin.y, y = 0, m = 0, v = 0; v < o.length; v++) { var x = o[v], b = this.Zi(x, l), w = Math.ceil((b.width + a) / u) * u, k = Math.ceil((b.height + h) / c) * c; switch (f) { case Qc: var M = Math.abs(p - b.width); break; default: M = p + b.width }switch ((0 < r && r - 1 < y || 0 < s && 0 < y && s < M - d) && (n.push(new yi(0, g, s + a, m)), p = d, g += m, m = y = 0), m = Math.max(m, k), f) { case Qc: b = -b.width; break; default: b = 0 }switch (x.moveTo(p + b, g), f) { case Qc: p -= w; break; default: p += w }y++ } n.push(new yi(0, g, s + a, m)), yi.free(l); break; case Zc: for (h = s, u = r, c = i, f = e, s = yi.alloc(), d = Math.max(this.cellSize.width, 1), r = g = l = 0, a = gi.alloc(), p = 0; p < o.length; p++)m = o[p], y = this.Zi(m, s), m = m.vf(m.locationObject, m.locationSpot, a), l = Math.max(l, m.x), g = Math.max(g, y.width - m.x), r = Math.max(r, m.y); switch (p = this.arrangement) { case Qc: l += c; break; default: g += c }d = isFinite(d) ? Math.max(d + c, 1) : Math.max(l + g, 1); var S = m = this.arrangementOrigin.x, v = this.arrangementOrigin.y, g = 0; for (l <= h && (h -= l), l = x = 0, w = Math.max(this.cellSize.height, 1), b = r = 0, k = !0, y = gi.alloc(), M = 0; M < o.length; M++) { var P = o[M], N = this.Zi(P, s), C = P.vf(P.locationObject, P.locationSpot, a); if (0 < g) switch (p) { case Qc: S = (S - m - (N.width - C.x)) / d, S = (S = qi.$(Math.round(S), S) ? Math.round(S) : Math.floor(S)) * d + m; break; default: S = (S - m + C.x) / d, S = (S = qi.$(Math.round(S), S) ? Math.round(S) : Math.ceil(S)) * d + m } else switch (p) { case Qc: x = S + C.x + N.width; break; default: x = S - C.x }switch (p) { case Qc: var T = -(S + C.x) + x; break; default: T = S + N.width - C.x - x }if (0 < u && u - 1 < g || 0 < h && 0 < g && h < T) { for (n.push(new yi(0, k ? v - r : v, h + c, b + r + f)), S = 0; S < g && M !== g; S++) { var L = (T = o[M - g + S]).vf(T.locationObject, T.locationSpot, y); T.moveTo(T.position.x, T.position.y + r - L.y) } b += f, v = k ? v + b : v + (b + r), g = b = r = 0, S = m, k = !1 } switch (S === m && (l = p === Qc ? Math.max(l, N.width - C.x) : Math.min(l, -C.x)), r = Math.max(r, C.y), b = Math.max(b, N.height - C.y), isFinite(w) && (b = Math.max(b, Math.max(N.height, w) - C.y)), k ? P.moveTo(S - C.x, v - C.y) : P.moveTo(S - C.x, v), p) { case Qc: S -= C.x + c; break; default: S += N.width - C.x + c }g++ } if (n.push(new yi(0, v, h + c, (k ? b : b + r) + f)), o.length !== g) for (h = 0; h < g; h++)c = (u = o[o.length - g + h]).vf(u.locationObject, u.locationSpot, a), u.moveTo(u.position.x, u.position.y + r - c.y); if (gi.free(a), gi.free(y), p === Qc) for (o = 0; o < n.length; o++)(r = n[o]).width += l, r.x -= l; else for (o = 0; o < n.length; o++)(r = n[o]).x > l && (r.width += r.x - l, r.x = l); yi.free(s) }for (a = r = s = o = 0; a < n.length; a++)h = n[a], o = Math.min(o, h.x), s = Math.min(s, h.y), r = Math.max(r, h.x + h.width); this.arrangement === Qc ? this.commitLayers(n, new gi(o + i / 2 - (r + o), s - e / 2)) : this.commitLayers(n, new gi(o - i / 2, s - e / 2)), null !== t && t.Va("Layout"), this.isValidLayout = !0 } }, Hc.prototype.commitLayers = function () { }, l.Object.defineProperties(Hc.prototype, { wrappingWidth: { get: function () { return this.aq }, set: function (t) { this.aq !== t && (0 < t || isNaN(t)) && (this.aq = t, this.isViewportSized = isNaN(t), this.C()) } }, wrappingColumn: { get: function () { return this.$p }, set: function (t) { this.$p !== t && (0 < t || isNaN(t)) && (this.$p = t, this.C()) } }, cellSize: { get: function () { return this.Kg }, set: function (t) { this.Kg.w(t) || (this.Kg.assign(t), this.C()) } }, spacing: { get: function () { return this.ef }, set: function (t) { this.ef.w(t) || (this.ef.assign(t), this.C()) } }, alignment: { get: function () { return this.wb }, set: function (t) { this.wb === t || t !== Zc && t !== Jc || (this.wb = t, this.C()) } }, arrangement: { get: function () { return this.Bb }, set: function (t) { this.Bb === t || t !== $c && t !== Qc || (this.Bb = t, this.C()) } }, sorting: { get: function () { return this.Qc }, set: function (t) { this.Qc === t || t !== _c && t !== tf && t !== ef && t !== nf || (this.Qc = t, this.C()) } }, comparer: { get: function () { return this.Kc }, set: function (t) { this.Kc !== t && (this.Kc = t, this.C()) } } }); var Jc = new V(Hc, "Position", 0), Zc = new V(Hc, "Location", 1), $c = new V(Hc, "LeftToRight", 2), Qc = new V(Hc, "RightToLeft", 3), _c = new V(Hc, "Forward", 4), tf = new V(Hc, "Reverse", 5), ef = new V(Hc, "Ascending", 6), nf = new V(Hc, "Descending", 7); function of() { this.To = new $, this.to = new $, this.Ca = new $, this.Oe = new at, this.Ne = new at, this.yj = new at, this.B = null, this.Uq = !1 } function rf(t, i, e) { if (null != i && !t.diagram.undoManager.isUndoingRedoing && !t.Oe.contains(i)) { void 0 === e && (e = !0); t: { if (null != i && !t.B.undoManager.isUndoingRedoing && !t.Oe.contains(i)) { var n = t.pt(i), o = sf(t, i, n); if (null !== o && (Dh(o), null !== (o = o.copy()))) { var r = t.diagram.skipsModelSourceBindings; t.diagram.skipsModelSourceBindings = !0, o.If = n, o.jb = i, t.Uq && (o.ah = "Tool"), t.diagram.add(o), o.jb = null, o.data = i, t.diagram.skipsModelSourceBindings = r, n = o; break t } } n = null } null !== n && e && t.resolveReferencesForData(i) } } function sf(t, i, e) { var n = (t = t.B).model; return n.jk() && n.Lv(i) ? null === (i = t.groupTemplateMap.H(e)) && (null === (i = t.groupTemplateMap.H("")) && (df || (df = !0, v('No Group template found for category "' + e + '"'), v("  Using default group template")), i = t.hu)) : null === (i = t.nodeTemplateMap.H(e)) && (null === (i = t.nodeTemplateMap.H("")) && (ff || (ff = !0, v('No Node template found for category "' + e + '"'), v("  Using default node template")), i = t.ju)), i } function af(t, i, e) { for (var n in e) { var o = i[n], r = e[n]; if (w(r)) { if (!w(o) || o.length < r.length) return; for (var s = 0; s < o.length; s++) { var a = r[s]; if (void 0 !== a && !hf(t, o[s], a)) return } } else if (!hf(t, o, r)) return } return 1 } function hf(t, i, e) { if ("function" == typeof e) { if (!e(i)) return } else if (e instanceof RegExp) { if (!i || !e.test(i.toString())) return } else if (b(i) && b(e)) { if (!af(t, i, e)) return } else if (i !== e) return; return 1 } function lf(t, i) { var e = i.si; if (w(e)) { var n = t.yj.H(e); if (null === n) (n = []).push(i), t.yj.add(e, n); else { for (t = 0; t < n.length; t++)if (n[t] === i) return; n.push(i) } } } function uf(t, i, n) { Ph(i, function (t) { for (var i = (t = t.V.j).length, e = 0; e < i; e++)Pr(n, t[e]) }); var e = i.si; if (w(e)) { var o = t.yj.H(e); if (null !== o) for (var r = 0; r < o.length; r++)if (o[r] === i) { o.splice(r, 1), 0 === o.length && t.yj.remove(e); break } } } function cf(t, i, e, n, o) { if (null === i || o && !i.canCopy()) return null; if (n.contains(i)) return n.H(i); var r = t.copyPartData(i, e); if (!(r instanceof Hl)) return null; if (r.isSelected = !1, r.isHighlighted = !1, n.add(i, r), i instanceof pu) { for (var s = i.linksConnected; s.next();) { var a, h = s.value; h.fromNode !== i || null !== (a = n.H(h)) && (a.fromNode = r), h.toNode === i && (null !== (h = n.H(h)) && (h.toNode = r)) } if (i instanceof Lu && r instanceof Lu) for (i = i.memberParts; i.next();)(s = cf(t, i.value, e, n, o)) instanceof Fu || null === s || (s.containingGroup = r) } else if (i instanceof Fu && r instanceof Fu) for (null !== (s = i.fromNode) && (null !== (s = n.H(s)) && (r.fromNode = s)), null !== (s = i.toNode) && (null !== (s = n.H(s)) && (r.toNode = s)), i = i.labelNodes; i.next();)null !== (s = cf(t, i.value, e, n, o)) && s instanceof pu && (s.labeledLink = r); return r } Hc.className = "GridLayout", Hc.standardComparer = Wc, Hc.smartComparer = function (t, i) { if (null === t) return null !== i ? -1 : 0; if (null === i) return 1; t = t.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/), i = i.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/); for (var e = 0; e < t.length; e++)if ("" !== i[e] && void 0 !== i[e]) { var n = parseFloat(t[e]), o = parseFloat(i[e]); if (isNaN(n)) { if (!isNaN(o)) return 1; if (0 !== t[e].localeCompare(i[e])) return t[e].localeCompare(i[e]) } else { if (isNaN(o)) return -1; if (0 != n - o) return n - o } } else if ("" !== t[e]) return 1; return "" !== i[e] && void 0 !== i[e] ? -1 : 0 }, Hc.Position = Jc, Hc.Location = Zc, Hc.LeftToRight = $c, Hc.RightToLeft = Qc, Hc.Forward = _c, Hc.Reverse = tf, Hc.Ascending = ef, Hc.Descending = nf, (t = of.prototype).clear = function () { this.To.clear(), this.to.clear(), this.Ca.clear(), this.Oe.clear(), this.Ne.clear(), this.yj.clear() }, t.$d = function (t) { this.B = t }, t.aj = function (t) { var i; t instanceof pu ? (this.To.add(t), t instanceof Lu && (null === (i = t.containingGroup) ? this.B.wh.add(t) : i.yl.add(t), null !== (i = t.layout) && (i.diagram = this.B))) : t instanceof Fu ? this.to.add(t) : t instanceof du || this.Ca.add(t), null === (i = t.data) || t instanceof du || (t instanceof Fu ? this.Ne.add(i, t) : this.Oe.add(i, t)) }, t.Fc = function (t) { var i; t.Yj(), t instanceof pu ? (this.To.remove(t), t instanceof Lu && (null === (i = t.containingGroup) ? this.B.wh.remove(t) : i.yl.remove(t), null !== (i = t.layout) && (i.diagram = null))) : t instanceof Fu ? this.to.remove(t) : t instanceof du || this.Ca.remove(t), null === (i = t.data) || t instanceof du || (t instanceof Fu ? this.Ne.remove(i) : this.Oe.remove(i)) }, t.zd = function () { for (var t = this.B.nodeTemplateMap.iterator; t.next();) { var i = t.value, e = t.key; (!i.Wb() || i instanceof Lu) && B('Invalid node template in Diagram.nodeTemplateMap: template for "' + e + '" must be a Node or a simple Part, not a Group or Link: ' + i) } for (t = this.B.groupTemplateMap.iterator; t.next();)i = t.value, e = t.key, i instanceof Lu || B('Invalid group template in Diagram.groupTemplateMap: template for "' + e + '" must be a Group, not a normal Node or Link: ' + i); for (t = this.B.linkTemplateMap.iterator; t.next();)i = t.value, e = t.key, i instanceof Fu || B('Invalid link template in Diagram.linkTemplateMap: template for "' + e + '" must be a Link, not a normal Node or simple Part: ' + i); for (t = zi(), i = this.B.selection.iterator; i.next();)(e = i.value.data) && t.push(e); for (i = zi(), e = this.B.highlighteds.iterator; e.next();) { var n = e.value.data; n && i.push(n) } for (e = zi(), n = this.nodes.iterator; n.next();) { var o = n.value; null !== o.data && (e.push(o.data), e.push(o.location)) } for (n = this.links.iterator; n.next();)null !== (o = n.value).data && (e.push(o.data), e.push(o.location)); for (n = this.parts.iterator; n.next();)null !== (o = n.value).data && (e.push(o.data), e.push(o.location)); for (this.removeAllModeledParts(), this.addAllModeledParts(), n = 0; n < t.length; n++)null !== (o = this.wc(t[n])) && (o.isSelected = !0); for (n = 0; n < i.length; n++)null !== (o = this.wc(i[n])) && (o.isHighlighted = !0); for (n = 0; n < e.length; n += 2)null !== (o = this.wc(e[n])) && (o.location = e[n + 1]); Vi(t), Vi(i), Vi(e) }, of.prototype.addAllModeledParts = function () { this.addModeledParts(this.diagram.model.nodeDataArray) }, of.prototype.addModeledParts = function (t, i) { var e = this, n = this.diagram.model; t.forEach(function (t) { n.nb(t) && rf(e, t, !1) }), t.forEach(function (t) { n.nb(t) && e.resolveReferencesForData(t) }), !1 !== i && Tr(this.diagram, !1) }, of.prototype.insertLink = function () { return null }, of.prototype.resolveReferencesForData = function () { }, of.prototype.pt = function (t) { return this.B.model.pt(t) }, of.prototype.getLinkCategoryForData = function () { return "" }, of.prototype.setLinkCategoryForData = function () { }, of.prototype.setFromNodeForLink = function () { }, of.prototype.setToNodeForLink = function () { }, of.prototype.findLinkTemplateForCategory = function (t) { var i = this.B.linkTemplateMap.H(t); return null === i && (null === (i = this.B.linkTemplateMap.H("")) && (pf || (pf = !0, v('No Link template found for category "' + t + '"'), v("  Using default link template")), i = this.B.iu)), i }, of.prototype.removeAllModeledParts = function () { this.Kt(this.diagram.model.nodeDataArray) }, of.prototype.Kt = function (t) { var i = this; t.forEach(function (t) { i.Hq(t) }) }, of.prototype.Hq = function (t) { null !== (t = this.wc(t)) && (cr(this.diagram, t, !1), this.unresolveReferencesForPart(t)) }, of.prototype.unresolveReferencesForPart = function () { }, of.prototype.removeDataForLink = function () { }, of.prototype.findPartForKey = function (t) { return null != t && null !== (t = this.B.model.Jb(t)) ? this.Oe.H(t) : null }, of.prototype.Kb = function (t) { return null != t && null !== (t = this.B.model.Jb(t)) && (t = this.Oe.H(t)) instanceof pu ? t : null }, of.prototype.findLinkForKey = function () { return null }, (t = of.prototype).wc = function (t) { if (null === t) return null; var i = this.Oe.H(t); return null !== i ? i : i = this.Ne.H(t) }, t.Si = function (t) { return null !== t && (t = this.Oe.H(t)) instanceof pu ? t : null }, t.vc = function (t) { return null === t ? null : this.Ne.H(t) }, t.mt = function (t) { for (var i = 0; i < arguments.length; ++i); i = new $; for (var e = this.To.iterator; e.next();) { var n = e.value, o = n.data; if (null !== o) for (var r = 0; r < arguments.length; r++) { var s = arguments[r]; if (b(s) && af(this, o, s)) { i.add(n); break } } } return i.iterator }, t.lt = function (t) { for (var i = 0; i < arguments.length; ++i); i = new $; for (var e = this.to.iterator; e.next();) { var n = e.value, o = n.data; if (null !== o) for (var r = 0; r < arguments.length; r++) { var s = arguments[r]; if (b(s) && af(this, o, s)) { i.add(n); break } } } return i.iterator }, of.prototype.doModelChanged = function (t) { if (this.B) { var i = this.B; if (t.model === i.model) { var e = t.change; if (i.doModelChanged(t), i.Z) { i.Z = !1; try { var n, o, r, s, a = t.modelChange; if ("" !== a) e === be ? ("nodeCategory" === a ? (n = this.wc(t.object), o = t.newValue, null !== n && "string" == typeof o && (n.category = o)) : "nodeDataArray" === a && (this.Kt(t.oldValue), this.addModeledParts(t.newValue)), i.isModified = !0) : e === we ? (r = t.newValue, "nodeDataArray" === a && b(r) && rf(this, r), i.isModified = !0) : e === ke ? (s = t.oldValue, "nodeDataArray" === a && b(s) && this.Hq(s), i.isModified = !0) : e === xe && ("SourceChanged" === a ? null !== t.object ? this.updateDataBindings(t.object, t.propertyName) : (this.Qq(), this.updateAllTargetBindings()) : "ModelDisplaced" === a && this.zd()); else if (e === be) { var h = t.propertyName, l = t.object; l === i.model ? "nodeKeyProperty" !== h && "nodeCategoryProperty" !== h || i.undoManager.isUndoingRedoing || this.zd() : this.updateDataBindings(l, h), i.isModified = !0 } else if (e === we || e === ke) { var u = t.change === we, c = u ? t.newParam : t.oldParam, f = u ? t.newValue : t.oldValue, d = this.yj.H(t.object); if (Array.isArray(d)) for (t = 0; t < d.length; t++) { var p, g = d[t]; u ? Oh(g, f, c) : c < 0 || (p = c + Fh(g), g.Fc(p, !0), Bh(g, p, c)) } i.isModified = !0 } } finally { i.Z = !0 } } } } }, of.prototype.updateAllTargetBindings = function (t) { void 0 === t && (t = ""); for (var i = this.parts.iterator; i.next();)i.value.Ba(t); for (i = this.nodes.iterator; i.next();)i.value.Ba(t); for (i = this.links.iterator; i.next();)i.value.Ba(t) }, of.prototype.Qq = function () { for (var i = this.B.model, e = new $, t = i.nodeDataArray, n = 0; n < t.length; n++)e.add(t[n]); var o = []; for (this.nodes.each(function (t) { null === t.data || e.contains(t.data) || o.push(t.data) }), this.parts.each(function (t) { null === t.data || e.contains(t.data) || o.push(t.data) }), o.forEach(function (t) { Rf(i, t, !1) }), n = 0; n < t.length; n++) { var r = t[n]; null === this.wc(r) && If(i, r, !1) } for (this.refreshDataBoundLinks(), t = this.parts.iterator; t.next();)t.value.updateRelationshipsFromData(); for (t = this.nodes.iterator; t.next();)t.value.updateRelationshipsFromData(); for (t = this.links.iterator; t.next();)t.value.updateRelationshipsFromData() }, of.prototype.refreshDataBoundLinks = function () { }, of.prototype.updateRelationshipsFromData = function () { }, of.prototype.updateDataBindings = function (t, i) { if ("string" == typeof i) { var e = this.wc(t); if (null !== e) e.Ba(i); else { e = null; for (var n = this.yj.iterator; n.next();) { for (var o = n.value, r = 0; r < o.length; r++) { var s = o[r].Mx(t); null !== s && (null === e && (e = zi()), e.push(s)) } if (null !== e) break } if (null !== e) { for (n = 0; n < e.length; n++)e[n].Ba(i); Vi(e) } } t === this.diagram.model.modelData && this.updateAllTargetBindings(i) } }, of.prototype.ck = function (t, i, e) { var n, o = new at; if (w(t)) for (var r = 0; r < t.length; r++)cf(this, t[r], i, o, e); else for (t = t.iterator; t.next();)cf(this, t.value, i, o, e); if (null !== i) { e = i.model, t = null !== (t = i.toolManager.findTool("Dragging")) ? t.dragOptions.dragsLink : i.Qk.dragsLink, r = new $; for (var s = new at, a = o.iterator; a.next();) { var h, l, u = a.value; u instanceof Fu ? t || null !== u.fromNode && null !== u.toNode || r.add(u) : u instanceof pu && null !== u.data && e.pm() && (h = u, null !== (l = (u = a.key).yg()) && (null !== (l = o.H(l)) ? (e.He(h.data, e.ja(l.data)), h = i.vc(h.data), null !== (u = u.Vi()) && null !== h && s.add(u, h)) : e.He(h.data, void 0))) } if (0 < r.count && i.Lt(r, !1), 0 < s.count) for (e = s.iterator; e.next();)o.add(e.key, e.value) } for (null !== i && null !== this.B && null !== (e = (i = i.model).afterCopyFunction) && (n = new at, o.each(function (t) { null !== t.key.data && n.add(t.key.data, t.value.data) }), e(n, i, this.B.model)), i = o.iterator; i.next();)i.value.Ba(); return o }, of.prototype.copyPartData = function (t, i) { var e, n = null, o = t.data; return null !== o && null !== i ? (e = i.model, t instanceof Fu || b(o = e.copyNodeData(o)) && (e.pf(o), n = i.wc(o))) : (Dh(t), null !== (n = t.copy()) && (e = this.B, null !== i ? i.add(n) : null !== o && null !== e && null !== e.commandHandler && e.commandHandler.copiesClipboardData && (i = e.model, e = null, n instanceof Fu || (e = i.copyNodeData(o)), b(e) && (n.data = e)))), n }, l.Object.defineProperties(of.prototype, { nodes: { get: function () { return this.To } }, links: { get: function () { return this.to } }, parts: { get: function () { return this.Ca } }, diagram: { get: function () { return this.B } }, addsToTemporaryLayer: { get: function () { return this.Uq }, set: function (t) { this.Uq = t } } }), of.prototype.updateAllRelationshipsFromData = of.prototype.Qq, of.prototype.findLinksByExample = of.prototype.lt, of.prototype.findNodesByExample = of.prototype.mt, of.prototype.findLinkForData = of.prototype.vc, of.prototype.findNodeForData = of.prototype.Si, of.prototype.findPartForData = of.prototype.wc, of.prototype.findNodeForKey = of.prototype.Kb, of.prototype.removeModeledPart = of.prototype.Hq, of.prototype.removeModeledParts = of.prototype.Kt, of.prototype.rebuildParts = of.prototype.zd; var ff = !1, df = !1, pf = !1; function gf(t) { of.apply(this, arguments) } function yf(i, t) { t.forEach(function (t) { mf(i, t) }), Tr(i.diagram, !1) } function mf(i, t) { var e, n, o, r; null == t || i.diagram.undoManager.isUndoingRedoing || i.Ne.contains(t) || (e = i.getLinkCategoryForData(t), null !== (n = i.findLinkTemplateForCategory(e)) && (Dh(n), null !== (o = n.copy()) && (n = i.diagram.skipsModelSourceBindings, i.diagram.skipsModelSourceBindings = !0, o.If = e, o.jb = t, "" !== (r = nd(e = i.diagram.model, t, !0)) && (o.fromPortId = r), void 0 === (r = id(e, t, !0)) || (r = i.Kb(r)) instanceof pu && (o.fromNode = r), "" !== (r = nd(e, t, !1)) && (o.toPortId = r), void 0 === (r = id(e, t, !1)) || (r = i.Kb(r)) instanceof pu && (o.toNode = r), e = e.zg(t), Array.isArray(e) && e.forEach(function (t) { null !== (t = i.Kb(t)) && (t.labeledLink = o) }), i.Uq && (o.ah = "Tool"), i.diagram.add(o), o.jb = null, o.data = t, i.diagram.skipsModelSourceBindings = n))) } function vf(i, t) { t.forEach(function (t) { i.Hq(t) }) } function xf() { of.apply(this, arguments), this.ih = null } function bf(t, i, e) { if (null !== i && null !== e) { var n, o = t.diagram.toolManager.findTool("Linking"), r = i, s = e; if (t.diagram.isTreePathToChildren) { for (i = s.linksConnected; i.next();)if (i.value.toNode === s) return } else for (s = i, i = (r = e).linksConnected; i.next();)if (i.value.fromNode === r) return; null !== o && rn(o, r, s, null, !0) || (o = t.getLinkCategoryForData(e.data), null !== (i = t.findLinkTemplateForCategory(o)) && (Dh(i), null !== (i = i.copy())) && (n = t.diagram.skipsModelSourceBindings, t.diagram.skipsModelSourceBindings = !0, i.If = o, i.jb = e.data, i.fromNode = r, i.toNode = s, t.diagram.add(i), i.jb = null, i.data = e.data, t.diagram.skipsModelSourceBindings = n)) } } function wf(t) { this.Xt = ',\n  "insertedNodeKeys": ', this.Lw = ',\n  "modifiedNodeData": ', this.Zt = ',\n  "removedNodeKeys": ', this.Ph = null, Q(this), this.tn = this.Qa = "", this.Wf = !1, this.l = {}, this.Cc = [], this.Ua = new at, this.Ai = "key", this.Ok = this.vl = null, this.kn = this.ln = !1, this.nn = !0, this.Sm = null, this.Gj = "category", this.Of = new at, this.Gu = new J, this.pg = !1, this.u = null, this.undoManager = new Se, void 0 !== t && (this.nodeDataArray = t) } function kf(t) { return ',\n  "modelData": ' + Df(t, t.modelData) } function Mf(t, i) { b(i = i.modelData) && (t.Am(i), t.modelData = i) } function Sf(t, i, e, n) { if (i === e) return 1; if (typeof i == typeof e && "function" != typeof i && "function" != typeof e) { if (Array.isArray(i) && Array.isArray(e)) { if (n.H(i) === e) return 1; if (n.add(i, e), i.length !== e.length) return; for (var o = 0; o < i.length; o++)if (!Sf(t, i[o], e[o], n)) return; return 1 } if (b(i) && b(e)) { if (n.H(i) === e) return 1; for (var r in n.add(i, e), i) { var s = i[r]; if (!Af(r, s)) { var a = e[r]; if (void 0 === a || !Sf(t, s, a, n)) return } } for (o in e) if (!Af(o, r = e[o]) && (void 0 === (s = i[o]) || !Sf(t, s, r, n))) return; return 1 } } } function Pf(t, i, e) { t[e] !== i[e] && B("Model.computeJsonDifference: Model." + e + ' is not the same in both models: "' + t[e] + '" and "' + i[e] + '"') } function Nf(t, i) { function e(t, i) { var e; t !== (i = i.part.data) && (null === (e = n.get(t)) ? ((e = new $).add(i), n.add(t, e)) : e.add(i)) } var n = t.Ph; null === n && (n = new at, i.changes.each(function (t) { var i; null !== t.diagram && ((i = t.change) === be ? (t = t.object.panel) && (i = t.data) && e(i, t) : i !== we && i !== ke || (i = (t = t.object).itemArray) && e(i, t)) }), t.Ph = n) } function Cf(t, i) { for (var e = new $, n = 0; n < t.nodeDataArray.length; n++) { var o = t.nodeDataArray[n]; Tf(t, i, o, o, e) } return e } function Tf(t, i, e, n, o) { if (Array.isArray(e)) for (var r = 0; r < e.length; r++) { var s = e[r]; if (s === i) return o.add(n), 1; if (Tf(t, i, s, n, o)) return 1 } else if (b(e) && Object.getPrototypeOf(e) === Object.prototype) for (r in e) { if ((s = e[r]) === i) return o.add(n), 1; if (Tf(t, i, s, n, o)) return 1 } } function Lf(t, i, e) { void 0 === e && (e = !1); var n = i.length; if (n <= 0) return "[]"; var o = new G; o.add("[ "), e && 1 < n && o.add("\n"); for (var r = 0; r < n; r++) { var s = i[r]; void 0 !== s && (0 < r && (o.add(","), e && o.add("\n")), o.add(t.Km(s))) } return e && 1 < n && o.add("\n"), o.add(" ]"), o.toString() } function Af(t, i) { return void 0 === i || "__gohashid" === t || "_" === t[0] || "function" == typeof i } function jf(t) { return isNaN(t) ? "NaN" : 1 / 0 === t ? "9e9999" : -1 / 0 === t ? "-9e9999" : t } function Df(t, i) { if ((n = i) instanceof gi) i = { class: "go.Point", x: jf(n.x), y: jf(n.y) }; else if (n instanceof Yi) i = { class: "go.Size", width: jf(n.width), height: jf(n.height) }; else if (n instanceof yi) i = { class: "go.Rect", x: jf(n.x), y: jf(n.y), width: jf(n.width), height: jf(n.height) }; else if (n instanceof Xt) i = { class: "go.Margin", top: jf(n.top), right: jf(n.right), bottom: jf(n.bottom), left: jf(n.left) }; else if (n instanceof Oi) i = n.gb() ? { class: "go.Spot", x: jf(n.x), y: jf(n.y), offsetX: jf(n.offsetX), offsetY: jf(n.offsetY) } : { class: "go.Spot", enum: n.toString() }; else if (n instanceof La) { if (i = { class: "go.Brush", type: n.type.name }, n.type === Xa ? i.color = n.color : n.type !== qa && n.type !== Ua || (i.start = n.start, i.end = n.end, n.type === Ua && (0 !== n.startRadius && (i.startRadius = jf(n.startRadius)), isNaN(n.endRadius) || (i.endRadius = jf(n.endRadius)))), null !== n.colorStops) { for (var e = {}, n = n.colorStops.iterator; n.next();)e[n.key] = n.value; i.colorStops = e } } else n instanceof Ui ? (i = { class: "go.Geometry", type: n.type.name }, 0 !== n.startX && (i.startX = jf(n.startX)), 0 !== n.startY && (i.startY = jf(n.startY)), 0 !== n.endX && (i.endX = jf(n.endX)), 0 !== n.endY && (i.endY = jf(n.endY)), n.spot1.w(Ht) || (i.spot1 = n.spot1), n.spot2.w(ti) || (i.spot2 = n.spot2), n.type === re && (i.path = Hi(n))) : n instanceof V && (i = { class: "go.EnumValue", classType: Xf(t, n.classType), name: n.name }); for (var o in e = "{", n = !0, i) { if (!Af(o, s = Uf(i, o))) if (n ? n = !1 : e += ", ", e += '"' + o + '":', "points" === o && s instanceof J) { for (var r = "[", s = s.iterator; s.next();) { var a = s.value; 1 < r.length && (r += ","), r += t.Km(a.x), r += ",", r += t.Km(a.y) } e += r += "]" } else e += t.Km(s) } return e + "}" } function Ff(t) { return "number" == typeof t ? t : "NaN" === t ? NaN : "9e9999" === t ? 1 / 0 : "-9e9999" === t ? -1 / 0 : parseFloat(t) } function Of(t, i, e, n, o, r, s, a, h) { void 0 === a && (a = null), void 0 === h && (h = null); var l = new ve; l.model = t, l.change = e, l.modelChange = i, l.propertyName = n, l.object = o, l.oldValue = r, l.oldParam = a, l.newValue = s, l.newParam = h, t.dt(l) } function Bf(t) { return "number" == typeof t || "string" == typeof t } function If(t, i, e) { var n = t.ja(i); void 0 !== n && t.Ua.H(n) === i || (t.Bt(i), void 0 === (n = t.ja(i)) ? B("Model.makeNodeDataKeyUnique failed on " + i + ".  Data not added to Model.") : (t.Ua.add(n, i), n = null, e && (n = t.Cc.length, M(t.Cc, n, i)), Of(t, "nodeDataArray", we, "nodeDataArray", t, null, i, null, n), t.Cm(i), t.Bm(i))) } function Rf(t, i, e) { var n = t.ja(i); if (void 0 !== n && t.Ua.remove(n), n = null, e) { t: if (e = t.Cc, Array.isArray(e)) n = e.indexOf(i); else { n = e.length; for (var o = 0; o < n; o++)if (e[o] === i) { n = o; break t } n = -1 } if (n < 0) return; S(t.Cc, n) } Of(t, "nodeDataArray", ke, "nodeDataArray", t, i, null, n, null), t.Pq(i) } function Ef(t, i, e) { var n; void 0 !== i && (null === (n = t.Of.H(i)) && (n = new $, t.Of.add(i, n)), n.add(e)) } function zf(t, i, e) { var n; void 0 === i || (n = t.Of.H(i)) instanceof $ && (null == e ? t.Of.remove(i) : (n.remove(e), 0 === n.count && t.Of.remove(i))) } function Vf(t, i) { return void 0 !== i && (t = t.Of.H(i)) instanceof $ ? t : null } function Yf(t, i, e) { if (t.copiesArrays && Array.isArray(i)) { var n = []; for (e = 0; e < i.length; e++) { var o = Yf(t, i[e], t.copiesArrayObjects); n.push(o) } return Q(n), n } if (e && b(i)) { for (n in e = (e = i.constructor) ? new e : {}, o = t.copiesKey || "string" != typeof t.nodeKeyProperty ? null : t.nodeKeyProperty, i) { var r, s; "__gohashid" === n ? e.__gohashid = void 0 : n === o ? e[o] = void 0 : ("GraphObject" === (s = Xf(t, r = Uf(i, n))) || "Diagram" === s || "Layer" === s || "RowColumnDefinition" === s || "AnimationManager" === s || "Tool" === s || "CommandHandler" === s || "Layout" === s || "InputEvent" === s || "DiagramEvent" === s || r instanceof wf || r instanceof Se || r instanceof Me || r instanceof ve || (r = Yf(t, r, !1)), Kf(e, n, r)) } return Q(e), e } return i instanceof gi || i instanceof Yi || i instanceof yi || i instanceof Oi || i instanceof Xt ? i.copy() : i } function Gf() { return new wf } function Xf(t, i) { if ("function" == typeof i) { if (i.className) return i.className; if (i.name) return i.name } else if ("object" == typeof i && null !== i && i.constructor) return Xf(t, i.constructor); return typeof i } function qf(t) { return Wf[t] ? Wf[t] : void 0 !== c.go && c.go[t] ? c.go[t] : null } function Uf(t, i) { if (!t || !i) return null; try { var e; "function" == typeof i ? e = i(t) : "function" == typeof t.getAttribute ? null === (e = t.getAttribute(i)) && (e = void 0) : e = t[i] } catch (t) { } return e } function Kf(t, i, e) { if (t && i) try { "function" == typeof i ? i(t, e) : "function" == typeof t.setAttribute ? t.setAttribute(i, e) : t[i] = e } catch (t) { } } of.className = "PartManager", h(gf, of), gf.prototype.addAllModeledParts = function () { var t = this.diagram.model; this.addModeledParts(t.nodeDataArray), yf(this, t.linkDataArray) }, gf.prototype.addModeledParts = function (t) { for (of.prototype.addModeledParts.call(this, t, !1), t = this.links.iterator; t.next();)Ou(t.value); Tr(this.diagram, !1) }, gf.prototype.removeAllModeledParts = function () { var t = this.diagram.model; vf(this, t.linkDataArray), this.Kt(t.nodeDataArray) }, gf.prototype.getLinkCategoryForData = function (t) { return this.diagram.model.Av(t) }, gf.prototype.setLinkCategoryForData = function (t, i) { return this.diagram.model.Nt(t, i) }, gf.prototype.setFromNodeForLink = function (t, i) { var e = this.diagram.model; e.ky(t.data, e.ja(null !== i ? i.data : null)) }, gf.prototype.setToNodeForLink = function (t, i) { var e = this.diagram.model; e.oy(t.data, e.ja(null !== i ? i.data : null)) }, gf.prototype.removeDataForLink = function (t) { this.diagram.model.ym(t.data) }, gf.prototype.findPartForKey = function (t) { var i = of.prototype.findPartForKey.call(this, t); return null === i && null !== (t = this.diagram.model.wg(t)) ? this.Ne.H(t) : i }, gf.prototype.findLinkForKey = function (t) { return null != t && null !== (t = this.diagram.model.wg(t)) ? this.Ne.H(t) : null }, gf.prototype.doModelChanged = function (t) { var i = this; if (of.prototype.doModelChanged.call(this, t), this.diagram) { var e = this.diagram; if (t.model === e.model) { var n = t.change; if (e.Z) { e.Z = !1; try { var o, r, s, a, h, l, u, c, f, d, p, g, y, m, v, x, b, w, k, M, S, P, N = t.modelChange; "" !== N ? n === be ? ("linkFromKey" === N ? null !== (o = this.vc(t.object)) && (r = this.Kb(t.newValue), o.fromNode = r) : "linkToKey" === N ? null !== (s = this.vc(t.object)) && (a = this.Kb(t.newValue), s.toNode = a) : "linkFromPortId" === N ? null === (h = this.vc(t.object)) || "string" == typeof (l = t.newValue) && (h.fromPortId = l) : "linkToPortId" === N ? null === (u = this.vc(t.object)) || "string" == typeof (c = t.newValue) && (u.toPortId = c) : "nodeGroupKey" === N ? null !== (f = this.wc(t.object)) && (void 0 !== (d = t.newValue) ? (p = this.Kb(d), f.containingGroup = p instanceof Lu ? p : null) : f.containingGroup = null) : "linkLabelKeys" === N ? null !== (g = this.vc(t.object)) && (y = t.oldValue, m = t.newValue, Array.isArray(y) && y.forEach(function (t) { null !== (t = i.Kb(t)) && (t.labeledLink = null) }), Array.isArray(m) && m.forEach(function (t) { null !== (t = i.Kb(t)) && (t.labeledLink = g) })) : "linkCategory" === N ? (v = this.vc(t.object), x = t.newValue, null !== v && "string" == typeof x && (v.category = x)) : "linkDataArray" === N && (vf(this, t.oldValue), yf(this, t.newValue)), e.isModified = !0) : n === we ? (b = t.newValue, "linkDataArray" === N && "object" == typeof b && null !== b ? mf(this, b) : "linkLabelKeys" === N && Bf(b) && (w = this.vc(t.object), k = this.Kb(b), null !== w && null !== k && (k.labeledLink = w)), e.isModified = !0) : n === ke && (M = t.oldValue, "linkDataArray" === N && "object" == typeof M && null !== M ? this.Hq(M) : "linkLabelKeys" !== N || !Bf(M) || null !== (S = this.Kb(M)) && (S.labeledLink = null), e.isModified = !0) : n === be && (P = t.propertyName, t.object !== e.model || "linkFromKeyProperty" !== P && "linkToKeyProperty" !== P && "linkFromPortIdProperty" !== P && "linkToPortIdProperty" !== P && "linkLabelKeysProperty" !== P && "nodeIsGroupProperty" !== P && "nodeGroupKeyProperty" !== P && "linkCategoryProperty" !== P || e.undoManager.isUndoingRedoing || this.zd(), e.isModified = !0) } finally { e.Z = !0 } } } } }, gf.prototype.refreshDataBoundLinks = function () { var i = this, e = this.diagram.model, n = new $, t = e.linkDataArray; t.forEach(function (t) { n.add(t) }); var o = []; this.links.each(function (t) { null === t.data || n.contains(t.data) || o.push(t.data) }), o.forEach(function (t) { sd(e, t, !1) }), t.forEach(function (t) { null === i.vc(t) && rd(e, t, !1) }) }, gf.prototype.updateRelationshipsFromData = function (i) { var t = i.data; if (null !== t) { var e = i.diagram; if (null !== e) { var n = e.model; if (i instanceof Fu) { var o = id(n, t, !0), o = e.Kb(o); if (i.fromNode = o, o = id(n, t, !1), o = e.Kb(o), i.toNode = o, 0 < (t = n.zg(t)).length || 0 < i.labelNodes.count) { if (1 === t.length && 1 === i.labelNodes.count) { o = t[0]; var r = i.labelNodes.first(); if (n.ja(r.data) === o) return } o = (new $).addAll(t); var s = new $; i.labelNodes.each(function (t) { null !== t.data && (void 0 !== (t = n.ja(t.data)) && s.add(t)) }), (t = s.copy()).Gq(o), (o = o.copy()).Gq(s), (0 < t.count || 0 < o.count) && (t.each(function (t) { null !== (t = e.Kb(t)) && t.labeledLink === i && (t.labeledLink = null) }), o.each(function (t) { null !== (t = e.Kb(t)) && t.labeledLink !== i && (t.labeledLink = i) })) } } else !(i instanceof du) && (t = n.Yi(t), null === (t = e.findPartForKey(t)) || t instanceof Lu) && (i.containingGroup = t) } } }, gf.prototype.resolveReferencesForData = function (t) { var i = this.diagram.model, e = i.ja(t); if (void 0 !== e) { var n = Vf(i, e), o = this.wc(t); if (null !== n && null !== o) { n = n.iterator; for (var r = {}; n.next();) { var s = n.value; i.nb(s) ? o instanceof Lu && i.Yi(s) === e && (null !== (s = this.wc(s)) && (s.containingGroup = o)) : (r.link = this.vc(s), null !== r.link && o instanceof pu && (id(i, s, !0) === e && (r.link.fromNode = o), id(i, s, !1) === e && (r.link.toNode = o), s = i.zg(s), Array.isArray(s) && s.some(function (i) { return function (t) { return t === e && (o.labeledLink = i.link, !0) } }(r)))), r = { link: r.link } } zf(i, e) } void 0 !== (t = i.Yi(t)) && ((t = this.Kb(t)) instanceof Lu && (o.containingGroup = t)) } }, gf.prototype.unresolveReferencesForPart = function (t) { var i = this.diagram.model; if (t instanceof pu) { var e = i.ja(t.data); if (void 0 !== e) { for (var n = t.linksConnected; n.next();)Ef(i, e, n.value.data); if (t.isLinkLabel && (null !== (n = t.labeledLink) && Ef(i, e, n.data)), t instanceof Lu) for (t = t.memberParts; t.next();)n = t.value.data, i.nb(n) && Ef(i, e, n) } } }, gf.prototype.copyPartData = function (t, i) { var e, n = of.prototype.copyPartData.call(this, t, i); return t instanceof Fu && (null !== (t = t.data) && null !== i ? "object" == typeof (t = (e = i.model).iq(t)) && null !== t && (e.Ni(t), n = i.vc(t)) : null !== n && (i = this.diagram, null === t || null === i || null === i.commandHandler || !i.commandHandler.copiesClipboardData || "object" == typeof (i = i.model.iq(t)) && null !== i && (n.data = i))), n }, gf.prototype.insertLink = function (t, i, e, n) { var o = this.diagram, r = o.model, s = o.toolManager.findTool("Linking"), a = ""; if (null !== t && (null === i && (i = t), null === (a = i.portId) && (a = "")), i = "", null !== e && (null === n && (n = e), null === (i = n.portId) && (i = "")), (n = s.archetypeLinkData) instanceof Fu) { if (Dh(n), null !== (r = n.copy())) return r.fromNode = t, r.fromPortId = a, r.toNode = e, r.toPortId = i, o.add(r), (t = s.archetypeLabelNodeData) instanceof pu && (Dh(t), null !== (t = t.copy()) && (t.labeledLink = r, o.add(t))), r } else if (null !== n && ("object" == typeof (n = r.iq(n)) && null !== n)) return null !== t && ed(r, n, r.ja(t.data), !0), od(r, n, a, !0), null !== e && ed(r, n, r.ja(e.data), !1), od(r, n, i, !1), r.Ni(n), null === (t = s.archetypeLabelNodeData) || t instanceof pu || "object" == typeof (t = r.copyNodeData(t)) && null !== t && (r.pf(t), void 0 !== (t = r.ja(t)) && r.hv(n, t)), o.vc(n); return null }, gf.prototype.findLinkForKey = gf.prototype.findLinkForKey, gf.prototype.findPartForKey = gf.prototype.findPartForKey, gf.prototype.removeAllModeledParts = gf.prototype.removeAllModeledParts, gf.prototype.addModeledParts = gf.prototype.addModeledParts, gf.prototype.addAllModeledParts = gf.prototype.addAllModeledParts, gf.className = "GraphLinksPartManager", h(xf, of), xf.prototype.getLinkCategoryForData = function (t) { return this.diagram.model.Bv(t) }, xf.prototype.setLinkCategoryForData = function (t, i) { this.diagram.model.iw(t, i) }, xf.prototype.setFromNodeForLink = function (t, i, e) { var n, o = this.diagram.model; void 0 === e && (e = null), i = null !== i ? i.data : null, this.diagram.isTreePathToChildren ? o.He(t.data, o.ja(i)) : (n = this.ih, this.ih = t, null !== e && o.He(e.data, void 0), o.He(i, o.ja(null !== t.toNode ? t.toNode.data : null)), this.ih = n) }, xf.prototype.setToNodeForLink = function (t, i, e) { var n, o = this.diagram.model; void 0 === e && (e = null), i = null !== i ? i.data : null, this.diagram.isTreePathToChildren ? (n = this.ih, this.ih = t, null !== e && o.He(e.data, void 0), o.He(i, o.ja(null !== t.fromNode ? t.fromNode.data : null)), this.ih = n) : o.He(t.data, o.ja(i)) }, xf.prototype.removeDataForLink = function (t) { this.diagram.model.He(t.data, void 0) }, xf.prototype.findLinkForKey = function (t) { return null != t && null !== (t = this.diagram.model.Jb(t)) ? this.Ne.H(t) : null }, xf.prototype.doModelChanged = function (t) { if (of.prototype.doModelChanged.call(this, t), this.diagram) { var i = this.diagram; if (t.model === i.model) { var e = t.change; if (i.Z) { i.Z = !1; try { var n, o, r, s, a, h, l, u, c = t.modelChange; "" !== c ? e === be && ("nodeParentKey" === c ? (n = t.object, o = this.Kb(t.newValue), r = this.Si(n), null !== this.ih ? null !== o && (this.ih.data = n, this.ih.category = this.getLinkCategoryForData(n)) : null !== r && (null !== (s = r.Vi()) ? null === o ? i.remove(s) : i.isTreePathToChildren ? s.fromNode = o : s.toNode = o : bf(this, o, r))) : "parentLinkCategory" === c && (a = this.Si(t.object), h = t.newValue, null === a || "string" != typeof h || null !== (l = a.Vi()) && (l.category = h)), i.isModified = !0) : e === be && (u = t.propertyName, t.object === i.model && "nodeParentKeyProperty" === u && (i.undoManager.isUndoingRedoing || this.zd()), i.isModified = !0) } finally { i.Z = !0 } } } } }, xf.prototype.updateRelationshipsFromData = function (t) { var i, e, n = t.data; null === n || null !== (i = t.diagram) && (e = i.model, t instanceof pu && (n = e.$i(n), (n = i.Kb(n)) !== (e = t.yg()) && (e = t.Vi(), null !== n ? null !== e ? i.isTreePathToChildren ? e.fromNode = n : e.toNode = n : bf(this, n, t) : null !== e && cr(i, e, !1)))) }, xf.prototype.updateDataBindings = function (t, i) { of.prototype.updateDataBindings.call(this, t, i), "string" != typeof i || null === this.wc(t) || null !== (t = this.vc(t)) && t.Ba(i) }, xf.prototype.resolveReferencesForData = function (t) { var i = this.diagram.model, e = i.ja(t); if (void 0 !== e) { var n = Vf(i, e), o = this.wc(t); if (null !== n && null !== o) { for (n = n.iterator; n.next();) { var r = n.value; i.nb(r) && o instanceof pu && i.$i(r) === e && bf(this, o, this.Si(r)) } zf(i, e) } void 0 !== (t = i.$i(t)) && o instanceof pu && (t = this.Kb(t), bf(this, t, o)) } }, xf.prototype.unresolveReferencesForPart = function (t) { var i = this.diagram.model; if (t instanceof pu) { var e, n, o = i.ja(t.data), r = this.vc(t.data); for (null !== r && (r.isSelected = !1, r.isHighlighted = !1, null !== (e = r.layer) && (0 <= (n = e.Fc(-1, r, !1)) && this.diagram.Za(ke, "parts", e, r, null, n, null), null !== (n = r.layerChanged) && n(r, e, null))), r = this.diagram.isTreePathToChildren, t = t.linksConnected; t.next();)e = t.value, e = (r ? e.toNode : e.fromNode).data, i.nb(e) && Ef(i, o, e) } }, xf.prototype.insertLink = function (t, i, e) { i = this.diagram.model; var n = t, o = e; return this.diagram.isTreePathToChildren || (n = e, o = t), null !== n && null !== o ? (i.He(o.data, i.ja(n.data)), o.Vi()) : null }, xf.prototype.findLinkForKey = xf.prototype.findLinkForKey, xf.className = "TreePartManager", wf.prototype.cloneProtected = function (t) { t.Qa = this.Qa, t.tn = this.tn, t.Wf = this.Wf, t.Ai = this.Ai, t.vl = this.vl, t.Ok = this.Ok, t.ln = this.ln, t.kn = this.kn, t.nn = this.nn, t.Sm = this.Sm, t.Gj = this.Gj }, wf.prototype.copy = function () { var t = new this.constructor; return this.cloneProtected(t), t }, wf.prototype.clear = function () { this.Cc = [], this.Ua.clear(), this.Of.clear(), this.undoManager.clear() }, wf.prototype.toString = function (t) { if (void 0 === t && (t = 0), 1 < t) return this.Nq(); var i = ("" !== this.name ? this.name : "") + " Model"; if (0 < t) { i += "\n node data:"; for (var e = (t = this.nodeDataArray).length, n = 0; n < e; n++) { var o = t[n]; i += " " + this.ja(o) + ":" + N(o) } } return i }, wf.prototype.AA = function (t) { t.change !== xe && B("Model.toIncrementalData argument is not a Transaction ChangedEvent:" + t.toString()); var i = t.object; return t.isTransactionFinished && i instanceof Me ? (Nf(this, i), t = this.Aw(i, "FinishedUndo" === t.propertyName), this.Ph = null, t) : null }, wf.prototype.Aw = function (t, i) { var e = this, n = !1, o = new $, r = new $, s = new $, a = this.Ph; t.changes.each(function (t) { t.model === e && ("nodeDataArray" === t.modelChange ? t.change === we ? o.add(t.newValue) : t.change === ke && s.add(t.oldValue) : e.nb(t.object) ? r.add(t.object) : t.change !== be || e.modelData !== t.object && "modelData" !== t.propertyName ? null !== t.object && (a && a.contains(t.object) ? a.get(t.object).each(function (t) { e.nb(t) && r.add(t) }) : Cf(e, t.object).each(function (t) { r.add(t) })) : n = !0) }); var h = new $; o.each(function (t) { h.add(e.ja(t)), i || r.add(t) }); var l = new $; s.each(function (t) { l.add(e.ja(t)), i && r.add(t) }), t = e.cloneDeep(r.na()); var u = null; return n && (null === u && (u = {}), u.modelData = this.cloneDeep(this.modelData)), 0 < h.count && (null === u && (u = {}), i ? u.removedNodeKeys = h.na() : u.insertedNodeKeys = h.na()), 0 < t.length && (null === u && (u = {}), u.modifiedNodeData = t), 0 < l.count && (null === u && (u = {}), i ? u.insertedNodeKeys = l.na() : u.removedNodeKeys = l.na()), u }, wf.prototype.cloneDeep = function (t) { return function t(i, e, n, o, r, s) { function a(t, i) { h ? (void 0 === t.__gohashid && s.push(t), o.set(t, i)) : (t = it++, o.set(t, i), r.set(t, e)) } if (!b(e)) return e; s = s || []; var h = Object.isExtensible(e); o = o || new at; if (h) { var l = o.get(e); if (l) return l } else for (r = r || new at, l = r.iterator; l.next();) { var u = l.key; if (l.value === e && (u = o.get(u))) return u } if (Array.isArray(e)) { a(e, l = []); for (var c = 0; c < e.length; c++)l.push(t(i, e[c], !1, o, r, s)) } else if (e instanceof gi || e instanceof Yi || e instanceof yi || e instanceof Xt || e instanceof Oi) l = e.copy(), a(e, l); else { if (e instanceof La || e instanceof Ui || e instanceof V) return e; if (e instanceof J) l = (new J).addAll(t(i, e.na(), !1, o, r, s)), a(e, l); else if (e instanceof $) l = (new $).addAll(t(i, e.na(), !1, o, r, s)), a(e, l); else if (e instanceof at) l = (new at).addAll(t(i, e.na(), !1, o, r, s)), a(e, l); else if (e instanceof Date) l = new Date(e.getTime()), a(e, l); else if (e instanceof RegExp) l = new RegExp(e), a(e, l), l.lastIndex = e.lastIndex; else if ("function" == typeof e.copy) l = e.copy(), a(e, l); else for (c in a(e, l = {}), e) "__gohashid" !== c && (l[c] = t(i, e[c], !1, o, r, s)) } n && s.forEach(function (t) { delete t.__gohashid }); return l }(this, t, !0) }, (t = wf.prototype).zk = function () { var t = ""; return "" !== this.name && (t += ',\n  "name": ' + this.quote(this.name)), "" !== this.dataFormat && (t += ',\n  "dataFormat": ' + this.quote(this.dataFormat)), this.isReadOnly && (t += ',\n  "isReadOnly": ' + this.isReadOnly), "key" !== this.nodeKeyProperty && "string" == typeof this.nodeKeyProperty && (t += ',\n  "nodeKeyProperty": ' + this.quote(this.nodeKeyProperty)), this.copiesArrays && (t += ',\n  "copiesArrays": true'), this.copiesArrayObjects && (t += ',\n  "copiesArrayObjects": true'), this.copiesKey || (t += ',\n  "copiesKey": false'), "category" !== this.nodeCategoryProperty && "string" == typeof this.nodeCategoryProperty && (t += ',\n  "nodeCategoryProperty": ' + this.quote(this.nodeCategoryProperty)), t }, t.Fq = function (t) { t.name && (this.name = t.name), t.dataFormat && (this.dataFormat = t.dataFormat), t.isReadOnly && (this.isReadOnly = !0), t.nodeKeyProperty && (this.nodeKeyProperty = t.nodeKeyProperty), t.copiesArrays && (this.copiesArrays = !0), t.copiesArrayObjects && (this.copiesArrayObjects = !0), !1 === t.copiesKey && (this.copiesKey = !1), t.nodeCategoryProperty && (this.nodeCategoryProperty = t.nodeCategoryProperty) }, t.Bw = function () { var t, i = this.modelData, e = !1; for (t in i) if (!Af(t, i[t])) { e = !0; break } return i = "", e && (i = kf(this)), i + ',\n  "nodeDataArray": ' + Lf(this, this.nodeDataArray, !0) }, t.Xv = function (t) { Mf(this, t), w(t = t.nodeDataArray) && (this.Am(t), this.nodeDataArray = t) }, t.Sq = function (t) { Pf(this, t, "nodeKeyProperty"); for (var i = new $, e = new $, n = (new $).addAll(this.Ua.iteratorKeys), o = new at, r = t.nodeDataArray, s = r.length, a = 0; a < s; a++) { var h, l = r[a], u = t.ja(l); void 0 !== u ? (n.remove(u), null === (h = this.Jb(u)) ? (i.add(u), e.add(l)) : Sf(this, h, l, o) || e.add(l)) : (this.Bt(l), u = this.ja(l), i.add(u), e.add(l)) } return r = "", Sf(this, this.modelData, t.modelData, o) || (r += kf(this)), 0 < i.count && (r += this.Xt + Lf(this, i.na(), !0)), 0 < e.count && (r += this.Lw + Lf(this, e.na(), !0)), 0 < n.count && (r += this.Zt + Lf(this, n.na(), !0)), r }, t.Vy = function (t, i) { return void 0 === i && (i = Xf(this, this)), '{ "class": ' + this.quote(i) + ', "incremental": 1' + this.zk() + this.Sq(t) + "}" }, t.zw = function (t, i) { var e = this, n = !1, o = new $, r = new $, s = new $, a = this.Ph; t.changes.each(function (t) { t.model === e && ("nodeDataArray" === t.modelChange ? t.change === we ? o.add(t.newValue) : t.change === ke && s.add(t.oldValue) : e.nb(t.object) ? r.add(t.object) : t.change !== be || e.modelData !== t.object && "modelData" !== t.propertyName ? null !== t.object && (a && a.contains(t.object) ? a.get(t.object).each(function (t) { e.nb(t) && r.add(t) }) : Cf(e, t.object).each(function (t) { r.add(t) })) : n = !0) }); var h = new $; o.each(function (t) { h.add(e.ja(t)), i || r.add(t) }); var l = new $; return s.each(function (t) { l.add(e.ja(t)), i && r.add(t) }), t = "", n && (t += kf(this)), 0 < h.count && (t += (i ? this.Zt : this.Xt) + Lf(this, h.na(), !0)), 0 < r.count && (t += this.Lw + Lf(this, r.na(), !0)), 0 < l.count && (t += (i ? this.Xt : this.Zt) + Lf(this, l.na(), !0)), t }, t.Eq = function (t) { (void 0 !== t.name && t.name !== this.name || void 0 !== t.dataFormat && t.dataFormat !== this.dataFormat || void 0 !== t.isReadOnly && t.isReadOnly !== this.isReadOnly || void 0 !== t.nodeKeyProperty && t.nodeKeyProperty !== this.nodeKeyProperty || void 0 !== t.copiesArrays && t.copiesArrays !== this.copiesArrays || void 0 !== t.copiesArrayObjects && t.copiesArrayObjects !== this.copiesArrayObjects || void 0 !== t.copiesKey && t.copiesKey !== this.copiesKey || void 0 !== t.nodeCategoryProperty && t.nodeCategoryProperty !== this.nodeCategoryProperty) && B("applyIncrementalJson cannot change Model properties"), Mf(this, t); var i = t.insertedNodeKeys, e = t.modifiedNodeData, n = new at; if (Array.isArray(e)) for (var o = 0; o < e.length; o++) { var r = e[o], s = this.ja(r); null != s && n.set(s, r) } if (Array.isArray(i)) for (o = i.length, r = 0; r < o; r++) { s = i[r]; var a = this.Jb(s); null === a && (a = (a = n.get(s)) ? a : this.copyNodeData({}), this.Gm(a, s), this.pf(a)) } if (Array.isArray(e)) for (i = e.length, n = 0; n < i; n++)if (o = e[n], r = this.ja(o), null !== (r = this.Jb(r))) for (var h in o) "__gohashid" === h || h === this.nodeKeyProperty || this.ik() && h === this.nodeIsGroupProperty || this.setDataProperty(r, h, o[h]); if (t = t.removedNodeKeys, Array.isArray(t)) for (e = t.length, h = 0; h < e; h++)null !== (i = this.Jb(t[h])) && this.zm(i) }, t.ty = function (t, i) { t.change !== xe && B("Model.toIncrementalJson argument is not a Transaction ChangedEvent:" + t.toString()); var e = t.object; return t.isTransactionFinished && e instanceof Me ? (void 0 === i && (i = Xf(this, this)), Nf(this, e), t = this.zw(e, "FinishedUndo" === t.propertyName), this.Ph = null, "2" === i ? '{ "incremental": 2' + t + "}" : '{ "class": ' + this.quote(i) + ', "incremental": 1' + this.zk() + t + "}") : '{ "incremental": 0 }' }, t.BA = function (t, i) { return this.ty(t, i) }, t.Nq = function (t) { return void 0 === t && (t = Xf(this, this)), '{ "class": ' + this.quote(t) + this.zk() + this.Bw() + "}" }, t.toJSON = function (t) { return this.Nq(t) }, t.yx = function (t) { var i = null; if ("string" == typeof t) try { i = c.JSON.parse(t) } catch (t) { } else "object" == typeof t ? i = t : B("Unable to modify a Model from: " + t); var e = i.incremental; "number" != typeof e && B("Unable to apply non-incremental changes to Model: " + t), 0 !== e && (this.ua("applyIncrementalJson"), this.Eq(i), this.Va("applyIncrementalJson")) }, t.Py = function (t) { return this.yx(t) }, wf.constructGraphLinksModel = function () { return new wf }, (t = wf.prototype).Am = function (t) { if (w(t)) for (var i = t.length, e = 0; e < i; e++) { var n, o = t[e]; b(o) && (n = e, o = this.Am(o), Array.isArray(t) ? t[n] = o : B("Cannot replace an object in an HTMLCollection or NodeList at " + n)) } else if (b(t)) { for (e in t) if (b(n = t[e]) && (n = this.Am(n), t[e] = n, "points" === e && Array.isArray(n))) { o = 0 == n.length % 2; for (var r = 0; r < n.length; r++)if ("number" != typeof n[r]) { o = !1; break } if (o) { for (o = new J, r = 0; r < n.length / 2; r++)o.add(new gi(n[2 * r], n[2 * r + 1])); o.freeze(), t[e] = o } } if ("object" == typeof t) { if (0 === (n = (e = t).class || "").indexOf("go.") && (n = n.substr(3)), "NaN" === n) e = NaN; else if ("Date" === n) e = new Date(t.value); else if ("Point" === n) e = new gi(Ff(t.x), Ff(t.y)); else if ("Size" === n) e = new Yi(Ff(t.width), Ff(t.height)); else if ("Rect" === n) e = new yi(Ff(t.x), Ff(t.y), Ff(t.width), Ff(t.height)); else if ("Margin" === n) e = new Xt(Ff(t.top), Ff(t.right), Ff(t.bottom), Ff(t.left)); else if ("Spot" === n) e = "string" == typeof t.enum ? Ii(t.enum) : new Oi(Ff(t.x), Ff(t.y), Ff(t.offsetX), Ff(t.offsetY)); else if ("Brush" === n) { if ((e = new La).type = Y(La, t.type), "string" == typeof t.color && (e.color = t.color), t.start instanceof Oi && (e.start = t.start), t.end instanceof Oi && (e.end = t.end), "number" == typeof t.startRadius && (e.startRadius = Ff(t.startRadius)), "number" == typeof t.endRadius && (e.endRadius = Ff(t.endRadius)), b(t = t.colorStops)) for (i in t) e.addColorStop(parseFloat(i), t[i]) } else "Geometry" === n ? (i = null, (i = "string" == typeof t.path ? Wi(t.path) : new Ui).type = Y(Ui, t.type), "number" == typeof t.startX && (i.startX = Ff(t.startX)), "number" == typeof t.startY && (i.startY = Ff(t.startY)), "number" == typeof t.endX && (i.endX = Ff(t.endX)), "number" == typeof t.endY && (i.endY = Ff(t.endY)), t.spot1 instanceof Oi && (i.spot1 = t.spot1), t.spot2 instanceof Oi && (i.spot2 = t.spot2), e = i) : "EnumValue" === n && (0 === (i = t.classType).indexOf("go.") && (i = i.substr(3)), "function" == typeof (i = qf(i)) && (e = Y(i, t.name))); t = e } } return t }, t.quote = function (t) { for (var i = "", e = t.length, n = 0; n < e; n++) { var o, r = t[n]; '"' === r || "\\" === r ? i += "\\" + r : "\b" === r ? i += "\\b" : "\f" === r ? i += "\\f" : "\n" === r ? i += "\\n" : "\r" === r ? i += "\\r" : "\t" === r ? i += "\\t" : i = (o = t.charCodeAt(n)) < 16 ? i + ("\\u000" + t.charCodeAt(n).toString(16)) : o < 32 ? i + ("\\u00" + t.charCodeAt(n).toString(16)) : 8232 === o ? i + "\\u2028" : 8233 === o ? i + "\\u2029" : i + r } return '"' + i + '"' }, t.Km = function (t) { return void 0 === t ? "undefined" : null === t ? "null" : !0 === t ? "true" : !1 === t ? "false" : "string" == typeof t ? this.quote(t) : "number" == typeof t ? 1 / 0 === t ? "9e9999" : -1 / 0 === t ? "-9e9999" : isNaN(t) ? '{"class":"NaN"}' : t.toString() : t instanceof Date ? '{"class":"Date", "value":"' + t.toJSON() + '"}' : t instanceof Number ? this.Km(t.valueOf()) : w(t) ? Lf(this, t) : b(t) ? Df(this, t) : "function" == typeof t ? "null" : t.toString() }, t.Ah = function (t) { this.Gu.add(t) }, t.wk = function (t) { this.Gu.remove(t) }, t.dt = function (t) { this.skipsUndoManager || this.undoManager.Gv(t); for (var i = this.Gu, e = i.length, n = 0; n < e; n++)i.L(n)(t) }, t.Za = function (t, i, e, n, o, r, s) { Of(this, "", t, i, e, n, o, r, s) }, t.g = function (t, i, e, n, o) { Of(this, "", be, t, this, i, e, n, o) }, t.Ht = function (t, i, e, n, o, r) { Of(this, "", be, i, t, e, n, o, r) }, wf.prototype.changeState = function (t, i) { var e, n, o; null !== t && t.model === this && (t.change === be ? (e = t.object, n = t.propertyName, o = t.H(i), n === this.nodeKeyProperty && this.nb(e) && (void 0 !== (i = t.H(!i)) && this.Ua.remove(i), void 0 !== o && this.Ua.add(o, e)), Kf(e, n, o)) : t.change === we ? (e = t.newParam, "nodeDataArray" === t.modelChange ? b(t = t.newValue) && "number" == typeof e && (n = this.ja(t), i ? (this.Cc[e] === t && S(this.Cc, e), void 0 !== n && this.Ua.remove(n)) : (this.Cc[e] !== t && M(this.Cc, e, t), void 0 !== n && this.Ua.add(n, t))) : "" === t.modelChange ? ((n = t.object) && !w(n) && t.propertyName && (n = Uf(t.object, t.propertyName)), w(n) && "number" == typeof e && (t = t.newValue, i ? S(n, e) : M(n, e, t))) : B("unknown ChangedEvent.Insert modelChange: " + t.toString())) : t.change === ke ? (e = t.oldParam, "nodeDataArray" === t.modelChange ? b(t = t.oldValue) && "number" == typeof e && (n = this.ja(t), i ? (this.Cc[e] !== t && M(this.Cc, e, t), void 0 !== n && this.Ua.add(n, t)) : (this.Cc[e] === t && S(this.Cc, e), void 0 !== n && this.Ua.remove(n))) : "" === t.modelChange ? ((n = t.object) && !w(n) && t.propertyName && (n = Uf(t.object, t.propertyName)), w(n) && "number" == typeof e && (t = t.oldValue, i ? M(n, e, t) : S(n, e))) : B("unknown ChangedEvent.Remove modelChange: " + t.toString())) : t.change !== xe && B("unknown ChangedEvent: " + t.toString())) }, wf.prototype.ua = function (t) { return this.undoManager.ua(t) }, wf.prototype.Va = function (t) { return this.undoManager.Va(t) }, wf.prototype.Af = function () { return this.undoManager.Af() }, wf.prototype.commit = function (t, i) { void 0 === i && (i = ""); var e = this.skipsUndoManager; null === i && (this.skipsUndoManager = !0, i = ""), this.undoManager.ua(i); var n = !1; try { t(this), n = !0 } finally { n ? this.undoManager.Va(i) : this.undoManager.Af(), this.skipsUndoManager = e } }, (t = wf.prototype).Ba = function (t, i) { void 0 === i && (i = ""), Of(this, "SourceChanged", xe, i, t, null, null) }, t.ja = function (t) { if (null !== t) { var i = this.Ai; if ("" !== i && void 0 !== (i = Uf(t, i))) { if (Bf(i)) return i; B("Key value for node data " + t + " is not a number or a string: " + i) } } }, t.Gm = function (t, i) { var e, n; null === t || "" !== (e = this.Ai) && (this.nb(t) ? (n = Uf(t, e)) !== i && null === this.Jb(i) && (Kf(t, e, i), void 0 !== n && this.Ua.remove(n), this.Ua.add(i, t), Of(this, "nodeKey", be, e, t, n, i), "string" == typeof e && this.Ba(t, e), this.Iq(n, i)) : Kf(t, e, i)) }, t.nb = function (t) { var i = this.ja(t); return void 0 !== i && this.Ua.H(i) === t }, t.Jb = function (t) { return null === t && B("Model.findNodeDataForKey:key must not be null"), void 0 !== t && Bf(t) ? this.Ua.H(t) : null }, t.Bt = function (t) { if (null !== t) { var i = this.Ai; if ("" !== i) { var e = this.ja(t); if (void 0 === e || this.Ua.contains(e)) { var n = this.vl; if (null !== n && (null != (e = n(this, t)) && !this.Ua.contains(e))) return void Kf(t, i, e); if ("string" == typeof e) { for (n = 2; this.Ua.contains(e + n);)n++; Kf(t, i, e + n) } else if (void 0 === e || "number" == typeof e) { for (e = -this.Ua.count - 1; this.Ua.contains(e);)e--; Kf(t, i, e) } } } } }, t.pf = function (t) { null !== t && (_(t), this.nb(t) || If(this, t, !0)) }, t.Ly = function (t) { if (w(t)) for (var i = t.length, e = 0; e < i; e++)this.pf(t[e]); else for (t = t.iterator; t.next();)this.pf(t.value) }, t.zm = function (t) { null !== t && Rf(this, t, !0) }, t.qA = function (t) { if (w(t)) for (var i = t.length, e = 0; e < i; e++)this.zm(t[e]); else for (t = t.iterator; t.next();)this.zm(t.value) }, t.gA = function (t) { if (w(t)) { for (var i = new $(this.Ua.iteratorKeys), e = new $, n = t.length, o = 0; o < n; o++) { var r, s = t[o], a = this.ja(s); void 0 !== a ? (e.add(a), null !== (r = this.Jb(a)) ? this.Xj(r, s) : (r = {}, this.Gm(r, a), this.Xj(r, s), this.pf(r))) : (this.pf(s), e.add(this.ja(s))) } for (t = i.iterator; t.next();)i = t.value, e.contains(i) || (i = this.Jb(i)) && this.zm(i); this.hq() } }, t.Iq = function (t, i) { void 0 !== i && ((t = Vf(this, t)) instanceof $ && this.Of.add(i, t)) }, t.vw = function () { }, t.Cm = function () { }, t.Bm = function () { }, t.Pq = function () { }, t.hq = function (t) { void 0 === t ? this.Of.clear() : this.Of.remove(t) }, wf.prototype.copyNodeData = function (t) { if (null === t) return null; var i = this.Ok; return b(t = null !== i ? i(t, this) : Yf(this, t, !0)) && Q(t), t }, wf.prototype.setDataProperty = function (t, i, e) { if (this.nb(t)) { if (i === this.nodeKeyProperty) this.Gm(t, e); else if (i === this.nodeCategoryProperty) return void this.Kq(t, e) } else !Hf && t instanceof Es && (Hf = !0, v('Model.setDataProperty is modifying a GraphObject, "' + t.toString() + '"'), v("  Is that really your intent?")); var n = Uf(t, i); n !== e && (Kf(t, i, e), this.Ht(t, i, n, e)) }, (t = wf.prototype).set = function (t, i, e) { this.setDataProperty(t, i, e) }, t.Xj = function (t, i) { if (i) { var e, n = this.nb(t); for (e in i) "__gohashid" === e || n && e === this.nodeKeyProperty || this.setDataProperty(t, e, i[e]) } }, t.Hy = function (t, i) { this.st(t, -1, i) }, t.st = function (t, i, e) { i < 0 && (i = t.length), M(t, i, e), Of(this, "", we, "", t, null, e, null, i) }, t.Zv = function (t, i) { void 0 === i && (i = -1), t === this.Cc && B("Model.removeArrayItem should not be called on the Model.nodeDataArray"), -1 === i && (i = t.length - 1); var e = t[i]; S(t, i), Of(this, "", ke, "", t, e, null, i, null) }, t.pt = function (t) { if (null === t) return ""; var i = this.Gj; return "" === i || void 0 === (i = Uf(t, i)) ? "" : "string" == typeof i ? i : (B("getCategoryForNodeData found a non-string category for " + t + ": " + i), "") }, t.Kq = function (t, i) { var e, n; null === t || "" !== (e = this.Gj) && (this.nb(t) ? (void 0 === (n = Uf(t, e)) && (n = ""), n !== i && (Kf(t, e, i), Of(this, "nodeCategory", be, e, t, n, i))) : Kf(t, e, i)) }, t.pm = function () { return !1 }, t.ik = function () { return !1 }, t.om = function () { return !1 }, t.xt = function () { return !1 }, t.jk = function () { return !1 }, l.Object.defineProperties(wf.prototype, { name: { get: function () { return this.Qa }, set: function (t) { var i = this.Qa; i !== t && (this.Qa = t, this.g("name", i, t)) } }, dataFormat: { get: function () { return this.tn }, set: function (t) { var i = this.tn; i !== t && (this.tn = t, this.g("dataFormat", i, t)) } }, isReadOnly: { get: function () { return this.Wf }, set: function (t) { var i = this.Wf; i !== t && (this.Wf = t, this.g("isReadOnly", i, t)) } }, modelData: { get: function () { return this.l }, set: function (t) { var i = this.l; i !== t && (this.l = t, this.g("modelData", i, t), this.Ba(t)) } }, undoManager: { get: function () { return this.u }, set: function (t) { var i = this.u; i !== t && (null !== i && i.gy(this), null !== (this.u = t) && t.wx(this)) } }, skipsUndoManager: { get: function () { return this.pg }, set: function (t) { this.pg = t } }, nodeKeyProperty: { get: function () { return this.Ai }, set: function (t) { var i = this.Ai; i !== t && ("" === t && B("Model.nodeKeyProperty may not be the empty string"), 0 < this.Ua.count && B("Cannot set Model.nodeKeyProperty when there is existing node data"), this.Ai = t, this.g("nodeKeyProperty", i, t)) } }, makeUniqueKeyFunction: { get: function () { return this.vl }, set: function (t) { var i = this.vl; i !== t && (this.vl = t, this.g("makeUniqueKeyFunction", i, t)) } }, nodeDataArray: { get: function () { return this.Cc }, set: function (t) { var i = this.Cc; if (i !== t) { this.Ua.clear(), this.vw(); for (var e = t.length, n = 0; n < e; n++) { var o = t[n]; if (!b(o)) return void B("Model.nodeDataArray must only contain Objects, not: " + o); _(o) } for (this.Cc = t, n = new J, o = 0; o < e; o++) { var r = t[o], s = this.ja(r); void 0 === s || null !== this.Ua.H(s) ? n.add(r) : this.Ua.add(s, r) } for (n = n.iterator; n.next();)o = n.value, this.Bt(o), void 0 !== (r = this.ja(o)) && this.Ua.add(r, o); for (Of(this, "nodeDataArray", be, "nodeDataArray", this, i, t), i = 0; i < e; i++)n = t[i], this.Cm(n), this.Bm(n); this.hq(), Array.isArray(t) || (this.isReadOnly = !0) } } }, copyNodeDataFunction: { get: function () { return this.Ok }, set: function (t) { var i = this.Ok; i !== t && (this.Ok = t, this.g("copyNodeDataFunction", i, t)) } }, copiesArrays: { get: function () { return this.ln }, set: function (t) { var i = this.ln; i !== t && (this.ln = t, this.g("copiesArrays", i, t)) } }, copiesArrayObjects: { get: function () { return this.kn }, set: function (t) { var i = this.kn; i !== t && (this.kn = t, this.g("copiesArrayObjects", i, t)) } }, copiesKey: { get: function () { return this.nn }, set: function (t) { var i = this.nn; i !== t && (this.nn = t, this.g("copiesKey", i, t)) } }, afterCopyFunction: { get: function () { return this.Sm }, set: function (t) { var i = this.Sm; i !== t && (this.Sm = t, this.g("afterCopyFunction", i, t)) } }, nodeCategoryProperty: { get: function () { return this.Gj }, set: function (t) { var i = this.Gj; i !== t && (this.Gj = t, this.g("nodeCategoryProperty", i, t)) } } }), l.Object.defineProperties(wf, { type: { get: function () { return "Model" } } }), wf.prototype.setCategoryForNodeData = wf.prototype.Kq, wf.prototype.getCategoryForNodeData = wf.prototype.pt, wf.prototype.removeArrayItem = wf.prototype.Zv, wf.prototype.insertArrayItem = wf.prototype.st, wf.prototype.addArrayItem = wf.prototype.Hy, wf.prototype.assignAllDataProperties = wf.prototype.Xj, wf.prototype.set = wf.prototype.set, wf.prototype.clearUnresolvedReferences = wf.prototype.hq, wf.prototype.mergeNodeDataArray = wf.prototype.gA, wf.prototype.removeNodeDataCollection = wf.prototype.qA, wf.prototype.removeNodeData = wf.prototype.zm, wf.prototype.addNodeDataCollection = wf.prototype.Ly, wf.prototype.addNodeData = wf.prototype.pf, wf.prototype.makeNodeDataKeyUnique = wf.prototype.Bt, wf.prototype.findNodeDataForKey = wf.prototype.Jb, wf.prototype.containsNodeData = wf.prototype.nb, wf.prototype.setKeyForNodeData = wf.prototype.Gm, wf.prototype.getKeyForNodeData = wf.prototype.ja, wf.prototype.updateTargetBindings = wf.prototype.Ba, wf.prototype.commit = wf.prototype.commit, wf.prototype.rollbackTransaction = wf.prototype.Af, wf.prototype.commitTransaction = wf.prototype.Va, wf.prototype.startTransaction = wf.prototype.ua, wf.prototype.raiseDataChanged = wf.prototype.Ht, wf.prototype.raiseChanged = wf.prototype.g, wf.prototype.raiseChangedEvent = wf.prototype.Za, wf.prototype.removeChangedListener = wf.prototype.wk, wf.prototype.addChangedListener = wf.prototype.Ah, wf.prototype.writeJsonValue = wf.prototype.Km, wf.prototype.replaceJsonObjects = wf.prototype.Am, wf.prototype.applyIncrementalJSON = wf.prototype.Py, wf.prototype.applyIncrementalJson = wf.prototype.yx, wf.prototype.toJSON = wf.prototype.toJSON, wf.prototype.toJson = wf.prototype.Nq, wf.prototype.toIncrementalJSON = wf.prototype.BA, wf.prototype.toIncrementalJson = wf.prototype.ty, wf.prototype.computeJsonDifference = wf.prototype.Vy, wf.prototype.toIncrementalData = wf.prototype.AA, wf.prototype.clear = wf.prototype.clear; var Hf = !1, Wf = {}; function Jf(t, i, e) { Q(this), this.s = !1, void 0 === t && (t = ""), void 0 === i && (i = t), void 0 === e && (e = null), this.l = -1, this.cd = null, this.Vl = t, this.Ul = this.Rp = 0, this.Os = null, this.fo = !1, this.Nl = i, this.jn = e, this.Fo = $f, this.cn = null, this.ru = new $ } function Zf(t, i, e) { return null === (t = t.sourceName) || "" === t ? i : "/" === t ? e.part : "." === t ? e : ".." === t ? e.panel : i.Ya(t) } wf.className = "Model", wf.fromJSON = wf.fromJson = function (t, i) { void 0 === i && (i = null); var e = null; if ("string" == typeof t) try { e = c.JSON.parse(t) } catch (t) { } else "object" == typeof t ? e = t : B("Unable to construct a Model from: " + t); if (null === i) { t = null; var n = e.class; if ("string" == typeof n) try { var o = null; 0 === n.indexOf("go.") ? o = qf(n = n.substr(3)) : null === (o = qf(n)) && (o = c[n]), "function" == typeof o && (t = new o) } catch (t) { } null === t || t instanceof wf ? i = t : B("Unable to construct a Model of declared class: " + e.class) } return null === i && (i = wf.constructGraphLinksModel()), i.Fq(e), i.Xv(e), i }, wf.safePropertyValue = Uf, wf.safePropertySet = Kf, Wf.Brush = La, Wf.ChangedEvent = ve, Wf.Geometry = Ui, Wf.Margin = Xt, Wf.Panel = xh, Wf.Point = gi, Wf.Rect = yi, Wf.Size = Yi, Wf.Spot = Oi, Wf.Transaction = Me, Wf.UndoManager = Se, Jf.prototype.copy = function () { var t = new Jf; return t.Vl = this.Vl, t.Rp = this.Rp, t.Ul = this.Ul, t.Os = this.Os, t.fo = this.fo, t.Nl = this.Nl, t.jn = this.jn, t.Fo = this.Fo, t.cn = this.cn, t }, (t = Jf.prototype).fb = function (t) { t.classType === Jf && (this.mode = t) }, t.toString = function () { return "Binding(" + this.targetProperty + ":" + this.sourceProperty + (-1 !== this.gj ? " " + this.gj : "") + " " + this.mode.name + ")" }, t.freeze = function () { return this.s = !0, this }, t.ea = function () { return this.s = !1, this }, t.Xx = function (t) { return void 0 === t && (t = null), this.mode = Qf, this.backConverter = t, this }, t.Bq = function (t) { return void 0 === t && (t = ""), this.sourceName = t, this.isToModel = !1, this }, t.iA = function () { return this.sourceName = null, this.isToModel = !0, this }, t.ww = function (t, i, e) { var n = this.Nl; if (void 0 === e || "" === n || n === e) { e = this.Vl; var o = this.jn; if (null === o && "" === e) v("Binding error: target property is the empty string: " + this.toString()); else { var r = i; if ("" !== n && (r = Uf(i, n)), void 0 !== r) if (null === o) "" !== e && Kf(t, e, r); else try { "" !== e ? Kf(t, e, o(r, t)) : o(r, t) } catch (t) { } } } }, t.Rq = function (t, i, e, n) { if (this.Fo === Qf) { var o = this.Vl; if (void 0 === e || o === e) { e = this.Nl; var r = this.cn, s = t; if ("" !== o && (s = Uf(t, o)), void 0 !== s && !this.ru.contains(t)) try { this.ru.add(t); var a, h, l, u, c, f, d = null !== n ? n.diagram : null, p = null !== d ? d.model : null; if (null === r) "" !== e ? null !== p ? p.setDataProperty(i, e, s) : Kf(i, e, s) : null !== p && null !== n && 0 <= n.itemIndex && null !== n.panel && Array.isArray(n.panel.itemArray) && (a = n.itemIndex, h = n.panel.itemArray, p.Zv(h, a), p.st(h, a, s)); else try { "" !== e ? (l = r(s, i, p), null !== p ? p.setDataProperty(i, e, l) : Kf(i, e, l)) : void 0 !== (u = r(s, i, p)) && null !== p && null !== n && 0 <= n.itemIndex && null !== n.panel && Array.isArray(n.panel.itemArray) && (c = n.itemIndex, f = n.panel.itemArray, p.Zv(f, c), p.st(f, c, u)) } catch (t) { } } finally { this.ru.remove(t) } } } }, l.Object.defineProperties(Jf.prototype, { gj: { get: function () { return this.l }, set: function (t) { this.s && g(this), this.l = t } }, targetProperty: { get: function () { return this.Vl }, set: function (t) { this.s && g(this), this.Vl = t } }, sourceName: { get: function () { return this.Os }, set: function (t) { this.s && g(this), null !== (this.Os = t) && (this.fo = !1) } }, isToModel: { get: function () { return this.fo }, set: function (t) { this.s && g(this), this.fo = t } }, sourceProperty: { get: function () { return this.Nl }, set: function (t) { this.s && g(this), this.Nl = t } }, converter: { get: function () { return this.jn }, set: function (t) { this.s && g(this), this.jn = t } }, backConverter: { get: function () { return this.cn }, set: function (t) { this.s && g(this), this.cn = t } }, mode: { get: function () { return this.Fo }, set: function (t) { this.s && g(this), this.Fo = t } } }), Jf.prototype.updateSource = Jf.prototype.Rq, Jf.prototype.updateTarget = Jf.prototype.ww, Jf.prototype.ofModel = Jf.prototype.iA, Jf.prototype.ofObject = Jf.prototype.Bq, Jf.prototype.makeTwoWay = Jf.prototype.Xx; var $f = new V(Jf, "OneWay", 1), Qf = new V(Jf, "TwoWay", 2); function _f(t, i) { wf.call(this), this.Wt = ',\n  "insertedLinkKeys": ', this.Kw = ',\n  "modifiedLinkData": ', this.Yt = ',\n  "removedLinkKeys": ', this.Oc = [], this.Xf = new $, this.cb = new at, this.wi = "", this.ij = this.Nk = this.wl = null, this.Ve = "from", this.We = "to", this.Dj = this.Cj = "", this.Bj = "category", this.Nd = "", this.Al = "isGroup", this.te = "group", this.mn = !1, void 0 !== t && (this.nodeDataArray = t), void 0 !== i && (this.linkDataArray = i) } function td(t, i) { for (var e = new $, n = 0; n < t.linkDataArray.length; n++) { var o = t.linkDataArray[n]; Tf(t, i, o, o, e) } return e } function id(t, i, e) { if (null !== i && ("" !== (t = e ? t.Ve : t.We) && void 0 !== (t = Uf(i, t)))) { if (Bf(t)) return t; B((e ? "FromKey" : "ToKey") + " value for link data " + i + " is not a number or a string: " + t) } } function ed(t, i, e, n) { var o, r; null === e && (e = void 0), null === i || "" !== (o = n ? t.Ve : t.We) && (e = t.qm(e), t.Uc(i) ? (r = Uf(i, o)) !== e && (zf(t, r, i), Kf(i, o, e), null === t.Jb(e) && Ef(t, e, i), Of(t, n ? "linkFromKey" : "linkToKey", be, o, i, r, e), "string" == typeof o && t.Ba(i, o)) : Kf(i, o, e)) } function nd(t, i, e) { return null === i || "" === (t = e ? t.Cj : t.Dj) || void 0 === (i = Uf(i, t)) ? "" : i } function od(t, i, e, n) { var o, r; null === i || "" !== (o = n ? t.Cj : t.Dj) && (t.Uc(i) ? (void 0 === (r = Uf(i, o)) && (r = ""), r !== e && (Kf(i, o, e), Of(t, n ? "linkFromPortId" : "linkToPortId", be, o, i, r, e), "string" == typeof o && t.Ba(i, o))) : Kf(i, o, e)) } function rd(t, i, e) { if ("" !== t.linkKeyProperty) { var n = t.Vb(i); if (void 0 !== n && t.cb.H(n) === i) return; if (t.yq(i), void 0 === (n = t.Vb(i))) return void B("GraphLinksModel.makeLinkDataKeyUnique failed on " + i + ". Data not added to model."); t.cb.add(n, i) } t.Xf.add(i), n = null, e && (n = t.Oc.length, t.Oc.splice(n, 0, i)), Of(t, "linkDataArray", we, "linkDataArray", t, null, i, null, n), ad(t, i) } function sd(t, i, e) { t.Xf.remove(i); var n = t.Vb(i); if (void 0 !== n && t.cb.remove(n), n = null, e) { if ((n = t.Oc.indexOf(i)) < 0) return; t.Oc.splice(n, 1) } if (Of(t, "linkDataArray", ke, "linkDataArray", t, i, null, n, null), zf(t, e = id(t, i, !0), i), zf(t, e = id(t, i, !1), i), n = t.zg(i), Array.isArray(n)) for (var o = n.length, r = 0; r < o; r++)zf(t, e = n[r], i) } function ad(t, i) { var e = id(t, i, !0), e = t.qm(e); null === t.Jb(e) && Ef(t, e, i), e = id(t, i, !1), e = t.qm(e), null === t.Jb(e) && Ef(t, e, i); var n = t.zg(i); if (Array.isArray(n)) for (var o = n.length, r = 0; r < o; r++)e = n[r], null === t.Jb(e) && Ef(t, e, i) } Jf.className = "Binding", Jf.parseEnum = function (i, e) { return function (t) { return null === (t = Y(i, t)) ? e : t } }, Jf.toString = N, Jf.OneWay = $f, Jf.TwoWay = Qf, h(_f, wf), _f.constructGraphLinksModel = wf.constructGraphLinksModel, _f.prototype.cloneProtected = function (t) { wf.prototype.cloneProtected.call(this, t), t.wi = this.wi, t.wl = this.wl, t.Nk = this.Nk, t.Ve = this.Ve, t.We = this.We, t.Cj = this.Cj, t.Dj = this.Dj, t.Bj = this.Bj, t.Nd = this.Nd, t.Al = this.Al, t.te = this.te, t.mn = this.mn }, (t = _f.prototype).clear = function () { wf.prototype.clear.call(this), this.Oc = [], this.cb.clear(), this.Xf.clear() }, t.toString = function (t) { if (void 0 === t && (t = 0), 2 <= t) return this.Nq(); var i = ("" !== this.name ? this.name : "") + " GraphLinksModel"; if (0 < t) { i += "\n node data:"; for (var e = (t = this.nodeDataArray).length, n = 0; n < e; n++) { var o = t[n]; i += " " + this.ja(o) + ":" + N(o) } for (i += "\n link data:", e = (t = this.linkDataArray).length, n = 0; n < e; n++)i += " " + id(this, o = t[n], !0) + "--\x3e" + id(this, o, !1) } return i }, t.Aw = function (t, i) { "" === this.linkKeyProperty && B("GraphLinksModel.linkKeyProperty must not be an empty string for .toIncrementalData() to succeed."); var e = wf.prototype.Aw.call(this, t, i), n = this, o = new $, r = new $, s = new $, a = this.Ph; t.changes.each(function (t) { t.model === n && ("linkDataArray" === t.modelChange ? t.change === we ? o.add(t.newValue) : t.change === ke && s.add(t.oldValue) : n.Uc(t.object) ? r.add(t.object) : null !== t.object && (null !== t.object && a && a.contains(t.object) ? a.get(t.object).each(function (t) { n.Uc(t) && r.add(t) }) : td(n, t.object).each(function (t) { r.add(t) }))) }); var h = new $; o.each(function (t) { h.add(n.Vb(t)), i || r.add(t) }); var l = new $; return s.each(function (t) { l.add(n.Vb(t)), i && r.add(t) }), t = n.cloneDeep(r.na()), 0 < h.count && (null === e && (e = {}), i ? e.removedLinkKeys = h.na() : e.insertedLinkKeys = h.na()), 0 < t.length && (null === e && (e = {}), e.modifiedLinkData = t), 0 < l.count && (null === e && (e = {}), i ? e.insertedLinkKeys = l.na() : e.removedLinkKeys = l.na()), e }, t.zk = function () { var t = wf.prototype.zk.call(this), i = ""; return "category" !== this.linkCategoryProperty && "string" == typeof this.linkCategoryProperty && (i += ',\n  "linkCategoryProperty": ' + this.quote(this.linkCategoryProperty)), "" !== this.linkKeyProperty && "string" == typeof this.linkKeyProperty && (i += ',\n  "linkKeyProperty": ' + this.quote(this.linkKeyProperty)), "from" !== this.linkFromKeyProperty && "string" == typeof this.linkFromKeyProperty && (i += ',\n  "linkFromKeyProperty": ' + this.quote(this.linkFromKeyProperty)), "to" !== this.linkToKeyProperty && "string" == typeof this.linkToKeyProperty && (i += ',\n  "linkToKeyProperty": ' + this.quote(this.linkToKeyProperty)), "" !== this.linkFromPortIdProperty && "string" == typeof this.linkFromPortIdProperty && (i += ',\n  "linkFromPortIdProperty": ' + this.quote(this.linkFromPortIdProperty)), "" !== this.linkToPortIdProperty && "string" == typeof this.linkToPortIdProperty && (i += ',\n  "linkToPortIdProperty": ' + this.quote(this.linkToPortIdProperty)), "" !== this.linkLabelKeysProperty && "string" == typeof this.linkLabelKeysProperty && (i += ',\n  "linkLabelKeysProperty": ' + this.quote(this.linkLabelKeysProperty)), "isGroup" !== this.nodeIsGroupProperty && "string" == typeof this.nodeIsGroupProperty && (i += ',\n  "nodeIsGroupProperty": ' + this.quote(this.nodeIsGroupProperty)), "group" !== this.nodeGroupKeyProperty && "string" == typeof this.nodeGroupKeyProperty && (i += ',\n  "nodeGroupKeyProperty": ' + this.quote(this.nodeGroupKeyProperty)), t + i }, t.Fq = function (t) { wf.prototype.Fq.call(this, t), t.linkKeyProperty && (this.linkKeyProperty = t.linkKeyProperty), t.linkFromKeyProperty && (this.linkFromKeyProperty = t.linkFromKeyProperty), t.linkToKeyProperty && (this.linkToKeyProperty = t.linkToKeyProperty), t.linkFromPortIdProperty && (this.linkFromPortIdProperty = t.linkFromPortIdProperty), t.linkToPortIdProperty && (this.linkToPortIdProperty = t.linkToPortIdProperty), t.linkCategoryProperty && (this.linkCategoryProperty = t.linkCategoryProperty), t.linkLabelKeysProperty && (this.linkLabelKeysProperty = t.linkLabelKeysProperty), t.nodeIsGroupProperty && (this.nodeIsGroupProperty = t.nodeIsGroupProperty), t.nodeGroupKeyProperty && (this.nodeGroupKeyProperty = t.nodeGroupKeyProperty) }, t.Bw = function () { return wf.prototype.Bw.call(this) + (',\n  "linkDataArray": ' + Lf(this, this.linkDataArray, !0)) }, t.Xv = function (t) { wf.prototype.Xv.call(this, t), t = t.linkDataArray, Array.isArray(t) && (this.Am(t), this.linkDataArray = t) }, t.Sq = function (t) { if (!(t instanceof _f)) return B("Model.computeJsonDifference: newmodel must be a GraphLinksModel"), ""; "" === this.linkKeyProperty && B("GraphLinksModel.linkKeyProperty must not be an empty string for .computeJsonDifference() to succeed."); var i = wf.prototype.Sq.call(this, t); Pf(this, t, "linkKeyProperty"), Pf(this, t, "linkFromKeyProperty"), Pf(this, t, "linkToKeyProperty"), Pf(this, t, "linkLabelKeysProperty"), Pf(this, t, "nodeIsGroupProperty"), Pf(this, t, "nodeGroupKeyProperty"); for (var e = new $, n = new $, o = (new $).addAll(this.cb.iteratorKeys), r = new at, s = t.linkDataArray, a = s.length, h = 0; h < a; h++) { var l, u = s[h], c = t.Vb(u); void 0 !== c ? (o.remove(c), null === (l = this.wg(c)) ? (e.add(c), n.add(u)) : Sf(this, l, u, r) || n.add(u)) : (this.yq(u), c = this.Vb(u), e.add(c), n.add(u)) } return t = i, 0 < e.count && (t += this.Wt + Lf(this, e.na(), !0)), 0 < n.count && (t += this.Kw + Lf(this, n.na(), !0)), 0 < o.count && (t += this.Yt + Lf(this, o.na(), !0)), t }, t.zw = function (t, i) { "" === this.linkKeyProperty && B("GraphLinksModel.linkKeyProperty must not be an empty string for .toIncrementalJson() to succeed."); var e = wf.prototype.zw.call(this, t, i), n = this, o = new $, r = new $, s = new $, a = this.Ph; t.changes.each(function (t) { t.model === n && ("linkDataArray" === t.modelChange ? t.change === we ? o.add(t.newValue) : t.change === ke && s.add(t.oldValue) : n.Uc(t.object) ? r.add(t.object) : null !== t.object && (null !== t.object && a && a.contains(t.object) ? a.get(t.object).each(function (t) { n.Uc(t) && r.add(t) }) : td(n, t.object).each(function (t) { r.add(t) }))) }); var h = new $; o.each(function (t) { h.add(n.Vb(t)), i || r.add(t) }); var l = new $; return s.each(function (t) { l.add(n.Vb(t)), i && r.add(t) }), t = e, 0 < h.count && (t += (i ? this.Yt : this.Wt) + Lf(this, h.na(), !0)), 0 < r.count && (t += this.Kw + Lf(this, r.na(), !0)), 0 < l.count && (t += (i ? this.Wt : this.Yt) + Lf(this, l.na(), !0)), t }, t.Eq = function (t) { (void 0 !== t.linkCategoryProperty && t.linkCategoryProperty !== this.linkCategoryProperty || void 0 !== t.linkKeyProperty && t.linkKeyProperty !== this.linkKeyProperty || void 0 !== t.linkFromKeyProperty && t.linkFromKeyProperty !== this.linkFromKeyProperty || void 0 !== t.linkToKeyProperty && t.linkToKeyProperty !== this.linkToKeyProperty || void 0 !== t.linkFromPortIdProperty && t.linkFromPortIdProperty !== this.linkFromPortIdProperty || void 0 !== t.linkToPortIdProperty && t.linkToPortIdProperty !== this.linkToPortIdProperty || void 0 !== t.linkLabelKeysProperty && t.linkLabelKeysProperty !== this.linkLabelKeysProperty || void 0 !== t.nodeIsGroupProperty && t.nodeIsGroupProperty !== this.nodeIsGroupProperty || void 0 !== t.nodeGroupKeyProperty && t.nodeGroupKeyProperty !== this.nodeGroupKeyProperty) && B("applyIncrementalJson cannot change Model properties"), wf.prototype.Eq.call(this, t); var i = t.insertedLinkKeys; if (Array.isArray(i)) for (var e = i.length, n = 0; n < e; n++) { var o = i[n], r = this.wg(o); null === r && (r = this.iq({}), this.Pt(r, o), this.Ni(r)) } if (i = t.modifiedLinkData, Array.isArray(i)) for (e = i.length, n = 0; n < e; n++)if (o = i[n], r = this.Vb(o), null !== (r = this.wg(r))) for (var s in o) "__gohashid" !== s && s !== this.linkKeyProperty && this.setDataProperty(r, s, o[s]); if (t = t.removedLinkKeys, Array.isArray(t)) for (s = t.length, i = 0; i < s; i++)null !== (e = this.wg(t[i])) && this.ym(e) }, _f.prototype.changeState = function (t, i) { if (null !== t && t.model === this) { if (t.change === be) { var e = t.object, n = t.propertyName; if (n === this.linkKeyProperty && this.Uc(e)) { var o = t.H(i); return void 0 !== (i = t.H(!i)) && this.cb.remove(i), void 0 !== o && this.cb.add(o, e), void Kf(e, n, o) } } else if (t.change === we) { if (e = t.newParam, "linkDataArray" === t.modelChange) return void (b(t = t.newValue) && "number" == typeof e && (n = this.Vb(t), i ? (this.Xf.remove(t), this.Oc[e] === t && this.Oc.splice(e, 1), void 0 !== n && this.cb.remove(n)) : (this.Xf.add(t), this.Oc[e] !== t && this.Oc.splice(e, 0, t), void 0 !== n && this.cb.add(n, t)))); if ("linkLabelKeys" === t.modelChange) return n = this.zg(t.object), void (Array.isArray(n) && "number" == typeof e && (i ? 0 <= (e = n.indexOf(t.newValue)) && n.splice(e, 1) : n.indexOf(t.newValue) < 0 && n.splice(e, 0, t.newValue))) } else if (t.change === ke) { if (e = t.oldParam, "linkDataArray" === t.modelChange) return void (b(t = t.oldValue) && "number" == typeof e && (n = this.Vb(t), i ? (this.Xf.add(t), this.Oc[e] !== t && this.Oc.splice(e, 0, t), void 0 !== n && this.cb.add(n, t)) : (this.Xf.remove(t), this.Oc[e] === t && this.Oc.splice(e, 1), void 0 !== n && this.cb.remove(n)))); if ("linkLabelKeys" === t.modelChange) return n = this.zg(t.object), void (Array.isArray(n) && "number" == typeof e && (i ? n.indexOf(t.newValue) < 0 && n.splice(e, 0, t.newValue) : 0 <= (e = n.indexOf(t.newValue)) && n.splice(e, 1))) } wf.prototype.changeState.call(this, t, i) } }, (t = _f.prototype).qm = function (t) { if (void 0 !== t) { var i, e = this.ij; return null === e || null === (i = this.Jb(t)) && (Kf(i = this.copyNodeData(e), this.nodeKeyProperty, t), this.pf(i)), t } }, t.Ez = function (t) { return id(this, t, !0) }, t.ky = function (t, i) { ed(this, t, i, !0) }, t.Kz = function (t) { return id(this, t, !1) }, t.oy = function (t, i) { ed(this, t, i, !1) }, t.Fz = function (t) { return nd(this, t, !0) }, t.ly = function (t, i) { od(this, t, i, !0) }, t.Lz = function (t) { return nd(this, t, !1) }, t.py = function (t, i) { od(this, t, i, !1) }, t.zg = function (t) { if (null === t) return hd; var i = this.Nd; return "" === i || void 0 === (t = Uf(t, i)) ? hd : t }, t.hw = function (t, i) { if (null !== t) { var e = this.Nd; if ("" !== e) if (this.Uc(t)) { var n = Uf(t, e); if (void 0 === n && (n = hd), n !== i) { if (Array.isArray(n)) for (var o = n.length, r = 0; r < o; r++)zf(this, n[r], t); for (Kf(t, e, i), o = i.length, r = 0; r < o; r++) { var s = i[r]; null === this.Jb(s) && Ef(this, s, t) } Of(this, "linkLabelKeys", be, e, t, n, i), "string" == typeof e && this.Ba(t, e) } } else Kf(t, e, i) } }, t.hv = function (t, i) { var e, n, o; null == i || null === t || "" !== (e = this.Nd) && (void 0 === (n = Uf(t, e)) ? ((e = []).push(i), this.hw(t, e)) : Array.isArray(n) ? 0 <= (o = n.indexOf(i)) || (o = n.length, n.push(i), this.Uc(t) && (null === this.Jb(i) && Ef(this, i, t), Of(this, "linkLabelKeys", we, e, t, null, i, null, o))) : B(e + " property is not an Array; cannot addLabelKeyForLinkData: " + t)) }, t.ey = function (t, i) { var e, n, o; null == i || null === t || "" !== (e = this.Nd) && (n = Uf(t, e), Array.isArray(n) ? (o = n.indexOf(i)) < 0 || (n.splice(o, 1), this.Uc(t) && (zf(this, i, t), Of(this, "linkLabelKeys", ke, e, t, i, null, o, null))) : void 0 !== n && B(e + " property is not an Array; cannot removeLabelKeyforLinkData: " + t)) }, t.Vb = function (t) { if (null !== t) { var i = this.wi; if ("" !== i && void 0 !== (i = Uf(t, i))) { if (Bf(i)) return i; B("Key value for link data " + t + " is not a number or a string: " + i) } } }, t.Pt = function (t, i) { var e, n; null === t || "" !== (e = this.wi) && (this.Uc(t) ? (n = Uf(t, e)) !== i && null === this.wg(i) && (Kf(t, e, i), void 0 !== n && this.cb.remove(n), this.cb.add(i, t), Of(this, "linkKey", be, e, t, n, i), "string" == typeof e && this.Ba(t, e)) : Kf(t, e, i)) }, t.wg = function (t) { return null === t && B("GraphLinksModel.findLinkDataForKey:key must not be null"), void 0 !== t && Bf(t) ? this.cb.H(t) : null }, t.yq = function (t) { if (null !== t) { var i = this.wi; if ("" !== i) { var e = this.Vb(t); if (void 0 === e || this.cb.contains(e)) { var n = this.wl; if (null !== n && (null != (e = n(this, t)) && !this.cb.contains(e))) return void Kf(t, i, e); if ("string" == typeof e) { for (n = 2; this.cb.contains(e + n);)n++; Kf(t, i, e + n) } else if (void 0 === e || "number" == typeof e) { for (e = -this.cb.count - 1; this.cb.contains(e);)e--; Kf(t, i, e) } } } } }, t.Uc = function (t) { return null !== t && this.Xf.contains(t) }, t.Ni = function (t) { null !== t && (_(t), this.Uc(t) || rd(this, t, !0)) }, t.Ky = function (t) { if (Array.isArray(t)) for (var i = t.length, e = 0; e < i; e++)this.Ni(t[e]); else for (t = t.iterator; t.next();)this.Ni(t.value) }, t.ym = function (t) { null !== t && sd(this, t, !0) }, t.oA = function (t) { if (Array.isArray(t)) for (var i = t.length, e = 0; e < i; e++)this.ym(t[e]); else for (t = t.iterator; t.next();)this.ym(t.value) }, t.fA = function (t) { if ("" === this.linkKeyProperty && B("GraphLinksModel.linkKeyProperty must not be an empty string for .mergeLinkDataArray() to succeed."), w(t)) { for (var i = new $(this.cb.iteratorKeys), e = new $, n = t.length, o = 0; o < n; o++) { var r, s = t[o], a = this.Vb(s); void 0 !== a ? (e.add(a), null !== (r = this.wg(a)) ? this.Xj(r, s) : (r = {}, this.Pt(r, a), this.Xj(r, s), this.Ni(r))) : (this.Ni(s), e.add(this.Vb(s))) } for (t = i.iterator; t.next();)i = t.value, e.contains(i) || (i = this.wg(i)) && this.ym(i); this.hq() } }, t.iq = function (t) { if (null === t) return null; var i = this.Nk; return b(t = null !== i ? i(t, this) : Yf(this, t, !0)) && (Q(t), "" !== this.Ve && Kf(t, this.Ve, void 0), "" !== this.We && Kf(t, this.We, void 0), "" !== this.Nd && Kf(t, this.Nd, [])), t }, t.Lv = function (t) { if (null === t) return !1; var i = this.Al; return "" !== i && !!Uf(t, i) }, t.Yi = function (t) { if (null !== t) { var i = this.te; if ("" !== i && void 0 !== (i = Uf(t, i))) { if (Bf(i)) return i; B("GroupKey value for node data " + t + " is not a number or a string: " + i) } } }, t.Ot = function (t, i) { var e, n; null === i && (i = void 0), null === t || "" !== (e = this.te) && (this.nb(t) ? (n = Uf(t, e)) !== i && (zf(this, n, t), Kf(t, e, i), null === this.Jb(i) && Ef(this, i, t), Of(this, "nodeGroupKey", be, e, t, n, i), "string" == typeof e && this.Ba(t, e)) : Kf(t, e, i)) }, _f.prototype.copyNodeData = function (t) { return null === t ? null : (t = wf.prototype.copyNodeData.call(this, t), this.ak || "" === this.te || void 0 === Uf(t, this.te) || Kf(t, this.te, void 0), t) }, _f.prototype.setDataProperty = function (t, i, e) { if (this.nb(t)) if (i === this.nodeKeyProperty) this.Gm(t, e); else { if (i === this.nodeCategoryProperty) return void this.Kq(t, e); if (i === this.nodeGroupKeyProperty) return void this.Ot(t, e) } else if (this.Uc(t)) { if (i === this.linkFromKeyProperty) return void ed(this, t, e, !0); if (i === this.linkToKeyProperty) return void ed(this, t, e, !1); if (i === this.linkFromPortIdProperty) return void od(this, t, e, !0); if (i === this.linkToPortIdProperty) return void od(this, t, e, !1); if (i === this.linkKeyProperty) return void this.Pt(t, e); if (i === this.linkCategoryProperty) return void this.Nt(t, e); if (i === this.linkLabelKeysProperty) return void this.hw(t, e) } var n = Uf(t, i); n !== e && (Kf(t, i, e), this.Ht(t, i, n, e)) }, (t = _f.prototype).Xj = function (t, i) { if (i) { var e, n = this.nb(t), o = this.Uc(t); for (e in i) "__gohashid" === e || n && e === this.nodeKeyProperty || n && e === this.nodeIsGroupProperty && Uf(t, e) === i[e] || o && e === this.linkKeyProperty || this.setDataProperty(t, e, i[e]) } }, t.Iq = function (t, i) { wf.prototype.Iq.call(this, t, i); for (var e = this.Ua.iterator; e.next();)this.cw(e.value, t, i); for (e = this.Xf.iterator; e.next();) { var n, o = e.value, r = t, s = i; if (id(this, o, !0) === r && (Kf(o, n = this.Ve, s), Of(this, "linkFromKey", be, n, o, r, s), "string" == typeof n && this.Ba(o, n)), id(this, o, !1) === r && (Kf(o, n = this.We, s), Of(this, "linkToKey", be, n, o, r, s), "string" == typeof n && this.Ba(o, n)), n = this.zg(o), Array.isArray(n)) for (var a = n.length, h = this.Nd, l = 0; l < a; l++)n[l] === r && (n[l] = s, Of(this, "linkLabelKeys", we, h, o, r, s, l, l)) } }, t.cw = function (t, i, e) { var n; this.Yi(t) === i && (Kf(t, n = this.te, e), Of(this, "nodeGroupKey", be, n, t, i, e), "string" == typeof n && this.Ba(t, n)) }, t.vw = function () { wf.prototype.vw.call(this); for (var t = this.linkDataArray, i = t.length, e = 0; e < i; e++)ad(this, t[e]) }, t.Cm = function (t) { if (wf.prototype.Cm.call(this, t), t = this.ja(t), null !== (e = Vf(this, t))) { for (var i = zi(), e = e.iterator; e.next();) { var n, o = e.value; if (this.nb(o)) this.Yi(o) === t && (n = this.te, Of(this, "nodeGroupKey", be, n, o, t, t), "string" == typeof n && this.Ba(o, n), i.push(o)); else if (id(this, o, !0) === t && (n = this.Ve, Of(this, "linkFromKey", be, n, o, t, t), "string" == typeof n && this.Ba(o, n), i.push(o)), id(this, o, !1) === t && (n = this.We, Of(this, "linkToKey", be, n, o, t, t), "string" == typeof n && this.Ba(o, n), i.push(o)), n = this.zg(o), Array.isArray(n)) for (var r = n.length, s = this.Nd, a = 0; a < r; a++)n[a] === t && (Of(this, "linkLabelKeys", we, s, o, t, t, a, a), i.push(o)) } for (e = 0; e < i.length; e++)zf(this, t, i[e]); Vi(i) } }, t.Bm = function (t) { wf.prototype.Bm.call(this, t); var i = this.Yi(t); null === this.Jb(i) && Ef(this, i, t) }, t.Pq = function (t) { wf.prototype.Pq.call(this, t); var i = this.Yi(t); zf(this, i, t) }, t.Av = function (t) { if (null === t) return ""; var i = this.Bj; return "" === i || void 0 === (i = Uf(t, i)) ? "" : "string" == typeof i ? i : (B("getCategoryForLinkData found a non-string category for " + t + ": " + i), "") }, _f.prototype.getLinkCategoryForData = function (t) { return this.Av(t) }, _f.prototype.Nt = function (t, i) { var e, n; null === t || "" !== (e = this.Bj) && (this.Uc(t) ? (void 0 === (n = Uf(t, e)) && (n = ""), n !== i && (Kf(t, e, i), Of(this, "linkCategory", be, e, t, n, i), "string" == typeof e && this.Ba(t, e))) : Kf(t, e, i)) }, _f.prototype.setLinkCategoryForData = function (t, i) { this.Nt(t, i) }, _f.prototype.ik = function () { return !0 }, _f.prototype.om = function () { return !0 }, _f.prototype.xt = function () { return !0 }, _f.prototype.jk = function () { return !0 }, l.Object.defineProperties(_f.prototype, { archetypeNodeData: { get: function () { return this.ij }, set: function (t) { var i = this.ij; i !== t && (this.ij = t, this.g("archetypeNodeData", i, t)) } }, linkFromKeyProperty: { get: function () { return this.Ve }, set: function (t) { var i = this.Ve; i !== t && (this.Ve = t, this.g("linkFromKeyProperty", i, t)) } }, linkToKeyProperty: { get: function () { return this.We }, set: function (t) { var i = this.We; i !== t && (this.We = t, this.g("linkToKeyProperty", i, t)) } }, linkFromPortIdProperty: { get: function () { return this.Cj }, set: function (t) { var i = this.Cj; i !== t && (this.Cj = t, this.g("linkFromPortIdProperty", i, t)) } }, linkToPortIdProperty: { get: function () { return this.Dj }, set: function (t) { var i = this.Dj; i !== t && (this.Dj = t, this.g("linkToPortIdProperty", i, t)) } }, linkLabelKeysProperty: { get: function () { return this.Nd }, set: function (t) { var i = this.Nd; i !== t && (this.Nd = t, this.g("linkLabelKeysProperty", i, t)) } }, linkDataArray: { get: function () { return this.Oc }, set: function (t) { var i = this.Oc; if (i !== t) { this.cb.clear(); for (var e = t.length, n = 0; n < e; n++) { var o = t[n]; if (!b(o)) return void B("GraphLinksModel.linkDataArray must only contain Objects, not: " + o); _(o) } if (this.Oc = t, "" !== this.linkKeyProperty) { for (n = new J, o = 0; o < e; o++) { var r = t[o], s = this.Vb(r); void 0 === s || null !== this.cb.H(s) ? n.add(r) : this.cb.add(s, r) } for (n = n.iterator; n.next();)o = n.value, this.yq(o), void 0 !== (r = this.Vb(o)) && this.cb.add(r, o) } for (n = new $, o = 0; o < e; o++)n.add(t[o]); for (this.Xf = n, Of(this, "linkDataArray", be, "linkDataArray", this, i, t), i = 0; i < e; i++)ad(this, t[i]) } } }, linkKeyProperty: { get: function () { return this.wi }, set: function (t) { var i = this.wi; if (i !== t) { this.wi = t, this.cb.clear(); for (var e = this.linkDataArray.length, n = 0; n < e; n++) { var o = this.linkDataArray[n], r = this.Vb(o); void 0 === r && (this.yq(o), r = this.Vb(o)), void 0 !== r && this.cb.add(r, o) } this.g("linkKeyProperty", i, t) } } }, makeUniqueLinkKeyFunction: { get: function () { return this.wl }, set: function (t) { var i = this.wl; i !== t && (this.wl = t, this.g("makeUniqueLinkKeyFunction", i, t)) } }, copyLinkDataFunction: { get: function () { return this.Nk }, set: function (t) { var i = this.Nk; i !== t && (this.Nk = t, this.g("copyLinkDataFunction", i, t)) } }, nodeIsGroupProperty: { get: function () { return this.Al }, set: function (t) { var i = this.Al; i !== t && (this.Al = t, this.g("nodeIsGroupProperty", i, t)) } }, nodeGroupKeyProperty: { get: function () { return this.te }, set: function (t) { var i = this.te; i !== t && (this.te = t, this.g("nodeGroupKeyProperty", i, t)) } }, ak: { get: function () { return this.mn }, set: function (t) { this.mn !== t && (this.mn = t) } }, linkCategoryProperty: { get: function () { return this.Bj }, set: function (t) { var i = this.Bj; i !== t && (this.Bj = t, this.g("linkCategoryProperty", i, t)) } } }), l.Object.defineProperties(_f, { type: { get: function () { return "GraphLinksModel" } } }), _f.prototype.setCategoryForLinkData = _f.prototype.Nt, _f.prototype.getCategoryForLinkData = _f.prototype.Av, _f.prototype.assignAllDataProperties = _f.prototype.Xj, _f.prototype.setGroupKeyForNodeData = _f.prototype.Ot, _f.prototype.getGroupKeyForNodeData = _f.prototype.Yi, _f.prototype.isGroupForNodeData = _f.prototype.Lv, _f.prototype.copyLinkData = _f.prototype.iq, _f.prototype.mergeLinkDataArray = _f.prototype.fA, _f.prototype.removeLinkDataCollection = _f.prototype.oA, _f.prototype.removeLinkData = _f.prototype.ym, _f.prototype.addLinkDataCollection = _f.prototype.Ky, _f.prototype.addLinkData = _f.prototype.Ni, _f.prototype.containsLinkData = _f.prototype.Uc, _f.prototype.makeLinkDataKeyUnique = _f.prototype.yq, _f.prototype.findLinkDataForKey = _f.prototype.wg, _f.prototype.setKeyForLinkData = _f.prototype.Pt, _f.prototype.getKeyForLinkData = _f.prototype.Vb, _f.prototype.removeLabelKeyForLinkData = _f.prototype.ey, _f.prototype.addLabelKeyForLinkData = _f.prototype.hv, _f.prototype.setLabelKeysForLinkData = _f.prototype.hw, _f.prototype.getLabelKeysForLinkData = _f.prototype.zg, _f.prototype.setToPortIdForLinkData = _f.prototype.py, _f.prototype.getToPortIdForLinkData = _f.prototype.Lz, _f.prototype.setFromPortIdForLinkData = _f.prototype.ly, _f.prototype.getFromPortIdForLinkData = _f.prototype.Fz, _f.prototype.setToKeyForLinkData = _f.prototype.oy, _f.prototype.getToKeyForLinkData = _f.prototype.Kz, _f.prototype.setFromKeyForLinkData = _f.prototype.ky, _f.prototype.getFromKeyForLinkData = _f.prototype.Ez, _f.prototype.clear = _f.prototype.clear; var hd = Object.freeze([]); function ld(t) { wf.call(this), this.ue = "parent", this.on = !1, this.Ij = "parentLinkCategory", void 0 !== t && (this.nodeDataArray = t) } function ud() { Ic.call(this), this.Vw = this.Cn = this.$b = 0, this.Br = 360, this.Uw = bd, this.qj = 0, this.Mw = new gi, this.mr = this.Td = 0, this.$s = new Bd, this.eu = this.Hj = 0, this.By = 600, this.hp = NaN, this.Ym = 1, this.Mp = 0, this.Sl = 360, this.Bb = bd, this.J = Sd, this.Qc = Dd, this.Kc = Uc, this.ef = 6, this.Ro = Fd } function cd(t, i, e, n, o) { var r = t.Br, s = t.$b; t = t.Td, n = n * Math.PI / 180, e = e * Math.PI / 180; for (var a = i.length, h = 0; h < a; h++) { var l = n + (o === Sd ? h * e / (360 <= r ? a : a - 1) : -h * e / a), u = i.L(h), c = s * Math.tan(l) / t, c = Math.sqrt((s * s + t * t * c * c) / (1 + c * c)); u.centerX = c * Math.cos(l), u.centerY = c * Math.sin(l), u.actualAngle = 180 * l / Math.PI } } function fd(t, i, e, n) { var o = t.$b, r = t.Td, s = t.qj; e = e * Math.PI / 180; for (var a = i.length, h = 0; h < a; h++) { var l = i.L(h), u = i.L(h === a - 1 ? 0 : h + 1), c = r * Math.sin(e); l.centerX = o * Math.cos(e), l.centerY = c, l.actualAngle = 180 * e / Math.PI, isNaN(l.diameter) && Ed(l, 0), isNaN(u.diameter) && Ed(u, 0), l = xd(t, o, r, n === Sd ? e : -e, (l.diameter + u.diameter) / 2 + s), e += n === Sd ? l : -l } } function dd(t, i, e, n) { var o = t.$b, r = t.Td, s = t.mr; e = e * Math.PI / 180; for (var a = i.length, h = 0; h < a; h++) { var l = i.L(h); l.centerX = o * Math.cos(e), l.centerY = r * Math.sin(e), l.actualAngle = 180 * e / Math.PI, l = xd(t, o, r, n === Sd ? e : -e, s), e += n === Sd ? l : -l } } function pd(t, i, e, n, o) { var r = t.Br; if (t.Hj = 0, t.$s = new Bd, e < 360) { for (r = n + (o === Sd ? r : -r); r < 0;)r += 360; 180 < (r %= 360) && (r -= 360), r *= Math.PI / 180, t.eu = r, function t(i, e, n, o, r) { for (var s = i.$b, a = i.Td, h = i.Cn, l = s * Math.cos(o * Math.PI / 180), u = a * Math.sin(o * Math.PI / 180), c = gi.alloc(), f = e.na(), d = 0; d < f.length && (f[d].centerX = l, f[d].centerY = u, !(d >= f.length - 1)); d++)gd(i, l, u, f, d, r, c) || yd(i, l, u, f, d, r, c), l = c.x, u = c.y; gi.free(c); i.Hj++; if (!(23 < i.Hj)) { if (l = Math.atan2(u, l), l = r === Sd ? i.eu - l : l - i.eu, l = Math.abs(l) < Math.abs(l - 2 * Math.PI) ? l : l - 2 * Math.PI, s = l * (s + a) / 2, a = i.$s, Math.abs(s) < Math.abs(a.jm)) for (a.jm = s, a.Ak = [], a.Lm = [], l = 0; l < f.length; l++)a.Ak[l] = f[l].bounds.x, a.Lm[l] = f[l].bounds.y; 1 < Math.abs(s) && (i.$b = i.Hj < 8 ? i.$b - s / (2 * Math.PI) : i.$b - (0 < s ? 1.7 : -2.3), i.Td = i.$b * h, t(i, e, n, o, r)) } }(t, i, e, n, o) } else !function t(i, e, n, o, r) { var s = i.$b, a = i.qj, h = i.Cn, l = s * Math.cos(o * Math.PI / 180), u = i.Td * Math.sin(o * Math.PI / 180), c = e.na(); if (3 === c.length) c[0].centerX = s, c[0].centerY = 0, c[1].centerX = c[0].centerX - c[0].width / 2 - c[1].width / 2 - a, c[1].y = c[0].y, c[2].centerX = (c[0].centerX + c[1].centerX) / 2, c[2].y = c[0].y - c[2].height - a; else if (4 === c.length) c[0].centerX = s, c[0].centerY = 0, c[2].centerX = -c[0].centerX, c[2].centerY = c[0].centerY, c[1].centerX = 0, c[1].y = Math.min(c[0].y, c[2].y) - c[1].height - a, c[3].centerX = 0, c[3].y = Math.max(c[0].y + c[0].height + a, c[2].y + c[2].height + a); else { s = gi.alloc(); for (var f, d, p = 0; p < c.length && (c[p].centerX = l, c[p].centerY = u, !(p >= c.length - 1)); p++)gd(i, l, u, c, p, r, s) || yd(i, l, u, c, p, r, s), l = s.x, u = s.y; gi.free(s), i.Hj++, 23 < i.Hj || (l = c[0].centerX, u = c[0].centerY, s = c[c.length - 1].centerX, p = c[c.length - 1].centerY, f = Math.abs(l - s) - ((c[0].width + c[c.length - 1].width) / 2 + a), d = Math.abs(u - p) - ((c[0].height + c[c.length - 1].height) / 2 + a), a = 0, Math.abs(d) < 1 ? Math.abs(l - s) < (c[0].width + c[c.length - 1].width) / 2 && (a = 0) : a = 0 < d ? d : Math.abs(f) < 1 ? 0 : f, l = Math.abs(s) > Math.abs(p) ? 0 < s != p < u : 0 < p != l < s, (l = r === Sd ? l : !l) && (a = -Math.abs(a), a = Math.min(a, -c[c.length - 1].width), a = Math.min(a, -c[c.length - 1].height)), i.$s.compare(a, c), 1 < Math.abs(a) && (i.$b = i.Hj < 8 ? i.$b - a / (2 * Math.PI) : c.length < 5 && 10 < a ? i.$b / 2 : i.$b - (0 < a ? 1.7 : -2.3), i.Td = i.$b * h, t(i, e, n, o, r))) } }(t, i, e, n, o); t.$s.commit(i) } function gd(t, i, e, n, o, r, s) { var a = t.$b, h = t.Td, l = 0; t = (n[o].width + n[o + 1].width) / 2 + t.qj; var u = !1; if (0 <= e != (r === Sd)) { if (a < (r = i + t)) { if ((r = i - t) < -a) return s.x = r, s.y = l, 0; u = !0 } } else if ((r = i - t) < -a) { if (a < (r = i + t)) return s.x = r, s.y = l, 0; u = !0 } return l = Math.sqrt(1 - Math.min(1, r * r / (a * a))) * h, e < 0 !== u && (l = -l), Math.abs(e - l) > (n[o].height + n[o + 1].height) / 2 ? (s.x = r, s.y = l, 0) : (s.x = r, s.y = l, 1) } function yd(t, i, e, n, o, r, s) { var a = t.$b, h = t.Td, l = 0; if (t = (n[o].height + n[o + 1].height) / 2 + t.qj, n = !1, 0 <= i != (r === Sd)) { if ((r = e - t) < -h) { if (h < (r = e + t)) return s.x = l, void (s.y = r); n = !0 } } else if (h < (r = e + t)) { if ((r = e - t) < -h) return s.x = l, void (s.y = r); n = !0 } l = Math.sqrt(1 - Math.min(1, r * r / (h * h))) * a, i < 0 !== n && (l = -l), s.x = l, s.y = r } function md(t, i, e, n, o) { var r = t.By; if (Math.abs(t.Cn - 1) < .001) return void 0 !== n && void 0 !== o ? o * i : 2 * Math.PI * i; t = e < i ? Math.sqrt(i * i - e * e) / i : Math.sqrt(e * e - i * i) / e; for (var s = 0, a = void 0 !== n && void 0 !== o ? o / (r + 1) : Math.PI / (2 * (r + 1)), h = 0, l = 0; l <= r; l++) { h = void 0 !== n && void 0 !== o ? n + l * o / r : l * Math.PI / (2 * r); var u = Math.sin(h); s += Math.sqrt(1 - t * t * u * u) * a } return void 0 !== n && void 0 !== o ? (e < i ? i : e) * s : 4 * (e < i ? i : e) * s } function vd(t, i, e, n, o) { return i / (void 0 !== n && void 0 !== o ? md(t, 1, e, n, o) : md(t, 1, e)) } function xd(t, i, e, n, o) { if (Math.abs(t.Cn - 1) < .001) return o / i; var r = e < i ? Math.sqrt(i * i - e * e) / i : Math.sqrt(e * e - i * i) / e, s = 0; t = 2 * Math.PI / (700 * t.network.vertexes.count), e < i && (n += Math.PI / 2); for (var a = 0; ; a++) { var h = Math.sin(n + a * t); if (o <= (s += (e < i ? i : e) * Math.sqrt(1 - r * r * h * h) * t)) return a * t } } _f.className = "GraphLinksModel", Wf.GraphLinksModel = _f, wf.constructGraphLinksModel = wf.constructGraphLinksModel = function () { return new _f }, wf.initDiagramModel = Gf = function () { return new _f }, h(ld, wf), ld.constructGraphLinksModel = wf.constructGraphLinksModel, ld.prototype.cloneProtected = function (t) { wf.prototype.cloneProtected.call(this, t), t.ue = this.ue, t.on = this.on, t.Ij = this.Ij }, (t = ld.prototype).toString = function (t) { if (void 0 === t && (t = 0), 2 <= t) return this.Nq(); var i = ("" !== this.name ? this.name : "") + " TreeModel"; if (0 < t) { i += "\n node data:"; for (var e = (t = this.nodeDataArray).length, n = 0; n < e; n++) { var o = t[n]; i += " " + this.ja(o) + ":" + N(o) } } return i }, t.zk = function () { var t = wf.prototype.zk.call(this), i = ""; return "parent" !== this.nodeParentKeyProperty && "string" == typeof this.nodeParentKeyProperty && (i += ',\n  "nodeParentKeyProperty": ' + this.quote(this.nodeParentKeyProperty)), t + i }, t.Fq = function (t) { wf.prototype.Fq.call(this, t), t.nodeParentKeyProperty && (this.nodeParentKeyProperty = t.nodeParentKeyProperty) }, t.Sq = function (t) { return Pf(this, t, "nodeParentKeyProperty"), wf.prototype.Sq.call(this, t) }, t.Eq = function (t) { void 0 !== t.nodeParentKeyProperty && t.nodeParentKeyProperty !== this.nodeParentKeyProperty && B("applyIncrementalJson cannot change Model properties"), wf.prototype.Eq.call(this, t) }, t.qm = function (t) { return t }, t.$i = function (t) { if (null !== t) { var i = this.ue; if ("" !== i && void 0 !== (i = Uf(t, i))) { if (Bf(i)) return i; B("ParentKey value for node data " + t + " is not a number or a string: " + i) } } }, t.He = function (t, i) { var e, n; null === i && (i = void 0), null === t || "" !== (e = this.ue) && (i = this.qm(i), this.nb(t) ? (n = Uf(t, e)) !== i && (zf(this, n, t), Kf(t, e, i), null === this.Jb(i) && Ef(this, i, t), Of(this, "nodeParentKey", be, e, t, n, i), "string" == typeof e && this.Ba(t, e)) : Kf(t, e, i)) }, t.Bv = function (t) { if (null === t) return ""; var i = this.Ij; return "" === i || void 0 === (i = Uf(t, i)) ? "" : "string" == typeof i ? i : (B("getParentLinkCategoryForNodeData found a non-string category for " + t + ": " + i), "") }, ld.prototype.getLinkCategoryForData = function (t) { return this.Bv(t) }, ld.prototype.iw = function (t, i) { var e, n; null === t || "" !== (e = this.Ij) && (this.nb(t) ? (void 0 === (n = Uf(t, e)) && (n = ""), n !== i && (Kf(t, e, i), Of(this, "parentLinkCategory", be, e, t, n, i), "string" == typeof e && this.Ba(t, e))) : Kf(t, e, i)) }, ld.prototype.setLinkCategoryForData = function (t, i) { this.iw(t, i) }, ld.prototype.copyNodeData = function (t) { return null === t ? null : (t = wf.prototype.copyNodeData.call(this, t), this.bk || "" === this.ue || void 0 === Uf(t, this.ue) || Kf(t, this.ue, void 0), t) }, ld.prototype.setDataProperty = function (t, i, e) { if (this.nb(t)) if (i === this.nodeKeyProperty) this.Gm(t, e); else { if (i === this.nodeCategoryProperty) return void this.Kq(t, e); if (i === this.nodeParentKeyProperty) return void this.He(t, e) } var n = Uf(t, i); n !== e && (Kf(t, i, e), this.Ht(t, i, n, e)) }, (t = ld.prototype).Iq = function (t, i) { wf.prototype.Iq.call(this, t, i); for (var e = this.Ua.iterator; e.next();)this.cw(e.value, t, i) }, t.cw = function (t, i, e) { var n; this.$i(t) === i && (Kf(t, n = this.ue, e), Of(this, "nodeParentKey", be, n, t, i, e), "string" == typeof n && this.Ba(t, n)) }, t.Cm = function (t) { if (wf.prototype.Cm.call(this, t), t = this.ja(t), null !== (e = Vf(this, t))) { for (var i = zi(), e = e.iterator; e.next();) { var n, o = e.value; this.nb(o) && this.$i(o) === t && (n = this.ue, Of(this, "nodeParentKey", be, n, o, t, t), "string" == typeof n && this.Ba(o, n), i.push(o)) } for (e = 0; e < i.length; e++)zf(this, t, i[e]); Vi(i) } }, t.Bm = function (t) { wf.prototype.Bm.call(this, t); var i = this.$i(t), i = this.qm(i); null === this.Jb(i) && Ef(this, i, t) }, t.Pq = function (t) { wf.prototype.Pq.call(this, t); var i = this.$i(t); zf(this, i, t) }, t.pm = function () { return !0 }, t.xt = function () { return !0 }, l.Object.defineProperties(ld.prototype, { nodeParentKeyProperty: { get: function () { return this.ue }, set: function (t) { var i = this.ue; i !== t && (this.ue = t, this.g("nodeParentKeyProperty", i, t)) } }, bk: { get: function () { return this.on }, set: function (t) { this.on !== t && (this.on = t) } }, parentLinkCategoryProperty: { get: function () { return this.Ij }, set: function (t) { var i = this.Ij; i !== t && (this.Ij = t, this.g("parentLinkCategoryProperty", i, t)) } }, linkCategoryProperty: { get: function () { return this.parentLinkCategoryProperty }, set: function (t) { this.parentLinkCategoryProperty = t } } }), l.Object.defineProperties(ld, { type: { get: function () { return "TreeModel" } } }), ld.prototype.setParentLinkCategoryForNodeData = ld.prototype.iw, ld.prototype.getParentLinkCategoryForNodeData = ld.prototype.Bv, ld.prototype.setParentKeyForNodeData = ld.prototype.He, ld.prototype.getParentKeyForNodeData = ld.prototype.$i, ld.className = "TreeModel", Wf.TreeModel = ld, h(ud, Ic), ud.prototype.cloneProtected = function (t) { Ic.prototype.cloneProtected.call(this, t), t.hp = this.hp, t.Ym = this.Ym, t.Mp = this.Mp, t.Sl = this.Sl, t.Bb = this.Bb, t.J = this.J, t.Qc = this.Qc, t.Kc = this.Kc, t.ef = this.ef, t.Ro = this.Ro }, ud.prototype.fb = function (t) { t.classType === ud ? t === Ad || t === jd || t === Td || t === Ld || t === Dd ? this.sorting = t : t === Nd || t === Cd || t === Sd || t === Pd ? this.direction = t : t === kd || t === wd || t === bd || t === Md ? this.arrangement = t : t !== Od && t !== Fd || (this.nodeDiameterFormula = t) : Ic.prototype.fb.call(this, t) }, ud.prototype.createNetwork = function () { return new Id(this) }, ud.prototype.doLayout = function (t) { if (null === this.network && (this.network = this.makeNetwork(t)), this.arrangementOrigin = this.initialOrigin(this.arrangementOrigin), (t = this.network.vertexes).count <= 1) 1 === t.count && ((t = t.first()).centerX = 0, t.centerY = 0); else { var i = new J; i.addAll(t.iterator), t = new J; var e, n, o = new J, r = this.sort(i), s = this.mr, a = this.arrangement, h = this.nodeDiameterFormula, l = this.radius; (!isFinite(l) || l <= 0) && (l = NaN); var u = this.aspectRatio; (!isFinite(u) || u <= 0) && (u = 1); var c = this.startAngle; isFinite(c) || (c = 0); var f = this.sweepAngle; if ((!isFinite(f) || 360 < f || f < 1) && (f = 360), i = this.spacing, isFinite(i) || (i = NaN), a === Md && h === Od ? a = bd : a === Md && h !== Od && (a = this.arrangement), (this.direction === Nd || this.direction === Cd) && this.sorting !== Dd) { for (h = 0; !(h >= r.length) && (t.add(r.L(h)), !(h + 1 >= r.length)); h += 2)o.add(r.L(h + 1)); this.direction === Nd ? (this.arrangement === Md && t.reverse(), (r = new J).addAll(t), r.addAll(o)) : (this.arrangement === Md && o.reverse(), (r = new J).addAll(o), r.addAll(t)) } h = r.length; for (var d = n = e = 0; d < r.length; d++) { var p = c + f * n * (this.direction === Sd ? 1 : -1) / h, g = r.L(d).diameter; isNaN(g) && (g = Ed(r.L(d), p)), f < 360 && (0 === d || d === r.length - 1) && (g /= 2), e += g, n++ } if (isNaN(l) || a === Md) { if (isNaN(i) && (i = 6), a !== bd && a !== Md) { for (n = -1 / 0, s = 0; s < h; s++)d = r.L(s), e = r.L(s === h - 1 ? 0 : s + 1), isNaN(d.diameter) && Ed(d, 0), isNaN(e.diameter) && Ed(e, 0), n = Math.max(n, (d.diameter + e.diameter) / 2); s = n + i, l = a === kd ? (n + i) / (2 * Math.PI / h) : vd(this, s * (360 <= f ? h : h - 1), u, c * Math.PI / 180, f * Math.PI / 180) } else l = vd(this, e + (360 <= f ? h : h - 1) * (a !== Md ? i : 1.6 * i), u, c * Math.PI / 180, f * Math.PI / 180); n = l * u } else if (d = md(this, l, n = l * u, c * Math.PI / 180, f * Math.PI / 180), isNaN(i)) a !== bd && a !== Md || (i = (d - e) / (360 <= f ? h : h - 1)); else if (a === bd || a === Md) (d = (d - e) / (360 <= f ? h : h - 1)) < i ? n = (l = vd(this, e + i * (360 <= f ? h : h - 1), u, c * Math.PI / 180, f * Math.PI / 180)) * u : i = d; else { for (s = -1 / 0, e = 0; e < h; e++)p = r.L(e), g = r.L(e === h - 1 ? 0 : e + 1), isNaN(p.diameter) && Ed(p, 0), isNaN(g.diameter) && Ed(g, 0), s = Math.max(s, (p.diameter + g.diameter) / 2); l < (e = vd(this, (s += i) * (360 <= f ? h : h - 1), u, c * Math.PI / 180, f * Math.PI / 180)) ? n = (l = e) * u : s = d / (360 <= f ? h : h - 1) } if (this.Uw = a, this.$b = l, this.Cn = u, this.Vw = c, this.Br = f, this.qj = i, this.Td = n, this.mr = s, i = r, r = this.Uw, a = this.$b, l = this.Vw, u = this.Br, c = this.qj, f = this.Td, h = this.mr, this.direction !== Nd && this.direction !== Cd || r !== Md) if (this.direction === Nd || this.direction === Cd) { switch (s = 0, r) { case wd: s = 180 * xd(this, a, f, l, h) / Math.PI; break; case bd: h = i = 0, null !== (s = t.first()) && (i = Ed(s, Math.PI / 2)), null !== (s = o.first()) && (h = Ed(s, Math.PI / 2)), s = 180 * xd(this, a, f, l, c + (i + h) / 2) / Math.PI; break; case kd: s = u / i.length }if (this.direction === Nd) { switch (r) { case wd: dd(this, t, l, Pd); break; case bd: fd(this, t, l, Pd); break; case kd: cd(this, t, u / 2, l, Pd) }switch (r) { case wd: dd(this, o, l + s, Sd); break; case bd: fd(this, o, l + s, Sd); break; case kd: cd(this, o, u / 2, l + s, Sd) } } else { switch (r) { case wd: dd(this, o, l, Pd); break; case bd: fd(this, o, l, Pd); break; case kd: cd(this, o, u / 2, l, Pd) }switch (r) { case wd: dd(this, t, l + s, Sd); break; case bd: fd(this, t, l + s, Sd); break; case kd: cd(this, t, u / 2, l + s, Sd) } } } else switch (r) { case wd: dd(this, i, l, this.direction); break; case bd: fd(this, i, l, this.direction); break; case kd: cd(this, i, u, l, this.direction); break; case Md: pd(this, i, u, l, this.direction) } else pd(this, i, u, l - u / 2, Sd) } this.updateParts(), this.network = null, this.isValidLayout = !0 }, ud.prototype.commitLayout = function () { this.commitNodes(), this.isRouting && this.commitLinks() }, ud.prototype.commitNodes = function () { var t = null !== this.group && null !== this.group.placeholder && this.group.isSubGraphExpanded, i = t ? this.group.location.copy() : null, e = this.actualCenter; t ? e = new gi(0, 0) : (e.x = this.arrangementOrigin.x + this.$b, e.y = this.arrangementOrigin.y + this.Td); for (var n = this.network.vertexes.iterator; n.next();) { var o = n.value; o.x += e.x, o.y += e.y, o.commit() } t && (this.group.zb(), t = this.group.position.copy(), e = this.group.location.copy(), i = i.ae(e.ae(t)), this.group.move(i), this.Mw = i.ae(t)) }, ud.prototype.commitLinks = function () { for (var t = this.network.edges.iterator; t.next();)t.value.commit() }, ud.prototype.sort = function (t) { switch (this.sorting) { case Td: break; case Ld: t.reverse(); break; case Ad: t.sort(this.comparer); break; case jd: t.sort(this.comparer), t.reverse(); break; case Dd: for (var i = [], e = 0; e < t.length; e++)i.push(0); e = new J; for (var n = 0; n < t.length; n++) { var o = -1, r = -1; if (0 === n) for (var s = 0; s < t.length; s++) { var a = t.L(s).edgesCount; o < a && (o = a, r = s) } else for (s = 0; s < t.length; s++)o < (a = i[s]) && (o = a, r = s); for (e.add(t.L(r)), i[r] = -1, s = (r = t.L(r)).sourceEdges; s.next();)(o = t.indexOf(s.value.fromVertex)) < 0 || 0 <= i[o] && i[o]++; for (r = r.destinationEdges; r.next();)(o = t.indexOf(r.value.toVertex)) < 0 || 0 <= i[o] && i[o]++ } for (t = [], i = 0; i < e.length; i++) { for (o = e.L(i), t[i] = [], r = o.destinationEdges; r.next();)(n = e.indexOf(r.value.toVertex)) !== i && t[i].indexOf(n) < 0 && t[i].push(n); for (o = o.sourceEdges; o.next();)(n = e.indexOf(o.value.fromVertex)) !== i && t[i].indexOf(n) < 0 && t[i].push(n) } for (r = [], i = 0; i < t.length; i++)r[i] = 0; i = [], s = [], a = [], o = [], n = new J; for (var h = 0, l = 0; l < t.length; l++) { var u = t[l].length; if (1 === u) o.push(l); else if (0 === u) n.add(e.L(l)); else { if (0 === h) i.push(l); else { for (var c = u = 1 / 0, f = -1, d = [], p = 0; p < i.length; p++)t[i[p]].indexOf(i[p === i.length - 1 ? 0 : p + 1]) < 0 && d.push(p === i.length - 1 ? 0 : p + 1); if (0 === d.length) for (p = 0; p < i.length; p++)d.push(p); for (p = 0; p < d.length; p++) { for (var g = d[p], y = t[l], m = 0, v = 0; v < s.length; v++) { var x, b = r[s[v]], w = r[a[v]]; if (b < w ? (x = b, b = w) : x = w, x < g && g <= b) for (w = 0; w < y.length; w++) { var k = y[w]; i.indexOf(k) < 0 || x < r[k] && r[k] < b || x === r[k] || b === r[k] || m++ } else for (w = 0; w < y.length; w++)k = y[w], i.indexOf(k) < 0 || x < r[k] && r[k] < b && x !== r[k] && b !== r[k] && m++ } for (y = m, v = m = 0; v < t[l].length; v++)0 <= (x = i.indexOf(t[l][v])) && (m += (x = Math.abs(g - (g <= x ? x + 1 : x))) < i.length + 1 - x ? x : i.length + 1 - x); for (v = 0; v < s.length; v++)g <= (x = r[s[v]]) && x++, g <= (b = r[a[v]]) && b++, b < x && (w = b, b = x, x = w), b - x < (i.length + 2) / 2 == (x < g && g <= b) && m++; (y < u || y === u && m < c) && (u = y, c = m, f = g) } for (i.splice(f, 0, l), u = 0; u < i.length; u++)r[i[u]] = u; for (u = 0; u < t[l].length; u++)c = t[l][u], 0 <= i.indexOf(c) && (s.push(l), a.push(c)) } h++ } } for (s = i.length; ;) { for (r = !0, a = 0; a < o.length; a++)if (l = t[h = o[a]][0], 0 <= (u = i.indexOf(l))) { for (f = c = 0; f < t[l].length; f++)(d = i.indexOf(t[l][f])) < 0 || d === u || (c += d < u != s - (p = u < d ? d - u : u - d) < p ? 1 : -1); i.splice(c < 0 ? u : u + 1, 0, h), o.splice(a, 1), a-- } else r = !1; if (r) break; i.push(o[0]), o.splice(0, 1) } for (t = 0; t < i.length; t++)n.add(e.L(i[t])); return n; default: B("Invalid sorting type.") }return t }, l.Object.defineProperties(ud.prototype, { radius: { get: function () { return this.hp }, set: function (t) { this.hp !== t && (0 < t || isNaN(t)) && (this.hp = t, this.C()) } }, aspectRatio: { get: function () { return this.Ym }, set: function (t) { this.Ym !== t && 0 < t && (this.Ym = t, this.C()) } }, startAngle: { get: function () { return this.Mp }, set: function (t) { this.Mp !== t && (this.Mp = t, this.C()) } }, sweepAngle: { get: function () { return this.Sl }, set: function (t) { this.Sl !== t && (this.Sl = 0 < t && t <= 360 ? t : 360, this.C()) } }, arrangement: { get: function () { return this.Bb }, set: function (t) { this.Bb === t || t !== Md && t !== bd && t !== wd && t !== kd || (this.Bb = t, this.C()) } }, direction: { get: function () { return this.J }, set: function (t) { this.J === t || t !== Sd && t !== Pd && t !== Nd && t !== Cd || (this.J = t, this.C()) } }, sorting: { get: function () { return this.Qc }, set: function (t) { this.Qc === t || t !== Td && t !== Ld && t !== Ad && !jd && t !== Dd || (this.Qc = t, this.C()) } }, comparer: { get: function () { return this.Kc }, set: function (t) { this.Kc !== t && (this.Kc = t, this.C()) } }, spacing: { get: function () { return this.ef }, set: function (t) { this.ef !== t && (this.ef = t, this.C()) } }, nodeDiameterFormula: { get: function () { return this.Ro }, set: function (t) { this.Ro === t || t !== Fd && t !== Od || (this.Ro = t, this.C()) } }, actualXRadius: { get: function () { return this.$b } }, actualYRadius: { get: function () { return this.Td } }, actualSpacing: { get: function () { return this.qj } }, actualCenter: { get: function () { return this.Mw } } }); var bd = new V(ud, "ConstantSpacing", 0), wd = new V(ud, "ConstantDistance", 1), kd = new V(ud, "ConstantAngle", 2), Md = new V(ud, "Packed", 3), Sd = new V(ud, "Clockwise", 4), Pd = new V(ud, "Counterclockwise", 5), Nd = new V(ud, "BidirectionalLeft", 6), Cd = new V(ud, "BidirectionalRight", 7), Td = new V(ud, "Forwards", 8), Ld = new V(ud, "Reverse", 9), Ad = new V(ud, "Ascending", 10), jd = new V(ud, "Descending", 11), Dd = new V(ud, "Optimized", 12), Fd = new V(ud, "Pythagorean", 13), Od = new V(ud, "Circular", 14); function Bd() { this.jm = -1 / 0, this.Lm = this.Ak = null } function Id(t) { zc.call(this, t) } function Rd(t) { qc.call(this, t), this.I = this.oj = NaN } function Ed(t, i) { var e = t.network; if (null === e) return NaN; if (null === (e = e.layout)) return NaN; if (e.arrangement === Md) if (e.nodeDiameterFormula === Od) t.oj = Math.max(t.width, t.height); else { if (e = Math.abs(Math.sin(i)), i = Math.abs(Math.cos(i)), 0 === e) return t.width; if (0 === i) return t.height; t.oj = Math.min(t.height / e, t.width / i) } else t.oj = e.nodeDiameterFormula === Od ? Math.max(t.width, t.height) : Math.sqrt(t.width * t.width + t.height * t.height); return t.oj } function zd(t) { Kc.call(this, t) } function Vd() { Ic.call(this), this.yh = null, this.ko = 0, this.Bd = new Yi(100, 100).freeze(), this.Xm = !1, this.cf = !0, this.$c = !1, this.xl = 100, this.Fn = 1, this.Tf = 1e3, this.Io = 10, this.ip = Math, this.Uk = .05, this.Tk = 50, this.Rk = 150, this.Sk = 0, this.wn = 10, this.vn = 5 } function Yd(t, i, e) { if (function (t, i) { if (10 < i || t.network.vertexes.count < 3) return; for (t.yh = t.network.vertexes.na(), (t = t.yh).sort(function (t, i) { return null === t || null === i || t === i ? 0 : i.yd - t.yd }), i = t.length - 1; 0 <= i && t[i].yd <= 1;)i--; return 1 < t.length - i }(t, i)) { var n = t.Tf; t.Tf *= 1 + 1 / (i + 1); var o = function (t, i) { for (var e = t.network, n = new Wd(t), o = 0; o < t.yh.length; o++) { var r = t.yh[o]; if (!(1 < r.yd)) break; n.Bh(r); var s = new Hd; s.Ut = r.yd, s.Vt = r.width, s.Tt = r.height, s.Cw = r.focus.x, s.Dw = r.focus.y, null === r.Ge && (r.Ge = new J), r.Ge.add(s), r.fw = r.Ge.count - 1 } for (r = e.edges.iterator; r.next();) { var a = r.value; o = a.fromVertex, s = a.toVertex, o.network === n && s.network === n ? n.cq(a) : o.network === n ? (null === (a = o.$j) && (a = new J, o.$j = a), a.add(s), o.yd--, o.Jh += s.Jh) : s.network === n && (null === (a = s.$j) && (a = new J, s.$j = a), a.add(o), s.yd--, s.Jh += o.Jh) } for (o = n.edges.iterator; o.next();)(r = o.value).length *= Math.max(1, qi.sqrt((r.fromVertex.Jh + r.toVertex.Jh) / (4 * i + 1))); for (i = n.vertexes.iterator; i.next();) { var h = (o = i.value).$j; if (null !== h && 0 < h.count && !((s = o.Ge.L(o.Ge.count - 1).Ut - o.yd) <= 0)) { for (var l = a = 0, u = h.count - s; u < h.count; u++) { var c = h.L(u), f = null; for (r = c.edges.iterator; r.next();) { var d = r.value; if (d.Sx(c) === o) { f = d; break } } null !== f && (l += f.length, a += c.width * c.height) } r = o.centerX, h = o.centerY, u = o.width, c = o.height, f = o.focus, (d = u * c) < 1 && (d = 1), a = qi.sqrt((a + d + l * l * 4 / (s * s)) / d), s = (a - 1) * u / 2, a = (a - 1) * c / 2, o.bounds = new yi(r - f.x - s, h - f.y - a, u + 2 * s, c + 2 * a), o.focus = new gi(f.x + s, f.y + a) } } return t.network = n, e }(t, i), r = Math.max(0, Math.max(Math.min(t.network.vertexes.count, e * (i + 1) / 11), 10)); for (t.maxIterations += r, Yd(t, i + 1, e), Ud(t, r), function (t, i) { for (var e = t.network.vertexes.iterator; e.next();) { var n, o, r, s = e.value; s.network = i, null !== s.Ge && (n = s.Ge.L(s.fw), s.yd = n.Ut, o = n.Cw, r = n.Dw, s.bounds = new yi(s.centerX - o, s.centerY - r, n.Vt, n.Tt), s.focus = new gi(o, r), s.fw--) } for (e = t.network.edges.iterator; e.next();)e.value.network = i; t.network = i }(t, o), (i = o.vertexes.na()).sort(function (t, i) { return null === t || null === i || t === i ? 0 : i.yd - t.yd }), e = 0; e < i.length; e++)Gd(t, i[e]); t.Tf = n } } function Gd(t, i) { var e = i.$j; if (null !== e && 0 !== e.count) { var n = i.centerX, o = i.centerY, r = i.width, s = i.height; null !== i.Ge && 0 < i.Ge.count && (r = (s = i.Ge.L(0)).Vt, s = s.Tt), r = qi.sqrt(r * r + s * s) / 2; for (var a = !1, h = s = 0, l = 0, u = i.vertexes.iterator; u.next();) { var c = u.value; c.yd <= 1 ? h++ : (a = !0, l++, s += Math.atan2(i.centerY - c.centerY, i.centerX - c.centerX)) } if (0 !== h) for (0 < l && (s /= l), l = i = 0, i = a ? 2 * Math.PI / (h + 1) : 2 * Math.PI / h, 0 == h % 2 && (l = i / 2), 1 < e.count && e.sort(function (t, i) { return null === t || null === i || t === i ? 0 : i.width * i.height - t.width * t.height }), a = 0 == h % 2 ? 0 : 1, e = e.iterator; e.next();)if (!(1 < (h = e.value).yd || t.isFixed(h))) { for (u = null, c = h.edges.iterator; c.next();) { u = c.value; break } c = h.width; var f = h.height, c = qi.sqrt(c * c + f * f) / 2, u = r + u.length + c; c = s + (i * (a / 2 >> 1) + l) * (0 == a % 2 ? 1 : -1), h.centerX = n + u * Math.cos(c), h.centerY = o + u * Math.sin(c), a++ } } } function Xd(t, i, e, n, o, r, s) { var a = 9e19, h = -1, l = 0; t: for (; l < i; l++) { var u = t[l], c = u.x - e, f = u.y - n; if ((c = c * c + f * f) < a) { for (f = l - 1; 0 <= f; f--)if (t[f].y > u.y && t[f].x - u.x < o + s.width) continue t; for (f = l + 1; f < i; f++)if (t[f].x > u.x && t[f].y - u.y < r + s.height) continue t; h = l, a = c } } return h } function qd(t, i) { var e = (o = t.bounds).x; t = o.y; var n = o.width, o = o.height, r = (a = i.bounds).x; i = a.y; var s = a.width, a = a.height; return e + n < r ? i + a < t ? (o = e + n - r, t = t - i - a, qi.sqrt(o * o + t * t)) : t + o < i ? (e = e + n - r, t = t + o - i, qi.sqrt(e * e + t * t)) : r - (e + n) : r + s < e ? i + a < t ? (o = e - r - s, t = t - i - a, qi.sqrt(o * o + t * t)) : t + o < i ? (e = e - r - s, t = t + o - i, qi.sqrt(e * e + t * t)) : e - (r + s) : i + a < t ? t - (i + a) : t + o < i ? i - (t + o) : .1 } function Ud(t, i) { for (t.yh = null, i = t.ko + i; t.ko < i && (t.ko++, Kd(t));); t.yh = null } function Kd(t) { null === t.yh && (t.yh = t.network.vertexes.na()); var i = t.yh; if (!(i.length <= 0)) { (h = i[0]).forceX = 0, h.forceY = 0; for (var e = a = h.centerX, n = h = h.centerY, o = 1; o < i.length; o++) { (s = i[o]).forceX = 0, s.forceY = 0; var r = s.centerX, s = s.centerY, a = Math.min(a, r), e = Math.max(e, r), h = Math.min(h, s), n = Math.max(n, s) } (e = n - h < e - a) ? i.sort(function (t, i) { return null === t || null === i || t === i ? 0 : t.centerX - i.centerX }) : i.sort(function (t, i) { return null === t || null === i || t === i ? 0 : t.centerY - i.centerY }), h = t.Tf; var l = a = s = 0; for (n = 0; n < i.length; n++) { a = (o = i[n]).bounds, s = o.focus, r = a.x + s.x; var u = a.y + s.y; a = o.charge * t.electricalFieldX(r, u), l = o.charge * t.electricalFieldY(r, u), a += o.mass * t.gravitationalFieldX(r, u), l += o.mass * t.gravitationalFieldY(r, u), o.forceX += a, o.forceY += l; for (var c = n + 1; c < i.length; c++) { var f = i[c]; if (f !== o) { a = f.bounds, s = f.focus, l = a.x + s.x; var d = a.y + s.y; if (h < r - l || h < l - r) { if (e) break } else if (h < u - d || h < d - u) { if (!e) break } else { var p = qd(o, f), l = p < 1 ? (null === (a = t.randomNumberGenerator) && (t.randomNumberGenerator = a = new $d), p = a.random(), s = a.random(), a = l < r ? (1 + (a = Math.abs(f.bounds.right - o.bounds.x))) * p : r < l ? -(1 + (a = Math.abs(f.bounds.x - o.bounds.right))) * p : (1 + (a = Math.max(f.width, o.width))) * p - a / 2, d < u ? (1 + (l = Math.abs(f.bounds.bottom - o.bounds.y))) * s : r < l ? -(1 + (l = Math.abs(f.bounds.y - o.bounds.bottom))) * s : (1 + (l = Math.max(f.height, o.height))) * s - l / 2) : (a = (l - r) / p * (s = -(o.charge * f.charge) / (p * p)), (d - u) / p * s); o.forceX += a, o.forceY += l, f.forceX -= a, f.forceY -= l } } } } for (e = t.network.edges.iterator; e.next();)h = (s = e.value).fromVertex, n = s.toVertex, o = h.bounds, r = h.focus, a = o.x + r.x, o = o.y + r.y, u = n.bounds, c = n.focus, r = u.x + c.x, u = u.y + c.y, l = (c = qd(h, n)) < 1 ? (null === (c = t.randomNumberGenerator) && (t.randomNumberGenerator = c = new $d), s = c.random(), c = c.random(), a = (r < a ? 1 : -1) * (1 + (n.width > h.width ? n.width : h.width)) * s, (u < o ? 1 : -1) * (1 + (n.height > h.height ? n.height : h.height)) * c) : (a = (r - a) / c * (s = s.stiffness * (c - s.length)), (u - o) / c * s), h.forceX += a, h.forceY += l, n.forceX -= a, n.forceY -= l; for (e = a = 0; e < i.length; e++)h = i[e], t.isFixed(h) ? t.moveFixedVertex(h) : a = Math.max(a, t.moveVertex(h) || 0); return a > t.epsilonDistance * t.epsilonDistance } } function Hd() { this.Dw = this.Cw = this.Tt = this.Vt = this.Ut = 0 } function Wd(t) { zc.call(this, t) } function Jd(t) { qc.call(this, t), this.Ia = !1, this.ab = this.I = NaN, this.Jh = this.yd = this.Ha = this.W = 0, this.Ge = this.$j = null, this.fw = 0 } function Zd(t) { Kc.call(this, t), this.l = this.u = NaN } function $d() { var t = 0; void 0 === t && (t = 42), this.seed = t, this.uy = 48271, this.wy = 2147483647, this.Q = 44488.07041494893, this.yy = 3399, this.vy = 1 / 2147483647, this.random() } function Qd() { Ic.call(this), this.Zb = this.oe = 25, this.J = 0, this.Pk = jp, this.sl = Op, this.hl = Rp, this.zj = 4, this.Ek = Yp, this.jg = 7, this.cf = !0, this.so = 4, this.Da = this.$r = this.xa = -1, this.sd = this.Do = 0, this.Ga = this.qd = this.rd = this.Md = this.gc = null, this.No = 0, this.Mo = this.Ej = null, this.Qd = 0, this.Oo = null, this.Gf = new gi, this.re = [], this.re.length = 100 } function _d(t) { var i = t.fromVertex.node; return t = t.toVertex.node, null === i && null === t ? 8 : null === i || null === t ? 4 : 1 } function tp(t) { null === t.Ej && (t.Ej = []); for (var i = 0, e = t.network.vertexes.iterator; e.next();) { var n = e.value; t.Ej[i] = n.layer, i++, t.Ej[i] = n.column, i++, t.Ej[i] = n.index, i++ } return t.Ej } function ip(t, i) { var e = 0; for (t = t.network.vertexes.iterator; t.next();) { var n = t.value; n.layer = i[e], e++, n.column = i[e], e++, n.index = i[e], e++ } } function ep(t, i, e) { var n = Lp(t, i), o = t.gc[i]; (null === t.Mo || t.Mo.length < o * o) && (t.Mo = []); for (var r = t.Mo, s = 0; s < o; s++) { var a, h = 0, l = n[s]; if (null !== (x = l.near) && x.layer === l.layer) if (s < (l = x.index)) for (var u = s + 1; u < l; u++) { var c = n[u]; c.near === x && c.Wj === x.Wj || h++ } else for (u = s - 1; l < u; u--)(c = n[u]).near === x && c.Wj === x.Wj || h++; if (0 <= e) for (l = n[s].sourceEdgesArrayAccess, x = 0; x < l.length; x++) { var f = l[x]; if (f.valid && f.fromVertex.layer !== i) for (c = f.fromVertex.index, u = f.portToPos, f = f.portFromPos, a = x + 1; a < l.length; a++) { var d, p, g = l[a]; g.valid && g.fromVertex.layer !== i && (d = g.fromVertex.index, p = g.portToPos, g = g.portFromPos, u < p && (d < c || c === d && g < f) && h++, p < u && (c < d || d === c && f < g) && h++) } } if (e <= 0) for (l = n[s].destinationEdgesArrayAccess, x = 0; x < l.length; x++)if ((f = l[x]).valid && f.toVertex.layer !== i) for (c = f.toVertex.index, u = f.portToPos, f = f.portFromPos, a = x + 1; a < l.length; a++)(g = l[a]).valid && g.toVertex.layer !== i && (d = g.toVertex.index, p = g.portToPos, f < (g = g.portFromPos) && (d < c || c === d && p < u) && h++, g < f && (c < d || d === c && u < p) && h++); for (r[s * o + s] = h, l = s + 1; l < o; l++) { var y = 0, m = 0; if (0 <= e) { h = n[s].sourceEdgesArrayAccess; for (var v = n[l].sourceEdgesArrayAccess, x = 0; x < h.length; x++)if ((f = h[x]).valid && f.fromVertex.layer !== i) for (c = f.fromVertex.index, f = f.portFromPos, a = 0; a < v.length; a++)(g = v[a]).valid && g.fromVertex.layer !== i && (d = g.fromVertex.index, g = g.portFromPos, (c < d || c === d && f < g) && m++, (d < c || d === c && g < f) && y++) } if (e <= 0) for (h = n[s].destinationEdgesArrayAccess, v = n[l].destinationEdgesArrayAccess, x = 0; x < h.length; x++)if ((f = h[x]).valid && f.toVertex.layer !== i) for (c = f.toVertex.index, u = f.portToPos, a = 0; a < v.length; a++)(g = v[a]).valid && g.toVertex.layer !== i && (d = g.toVertex.index, p = g.portToPos, (c < d || c === d && u < p) && m++, (d < c || d === c && p < u) && y++); r[s * o + l] = y, r[l * o + s] = m } } return Ap(t, i, n), r } function np(t) { for (var i = 0, e = 0; e <= t.xa; e++) { for (var n = t, o = e, r = Lp(n, o), s = n.gc[o], a = 0, h = 0; h < s; h++) { var l = r[h].destinationEdgesArrayAccess; if (null !== l) for (var u = 0; u < l.length; u++) { var c, f, d = l[u]; d.valid && d.toVertex.layer !== o && (c = d.fromVertex.column + d.portFromColOffset, f = d.toVertex.column + d.portToColOffset, a += (Math.abs(c - f) + 1) * _d(d)) } } Ap(n, o, r), i += a } return i } function op(t, i, e) { for (var n = Lp(t, i), o = t.gc[i], r = [], s = 0; s < o; s++) { var a = n[s], h = null; e <= 0 && (h = a.sourceEdgesArrayAccess); var l = null; 0 <= e && (l = a.destinationEdgesArrayAccess); var u = 0, c = 0, f = a.near; if (null !== f && f.layer === a.layer && (u += f.column - 1, c++), null !== h) for (f = 0; f < h.length; f++) { var d = (a = h[f]).fromVertex; a.valid && !a.rev && d.layer !== i && (u += d.column, c++) } if (null !== l) for (h = 0; h < l.length; h++)f = (a = l[h]).toVertex, a.valid && !a.rev && f.layer !== i && (u += f.column, c++); r[s] = 0 === c ? -1 : u / c } return Ap(t, i, n), r } function rp(t, i, e) { for (var n = Lp(t, i), o = t.gc[i], r = [], s = 0; s < o; s++) { var a = n[s], h = null; e <= 0 && (h = a.sourceEdgesArrayAccess); var l = null; 0 <= e && (l = a.destinationEdgesArrayAccess); var u = 0, c = [], f = a.near; if (null !== f && f.layer === a.layer && (c[u] = f.column - 1, u++), a = void 0, null !== h) for (f = 0; f < h.length; f++) { var d = (a = h[f]).fromVertex; a.valid && !a.rev && d.layer !== i && (c[u] = d.column + a.portFromColOffset, u++) } if (null !== l) for (h = 0; h < l.length; h++)f = (a = l[h]).toVertex, a.valid && !a.rev && f.layer !== i && (c[u] = f.column + a.portToColOffset, u++); 0 === u ? r[s] = -1 : (c.sort(function (t, i) { return t - i }), l = u >> 1, r[s] = 0 != (1 & u) ? c[l] : c[l - 1] + c[l] >> 1) } return Ap(t, i, n), r } function sp(t, i, e, n, o, r) { if (i.component === n) { if (i.component = e, o) for (var s = i.destinationEdges; s.next();) { var a = s.value, h = a.toVertex, l = i.layer - h.layer; l === (a = t.linkMinLength(a)) && sp(t, h, e, n, o, r) } if (r) for (s = i.sourceEdges; s.next();)(l = (h = (a = s.value).fromVertex).layer - i.layer) === (a = t.linkMinLength(a)) && sp(t, h, e, n, o, r) } } function ap(t, i, e, n, o, r) { if (i.component === n) { if (i.component = e, o) for (var s = i.destinationEdges; s.next();)ap(t, s.value.toVertex, e, n, o, r); if (r) for (i = i.sourceEdges; i.next();)ap(t, i.value.fromVertex, e, n, o, r) } } function hp(t) { for (t = t.vertexes.iterator; t.next();) { var i = t.value; if (i.valid) return i } return null } function lp(t) { for (t = t.vertexes.iterator; t.next();) { var i = t.value; if (i.valid) { for (var e = !0, n = i.destinationEdges; n.next();)if (n.value.toVertex.valid) { e = !1; break } if (e) return i } } return null } function up(t) { for (t = t.vertexes.iterator; t.next();) { var i = t.value; if (i.valid) { for (var e = !0, n = i.sourceEdges; n.next();)if (n.value.fromVertex.valid) { e = !1; break } if (e) return i } } return null } function cp(t, i) { i.em = t.No, t.No++; for (var e = i.destinationEdges; e.next();) { var n = e.value, o = n.toVertex; -1 === o.em && (n.forest = !0, cp(t, o)) } i.finish = t.No, t.No++ } function fp(t) { for (var i = t.network.vertexes.iterator; i.next();) { var e = dp(t, i.value); t.xa = Math.max(e, t.xa) } } function dp(t, i) { var e = 0; if (-1 === i.layer) { for (var n = i.destinationEdges; n.next();)var o = (r = n.value).toVertex, r = t.linkMinLength(r), e = Math.max(e, dp(t, o) + r); i.layer = e } else e = i.layer; return e } function pp(t, i) { var e = 0; if (-1 === i.layer) { for (var n = i.sourceEdges; n.next();)var o = (r = n.value).fromVertex, r = t.linkMinLength(r), e = Math.max(e, pp(t, o) + r); i.layer = e } else e = i.layer; return e } function gp(t, i) { if (!i.valid) { i.valid = !0; for (var e = i.destinationEdges; e.next();)gp(t, e.value.toVertex); for (e = t.network.vertexes.iterator; e.next();)e.value.component = -1; for (var n = i.sourceEdgesArrayAccess, o = n.length, r = 0; r < o; r++) { var s = (h = n[r]).fromVertex, a = h.toVertex, h = t.linkMinLength(h); s.layer - a.layer > h && sp(t, s, 0, -1, !0, !1) } for (sp(t, i, 1, -1, !0, !0); 0 !== i.component;) { for (n = 1 / (r = 0), s = 0, a = null, h = t.network.vertexes.iterator; h.next();) { var l = h.value; if (1 === l.component) { for (var u = 0, c = !1, f = l.sourceEdgesArrayAccess, o = f.length, d = 0; d < o; d++) { var p = f[d], g = p.fromVertex; u += 1, 1 !== g.component && (r += 1, g = g.layer - l.layer, p = t.linkMinLength(p), n = Math.min(n, g - p)) } for (o = (f = l.destinationEdgesArrayAccess).length, d = 0; d < o; d++)--u, 1 !== (p = f[d].toVertex).component ? --r : c = !0; (null === a || u < s) && !c && (a = l, s = u) } } if (0 < r) { for (e.reset(); e.next();)1 === (o = e.value).component && (o.layer += n); i.component = 0 } else a.component = 0 } for (e = t.network.vertexes.iterator; e.next();)e.value.component = -1; for (sp(t, i, 1, -1, !0, !1); 0 !== i.component;) { for (o = 1 / (n = 0), r = 0, s = null, a = t.network.vertexes.iterator; a.next();)if (1 === (h = a.value).component) { for (l = 0, u = !1, c = (f = h.sourceEdgesArrayAccess).length, d = 0; d < c; d++)l += 1, 1 !== (p = f[d].fromVertex).component ? n += 1 : u = !0; for (c = (f = h.destinationEdgesArrayAccess).length, d = 0; d < c; d++)--l, 1 !== (g = (p = f[d]).toVertex).component && (--n, g = h.layer - g.layer, p = t.linkMinLength(p), o = Math.min(o, g - p)); (null === s || r < l) && !u && (s = h, r = l) } if (n < 0) { for (e.reset(); e.next();)1 === (n = e.value).component && (n.layer -= o); i.component = 0 } else s.component = 0 } } } function yp(t, i, e) { return 90 === t.J ? e && !i.rev || !e && i.rev ? 270 : 90 : 180 === t.J ? e && !i.rev || !e && i.rev ? 0 : 180 : 270 === t.J ? e && !i.rev || !e && i.rev ? 90 : 270 : e && !i.rev || !e && i.rev ? 180 : 0 } function mp(t, i) { var e = i.layer; for (i.index = t.gc[e], t.gc[e]++, i = i.destinationEdgesArrayAccess, e = !0; e;) { e = !1; for (var n = 0; n < i.length - 1; n++) { var o = i[n], r = i[n + 1]; o.portFromColOffset > r.portFromColOffset && (e = !0, i[n] = r, i[n + 1] = o) } } for (e = 0; e < i.length; e++)(n = i[e]).valid && (-1 === (n = n.toVertex).index && mp(t, n)) } function vp(t, i) { var e = i.layer; i.index = t.gc[e], t.gc[e]++, i = i.sourceEdgesArrayAccess; for (var n = !0; n;)for (n = !1, e = 0; e < i.length - 1; e++) { var o = i[e], r = i[e + 1]; o.portToColOffset > r.portToColOffset && (n = !0, i[e] = r, i[e + 1] = o) } for (e = 0; e < i.length; e++)(n = i[e]).valid && (-1 === (n = n.fromVertex).index && vp(t, n)) } function xp(t, i, e) { var n = Lp(t, i), o = t.gc[i], r = rp(t, i, e), s = op(t, i, e); for (e = 0; e < o; e++)-1 === s[e] && (s[e] = n[e].column), -1 === r[e] && (r[e] = n[e].column); for (var a, h = !0; h;)for (h = !1, e = 0; e < o - 1; e++)(r[e + 1] < r[e] || r[e + 1] === r[e] && s[e + 1] < s[e]) && (h = !0, a = r[e], r[e] = r[e + 1], r[e + 1] = a, a = s[e], s[e] = s[e + 1], s[e + 1] = a, a = n[e], n[e] = n[e + 1], n[e + 1] = a); for (e = r = 0; e < o; e++)(a = n[e]).index = e, r += t.nodeMinColumnSpace(a, !0), a.column = r, r += 1, r += t.nodeMinColumnSpace(a, !1); Ap(t, i, n) } function bp(t, i, e) { var n = Lp(t, i), o = t.gc[i]; e = ep(t, i, e); for (var r = [], s = 0; s < o; s++)r[s] = -1; var a = []; for (s = 0; s < o; s++)a[s] = -1; for (var h = !1, l = !0; l;)for (l = !1, s = 0; s < o - 1; s++) { var u = e[n[s].index * o + n[s + 1].index], c = e[n[s + 1].index * o + n[s].index], f = 0, d = 0, p = n[s].column, g = n[s + 1].column, y = t.nodeMinColumnSpace(n[s], !0), m = t.nodeMinColumnSpace(n[s], !1), v = t.nodeMinColumnSpace(n[s + 1], !0), x = t.nodeMinColumnSpace(n[s + 1], !1), y = p - y + v, m = g - m + x, b = n[s].sourceEdges.iterator; for (b.reset(); b.next();)if (x = (v = b.value).fromVertex, v.valid && x.layer === i) { for (v = 0; n[v] !== x;)v++; v < s && (f += 2 * (s - v), d += 2 * (s + 1 - v)), v === s + 1 && (f += 1), s + 1 < v && (f += 4 * (v - s), d += 4 * (v - (s + 1))) } for ((b = n[s].destinationEdges.iterator).reset(); b.next();)if (x = (v = b.value).toVertex, v.valid && x.layer === i) { for (v = 0; n[v] !== x;)v++; v === s + 1 && (d += 1) } for ((b = n[s + 1].sourceEdges.iterator).reset(); b.next();)if (x = (v = b.value).fromVertex, v.valid && x.layer === i) { for (v = 0; n[v] !== x;)v++; v < s && (f += 2 * (s + 1 - v), d += 2 * (s - v)), v === s && (d += 1), s + 1 < v && (f += 4 * (v - (s + 1)), d += 4 * (v - s)) } for ((b = n[s + 1].destinationEdges.iterator).reset(); b.next();)if (x = (v = b.value).toVertex, v.valid && x.layer === i) { for (v = 0; n[v] !== x;)v++; v === s && (f += 1) } v = x = 0, b = r[n[s].index]; var w = a[n[s].index], k = r[n[s + 1].index], M = a[n[s + 1].index]; -1 !== b && (x += Math.abs(b - p), v += Math.abs(b - m)), -1 !== w && (x += Math.abs(w - p), v += Math.abs(w - m)), -1 !== k && (x += Math.abs(k - g), v += Math.abs(k - y)), -1 !== M && (x += Math.abs(M - g), v += Math.abs(M - y)), (d < f - .5 || d === f && c < u - .5 || d === f && c === u && v < x - .5) && (l = h = !0, n[s].column = m, n[s + 1].column = y, u = n[s], n[s] = n[s + 1], n[s + 1] = u) } for (s = 0; s < o; s++)n[s].index = s; return Ap(t, i, n), h } function wp(t, i, e) { for (var n = !1; kp(t, i, e);)n = !0; return n } function kp(t, i, e) { var n, o = Lp(t, i), r = t.gc[i], s = op(t, i, -1); if (0 < e) for (n = 0; n < r; n++)s[n] = -1; var a = op(t, i, 1); if (e < 0) for (n = 0; n < r; n++)a[n] = -1; for (var h = !1, l = !0; l;)for (l = !1, n = 0; n < r; n++) { var u = o[n].column, c = t.nodeMinColumnSpace(o[n], !0), f = t.nodeMinColumnSpace(o[n], !1), d = 0, d = n - 1 < 0 || u - o[n - 1].column - 1 > c + t.nodeMinColumnSpace(o[n - 1], !1) ? u - 1 : u, c = r <= n + 1 || o[n + 1].column - u - 1 > f + t.nodeMinColumnSpace(o[n + 1], !0) ? u + 1 : u, p = f = 0, g = 0; if (e <= 0) for (var y = o[n].sourceEdges.iterator; y.next();) { var m, v, x = y.value, b = x.fromVertex; x.valid && b.layer !== i && (m = _d(x), v = x.portFromColOffset, x = x.portToColOffset, b = b.column, f += (Math.abs(u + x - (b + v)) + 1) * m, p += (Math.abs(d + x - (b + v)) + 1) * m, g += (Math.abs(c + x - (b + v)) + 1) * m) } if (0 <= e) for (y = o[n].destinationEdges.iterator; y.next();)b = (x = y.value).toVertex, x.valid && b.layer !== i && (m = _d(x), v = x.portFromColOffset, x = x.portToColOffset, b = b.column, f += (Math.abs(u + v - (b + x)) + 1) * m, p += (Math.abs(d + v - (b + x)) + 1) * m, g += (Math.abs(c + v - (b + x)) + 1) * m); x = v = m = 0, y = s[o[n].index], b = a[o[n].index], -1 !== y && (m += Math.abs(y - u), v += Math.abs(y - d), x += Math.abs(y - c)), -1 !== b && (m += Math.abs(b - u), v += Math.abs(b - d), x += Math.abs(b - c)), p < f || p === f && v < m ? (l = h = !0, o[n].column = d) : (g < f || g === f && x < m) && (l = h = !0, o[n].column = c) } return Ap(t, i, o), t.normalize(), h } function Mp(t, i, e) { var n = Lp(t, i), o = t.gc[i], r = rp(t, i, e), s = []; for (e = 0; e < o; e++)s[e] = r[e]; for (r = !0; r;)for (r = !1, e = 0; e < o; e++) { var a = n[e].column, h = t.nodeMinColumnSpace(n[e], !0), l = t.nodeMinColumnSpace(n[e], !1), u = 0; -1 === s[e] ? u = 0 === e && e === o - 1 ? a : 0 === e ? n[e + 1].column - a === l + t.nodeMinColumnSpace(n[e + 1], !0) ? a - 1 : a : e === o - 1 ? a - n[e - 1].column === h + t.nodeMinColumnSpace(n[e - 1], !1) ? a + 1 : a : ((h = n[e - 1].column + t.nodeMinColumnSpace(n[e - 1], !1) + h + 1) + (l = n[e + 1].column - t.nodeMinColumnSpace(n[e + 1], !0) - l - 1)) / 2 | 0 : 0 === e && e === o - 1 ? u = s[e] : 0 === e ? (l = n[e + 1].column - t.nodeMinColumnSpace(n[e + 1], !0) - l - 1, u = Math.min(s[e], l)) : e === o - 1 ? (h = n[e - 1].column + t.nodeMinColumnSpace(n[e - 1], !1) + h + 1, u = Math.max(s[e], h)) : (h = n[e - 1].column + t.nodeMinColumnSpace(n[e - 1], !1) + h + 1, l = n[e + 1].column - t.nodeMinColumnSpace(n[e + 1], !0) - l - 1, h < s[e] && s[e] < l ? u = s[e] : h >= s[e] ? u = h : l <= s[e] && (u = l)), u !== a && (r = !0, n[e].column = u) } Ap(t, i, n), t.normalize() } function Sp(t, i) { for (var e = !0, n = t.network.vertexes.iterator; n.next();) { var o = n.value, r = t.nodeMinColumnSpace(o, !0), s = t.nodeMinColumnSpace(o, !1); if (o.column - r <= i && o.column + s >= i) { e = !1; break } } if (t = !1, e) for (n.reset(); n.next();)(e = n.value).column > i && (--e.column, t = !0); return t } function Pp(t, i) { for (var e = i + 1, n = [], o = [], r = 0; r <= t.xa; r++)n[r] = !1, o[r] = !1; for (var s = t.network.vertexes.iterator; s.next();) { var a = (r = s.value).column - t.nodeMinColumnSpace(r, !0), h = r.column + t.nodeMinColumnSpace(r, !1); a <= i && i <= h && (n[r.layer] = !0), a <= e && e <= h && (o[r.layer] = !0) } for (e = !(a = !0), r = 0; r <= t.xa; r++)a = a && !(n[r] && o[r]); if (a) for (s.reset(); s.next();)(t = s.value).column > i && (--t.column, e = !0); return e } function Np(t, i) { for (var e = 0; e <= t.Da; e++)for (; Sp(t, e);); for (t.normalize(), e = 0; e < t.Da; e++)for (; Pp(t, e);); if (t.normalize(), 0 < i) for (e = 0; e <= t.Da; e++)for (var n = tp(t), o = np(t), r = o + 1; o < r;) { r = o, Cp(t, e, 1); var s = np(t); o < s ? ip(t, n) : s < o && (o = s, n = tp(t)) } if (i < 0) for (e = t.Da; 0 <= e; e--)for (n = tp(t), r = (o = np(t)) + 1; o < r;)r = o, Cp(t, e, -1), o < (s = np(t)) ? ip(t, n) : s < o && (o = s, n = tp(t)); t.normalize() } function Cp(t, i, e) { t.Qd = 0; for (var n, o = t.network.vertexes.iterator; o.next();)o.value.component = -1; if (0 < e) for (o.reset(); o.next();) { var r = o.value; r.column - t.nodeMinColumnSpace(r, !0) <= i && (r.component = t.Qd) } if (e < 0) for (o.reset(); o.next();)(r = o.value).column + t.nodeMinColumnSpace(r, !1) >= i && (r.component = t.Qd); for (t.Qd++, o.reset(); o.next();)-1 === (i = o.value).component && (ap(t, i, t.Qd, -1, !0, !0), t.Qd++); for (i = [], n = 0; n < t.Qd * t.Qd; n++)i[n] = !1; for (r = [], n = 0; n < (t.xa + 1) * (t.Da + 1); n++)r[n] = -1; for (o.reset(); o.next();)for (var s = (n = o.value).layer, a = Math.max(0, n.column - t.nodeMinColumnSpace(n, !0)), h = Math.min(t.Da, n.column + t.nodeMinColumnSpace(n, !1)); a <= h; a++)r[s * (t.Da + 1) + a] = n.component; for (n = 0; n <= t.xa; n++) { if (0 < e) for (s = 0; s < t.Da; s++)-1 !== r[n * (t.Da + 1) + s] && -1 !== r[n * (t.Da + 1) + s + 1] && r[n * (t.Da + 1) + s] !== r[n * (t.Da + 1) + s + 1] && (i[r[n * (t.Da + 1) + s] * t.Qd + r[n * (t.Da + 1) + s + 1]] = !0); if (e < 0) for (s = t.Da; 0 < s; s--)-1 !== r[n * (t.Da + 1) + s] && -1 !== r[n * (t.Da + 1) + s - 1] && r[n * (t.Da + 1) + s] !== r[n * (t.Da + 1) + s - 1] && (i[r[n * (t.Da + 1) + s] * t.Qd + r[n * (t.Da + 1) + s - 1]] = !0) } for (r = [], n = 0; n < t.Qd; n++)r[n] = !0; for ((s = []).push(0); 0 !== s.length;)if (h = s[s.length - 1], s.pop(), r[h]) for (r[h] = !1, n = 0; n < t.Qd; n++)i[h * t.Qd + n] && s.splice(0, 0, n); if (0 < e) for (o.reset(); o.next();)r[(t = o.value).component] && --t.column; if (e < 0) for (o.reset(); o.next();)r[(e = o.value).component] && (e.column += 1) } function Tp(t, i) { return 270 === t.J ? i ? Pi : Ti : 90 === t.J ? i ? Ti : Pi : 180 === t.J ? i ? Ni : Ci : i ? Ci : Ni } function Lp(t, i) { var e = t.gc[i]; if (e >= t.re.length) { for (var n = [], o = 0; o < t.re.length; o++)n[o] = t.re[o]; t.re = n } for (void 0 === t.re[e] || null === t.re[e] ? n = [] : (n = t.re[e], t.re[e] = null), t = t.Oo[i], i = 0; i < t.length; i++)n[(e = t[i]).index] = e; return n } function Ap(t, i, e) { t.re[t.gc[i]] = e } ud.className = "CircularLayout", ud.ConstantSpacing = bd, ud.ConstantDistance = wd, ud.ConstantAngle = kd, ud.Packed = Md, ud.Clockwise = Sd, ud.Counterclockwise = Pd, ud.BidirectionalLeft = Nd, ud.BidirectionalRight = Cd, ud.Forwards = Td, ud.Reverse = Ld, ud.Ascending = Ad, ud.Descending = jd, ud.Optimized = Dd, ud.Pythagorean = Fd, ud.Circular = Od, Bd.prototype.compare = function (t, i) { if (0 < t && this.jm < 0 || Math.abs(t) < Math.abs(this.jm) && !(t < 0 && 0 < this.jm)) for (this.jm = t, this.Ak = [], this.Lm = [], t = 0; t < i.length; t++)this.Ak[t] = i[t].bounds.x, this.Lm[t] = i[t].bounds.y }, Bd.prototype.commit = function (t) { if (null !== this.Ak && null !== this.Lm) for (var i = 0; i < this.Ak.length; i++) { var e = t.L(i); e.x = this.Ak[i], e.y = this.Lm[i] } }, Bd.className = "VertexArrangement", h(Id, zc), Id.prototype.createVertex = function () { return new Rd(this) }, Id.prototype.createEdge = function () { return new zd(this) }, Id.className = "CircularNetwork", h(Rd, qc), l.Object.defineProperties(Rd.prototype, { diameter: { get: function () { return this.oj }, set: function (t) { this.oj !== t && (this.oj = t) } }, actualAngle: { get: function () { return this.I }, set: function (t) { this.I !== t && (this.I = t) } } }), Rd.className = "CircularVertex", h(zd, Kc), zd.className = "CircularEdge", h(Vd, Ic), Vd.prototype.cloneProtected = function (t) { Ic.prototype.cloneProtected.call(this, t), t.Bd.assign(this.Bd), t.Xm = this.Xm, t.cf = this.cf, t.$c = this.$c, t.xl = this.xl, t.Fn = this.Fn, t.Tf = this.Tf, t.Io = this.Io, t.ip = this.ip, t.Uk = this.Uk, t.Tk = this.Tk, t.Rk = this.Rk, t.Sk = this.Sk, t.wn = this.wn, t.vn = this.vn }, Vd.prototype.createNetwork = function () { return new Wd(this) }, Vd.prototype.doLayout = function (t) { if (null === this.network && (this.network = this.makeNetwork(t)), t = this.maxIterations, 0 < this.network.vertexes.count) { this.network.jq(); for (var i = this.network.vertexes.iterator; i.next();) { var e = i.value; e.charge = this.electricalCharge(e), e.mass = this.gravitationalMass(e) } for (i = this.network.edges.iterator; i.next();)(e = i.value).stiffness = this.springStiffness(e), e.length = this.springLength(e); if (this.jv(), this.ko = 0, this.needsClusterLayout()) { for (e = (i = this.network).sy().iterator; e.next();) { this.network = e.value; for (var n = this.network.vertexes.iterator; n.next();) { var o = n.value; o.yd = o.vertexes.count, o.Jh = 1, o.$j = null, o.Ge = null } Yd(this, 0, t) } this.network = i, e.reset(), n = this.arrangementSpacing; for (var r = e.count, s = !0, a = o = 0, h = zi(), l = 0; l < r + i.vertexes.count + 2; l++)h[l] = null; r = 0, e.reset(); for (var u = yi.alloc(); e.next();)if (l = e.value, this.computeBounds(l, u), s) s = !1, o = u.x + u.width / 2, a = u.y + u.height / 2, h[0] = new gi(u.x + u.width + n.width, u.y), h[1] = new gi(u.x, u.y + u.height + n.height), r = 2; else { var c = Xd(h, r, o, a, u.width, u.height, n), f = h[c], d = new gi(f.x + u.width + n.width, f.y), p = new gi(f.x, f.y + u.height + n.height); for (c + 1 < r && h.splice(c + 1, 0, null), h[c] = d, h[c + 1] = p, r++, c = f.x - u.x, f = f.y - u.y, l = l.vertexes.iterator; l.next();)(d = l.value).centerX += c, d.centerY += f } for (yi.free(u), l = i.vertexes.iterator; l.next();)d = (s = l.value).bounds, r < 2 ? (o = d.x + d.width / 2, a = d.y + d.height / 2, h[0] = new gi(d.x + d.width + n.width, d.y), h[1] = new gi(d.x, d.y + d.height + n.height), r = 2) : (c = new gi((f = h[u = Xd(h, r, o, a, d.width, d.height, n)]).x + d.width + n.width, f.y), d = new gi(f.x, f.y + d.height + n.height), u + 1 < r && h.splice(u + 1, 0, null), h[u] = c, h[u + 1] = d, r++, s.centerX = f.x + s.width / 2, s.centerY = f.y + s.height / 2); for (Vi(h), e.reset(); e.next();) { for (o = (n = e.value).vertexes.iterator; o.next();)i.Bh(o.value); for (n = n.edges.iterator; n.next();)i.cq(n.value) } } Ud(this, t), this.updateParts() } this.xl = t, this.network = null, this.isValidLayout = !0 }, Vd.prototype.needsClusterLayout = function () { if (this.network.vertexes.count < 3) return !1; for (var t = 0, i = 0, e = this.network.vertexes.first().bounds, n = this.network.vertexes.iterator; n.next();) { if (n.value.bounds.Gc(e) && 2 < ++t) return !0; if (10 < i) break; i++ } return !1 }, Vd.prototype.computeBounds = function (t, i) { var e = !0; for (t = t.vertexes.iterator; t.next();) { var n = t.value; e ? (e = !1, i.set(n.bounds)) : i.Hc(n.bounds) } return i }, Vd.prototype.jv = function () { if (this.comments) for (var t = this.network.vertexes.iterator; t.next();)this.addComments(t.value) }, Vd.prototype.addComments = function (t) { var i = t.node; if (null !== i) for (i = i.vv(); i.next();) { var e = i.value; if ("Comment" === e.category && e.isVisible()) { var n = this.network.Wi(e); null === n && (n = this.network.$l(e)), n.charge = this.defaultCommentElectricalCharge, e = null; for (var o = n.destinationEdges; o.next();) { var r = o.value; if (r.toVertex === t) { e = r; break } } if (null === e) for (o = n.sourceEdges; o.next();)if ((r = o.value).fromVertex === t) { e = r; break } null === e && (e = this.network.mk(t, n, null)), e.length = this.defaultCommentSpringLength } } }, Vd.prototype.moveVertex = function (t) { var i = t.forceX, e = t.forceY, n = this.moveLimit; return i < -n ? i = -n : n < i && (i = n), e < -n ? e = -n : n < e && (e = n), t.centerX += i, t.centerY += e, i * i + e * e }, Vd.prototype.moveFixedVertex = function () { }, Vd.prototype.commitLayout = function () { this.jw(), this.commitNodes(), this.isRouting && this.commitLinks() }, Vd.prototype.jw = function () { if (this.setsPortSpots) for (var t = this.network.edges.iterator; t.next();) { var i = t.value.link; null !== i && (i.fromSpot = bi, i.toSpot = bi) } }, Vd.prototype.commitNodes = function () { var t, i = 0, e = 0; this.arrangesToOrigin && (t = yi.alloc(), this.computeBounds(this.network, t), i = (e = this.arrangementOrigin).x - t.x, e = e.y - t.y, yi.free(t)), t = yi.alloc(); for (var n = this.network.vertexes.iterator; n.next();) { var o = n.value; 0 === i && 0 === e || (t.assign(o.bounds), t.x += i, t.y += e, o.bounds = t), o.commit() } yi.free(t) }, Vd.prototype.commitLinks = function () { for (var t = this.network.edges.iterator; t.next();)t.value.commit() }, Vd.prototype.springStiffness = function (t) { return t = t.stiffness, isNaN(t) ? this.Uk : t }, Vd.prototype.springLength = function (t) { return t = t.length, isNaN(t) ? this.Tk : t }, Vd.prototype.electricalCharge = function (t) { return t = t.charge, isNaN(t) ? this.Rk : t }, Vd.prototype.electricalFieldX = function () { return 0 }, Vd.prototype.electricalFieldY = function () { return 0 }, Vd.prototype.gravitationalMass = function (t) { return t = t.mass, isNaN(t) ? this.Sk : t }, Vd.prototype.gravitationalFieldX = function () { return 0 }, Vd.prototype.gravitationalFieldY = function () { return 0 }, Vd.prototype.isFixed = function (t) { return t.isFixed }, l.Object.defineProperties(Vd.prototype, { currentIteration: { get: function () { return this.ko } }, arrangementSpacing: { get: function () { return this.Bd }, set: function (t) { this.Bd.w(t) || (this.Bd.assign(t), this.C()) } }, arrangesToOrigin: { get: function () { return this.Xm }, set: function (t) { this.Xm !== t && (this.Xm = t, this.C()) } }, setsPortSpots: { get: function () { return this.cf }, set: function (t) { this.cf !== t && (this.cf = t, this.C()) } }, comments: { get: function () { return this.$c }, set: function (t) { this.$c !== t && (this.$c = t, this.C()) } }, maxIterations: { get: function () { return this.xl }, set: function (t) { this.xl !== t && 0 <= t && (this.xl = t, this.C()) } }, epsilonDistance: { get: function () { return this.Fn }, set: function (t) { this.Fn !== t && 0 < t && (this.Fn = t, this.C()) } }, infinityDistance: { get: function () { return this.Tf }, set: function (t) { this.Tf !== t && 1 < t && (this.Tf = t, this.C()) } }, moveLimit: { get: function () { return this.Io }, set: function (t) { this.Io !== t && 1 < t && (this.Io = t, this.C()) } }, randomNumberGenerator: { get: function () { return this.ip }, set: function (t) { this.ip !== t && (null !== t && "function" != typeof t.random && B('ForceDirectedLayout.randomNumberGenerator must have a "random()" function on it: ' + t), this.ip = t) } }, defaultSpringStiffness: { get: function () { return this.Uk }, set: function (t) { this.Uk !== t && (this.Uk = t, this.C()) } }, defaultSpringLength: { get: function () { return this.Tk }, set: function (t) { this.Tk !== t && (this.Tk = t, this.C()) } }, defaultElectricalCharge: { get: function () { return this.Rk }, set: function (t) { this.Rk !== t && (this.Rk = t, this.C()) } }, defaultGravitationalMass: { get: function () { return this.Sk }, set: function (t) { this.Sk !== t && (this.Sk = t, this.C()) } }, defaultCommentSpringLength: { get: function () { return this.wn }, set: function (t) { this.wn !== t && (this.wn = t, this.C()) } }, defaultCommentElectricalCharge: { get: function () { return this.vn }, set: function (t) { this.vn !== t && (this.vn = t, this.C()) } } }), Vd.className = "ForceDirectedLayout", Hd.className = "ForceDirectedSubnet", h(Wd, zc), Wd.prototype.createVertex = function () { return new Jd(this) }, Wd.prototype.createEdge = function () { return new Zd(this) }, Wd.className = "ForceDirectedNetwork", h(Jd, qc), l.Object.defineProperties(Jd.prototype, { isFixed: { get: function () { return this.Ia }, set: function (t) { this.Ia !== t && (this.Ia = t) } }, charge: { get: function () { return this.I }, set: function (t) { this.I !== t && (this.I = t) } }, mass: { get: function () { return this.ab }, set: function (t) { this.ab !== t && (this.ab = t) } }, forceX: { get: function () { return this.W }, set: function (t) { this.W !== t && (this.W = t) } }, forceY: { get: function () { return this.Ha }, set: function (t) { this.Ha !== t && (this.Ha = t) } } }), Jd.className = "ForceDirectedVertex", h(Zd, Kc), l.Object.defineProperties(Zd.prototype, { stiffness: { get: function () { return this.u }, set: function (t) { this.u !== t && (this.u = t) } }, length: { get: function () { return this.l }, set: function (t) { this.l !== t && (this.l = t) } } }), Zd.className = "ForceDirectedEdge", $d.prototype.random = function () { var t = this.seed % this.Q * this.uy - this.seed / this.Q * this.yy; return this.seed = 0 < t ? t : t + this.wy, this.seed * this.vy }, $d.className = "RandomNumberGenerator", h(Qd, Ic), Qd.prototype.cloneProtected = function (t) { Ic.prototype.cloneProtected.call(this, t), t.oe = this.oe, t.Zb = this.Zb, t.J = this.J, t.Pk = this.Pk, t.sl = this.sl, t.hl = this.hl, t.zj = this.zj, t.Ek = this.Ek, t.jg = this.jg, t.cf = this.cf, t.so = this.so }, Qd.prototype.fb = function (t) { t.classType === Qd ? 0 === t.name.indexOf("Aggressive") ? this.aggressiveOption = t : 0 === t.name.indexOf("Cycle") ? this.cycleRemoveOption = t : 0 === t.name.indexOf("Init") ? this.initializeOption = t : 0 === t.name.indexOf("Layer") ? this.layeringOption = t : B("Unknown enum value: " + t) : Ic.prototype.fb.call(this, t) }, Qd.prototype.createNetwork = function () { return new qp(this) }, Qd.prototype.doLayout = function (t) { for (null === this.network && (this.network = this.makeNetwork(t)), this.arrangementOrigin = this.initialOrigin(this.arrangementOrigin), this.$r = -1, this.sd = this.Do = 0, this.Oo = this.Mo = this.Ej = null, t = 0; t < this.re.length; t++)this.re[t] = null; if (0 < this.network.vertexes.count) { for (this.network.jq(), this.cycleRemoveOption !== Fp && this.removeCycles(), t = this.network.vertexes.iterator; t.next();)t.value.layer = -1; for (this.xa = -1, this.assignLayers(), t.reset(); t.next();)this.xa = Math.max(this.xa, t.value.layer); this.cycleRemoveOption === Fp && this.removeCycles(); for (var i = [], e = (t = this.network).edges.iterator; e.next();) { var n = e.value; n.valid = !1, i.push(n) } for (e = 0; e < i.length; e++) { var o = (n = i[e]).fromVertex, r = n.toVertex; if (!n.valid && (null !== o.node && null !== r.node || o.layer !== r.layer)) { var s, a, h, l, u, c, f, d = 0, p = 0, g = 0, y = 0; if (null !== n.link) { if (null === (p = n.link)) continue; var m = o.node, d = r.node; if (null === m || null === d) continue; var v = p.fromNode; g = p.toNode; var x = p.fromPort; p = p.toPort, n.rev && (y = v, k = x, v = g, x = p, g = y, p = k); var b = o.focus, y = r.focus, w = n.rev ? r.bounds : o.bounds, k = gi.alloc(); m !== v ? w.v() && v.isVisible() ? v.actualBounds.v() ? (v.vf(x, Zt, k), k.x += v.actualBounds.x - w.x, k.y += v.actualBounds.y - w.y) : (v.vf(x, Zt, k), k.v() || k.assign(b)) : k.assign(b) : w.v() ? (v.vf(x, Zt, k), k.v() || k.assign(b)) : k.assign(b), v = n.rev ? o.bounds : r.bounds, m = gi.alloc(), d !== g ? v.v() && g.isVisible() ? g.actualBounds.v() ? (g.vf(p, Zt, m), m.x += g.actualBounds.x - v.x, m.y += g.actualBounds.y - v.y) : (g.vf(p, Zt, m), m.v() || m.assign(y)) : m.assign(y) : v.v() ? (g.vf(p, Zt, m), m.v() || m.assign(y)) : m.assign(y), y = 90 === this.J || 270 === this.J ? (d = Math.round((k.x - b.x) / this.Zb), g = k.x, p = Math.round((m.x - y.x) / this.Zb), m.x) : (d = Math.round((k.y - b.y) / this.Zb), g = k.y, p = Math.round((m.y - y.y) / this.Zb), m.y), gi.free(k), gi.free(m), n.portFromColOffset = d, n.portFromPos = g, n.portToColOffset = p, n.portToPos = y } else n.portFromColOffset = 0, n.portFromPos = 0, n.portToColOffset = 0, n.portToPos = 0; if (k = o.layer, m = r.layer, v = 0, null !== (w = n.link) && (s = w.fromPort, a = w.toPort, null !== s && null !== a && (h = w.fromNode, x = w.toNode, null !== h && null !== x && (l = Tp(this, !0), u = Tp(this, !1), c = this.setsPortSpots ? l : w.computeSpot(!0, s), b = this.setsPortSpots ? u : w.computeSpot(!1, a), f = w.isOrthogonal, c.gd() && c.wf(u) && b.gd() && b.wf(l) ? v = 0 : (l = w.getLinkPoint(h, s, c, !0, f, x, a, gi.alloc()), u = w.getLinkDirection(h, s, l, c, !0, f, x, a), gi.free(l), (!c.yt() && u === yp(this, n, !0) || this.setsPortSpots && null !== h && 1 === h.ports.count && n.rev) && (v += 1), c = w.getLinkPoint(x, a, b, !1, f, h, s, gi.alloc()), w = w.getLinkDirection(x, a, c, b, !1, f, h, s), gi.free(c), (!b.yt() && w === yp(this, n, !1) || this.setsPortSpots && null !== x && 1 === x.ports.count && n.rev) && (v += 2))))), v = 1 === (x = v) || 3 === x, (x = 2 === x || 3 === x) && ((b = t.createVertex()).node = null, b.Wj = 1, b.layer = k, b.near = o, t.Bh(b), (o = t.mk(o, b, n.link)).valid = !1, o.rev = n.rev, o.portFromColOffset = d, o.portToColOffset = 0, o.portFromPos = g, o.portToPos = 0, o = b), w = 1, v && w--, w < k - m && 0 < k) { for (n.valid = !1, (b = t.createVertex()).node = null, b.Wj = 2, b.layer = k - 1, t.Bh(b), (o = t.mk(o, b, n.link)).valid = !0, o.rev = n.rev, o.portFromColOffset = x ? 0 : d, o.portToColOffset = 0, o.portFromPos = x ? 0 : g, o.portToPos = 0, o = b, k--; w < k - m && 0 < k;)(b = t.createVertex()).node = null, b.Wj = 3, b.layer = k - 1, t.Bh(b), (o = t.mk(o, b, n.link)).valid = !0, o.rev = n.rev, o.portFromColOffset = 0, o.portToColOffset = 0, o.portFromPos = 0, o.portToPos = 0, o = b, k--; (o = t.mk(b, r, n.link)).valid = !v, v && (b.near = r), o.rev = n.rev, o.portFromColOffset = 0, o.portToColOffset = p, o.portFromPos = 0, o.portToPos = y } else n.valid = !0 } } for (t = this.gc = [], i = 0; i <= this.xa; i++)t[i] = 0; for (i = this.network.vertexes.iterator; i.next();)i.value.index = -1; for (this.initializeIndices(), this.$r = -1, e = this.sd = this.Do = 0; e <= this.xa; e++)t[e] > t[this.sd] && (this.$r = t[e] - 1, this.sd = e), t[e] < t[this.Do] && (this.Do = e); for (this.Oo = [], e = 0; e < t.length; e++)this.Oo[e] = []; for (i.reset(); i.next();)t = i.value, this.Oo[t.layer][t.index] = t; for (this.Da = -1, t = 0; t <= this.xa; t++) { for (i = Lp(this, t), e = 0, n = this.gc[t], r = 0; r < n; r++)o = i[r], e += this.nodeMinColumnSpace(o, !0), o.column = e, e += 1, e += this.nodeMinColumnSpace(o, !1); this.Da = Math.max(this.Da, e - 1), Ap(this, t, i) } this.reduceCrossings(), this.straightenAndPack(), this.updateParts() } this.network = null, this.isValidLayout = !0 }, Qd.prototype.linkMinLength = function () { return 1 }, Qd.prototype.nodeMinLayerSpace = function (t, i) { return null === t.node ? 0 : 90 === this.J || 270 === this.J ? i ? t.focus.y + 10 : t.bounds.height - t.focus.y + 10 : i ? t.focus.x + 10 : t.bounds.width - t.focus.x + 10 }, Qd.prototype.nodeMinColumnSpace = function (t, i) { if (null === t.node) return 0; var e = i ? t.Sv : t.Rv; return null !== e ? e : 90 === (e = this.J) || 270 === e ? i ? t.Sv = t.focus.x / this.Zb + 1 | 0 : t.Rv = (t.bounds.width - t.focus.x) / this.Zb + 1 | 0 : i ? t.Sv = t.focus.y / this.Zb + 1 | 0 : t.Rv = (t.bounds.height - t.focus.y) / this.Zb + 1 | 0 }, Qd.prototype.countCrossings = function () { for (var t = 0, i = 0; i <= this.xa; i++)for (var e = ep(this, i, 1), n = this.gc[i], o = 0; o < n; o++)for (var r = o; r < n; r++)t += e[o * n + r]; return t }, Qd.prototype.normalize = function () { var t = 1 / 0; this.Da = -1; for (var i = this.network.vertexes.iterator; i.next();) { var e = i.value, t = Math.min(t, e.column - this.nodeMinColumnSpace(e, !0)); this.Da = Math.max(this.Da, e.column + this.nodeMinColumnSpace(e, !1)) } for (i.reset(); i.next();)i.value.column -= t; this.Da -= t }, Qd.prototype.removeCycles = function () { for (var t = this.network.edges.iterator; t.next();)t.value.rev = !1; switch (this.Pk) { default: case Dp: var i = 0, e = (t = this.network).vertexes.count - 1, n = []; n.length = e + 1; for (var o = t.vertexes.iterator; o.next();)o.value.valid = !0; for (; null !== hp(t);) { for (o = lp(t); null !== o;)n[e] = o, e--, o.valid = !1, o = lp(t); for (o = up(t); null !== o;)n[i] = o, i++, o.valid = !1, o = up(t); o = null; for (var r = 0, s = this.network.vertexes.iterator; s.next();) { var a = s.value; if (a.valid) { for (var h = 0, l = a.destinationEdges; l.next();)l.value.toVertex.valid && h++; l = 0; for (var u = a.sourceEdges; u.next();)u.value.fromVertex.valid && l++; (null === o || r < h - l) && (o = a, r = h - l) } } null !== o && (n[i] = o, i++, o.valid = !1) } for (i = 0; i < t.vertexes.count; i++)n[i].index = i; for (n = t.edges.iterator; n.next();)(i = n.value).fromVertex.index > i.toVertex.index && (t.Dm(i), i.rev = !0); break; case jp: for (n = this.network.vertexes.iterator; n.next();)(t = n.value).em = -1, t.finish = -1; for (t = this.network.edges.iterator; t.next();)t.value.forest = !1; for (this.No = 0, n.reset(); n.next();)0 === (i = n.value).sourceEdges.count && cp(this, i); for (n.reset(); n.next();)-1 === (i = n.value).em && cp(this, i); for (t.reset(); t.next();)(n = t.value).forest || (e = (i = n.fromVertex).finish, r = (o = n.toVertex).finish, o.em < i.em && e < r && (this.network.Dm(n), n.rev = !0)); break; case Fp: for (i = (t = this.network).vertexes.iterator, n = 1 / 0; i.next();)n = Math.min(n, i.value.layer); if (n < 1 / 0) { if (n < 0) for (i.reset(); i.next();)i.value.layer -= n; for (n = [], i.reset(); i.next();)void 0 === (o = n[(e = i.value).layer]) ? n[e.layer] = [e] : o.push(e); for (e = i = 0; e < n.length; e++)if ((o = n[e]) && 0 !== o.length) { if (0 < e) for (r = 0; r < o.length; r++)o[r].layer -= i } else i++; for (n = t.edges.iterator; n.next();)(i = n.value).fromVertex.layer < i.toVertex.layer && (t.Dm(i), i.rev = !0) } } }, Qd.prototype.assignLayers = function () { switch (this.sl) { case Bp: fp(this); break; case Ip: for (var t, i = this.network.vertexes.iterator; i.next();)t = pp(this, i.value), this.xa = Math.max(t, this.xa); for (i.reset(); i.next();)(t = i.value).layer = this.xa - t.layer; break; default: for (fp(this), i = this.network.vertexes.iterator; i.next();)i.value.valid = !1; for (i.reset(); i.next();)0 === (t = i.value).sourceEdges.count && gp(this, t); for (t = 1 / 0, i.reset(); i.next();)t = Math.min(t, i.value.layer); for (this.xa = -1, i.reset(); i.next();) { var e = i.value; e.layer -= t, this.xa = Math.max(this.xa, e.layer) } } }, Qd.prototype.initializeIndices = function () { switch (this.hl) { default: case zp: for (var t = this.network.vertexes.iterator; t.next();) { var i = t.value, e = i.layer; i.index = this.gc[e], this.gc[e]++ } break; case Rp: for (t = this.network.vertexes.iterator, i = this.xa; 0 <= i; i--)for (t.reset(); t.next();)(e = t.value).layer === i && -1 === e.index && mp(this, e); break; case Ep: for (t = this.network.vertexes.iterator, i = 0; i <= this.xa; i++)for (t.reset(); t.next();)(e = t.value).layer === i && -1 === e.index && vp(this, e) } }, Qd.prototype.reduceCrossings = function () { for (var t, i, e, n, o = this.countCrossings(), r = tp(this), s = 0; s < this.zj; s++) { for (t = 0; t <= this.xa; t++)xp(this, t, 1), bp(this, t, 1); var a = this.countCrossings(); for (a < o && (o = a, r = tp(this)), t = this.xa; 0 <= t; t--)xp(this, t, -1), bp(this, t, -1); (a = this.countCrossings()) < o && (o = a, r = tp(this)) } for (ip(this, r), s = 0; s < this.zj; s++) { for (t = 0; t <= this.xa; t++)xp(this, t, 0), bp(this, t, 0); for ((a = this.countCrossings()) < o && (o = a, r = tp(this)), t = this.xa; 0 <= t; t--)xp(this, t, 0), bp(this, t, 0); (a = this.countCrossings()) < o && (o = a, r = tp(this)) } switch (ip(this, r), this.Ek) { case Vp: break; case Gp: for (n = o + 1; (t = this.countCrossings()) < n;)for (n = t, s = this.xa; 0 <= s; s--)for (e = 0; e <= s; e++) { for (i = !0; i;)for (i = !1, t = s; e <= t; t--)i = bp(this, t, -1) || i; for (o <= (a = this.countCrossings()) ? ip(this, r) : (o = a, r = tp(this)), i = !0; i;)for (i = !1, t = s; e <= t; t--)i = bp(this, t, 1) || i; for (o <= (a = this.countCrossings()) ? ip(this, r) : (o = a, r = tp(this)), i = !0; i;)for (i = !1, t = e; t <= s; t++)i = bp(this, t, 1) || i; for (o <= a ? ip(this, r) : (o = a, r = tp(this)), i = !0; i;)for (i = !1, t = e; t <= s; t++)i = bp(this, t, -1) || i; for (o <= a ? ip(this, r) : (o = a, r = tp(this)), i = !0; i;)for (i = !1, t = s; e <= t; t--)i = bp(this, t, 0) || i; for (o <= a ? ip(this, r) : (o = a, r = tp(this)), i = !0; i;)for (i = !1, t = e; t <= s; t++)i = bp(this, t, 0) || i; o <= a ? ip(this, r) : (o = a, r = tp(this)) } break; default: for (s = this.xa, e = 0, n = o + 1; (t = this.countCrossings()) < n;) { for (n = t, i = !0; i;)for (i = !1, t = s; e <= t; t--)i = bp(this, t, -1) || i; for (o <= (a = this.countCrossings()) ? ip(this, r) : (o = a, r = tp(this)), i = !0; i;)for (i = !1, t = s; e <= t; t--)i = bp(this, t, 1) || i; for (o <= (a = this.countCrossings()) ? ip(this, r) : (o = a, r = tp(this)), i = !0; i;)for (i = !1, t = e; t <= s; t++)i = bp(this, t, 1) || i; for (o <= a ? ip(this, r) : (o = a, r = tp(this)), i = !0; i;)for (i = !1, t = e; t <= s; t++)i = bp(this, t, -1) || i; for (o <= a ? ip(this, r) : (o = a, r = tp(this)), i = !0; i;)for (i = !1, t = s; e <= t; t--)i = bp(this, t, 0) || i; for (o <= a ? ip(this, r) : (o = a, r = tp(this)), i = !0; i;)for (i = !1, t = e; t <= s; t++)i = bp(this, t, 0) || i; o <= a ? ip(this, r) : (o = a, r = tp(this)) } }ip(this, r) }, Qd.prototype.straightenAndPack = function () { var t = 0 != (1 & this.jg), i = 7 === this.jg; if (1e3 < this.network.edges.count && !i && (t = !1), t) { var e = []; for (i = 0; i <= this.xa; i++)e[i] = 0; for (var n = this.network.vertexes.iterator; n.next();) { var i = (r = n.value).layer, o = r.column, r = this.nodeMinColumnSpace(r, !1); e[i] = Math.max(e[i], o + r) } for (n.reset(); n.next();)i = (r = n.value).layer, o = r.column, r.column = (8 * (this.Da - e[i]) >> 1) + 8 * o; this.Da *= 8 } if (0 != (2 & this.jg)) for (e = !0; e;) { for (e = !1, i = this.sd + 1; i <= this.xa; i++)e = wp(this, i, 1) || e; for (i = this.sd - 1; 0 <= i; i--)e = wp(this, i, -1) || e; e = wp(this, this.sd, 0) || e } if (0 != (4 & this.jg)) { for (i = this.sd + 1; i <= this.xa; i++)Mp(this, i, 1); for (i = this.sd - 1; 0 <= i; i--)Mp(this, i, -1); Mp(this, this.sd, 0) } if (t && (Np(this, -1), Np(this, 1)), 0 != (2 & this.jg)) for (e = !0; e;) { for (e = !1, e = wp(this, this.sd, 0) || e, i = this.sd + 1; i <= this.xa; i++)e = wp(this, i, 0) || e; for (i = this.sd - 1; 0 <= i; i--)e = wp(this, i, 0) || e } }, Qd.prototype.commitLayout = function () { if (this.setsPortSpots) for (var t = Tp(this, !0), i = Tp(this, !1), e = this.network.edges.iterator; e.next();) { var n = e.value.link; null !== n && (n.fromSpot = t, n.toSpot = i) } this.commitNodes(), this.lv(), this.isRouting && this.commitLinks() }, Qd.prototype.commitNodes = function () { this.Md = [], this.rd = [], this.qd = [], this.Ga = []; for (var t = 0; t <= this.xa; t++)this.Md[t] = 0, this.rd[t] = 0, this.qd[t] = 0, this.Ga[t] = 0; for (t = this.network.vertexes.iterator; t.next();) { var i = t.value, e = i.layer; this.Md[e] = Math.max(this.Md[e], this.nodeMinLayerSpace(i, !0)), this.rd[e] = Math.max(this.rd[e], this.nodeMinLayerSpace(i, !1)) } i = 0, e = this.oe; for (var n = 0; n <= this.xa; n++) { var o = e; this.Md[n] + this.rd[n] <= 0 && (o = 0), 0 < n && (i += o / 2), 90 === this.J || 0 === this.J ? (i += this.rd[n], this.qd[n] = i, i += this.Md[n]) : (i += this.Md[n], this.qd[n] = i, i += this.rd[n]), n < this.xa && (i += o / 2), this.Ga[n] = i } for (e = i, i = this.arrangementOrigin, n = 0; n <= this.xa; n++)270 === this.J ? this.qd[n] = i.y + this.qd[n] : 90 === this.J ? (this.qd[n] = i.y + e - this.qd[n], this.Ga[n] = e - this.Ga[n]) : 180 === this.J ? this.qd[n] = i.x + this.qd[n] : (this.qd[n] = i.x + e - this.qd[n], this.Ga[n] = e - this.Ga[n]); for (t.reset(), e = n = 1 / 0; t.next();) { var r, s = (o = t.value).layer, a = 0 | o.column; s = 270 === this.J || 90 === this.J ? (r = i.x + this.Zb * a, this.qd[s]) : (r = this.qd[s], i.y + this.Zb * a), o.centerX = r, o.centerY = s, n = Math.min(o.x, n), e = Math.min(o.y, e) } for (n = i.x - n, i = i.y - e, this.Gf = new gi(n, i), t.reset(); t.next();)(e = t.value).x += n, e.y += i, e.commit() }, Qd.prototype.lv = function () { for (var t = 0, i = this.oe, e = 0; e <= this.xa; e++)t += this.Md[e], t += this.rd[e]; t += this.xa * i, i = [], e = this.Zb * this.Da; for (var n = this.maxLayer; 0 <= n; n--)270 === this.J ? 0 === n ? i.push(new yi(0, 0, e, Math.abs(this.Ga[0]))) : i.push(new yi(0, this.Ga[n - 1], e, Math.abs(this.Ga[n - 1] - this.Ga[n]))) : 90 === this.J ? 0 === n ? i.push(new yi(0, this.Ga[0], e, Math.abs(this.Ga[0] - t))) : i.push(new yi(0, this.Ga[n], e, Math.abs(this.Ga[n - 1] - this.Ga[n]))) : 180 === this.J ? 0 === n ? i.push(new yi(0, 0, Math.abs(this.Ga[0]), e)) : i.push(new yi(this.Ga[n - 1], 0, Math.abs(this.Ga[n - 1] - this.Ga[n]), e)) : 0 === n ? i.push(new yi(this.Ga[0], 0, Math.abs(this.Ga[0] - t), e)) : i.push(new yi(this.Ga[n], 0, Math.abs(this.Ga[n - 1] - this.Ga[n]), e)); this.commitLayers(i, this.Gf) }, Qd.prototype.commitLayers = function () { }, Qd.prototype.commitLinks = function () { for (var t, i = this.network.edges.iterator; i.next();)null !== (t = i.value.link) && (t.Kh(), t.Zj(), t.rf()); for (i.reset(); i.next();)null !== (t = i.value.link) && t.hj(); for (i.reset(); i.next();) { if (null !== (t = (h = i.value).link)) { t.Kh(); var e = t, n = e.fromNode, o = e.toNode, r = e.fromPort, s = e.toPort; null === n || null !== (u = n.findVisibleNode()) && u !== n && (r = (n = u).port), null !== o && (null !== (u = o.findVisibleNode()) && u !== o && (s = (o = u).port)); var a, h, l = t.computeSpot(!0, r), u = t.computeSpot(!1, s), c = h.fromVertex, f = h.toVertex; if (h.valid) t.curve === nc && 4 === t.pointsCount && (c.column === f.column ? (h = t.getLinkPoint(n, r, l, !0, !1, o, s), r = t.getLinkPoint(o, s, u, !1, !1, n, r), h.v() || h.set(n.actualBounds.center), r.v() || r.set(o.actualBounds.center), t.Zj(), t.qf(h.x, h.y), t.qf((2 * h.x + r.x) / 3, (2 * h.y + r.y) / 3), t.qf((h.x + 2 * r.x) / 3, (h.y + 2 * r.y) / 3), t.qf(r.x, r.y)) : (a = g = !1, null !== r && l === Kt && (g = !0), null !== s && u === Kt && (a = !0), (g || a) && (y = t.i(0).x, h = t.i(0).y, c = t.i(3).x, e = t.i(3).y, g && (f = 90 === this.J || 270 === this.J ? (g = y, (h + e) / 2) : (g = (y + c) / 2, h), t.K(1, g, f), (l = t.getLinkPoint(n, r, l, !0, !1, o, s)).v() || l.set(n.actualBounds.center), t.K(0, l.x, l.y)), a && (h = 90 === this.J || 270 === this.J ? (l = c, (h + e) / 2) : (l = (y + c) / 2, e), t.K(2, l, h), (n = t.getLinkPoint(o, s, u, !1, !1, n, r)).v() || n.set(o.actualBounds.center), t.K(3, n.x, n.y))))), t.rf(); else if (c.layer === f.layer) t.rf(); else { var d, p, g = a = !1, y = t.firstPickIndex + 1; if (t.isOrthogonal ? (g = !0, 4 < (d = t.pointsCount) && t.points.removeRange(2, d - 3)) : t.curve === nc ? (a = !0, 4 < (d = t.pointsCount) && t.points.removeRange(2, d - 3), 4 === d && (y = 2)) : (d = t.pointsCount, k = l === Kt, p = u === Kt, 2 < d && k && p ? t.points.removeRange(1, d - 2) : 3 < d && k && !p ? t.points.removeRange(1, d - 3) : 3 < d && !k && p ? t.points.removeRange(2, d - 2) : 4 < d && !k && !p && t.points.removeRange(2, d - 3)), h.rev) { for (; null !== f && c !== f;) { for (var m, v, x, b, w = d = null, k = f.sourceEdges.iterator; k.next() && ((p = k.value).link !== h.link || (d = p.fromVertex, w = p.toVertex, null !== d.node));); d !== c && (k = t.i(y - 1).x, p = t.i(y - 1).y, m = d.centerX, v = d.centerY, g ? 180 === this.J || 0 === this.J ? y === t.firstPickIndex + 1 ? (t.m(y++, k, p), t.m(y++, k, v)) : (null !== w ? w.centerY : p) !== v && (w = this.Ga[d.layer - 1] + this.Gf.x, t.m(y++, w, p), t.m(y++, w, v)) : y === t.firstPickIndex + 1 ? (t.m(y++, k, p), t.m(y++, m, p)) : (null !== w ? w.centerX : k) !== m && (w = this.Ga[d.layer - 1] + this.Gf.y, t.m(y++, k, w), t.m(y++, m, w)) : y === t.firstPickIndex + 1 ? (w = Math.max(10, this.Md[f.layer]), x = Math.max(10, this.rd[f.layer]), a ? 180 === this.J ? m <= f.bounds.x ? (f = f.bounds.x, t.m(y++, f - w, v), t.m(y++, f, v), t.m(y++, f + x, v)) : (t.m(y++, m - w, v), t.m(y++, m, v), t.m(y++, m + x, v)) : 90 === this.J ? v >= f.bounds.bottom ? (f = f.bounds.y + f.bounds.height, t.m(y++, m, f + x), t.m(y++, m, f), t.m(y++, m, f - w)) : (t.m(y++, m, v + x), t.m(y++, m, v), t.m(y++, m, v - w)) : 270 === this.J ? v <= f.bounds.y ? (f = f.bounds.y, t.m(y++, m, f - w), t.m(y++, m, f), t.m(y++, m, f + x)) : (t.m(y++, m, v - w), t.m(y++, m, v), t.m(y++, m, v + x)) : 0 === this.J && (m >= f.bounds.right ? (f = f.bounds.x + f.bounds.width, t.m(y++, f + x, v), t.m(y++, f, v), t.m(y++, f - w, v)) : (t.m(y++, m + x, v), t.m(y++, m, v), t.m(y++, m - w, v))) : (t.m(y++, k, p), b = 0, 180 === this.J || 0 === this.J ? ((180 === this.J ? m >= f.bounds.right : m <= f.bounds.x) && (b = (0 === this.J ? -w : x) / 2), t.m(y++, k + b, v)) : ((270 === this.J ? v >= f.bounds.bottom : v <= f.bounds.y) && (b = (90 === this.J ? -w : x) / 2), t.m(y++, m, p + b)), t.m(y++, m, v))) : (w = Math.max(10, this.Md[d.layer]), x = Math.max(10, this.rd[d.layer]), 180 === this.J ? (a && t.m(y++, m - w, v), t.m(y++, m, v), a && t.m(y++, m + x, v)) : 90 === this.J ? (a && t.m(y++, m, v + x), t.m(y++, m, v), a && t.m(y++, m, v - w)) : 270 === this.J ? (a && t.m(y++, m, v - w), t.m(y++, m, v), a && t.m(y++, m, v + x)) : (a && t.m(y++, m + x, v), t.m(y++, m, v), a && t.m(y++, m - w, v)))), f = d } null !== s && l === Kt && !g || (k = t.i(y - 1).x, p = t.i(y - 1).y, m = t.i(y).x, v = t.i(y).y, g ? (f = this.rd[c.layer], 180 === this.J || 0 === this.J ? ((g = p) >= c.bounds.y && g <= c.bounds.bottom && (180 === this.J ? m >= c.bounds.x : m <= c.bounds.right) && (f = c.centerX + (180 === this.J ? -f : f), g = g < c.bounds.y + c.bounds.height / 2 ? c.bounds.y - this.Zb / 2 : c.bounds.bottom + this.Zb / 2, t.m(y++, f, p), t.m(y++, f, g)), t.m(y++, m, g)) : ((g = k) >= c.bounds.x && g <= c.bounds.right && (270 === this.J ? v >= c.bounds.y : v <= c.bounds.bottom) && (f = c.centerY + (270 === this.J ? -f : f), g = g < c.bounds.x + c.bounds.width / 2 ? c.bounds.x - this.Zb / 2 : c.bounds.right + this.Zb / 2, t.m(y++, k, f), t.m(y++, g, f)), t.m(y++, g, v)), t.m(y++, m, v)) : a ? (w = Math.max(10, this.Md[c.layer]), x = Math.max(10, this.rd[c.layer]), 180 === this.J && m >= c.bounds.x ? (f = c.bounds.x + c.bounds.width, t.K(y - 2, f, p), t.K(y - 1, f + x, p)) : 90 === this.J && v <= c.bounds.bottom ? (f = c.bounds.y, t.K(y - 2, k, f), t.K(y - 1, k, f - w)) : 270 === this.J && v >= c.bounds.y ? (f = c.bounds.y + c.bounds.height, t.K(y - 2, k, f), t.K(y - 1, k, f + x)) : 0 === this.J && m <= c.bounds.right && (f = c.bounds.x, t.K(y - 2, f, p), t.K(y - 1, f - w, p))) : (w = Math.max(10, this.Md[c.layer]), x = Math.max(10, this.rd[c.layer]), g = 0, 180 === this.J || 0 === this.J ? ((180 === this.J ? m <= c.bounds.x : m >= c.bounds.right) && (g = (0 === this.J ? x : -w) / 2), t.m(y++, m + g, p)) : ((270 === this.J ? v <= c.bounds.y : v >= c.bounds.bottom) && (g = (90 === this.J ? x : -w) / 2), t.m(y++, k, v + g)), t.m(y++, m, v))) } else { for (; null !== c && c !== f;) { for (w = d = null, c = c.destinationEdges.iterator; c.next() && ((k = c.value).link !== h.link || (d = k.toVertex, null !== (w = k.fromVertex).node && (w = null), null !== d.node));); d !== f && (k = t.i(y - 1).x, p = t.i(y - 1).y, m = d.centerX, v = d.centerY, g ? 180 === this.J || 0 === this.J ? (null !== w ? w.centerY : p) !== v && (w = this.Ga[d.layer] + this.Gf.x, y === t.firstPickIndex + 1 && (w = 0 === this.J ? Math.max(w, k) : Math.min(w, k)), t.m(y++, w, p), t.m(y++, w, v)) : (null !== w ? w.centerX : k) !== m && (w = this.Ga[d.layer] + this.Gf.y, y === t.firstPickIndex + 1 && (w = 90 === this.J ? Math.max(w, p) : Math.min(w, p)), t.m(y++, k, w), t.m(y++, m, w)) : (w = Math.max(10, this.Md[d.layer]), x = Math.max(10, this.rd[d.layer]), 180 === this.J ? (t.m(y++, m + x, v), a && t.m(y++, m, v), t.m(y++, m - w, v)) : 90 === this.J ? (t.m(y++, m, v - w), a && t.m(y++, m, v), t.m(y++, m, v + x)) : 270 === this.J ? (t.m(y++, m, v + x), a && t.m(y++, m, v), t.m(y++, m, v - w)) : (t.m(y++, m - w, v), a && t.m(y++, m, v), t.m(y++, m + x, v)))), c = d } g && (k = t.i(y - 1).x, p = t.i(y - 1).y, m = t.i(y).x, v = t.i(y).y, 180 === this.J || 0 === this.J ? p !== v && (w = 0 === this.J ? Math.min(Math.max((m + k) / 2, this.Ga[f.layer] + this.Gf.x), m) : Math.max(Math.min((m + k) / 2, this.Ga[f.layer] + this.Gf.x), m), t.m(y++, w, p), t.m(y++, w, v)) : k !== m && (w = 90 === this.J ? Math.min(Math.max((v + p) / 2, this.Ga[f.layer] + this.Gf.y), v) : Math.max(Math.min((v + p) / 2, this.Ga[f.layer] + this.Gf.y), v), t.m(y++, k, w), t.m(y++, m, w))) } null !== e && a && (null !== r && (l === Kt && (l = t.i(0), e = t.i(2), l.w(e) || t.K(1, (l.x + e.x) / 2, (l.y + e.y) / 2)), (l = t.getLinkPoint(n, r, Kt, !0, !1, o, s)).v() || l.set(n.actualBounds.center), t.K(0, l.x, l.y)), null !== s && (u === Kt && (u = t.i(t.pointsCount - 1), l = t.i(t.pointsCount - 3), u.w(l) || t.K(t.pointsCount - 2, (u.x + l.x) / 2, (u.y + l.y) / 2)), (n = t.getLinkPoint(o, s, Kt, !1, !1, n, r)).v() || n.set(o.actualBounds.center), t.K(t.pointsCount - 1, n.x, n.y))), t.rf(), h.commit() } } } this.avoidOrthogonalOverlaps() }, Qd.prototype.avoidOrthogonalOverlaps = function () { if (!(this.linkSpacing <= 0)) { for (var t = new J, i = this.network.edges.iterator; i.next();) { var e = i.value.link; null !== e && e.isOrthogonal && !t.contains(e) && t.add(e) } if (0 < t.count) if (90 === this.J || 270 === this.J) { for (i = 0, e = [], t = t.iterator; t.next();) { var n = t.value; if (null !== n && n.isOrthogonal) for (var o = 2; o < n.pointsCount - 3; o++) { var r, s, a = n.i(o), h = n.i(o + 1); this.A(a.y, h.y) && !this.A(a.x, h.x) && ((u = new Xp).layer = Math.floor(a.y / 2), c = n.i(0), r = n.i(n.pointsCount - 1), u.first = c.x * c.x + c.y, u.Xb = r.x * r.x + r.y, u.Tc = Math.min(a.x, h.x), u.tc = Math.max(a.x, h.x), (u.index = o) + 2 < (u.link = n).pointsCount && (c = n.i(o - 1), r = n.i(o + 2), s = 0, c.y < a.y ? s = r.y < a.y ? 3 : a.x < h.x ? 2 : 1 : c.y > a.y && (s = r.y > a.y ? 0 : h.x < a.x ? 2 : 1), u.l = s), e.push(u)) } } if (1 < e.length) for (e.sort(this.jy), t = 0; t < e.length;) { for (a = e[t].layer, n = t + 1; n < e.length && e[n].layer === a;)n++; if (1 < n - t) for (a = t; a < n;) { for (h = e[a].tc, o = t + 1; o < n && e[o].Tc < h;)h = Math.max(h, e[o].tc), o++; if (1 < (h = o - a)) { for (this.ej(e, this.Mt, a, a + h), s = 1, u = e[a].Xb, c = a; c < o; c++)(r = e[c]).Xb !== u && (s++, u = r.Xb); this.ej(e, this.iy, a, a + h); for (var l = 1, u = e[a].first, c = a; c < o; c++)(r = e[c]).first !== u && (l++, u = r.first); for (c = !0, s < (r = l) ? (c = !1, r = s, u = e[a].Xb, this.ej(e, this.Mt, a, a + h)) : u = e[a].first, s = 0, l = a; l < o; l++) { var f = e[l]; (c ? f.first : f.Xb) !== u && (s++, u = c ? f.first : f.Xb); var d = f.link, a = d.i(f.index), h = d.i(f.index + 1), p = this.linkSpacing * (s - (r - 1) / 2); i++, d.Kh(), d.K(f.index, a.x, a.y + p), d.K(f.index + 1, h.x, h.y + p), d.rf() } } a = o } t = n } } else { for (i = 0, e = [], t = t.iterator; t.next();)if (null !== (n = t.value) && n.isOrthogonal) for (o = 2; o < n.pointsCount - 3; o++)a = n.i(o), h = n.i(o + 1), this.A(a.x, h.x) && !this.A(a.y, h.y) && ((u = new Xp).layer = Math.floor(a.x / 2), c = n.i(0), r = n.i(n.pointsCount - 1), u.first = c.x + c.y * c.y, u.Xb = r.x + r.y * r.y, u.Tc = Math.min(a.y, h.y), u.tc = Math.max(a.y, h.y), (u.index = o) + 2 < (u.link = n).pointsCount && (c = n.i(o - 1), r = n.i(o + 2), s = 0, c.x < a.x ? s = r.x < a.x ? 3 : a.y < h.y ? 2 : 1 : c.x > a.x && (s = r.x > a.x ? 0 : h.y < a.y ? 2 : 1), u.l = s), e.push(u)); if (1 < e.length) for (e.sort(this.jy), t = 0; t < e.length;) { for (a = e[t].layer, n = t + 1; n < e.length && e[n].layer === a;)n++; if (1 < n - t) for (a = t; a < n;) { for (h = e[a].tc, o = t + 1; o < n && e[o].Tc < h;)h = Math.max(h, e[o].tc), o++; if (1 < (h = o - a)) { for (this.ej(e, this.Mt, a, a + h), s = 1, u = e[a].Xb, c = a; c < o; c++)(r = e[c]).Xb !== u && (s++, u = r.Xb); for (this.ej(e, this.iy, a, a + h), l = 1, u = e[a].first, c = a; c < o; c++)(r = e[c]).first !== u && (l++, u = r.first); for (c = !0, s < (r = l) ? (c = !1, r = s, u = e[a].Xb, this.ej(e, this.Mt, a, a + h)) : u = e[a].first, s = 0, l = a; l < o; l++)f = e[l], (c ? f.first : f.Xb) !== u && (s++, u = c ? f.first : f.Xb), a = (d = f.link).i(f.index), h = d.i(f.index + 1), p = this.linkSpacing * (s - (r - 1) / 2), i++, d.Kh(), d.K(f.index, a.x + p, a.y), d.K(f.index + 1, h.x + p, h.y), d.rf() } a = o } t = n } } } }, (t = Qd.prototype).jy = function (t, i) { return t instanceof Xp && i instanceof Xp && t !== i ? t.layer < i.layer ? -1 : t.layer > i.layer ? 1 : t.Tc < i.Tc ? -1 : t.Tc > i.Tc ? 1 : t.tc < i.tc ? -1 : t.tc > i.tc ? 1 : 0 : 0 }, t.iy = function (t, i) { return t instanceof Xp && i instanceof Xp && t !== i ? t.first < i.first ? -1 : t.first > i.first || t.l < i.l ? 1 : t.l > i.l || t.Tc < i.Tc ? -1 : t.Tc > i.Tc ? 1 : t.tc < i.tc ? -1 : t.tc > i.tc ? 1 : 0 : 0 }, t.Mt = function (t, i) { return t instanceof Xp && i instanceof Xp && t !== i ? t.Xb < i.Xb ? -1 : t.Xb > i.Xb || t.l < i.l ? 1 : t.l > i.l || t.Tc < i.Tc ? -1 : t.Tc > i.Tc ? 1 : t.tc < i.tc ? -1 : t.tc > i.tc ? 1 : 0 : 0 }, t.A = function (t, i) { return -1 < (t -= i) && t < 1 }, t.ej = function (t, i, e, n) { var o = t.length, r = n - e; if (!(r <= 1)) if ((e < 0 || o - 1 <= e) && B("not in range 0 <= from < length: " + e), 2 == r) 0 < i(n = t[e], o = t[e + 1]) && (t[e] = o, t[e + 1] = n); else if (0 === e) if (o <= n) t.sort(i); else for ((e = t.slice(0, n)).sort(i), i = 0; i < n; i++)t[i] = e[i]; else if (o <= n) for ((n = t.slice(e)).sort(i), i = e; i < o; i++)t[i] = n[i - e]; else for ((o = t.slice(e, n)).sort(i), i = e; i < n; i++)t[i] = o[i - e] }, l.Object.defineProperties(Qd.prototype, { layerSpacing: { get: function () { return this.oe }, set: function (t) { this.oe !== t && 0 <= t && (this.oe = t, this.C()) } }, columnSpacing: { get: function () { return this.Zb }, set: function (t) { this.Zb !== t && 0 < t && (this.Zb = t, this.C()) } }, direction: { get: function () { return this.J }, set: function (t) { this.J !== t && (0 === t || 90 === t || 180 === t || 270 === t ? (this.J = t, this.C()) : B("LayeredDigraphLayout.direction must be 0, 90, 180, or 270")) } }, cycleRemoveOption: { get: function () { return this.Pk }, set: function (t) { this.Pk === t || t !== Dp && t !== jp && t !== Fp || (this.Pk = t, this.C()) } }, layeringOption: { get: function () { return this.sl }, set: function (t) { this.sl === t || t !== Op && t !== Bp && t !== Ip || (this.sl = t, this.C()) } }, initializeOption: { get: function () { return this.hl }, set: function (t) { this.hl === t || t !== Rp && t !== Ep && t !== zp || (this.hl = t, this.C()) } }, iterations: { get: function () { return this.zj }, set: function (t) { this.zj !== t && 0 <= t && (this.zj = t, this.C()) } }, aggressiveOption: { get: function () { return this.Ek }, set: function (t) { this.Ek === t || t !== Vp && t !== Yp && t !== Gp || (this.Ek = t, this.C()) } }, packOption: { get: function () { return this.jg }, set: function (t) { this.jg !== t && 0 <= t && t < 8 && (this.jg = t, this.C()) } }, setsPortSpots: { get: function () { return this.cf }, set: function (t) { this.cf !== t && (this.cf = t, this.C()) } }, linkSpacing: { get: function () { return this.so }, set: function (t) { this.so !== t && 0 <= t && (this.so = t, this.C()) } }, maxLayer: { get: function () { return this.xa } }, maxIndex: { get: function () { return this.$r } }, maxColumn: { get: function () { return this.Da } }, minIndexLayer: { get: function () { return this.Do } }, maxIndexLayer: { get: function () { return this.sd } } }); var jp = new V(Qd, "CycleDepthFirst", 0), Dp = new V(Qd, "CycleGreedy", 1), Fp = new V(Qd, "CycleFromLayers", 2), Op = new V(Qd, "LayerOptimalLinkLength", 0), Bp = new V(Qd, "LayerLongestPathSink", 1), Ip = new V(Qd, "LayerLongestPathSource", 2), Rp = new V(Qd, "InitDepthFirstOut", 0), Ep = new V(Qd, "InitDepthFirstIn", 1), zp = new V(Qd, "InitNaive", 2), Vp = new V(Qd, "AggressiveNone", 0), Yp = new V(Qd, "AggressiveLess", 1), Gp = new V(Qd, "AggressiveMore", 2); function Xp() { this.index = this.tc = this.Tc = this.Xb = this.first = this.layer = 0, this.link = null, this.l = 0 } function qp(t) { zc.call(this, t) } function Up(t) { qc.call(this, t), this.Oa = this.Lg = this.ui = -1, this.I = NaN, this.W = null, this.valid = !1, this.finish = this.em = NaN, this.Wj = 0, this.Rv = this.Sv = null } function Kp(t) { Kc.call(this, t), this.l = this.Ia = this.ab = !1, this.Ha = this.I = NaN, this.W = this.u = 0 } function Hp() { Ic.call(this), this.Ib = new $, this.bp = Sg, this.ad = Pg, this.Yp = Yg, this.Zr = Wg, this.Nw = [], this.$c = !0, this.Bb = Ug, this.Bd = new Yi(10, 10).freeze(); var t = new $g(this); this.T = new Qg(t), this.U = new Qg(t), this.Yu = [] } function Wp(t) { var i = new $; for (t = t.iterator; t.next();) { var e = t.value; e.initialized || i.add(e) } return i } function Jp(t, i) { var e = 999999, n = null; for (i = i.iterator; i.next();) { var o = i.value; switch (t.ad) { case Pg: o.sourceEdges.count < e && (e = o.sourceEdges.count, n = o); break; case Ng: o.destinationEdges.count < e && (e = o.destinationEdges.count, n = o); break; default: B("Unhandled path value " + t.ad.toString()) } } return n } function Zp(t, i) { if (null !== i) { switch (t.ad) { case Pg: if (0 < i.destinationEdges.count) { for (var e = new J, n = i.destinationVertexes; n.next();) { var o = n.value; $p(t, i, o) && e.add(o) } 0 < e.count && (i.children = e.na()) } break; case Ng: if (0 < i.sourceEdges.count) { for (e = new J, n = i.sourceVertexes; n.next();)$p(t, i, o = n.value) && e.add(o); 0 < e.count && (i.children = e.na()) } break; default: B("Unhandled path value" + t.ad.toString()) }for (n = (e = i.children).length, o = 0; o < n; o++) { var r = e[o]; r.initialized = !0, r.level = i.level + 1, r.parent = i, t.Ib.remove(r) } for (i = 0; i < n; i++)Zp(t, e[i]) } } function $p(t, i, e) { if (e.initialized) { if (null === i) var n = !1; else { for (n = i.parent; null !== n && n !== e;)n = n.parent; n = n === e } if (n || e.level > i.level) return; t.removeChild(e.parent, e) } return 1 } function Qp(t, i) { if (null !== i) { t.initializeTreeVertexValues(i), i.alignment === Ig && t.sortTreeVertexChildren(i); for (var e = 0, n = i.childrenCount, o = 0, r = i.children, s = r.length, a = 0; a < s; a++) { var h = r[a]; Qp(t, h), e += h.descendantCount + 1, n = Math.max(n, h.maxChildrenCount), o = Math.max(o, h.maxGenerationCount) } i.descendantCount = e, i.maxChildrenCount = n, i.maxGenerationCount = 0 < n ? o + 1 : 0 } } function _p(t, i) { if (null !== i) { t.assignTreeVertexValues(i); for (var e = (i = i.children).length, n = 0; n < e; n++)_p(t, i[n]) } } function tg(t, i) { if (null !== i) { i.alignment !== Ig && t.sortTreeVertexChildren(i); for (var e = (i = i.children).length, n = 0; n < e; n++)tg(t, i[n]) } } function ig(t) { return t === Bg || t === Ig || t === Rg || t === Eg } function eg(t) { return t === Bg || t === Ig } function ng(t) { var i = t.parent; if (null !== i) { var e = i.alignment; if (ig(e)) { if (eg(e)) { for (i = i.children, e = 0; e < i.length && t !== i[e];)e++; return 0 == e % 2 } if (e === Rg) return !0 } } return !1 } function og(t, i) { if (0 === i.childrenCount) { var e = !1, n = 0; null !== i.parent && (n = i.parent.angle, e = ig(e = i.parent.alignment)); var o = ng(i); i.S.h(0, 0), i.ta.h(i.width, i.height), null === i.parent || null === i.comments || (180 !== n && 270 !== n || e) && !o ? i.da.h(0, 0) : 180 === n && !e || (90 === n || 270 === n) && o ? i.da.h(i.width - 2 * i.focus.x, 0) : i.da.h(0, i.height - 2 * i.focus.y) } else { e = 90 === (n = wg(i)) || 270 === n; for (var r = 0, s = (o = i.children).length, a = 0; a < s; a++)var h = o[a], r = Math.max(r, e ? h.ta.width : h.ta.height); var l = i.alignment, u = l === Fg, c = l === Og, a = ig(l), f = Math.max(0, i.breadthLimit), h = kg(i), d = i.nodeSpacing, p = Mg(i), g = u || c ? 0 : p / 2, y = i.rowSpacing, m = 0; (u || c || i.Em || i.Fm && 1 === i.maxGenerationCount) && (m = Math.max(0, i.rowIndent)), u = i.width; var v = i.height, x = 0, b = 0, w = 0, k = 0, M = 0, S = 0, P = 0, N = 0, C = 0; if (a && !eg(l) && 135 < n && o.reverse(), eg(l)) if (1 < s) for (var T = 0; T < s; T++) { var L = o[T], A = L.ta; 0 == T % 2 && T !== s - 1 && (C = Math.max(C, (e ? A.width : A.height) + ag(L) - d)) } else 1 === s && (C = e ? o[0].ta.width : o[0].ta.height); if (a) switch (l) { case Bg: case Ig: C = (b = (n < 135 ? rg : sg)(i, o, C, x, b)).x, x = b.width, b = b.height; break; case Rg: for (t = 0; t < s; t++)g = (f = o[t]).ta, w = 0 === P ? 0 : y, e ? (f.S.h(r - g.width, M + w), x = Math.max(x, g.width), b = Math.max(b, M + w + g.height), M += w + g.height) : (f.S.h(k + w, r - g.height), x = Math.max(x, k + w + g.width), b = Math.max(b, g.height), k += w + g.width), P++; break; case Eg: for (r = 0; r < s; r++)f = (t = o[r]).ta, g = 0 === P ? 0 : y, e ? (t.S.h(d / 2 + i.focus.x, M + g), x = Math.max(x, f.width), b = Math.max(b, M + g + f.height), M += g + f.height) : (t.S.h(k + g, d / 2 + i.focus.y), x = Math.max(x, k + g + f.width), b = Math.max(b, f.height), k += g + f.width), P++ } else for (T = 0; T < s; T++) { var j, A = (L = o[T]).ta; e ? (0 < f && 0 < P && k + d + A.width > f && (k < r && fg(i, l, r - k, 0, N, T - 1), S++, N = T, w = b, k = P = 0, M = 135 < n ? -b - y : b + y), j = 0 === P ? g : d, pg(t, L, 0, M), L.S.h(k + j, M), x = Math.max(x, k + j + A.width), b = Math.max(b, w + (0 === S ? 0 : y) + A.height), k += j + A.width) : (0 < f && 0 < P && M + d + A.height > f && (M < r && fg(i, l, 0, r - M, N, T - 1), S++, N = T, w = x, M = P = 0, k = 135 < n ? -x - y : x + y), j = 0 === P ? g : d, pg(t, L, k, 0), L.S.h(k, M + j), b = Math.max(b, M + j + A.height), x = Math.max(x, w + (0 === S ? 0 : y) + A.width), M += j + A.height), P++ } switch (0 < S && (e ? (b += Math.max(0, h), k < x && fg(i, l, x - k, 0, N, s - 1), 0 < m && (c || dg(i, m, 0, 0, s - 1), x += m)) : (x += Math.max(0, h), M < b && fg(i, l, 0, b - M, N, s - 1), 0 < m && (c || dg(i, 0, m, 0, s - 1), b += m))), m = c = 0, l) { case jg: e ? c += x / 2 - i.focus.x - p / 2 : m += b / 2 - i.focus.y - p / 2; break; case Dg: 0 < S ? e ? c += x / 2 - i.focus.x - p / 2 : m += b / 2 - i.focus.y - p / 2 : e ? c += (l = o[0].S.x + o[0].da.x) + (o[s - 1].S.x + o[s - 1].da.x + 2 * o[s - 1].focus.x - l) / 2 - i.focus.x - p / 2 : m += (l = o[0].S.y + o[0].da.y) + (o[s - 1].S.y + o[s - 1].da.y + 2 * o[s - 1].focus.y - l) / 2 - i.focus.y - p / 2; break; case Fg: e ? (c -= p, x += p) : (m -= p, b += p); break; case Og: e ? (c += x - i.width + p, x += p) : (m += b - i.height + p, b += p); break; case Bg: case Ig: e ? c += 1 < s ? C + d / 2 - i.focus.x : o[0].focus.x - i.focus.x + o[0].da.x : m += 1 < s ? C + d / 2 - i.focus.y : o[0].focus.y - i.focus.y + o[0].da.y; break; case Rg: e ? c += x + d / 2 - i.focus.x : m += b + d / 2 - i.focus.y; break; case Eg: break; default: B("Unhandled alignment value " + l.toString()) }for (p = 0; p < s; p++)l = o[p], e ? l.S.h(l.S.x + l.da.x - c, l.S.y + (135 < n ? (a ? -b : -l.ta.height) + l.da.y - h : v + h + l.da.y)) : l.S.h(l.S.x + (135 < n ? (a ? -x : -l.ta.width) + l.da.x - h : u + h + l.da.x), l.S.y + l.da.y - m); e ? (x = lg(i, x, c), c < 0 && (c = 0), 135 < n && (m += b + h), b = Math.max(Math.max(b, v), b + v + h)) : (135 < n && (c += x + h), x = Math.max(Math.max(x, u), x + u + h), b = ug(i, b, m), m < 0 && (m = 0)), i.da.h(c, m), i.ta.h(x, b) } } function rg(t, i, e, n, o) { var r = i.length; if (0 === r) return new yi(e, 0, n, o); if (1 === r) return new yi(e, 0, n = (t = i[0]).ta.width, o = t.ta.height); for (var s, a, h, l, u, c, f = t.nodeSpacing, d = t.rowSpacing, p = 90 === wg(t), g = 0, y = 0, m = 0, v = 0; v < r; v++) { 0 != v % 2 || 1 < r && v === r - 1 || (a = (s = i[v]).ta, h = 0 === g ? 0 : d, p ? (l = ag(s) - f, s.S.h(e - (a.width + l), m + h), n = Math.max(n, a.width + l), o = Math.max(o, m + h + a.height), m += h + a.height) : (l = ag(s) - f, s.S.h(y + h, e - (a.height + l)), o = Math.max(o, a.height + l), n = Math.max(n, y + h + a.width), y += h + a.width), g++) } for (g = 0, s = y, v = m, m = p ? (y = e + f, 0) : (y = 0, e + f), a = 0; a < r; a++) { 0 != a % 2 && (l = (h = i[a]).ta, u = 0 === g ? 0 : d, p ? (c = ag(h) - f, h.S.h(y + c, m + u), n = Math.max(n, y + l.width + c), o = Math.max(o, m + u + l.height), m += u + l.height) : (c = ag(h) - f, h.S.h(y + u, m + c), n = Math.max(n, y + u + l.width), o = Math.max(o, m + l.height + c), y += u + l.width), g++) } return 1 < r && 1 == r % 2 && (r = (i = i[r - 1]).ta, d = null === i.parent ? 0 : i.parent.rowSpacing, p ? (i.S.h(e + f / 2 - i.focus.x - i.da.x, o + d), p = e + f / 2 - i.focus.x - i.da.x, n = Math.max(n, p + r.width), p < 0 && (n -= p), o = Math.max(o, Math.max(v, m) + d + r.height), i.S.x < 0 && (e = hg(t, i.S.x, !1, e, f))) : (i.S.h(n + d, e + f / 2 - i.focus.y - i.da.y), n = Math.max(n, Math.max(s, y) + d + r.width), m = e + f / 2 - i.focus.y - i.da.y, o = Math.max(o, m + r.height), m < 0 && (o -= m), i.S.y < 0 && (e = hg(t, i.S.y, !0, e, f)))), new yi(e, 0, n, o) } function sg(t, i, e, n, o) { var r = i.length; if (0 === r) return new yi(e, 0, n, o); if (1 === r) return new yi(e, 0, n = (i = i[0]).ta.width, o = i.ta.height); for (var s, a, h, l, u, c, f = t.nodeSpacing, d = t.rowSpacing, p = 270 === wg(t), g = 0, y = 0, m = 0, v = 0; v < r; v++) { 0 != v % 2 || 1 < r && v === r - 1 || (a = (s = i[v]).ta, h = 0 === g ? 0 : d, p ? (l = ag(s) - f, m -= h + a.height, s.S.h(e - (a.width + l), m), n = Math.max(n, a.width + l), o = Math.max(o, Math.abs(m))) : (l = ag(s) - f, y -= h + a.width, s.S.h(y, e - (a.height + l)), o = Math.max(o, a.height + l), n = Math.max(n, Math.abs(y))), g++) } for (g = 0, s = y, v = m, m = p ? (y = e + f, 0) : (y = 0, e + f), a = 0; a < r; a++) { 0 != a % 2 && (l = (h = i[a]).ta, u = 0 === g ? 0 : d, p ? (c = ag(h) - f, m -= u + l.height, h.S.h(y + c, m), n = Math.max(n, y + l.width + c), o = Math.max(o, Math.abs(m))) : (c = ag(h) - f, y -= u + l.width, h.S.h(y, m + c), o = Math.max(o, m + l.height + c), n = Math.max(n, Math.abs(y))), g++) } for (1 < r && 1 == r % 2 && (g = (d = i[r - 1]).ta, a = null === d.parent ? 0 : d.parent.rowSpacing, p ? (d.S.h(e + f / 2 - d.focus.x - d.da.x, -o - g.height - a), y = e + f / 2 - d.focus.x - d.da.x, n = Math.max(n, y + g.width), y < 0 && (n -= y), o = Math.max(o, Math.abs(Math.min(v, m)) + a + g.height), d.S.x < 0 && (e = hg(t, d.S.x, !1, e, f))) : (d.S.h(-n - g.width - a, e + f / 2 - d.focus.y - d.da.y), n = Math.max(n, Math.abs(Math.min(s, y)) + a + g.width), m = e + f / 2 - d.focus.y - d.da.y, o = Math.max(o, m + g.height), m < 0 && (o -= m), d.S.y < 0 && (e = hg(t, d.S.y, !0, e, f)))), t = 0; t < r; t++)f = i[t], p ? f.S.h(f.S.x, f.S.y + o) : f.S.h(f.S.x + n, f.S.y); return new yi(e, 0, n, o) } function ag(t) { return null === t.parent ? 0 : t.parent.nodeSpacing } function hg(t, i, e, n, o) { for (var r = (t = t.children).length, s = 0; s < r; s++)e ? t[s].S.h(t[s].S.x, t[s].S.y - i) : t[s].S.h(t[s].S.x - i, t[s].S.y); return i = t[r - 1], Math.max(n, e ? i.da.y + i.focus.y - o / 2 : i.da.x + i.focus.x - o / 2) } function lg(t, i, e) { switch (t.alignment) { case Dg: case jg: return e + t.width > i && (i = e + t.width), e < 0 && (i -= e), i; case Fg: return t.width > i ? t.width : i; case Og: return 2 * t.focus.x > i ? t.width : i + t.width - 2 * t.focus.x; case Bg: case Ig: return Math.max(t.width, Math.max(i, e + t.width) - Math.min(0, e)); case Rg: return t.width - t.focus.x + t.nodeSpacing / 2 + i; case Eg: return Math.max(t.width, t.focus.x + t.nodeSpacing / 2 + i); default: return i } } function ug(t, i, e) { switch (t.alignment) { case Dg: case jg: return e + t.height > i && (i = e + t.height), e < 0 && (i -= e), i; case Fg: return t.height > i ? t.height : i; case Og: return 2 * t.focus.y > i ? t.height : i + t.height - 2 * t.focus.y; case Bg: case Ig: return Math.max(t.height, Math.max(i, e + t.height) - Math.min(0, e)); case Rg: return t.height - t.focus.y + t.nodeSpacing / 2 + i; case Eg: return Math.max(t.height, t.focus.y + t.nodeSpacing / 2 + i); default: return i } } function cg(t, i, e) { switch (t) { case jg: case Dg: i /= 2, e /= 2; break; case Fg: e = i = 0; break; case Og: break; default: B("Unhandled alignment value " + t.toString()) }return new gi(i, e) } function fg(t, i, e, n, o, r) { dg(t, (i = cg(i, e, n)).x, i.y, o, r) } function dg(t, i, e, n, o) { if (0 !== i || 0 !== e) for (t = t.children; n <= o; n++) { var r = t[n].S; r.x += i, r.y += e } } function pg(t, i, e, n) { var o = i.parent; switch (t.ad) { case Pg: for (t = i.sourceEdges; t.next();)(i = t.value).fromVertex === o && i.relativePoint.h(e, n); break; case Ng: for (t = i.destinationEdges; t.next();)(i = t.value).toVertex === o && i.relativePoint.h(e, n); break; default: B("Unhandled path value " + t.ad.toString()) } } function gg(t, i, e) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.x += i, o.y += e } } function yg(t, i, e, n, o, r, s, a) { var h = 90 === (g = wg(i)) || 270 === g, l = i.nodeSpacing; i = n; var u = o; n = r; var c = s, f = e.wq, d = e.Jq; s = e.ta; var p = h ? Math.max(c, s.height) : Math.max(n, s.width); if (null !== f && g === wg(e) || (f = mg(t, 2), d = mg(t, 2), h ? (f[0].h(0, 0), f[1].h(0, s.height), d[0].h(s.width, 0), d[1].h(d[0].x, f[1].y)) : (f[0].h(0, 0), f[1].h(s.width, 0), d[0].h(0, s.height), d[1].h(f[1].x, d[0].y))), h) { if (c = 9999999, !(null === u || u.length < 2 || null === f || f.length < 2)) for (o = e = 0; e < u.length && o < f.length;) { r = u[e]; var g = (m = f[o]).x, h = m.y; g += n; var y = r; e + 1 < u.length && (y = u[e + 1]); var m = (v = m).x, v = v.y; o + 1 < f.length && (m = (v = f[o + 1]).x, v = v.y, m += n); var x = c; r.y === h ? x = g - r.x : r.y > h && r.y < v ? x = g + (r.y - h) / (v - h) * (m - g) - r.x : h > r.y && h < y.y && (x = g - (r.x + (h - r.y) / (y.y - r.y) * (y.x - r.x))), x < c && (c = x), y.y <= r.y ? e++ : v <= h ? o++ : (y.y <= v && e++, v <= y.y && o++) } if (c = n - c, e = f, o = c += l, null === i || i.length < 2 || null === e || e.length < 2) n = null; else { for (l = mg(t, i.length + e.length), n = r = g = 0; r < e.length && e[r].y < i[0].y;)h = e[r++], l[n++].h(h.x + o, h.y); for (; g < i.length;)h = i[g++], l[n++].h(h.x, h.y); for (g = i[i.length - 1].y; r < e.length && e[r].y <= g;)r++; for (; r < e.length && e[r].y > g;)h = e[r++], l[n++].h(h.x + o, h.y); for (e = mg(t, n), g = 0; g < n; g++)e[g].assign(l[g]); vg(t, l), n = e } if (r = d, g = c, null === u || u.length < 2 || null === r || r.length < 2) o = null; else { for (l = mg(t, u.length + r.length), o = h = e = 0; e < u.length && u[e].y < r[0].y;)y = u[e++], l[o++].h(y.x, y.y); for (; h < r.length;)y = r[h++], l[o++].h(y.x + g, y.y); for (r = r[r.length - 1].y; e < u.length && u[e].y <= r;)e++; for (; e < u.length && u[e].y > r;)g = u[e++], l[o++].h(g.x, g.y); for (r = mg(t, o), e = 0; e < o; e++)r[e].assign(l[e]); vg(t, l), o = r } return r = Math.max(0, c) + s.width, s = p, vg(t, i), vg(t, f), vg(t, u), vg(t, d), a[0] = n, a[1] = o, new yi(c, 0, r, s) } if (n = 9999999, !(null === u || u.length < 2 || null === f || f.length < 2)) for (o = e = 0; e < u.length && o < f.length;)r = u[e], g = (m = f[o]).x, h = m.y, h += c, y = r, e + 1 < u.length && (y = u[e + 1]), m = (v = m).x, v = v.y, o + 1 < f.length && (m = (v = f[o + 1]).x, v = v.y, v += c), x = n, r.x === g ? x = h - r.y : r.x > g && r.x < m ? x = h + (r.x - g) / (m - g) * (v - h) - r.y : g > r.x && g < y.x && (x = h - (r.y + (g - r.x) / (y.x - r.x) * (y.y - r.y))), x < n && (n = x), y.x <= r.x ? e++ : m <= g ? o++ : (y.x <= m && e++, m <= y.x && o++); if (c -= n, e = f, o = c += l, null === i || i.length < 2 || null === e || e.length < 2) n = null; else { for (l = mg(t, i.length + e.length), n = r = g = 0; r < e.length && e[r].x < i[0].x;)h = e[r++], l[n++].h(h.x, h.y + o); for (; g < i.length;)h = i[g++], l[n++].h(h.x, h.y); for (g = i[i.length - 1].x; r < e.length && e[r].x <= g;)r++; for (; r < e.length && e[r].x > g;)h = e[r++], l[n++].h(h.x, h.y + o); for (e = mg(t, n), g = 0; g < n; g++)e[g].assign(l[g]); vg(t, l), n = e } if (r = d, g = c, null === u || u.length < 2 || null === r || r.length < 2) o = null; else { for (l = mg(t, u.length + r.length), o = h = e = 0; e < u.length && u[e].x < r[0].x;)y = u[e++], l[o++].h(y.x, y.y); for (; h < r.length;)y = r[h++], l[o++].h(y.x, y.y + g); for (r = r[r.length - 1].x; e < u.length && u[e].x <= r;)e++; for (; e < u.length && u[e].x > r;)g = u[e++], l[o++].h(g.x, g.y); for (r = mg(t, o), e = 0; e < o; e++)r[e].assign(l[e]); vg(t, l), o = r } return r = p, s = Math.max(0, c) + s.height, vg(t, i), vg(t, f), vg(t, u), vg(t, d), a[0] = n, a[1] = o, new yi(c, 0, r, s) } function mg(t, i) { if (void 0 !== (t = t.Yu[i]) && void 0 !== (t = t.pop())) return t; t = []; for (var e = 0; e < i; e++)t[e] = new gi; return t } function vg(t, i) { var e = i.length, n = t.Yu[e]; void 0 === n && (n = [], t.Yu[e] = n), n.push(i) } function xg(t, i, e, n) { if (null !== i) { i.x = e, i.y = n; for (var o = (i = i.children).length, r = 0; r < o; r++) { var s = i[r]; xg(t, s, e + s.S.x, n + s.S.y) } } } function bg(t, i) { if (null !== i) { t.setPortSpots(i); for (var e = (i = i.children).length, n = 0; n < e; n++)bg(t, i[n]) } } function wg(t) { return (t = t.angle) <= 45 ? 0 : t <= 135 ? 90 : t <= 225 ? 180 : t <= 315 ? 270 : 0 } function kg(t) { var i, e = 90 === (e = wg(t)) || 270 === e, n = t.layerSpacing; return 0 < t.layerSpacingParentOverlap && (i = Math.min(1, t.layerSpacingParentOverlap), n -= e ? t.height * i : t.width * i), n < (e ? -t.height : -t.width) && (n = e ? -t.height : -t.width), n } function Mg(t) { var i, e = wg(t), n = t.nodeIndent; return 0 < t.nodeIndentPastParent && (i = Math.min(1, t.nodeIndentPastParent), n += 90 === e || 270 === e ? t.width * i : t.height * i), Math.max(0, n) } Qd.className = "LayeredDigraphLayout", Qd.CycleDepthFirst = jp, Qd.CycleGreedy = Dp, Qd.CycleFromLayers = Fp, Qd.LayerOptimalLinkLength = Op, Qd.LayerLongestPathSink = Bp, Qd.LayerLongestPathSource = Ip, Qd.InitDepthFirstOut = Rp, Qd.InitDepthFirstIn = Ep, Qd.InitNaive = zp, Qd.AggressiveNone = Vp, Qd.AggressiveLess = Yp, Qd.AggressiveMore = Gp, Qd.PackNone = 0, Qd.PackExpand = 1, Qd.PackStraighten = 2, Qd.PackMedian = 4, Qd.PackAll = 7, Xp.className = "SegInfo", h(qp, zc), qp.prototype.createVertex = function () { return new Up(this) }, qp.prototype.createEdge = function () { return new Kp(this) }, qp.className = "LayeredDigraphNetwork", h(Up, qc), l.Object.defineProperties(Up.prototype, { layer: { get: function () { return this.ui }, set: function (t) { this.ui !== t && (this.ui = t) } }, column: { get: function () { return this.Lg }, set: function (t) { this.Lg !== t && (this.Lg = t) } }, index: { get: function () { return this.Oa }, set: function (t) { this.Oa !== t && (this.Oa = t) } }, component: { get: function () { return this.I }, set: function (t) { this.I !== t && (this.I = t) } }, near: { get: function () { return this.W }, set: function (t) { this.W !== t && (this.W = t) } } }), Up.className = "LayeredDigraphVertex", h(Kp, Kc), l.Object.defineProperties(Kp.prototype, { valid: { get: function () { return this.ab }, set: function (t) { this.ab !== t && (this.ab = t) } }, rev: { get: function () { return this.Ia }, set: function (t) { this.Ia !== t && (this.Ia = t) } }, forest: { get: function () { return this.l }, set: function (t) { this.l !== t && (this.l = t) } }, portFromPos: { get: function () { return this.I }, set: function (t) { this.I !== t && (this.I = t) } }, portToPos: { get: function () { return this.Ha }, set: function (t) { this.Ha !== t && (this.Ha = t) } }, portFromColOffset: { get: function () { return this.u }, set: function (t) { this.u !== t && (this.u = t) } }, portToColOffset: { get: function () { return this.W }, set: function (t) { this.W !== t && (this.W = t) } } }), Kp.className = "LayeredDigraphEdge", h(Hp, Ic), Hp.prototype.cloneProtected = function (t) { Ic.prototype.cloneProtected.call(this, t), t.bp = this.bp, t.Yp = this.Yp, t.Zr = this.Zr, t.$c = this.$c, t.Bb = this.Bb, t.Bd.assign(this.Bd), t.T.copyInheritedPropertiesFrom(this.T), t.U.copyInheritedPropertiesFrom(this.U) }, Hp.prototype.fb = function (t) { t.classType === Hp ? 0 === t.name.indexOf("Alignment") ? this.alignment = t : 0 === t.name.indexOf("Arrangement") ? this.arrangement = t : 0 === t.name.indexOf("Compaction") ? this.compaction = t : 0 === t.name.indexOf("Path") ? this.path = t : 0 === t.name.indexOf("Sorting") ? this.sorting = t : 0 === t.name.indexOf("Style") ? this.treeStyle = t : B("Unknown enum value: " + t) : Ic.prototype.fb.call(this, t) }, Hp.prototype.createNetwork = function () { return new $g(this) }, Hp.prototype.makeNetwork = function (t) { function i(t) { if (t instanceof pu) return !t.isLinkLabel && "Comment" !== t.category; if (t instanceof Fu) { var i = t.fromNode; return null === i || i.isLinkLabel || "Comment" === i.category ? !1 : null !== (t = t.toNode) && !t.isLinkLabel && "Comment" !== t.category } return !1 } var e = this.createNetwork(); return t instanceof Lo ? (e.ug(t.nodes, !0, i), e.ug(t.links, !0, i)) : t instanceof Lu ? e.ug(t.memberParts, !1, i) : e.ug(t.iterator, !1, i), e }, Hp.prototype.doLayout = function (t) { null === this.network && (this.network = this.makeNetwork(t)), this.arrangement !== Hg && (this.arrangementOrigin = this.initialOrigin(this.arrangementOrigin)); var i = this.diagram; if (null === i && t instanceof Lo && (i = t), this.path === Sg && null !== i ? this.ad = i.isTreePathToChildren ? Pg : Ng : this.ad = this.path === Sg ? Pg : this.path, 0 < this.network.vertexes.count) { for (this.network.jq(), t = this.network.vertexes.iterator; t.next();)(i = t.value).initialized = !1, i.level = 0, i.parent = null, i.children = []; if (0 < this.Ib.count) { for (t = new $, i = this.Ib.iterator; i.next();) { var e = i.value; e instanceof pu ? null !== (e = this.network.Wi(e)) && t.add(e) : e instanceof Qg && t.add(e) } this.Ib = t } for (0 === this.Ib.count && this.findRoots(), t = this.Ib.copy().iterator; t.next();)(i = t.value).initialized || (i.initialized = !0, Zp(this, i)); for (i = this.network.vertexes, t = null; 0 < (t = Wp(i)).count;)null !== (i = Jp(this, t)) && this.Ib.add(i), i.initialized = !0, Zp(this, i), i = t; for (t = this.Ib.iterator; t.next();)(i = t.value) instanceof Qg && Qp(this, i); for (t = this.Ib.iterator; t.next();)(i = t.value) instanceof Qg && _p(this, i); for (t = this.Ib.iterator; t.next();)(i = t.value) instanceof Qg && tg(this, i); if (this.jv(), this.layerStyle === Zg) { for (t = [], i = this.network.vertexes.iterator; i.next();) { var n = (e = i.value).parent; null === n && (n = e), n = 0 === n.angle || 180 === n.angle; var o = t[e.level]; void 0 === o && (o = 0), t[e.level] = Math.max(o, n ? e.width : e.height) } for (i = 0; i < t.length; i++)void 0 === t[i] && (t[i] = 0); for (this.Nw = t, i = this.network.vertexes.iterator; i.next();)null === (n = (e = i.value).parent) && (n = e), 0 === n.angle || 180 === n.angle ? (180 === n.angle && (e.focusX += t[e.level] - e.width), e.width = t[e.level]) : (270 === n.angle && (e.focusY += t[e.level] - e.height), e.height = t[e.level]) } else if (this.layerStyle === Jg) for (t = this.network.vertexes.iterator; t.next();) { for (e = 0 === (i = t.value).angle || 180 === i.angle, n = -1, o = 0; o < i.children.length; o++)var r = i.children[o], n = Math.max(n, e ? r.width : r.height); if (0 <= n) for (o = 0; o < i.children.length; o++)r = i.children[o], e ? (180 === i.angle && (r.focusX += n - r.width), r.width = n) : (270 === i.angle && (r.focusY += n - r.height), r.height = n) } for (t = this.Ib.iterator; t.next();)(i = t.value) instanceof Qg && this.layoutTree(i); this.arrangeTrees(), this.updateParts() } this.network = null, this.Ib = new $, this.isValidLayout = !0 }, Hp.prototype.findRoots = function () { for (var t = this.network.vertexes, i = t.iterator; i.next();) { var e = i.value; switch (this.ad) { case Pg: 0 === e.sourceEdges.count && this.Ib.add(e); break; case Ng: 0 === e.destinationEdges.count && this.Ib.add(e); break; default: B("Unhandled path value " + this.ad.toString()) } } 0 !== this.Ib.count || null !== (t = Jp(this, t)) && this.Ib.add(t) }, Hp.prototype.removeChild = function (t, i) { if (null !== t && null !== i) { for (var e = t.children, n = 0, o = 0; o < e.length; o++)e[o] === i && n++; if (0 < n) { n = Array(e.length - n); for (var r = o = 0; r < e.length; r++)e[r] !== i && (n[o++] = e[r]); t.children = n } } }, Hp.prototype.initializeTreeVertexValues = function (t) { if (t.copyInheritedPropertiesFrom(function (t, i) { switch (t.Yp) { default: case Yg: return null !== i.parent ? i.parent : t.T; case qg: return null === i.parent ? t.T : null === i.parent.parent ? t.U : i.parent; case Xg: return null !== i.parent ? null !== i.parent.parent ? i.parent.parent : t.U : t.T; case Gg: var e = !0; if (0 === i.childrenCount) e = !1; else for (var n = i.children, o = n.length, r = 0; r < o; r++)if (0 < n[r].childrenCount) { e = !1; break } return e && null !== i.parent ? t.U : null !== i.parent ? i.parent : t.T } }(this, t)), null !== t.parent && t.parent.alignment === Ig) { for (var i = t.angle, e = t.parent.children, n = 0; n < e.length && t !== e[n];)n++; 0 == n % 2 ? n !== e.length - 1 && (i = 90 === i || 180 !== i && 270 === i ? 180 : 270) : i = 90 === i || 180 !== i && 270 === i ? 0 : 90, t.angle = i } t.initialized = !0 }, Hp.prototype.assignTreeVertexValues = function () { }, Hp.prototype.sortTreeVertexChildren = function (t) { switch (t.sorting) { case Cg: break; case Tg: t.children.reverse(); break; case Lg: t.children.sort(t.comparer); break; case Ag: t.children.sort(t.comparer), t.children.reverse(); break; default: B("Unhandled sorting value " + t.sorting.toString()) } }, Hp.prototype.jv = function () { if (this.comments) for (var t = this.network.vertexes.iterator; t.next();)this.addComments(t.value) }, Hp.prototype.addComments = function (t) { var i = t.angle, e = t.parent, n = 0, o = !1; null !== e && (n = e.angle, o = ig(o = e.alignment)), i = 90 === i || 270 === i, n = 90 === n || 270 === n, e = 0 === t.childrenCount; var r = 0, s = 0, a = 0, h = t.commentSpacing; if (null !== t.node) for (var l = t.node.vv(); l.next();) { var u = l.value; "Comment" === u.category && u.canLayout() && (null === t.comments && (t.comments = []), t.comments.push(u), u.zb(), u = u.measuredBounds, i && !e || !o && !n && e || o && n && e ? (r = Math.max(r, u.width), s += u.height + Math.abs(a)) : (r += u.width + Math.abs(a), s = Math.max(s, u.height)), a = h) } null !== t.comments && (i && !e || !o && !n && e || o && n && e ? (r += Math.abs(t.commentMargin), s = Math.max(0, s - t.height)) : (s += Math.abs(t.commentMargin), r = Math.max(0, r - t.width)), o = yi.allocAt(0, 0, t.bounds.width + r, t.bounds.height + s), t.bounds = o, yi.free(o)) }, Hp.prototype.layoutComments = function (t) { if (null !== t.comments) { var i = t.node.measuredBounds, e = t.parent, n = t.angle, o = 0, r = !1; null !== e && (o = e.angle, r = ig(r = e.alignment)), n = 90 === n || 270 === n, e = 90 === o || 270 === o; for (var s = 0 === t.childrenCount, a = ng(t), h = 0, l = t.comments, u = l.length, c = gi.alloc(), f = 0; f < u; f++) { var d = l[f], p = d.measuredBounds; if (n && !s || !r && !e && s || r && e && s) { if (135 < o && !r || e && a) if (0 <= t.commentMargin) for (c.h(t.bounds.x - t.commentMargin - p.width, t.bounds.y + h), d.move(c), d = d.xd(); d.next();) { var g = d.value; g.fromSpot = Ni, g.toSpot = Ci } else for (c.h(t.bounds.x + 2 * t.focus.x - t.commentMargin, t.bounds.y + h), d.move(c), d = d.xd(); d.next();)(g = d.value).fromSpot = Ci, g.toSpot = Ni; else if (0 <= t.commentMargin) for (c.h(t.bounds.x + 2 * t.focus.x + t.commentMargin, t.bounds.y + h), d.move(c), d = d.xd(); d.next();)(g = d.value).fromSpot = Ci, g.toSpot = Ni; else for (c.h(t.bounds.x + t.commentMargin - p.width, t.bounds.y + h), d.move(c), d = d.xd(); d.next();)(g = d.value).fromSpot = Ni, g.toSpot = Ci; h = 0 <= t.commentSpacing ? h + (p.height + t.commentSpacing) : h + (t.commentSpacing - p.height) } else { if (135 < o && !r || !e && a) if (0 <= t.commentMargin) for (c.h(t.bounds.x + h, t.bounds.y - t.commentMargin - p.height), d.move(c), d = d.xd(); d.next();)(g = d.value).fromSpot = Pi, g.toSpot = Ti; else for (c.h(t.bounds.x + h, t.bounds.y + 2 * t.focus.y - t.commentMargin), d.move(c), d = d.xd(); d.next();)(g = d.value).fromSpot = Ti, g.toSpot = Pi; else if (0 <= t.commentMargin) for (c.h(t.bounds.x + h, t.bounds.y + 2 * t.focus.y + t.commentMargin), d.move(c), d = d.xd(); d.next();)(g = d.value).fromSpot = Ti, g.toSpot = Pi; else for (c.h(t.bounds.x + h, t.bounds.y + t.commentMargin - p.height), d.move(c), d = d.xd(); d.next();)(g = d.value).fromSpot = Pi, g.toSpot = Ti; h = 0 <= t.commentSpacing ? h + (p.width + t.commentSpacing) : h + (t.commentSpacing - p.width) } } if (gi.free(c), i = h - t.commentSpacing - (n ? i.height : i.width), this.ad === Pg) for (t = t.destinationEdges; t.next();)null === (o = t.value.link) || o.isAvoiding || (o.fromEndSegmentLength = 0 < i ? i : NaN); else for (t = t.sourceEdges; t.next();)null === (o = t.value.link) || o.isAvoiding || (o.toEndSegmentLength = 0 < i ? i : NaN) } }, Hp.prototype.layoutTree = function (t) { if (null !== t) { for (var i = (o = t.children).length, e = 0; e < i; e++)this.layoutTree(o[e]); switch (t.compaction) { case zg: og(this, t); break; case Vg: if (t.alignment === Ig) og(this, t); else if (0 === t.childrenCount) i = !1, o = 0, null !== (e = t.parent) && (o = e.angle, i = ig(i = e.alignment)), e = ng(t), t.S.h(0, 0), t.ta.h(t.width, t.height), null === t.parent || null === t.comments || (180 !== o && 270 !== o || i) && !e ? t.da.h(0, 0) : 180 === o && !i || (90 === o || 270 === o) && e ? t.da.h(t.width - 2 * t.focus.x, 0) : t.da.h(0, t.height - 2 * t.focus.y), t.wq = null, t.Jq = null; else { for (var n = wg(t), o = 90 === n || 270 === n, r = 0, s = t.children, a = s.length, i = 0; i < a; i++)e = s[i], r = Math.max(r, o ? e.ta.width : e.ta.height); var h = t.alignment, l = h === Og, u = ig(h), c = Math.max(0, t.breadthLimit); i = kg(t); var f = t.nodeSpacing, d = Mg(t), p = t.rowSpacing, g = 0; (h === Fg || l || t.Em || t.Fm && 1 === t.maxGenerationCount) && (g = Math.max(0, t.rowIndent)), e = t.width; var y = t.height, m = 0, v = 0, x = 0, b = null, w = null, k = 0, M = 0, S = 0, P = 0, N = 0, C = 0, T = 0, L = 0; if (u && !eg(h) && 135 < n && s.reverse(), eg(h)) if (1 < a) for (var A = 0; A < a; A++)0 == A % 2 && A !== a - 1 && (L = Math.max(L, o ? s[A].ta.width : s[A].ta.height)); else 1 === a && (L = o ? s[0].ta.width : s[0].ta.height); if (u) { switch (h) { case Bg: L = (v = (n < 135 ? rg : sg)(t, s, L, m, v)).x, m = v.width, v = v.height; break; case Rg: for (b = 0; b < a; b++)c = (w = s[b]).ta, x = 0 === C ? 0 : p, o ? (w.S.h(r - c.width, P + x), m = Math.max(m, c.width), v = Math.max(v, P + x + c.height), P += x + c.height) : (w.S.h(S + x, r - c.height), m = Math.max(m, S + x + c.width), v = Math.max(v, c.height), S += x + c.width), C++; break; case Eg: for (b = 0; b < a; b++)r = (w = s[b]).ta, c = 0 === C ? 0 : p, o ? (w.S.h(f / 2 + t.focus.x, P + c), m = Math.max(m, r.width), v = Math.max(v, P + c + r.height), P += c + r.height) : (w.S.h(S + c, f / 2 + t.focus.y), m = Math.max(m, S + c + r.width), v = Math.max(v, r.height), S += c + r.width), C++ }b = mg(this, 2), w = mg(this, 2), o ? (b[0].h(0, 0), b[1].h(0, v), w[0].h(m, 0)) : (b[0].h(0, 0), b[1].h(m, 0), w[0].h(0, v)), w[1].h(m, v) } else for (A = 0; A < a; A++) { var j, D, F = s[A], O = F.ta; o ? (0 < c && 0 < C && S + f + O.width > c && (S < r && fg(t, h, r - S, 0, T, A - 1), N++, T = A, x = v, S = C = 0, P = 135 < n ? -v - p : v + p), pg(this, F, 0, P), (D = 0) === C ? (b = F.wq, w = F.Jq, k = O.width, M = O.height, null !== b && null !== w && n === wg(F) || (b = mg(this, 2), w = mg(this, 2), b[0].h(0, 0), b[1].h(0, M), w[0].h(k, 0), w[1].h(k, M))) : (D = (M = yg(this, t, F, b, w, k, M, j = zi())).x, b = j[0], w = j[1], k = M.width, M = M.height, Vi(j), S < O.width && D < 0 && (dg(t, -D, 0, T, A - 1), gg(b, -D, 0), gg(w, -D, 0), D = 0)), F.S.h(D, P), m = Math.max(m, k), v = Math.max(v, x + (0 === N ? 0 : p) + O.height), S = k) : (0 < c && 0 < C && P + f + O.height > c && (P < r && fg(t, h, 0, r - P, T, A - 1), N++, T = A, x = m, P = C = 0, S = 135 < n ? -m - p : m + p), pg(this, F, S, 0), (D = 0) === C ? (b = F.wq, w = F.Jq, k = O.width, M = O.height, null !== b && null !== w && n === wg(F) || (b = mg(this, 2), w = mg(this, 2), b[0].h(0, 0), b[1].h(k, 0), w[0].h(0, M), w[1].h(k, M))) : (D = (M = yg(this, t, F, b, w, k, M, j = zi())).x, b = j[0], w = j[1], k = M.width, M = M.height, Vi(j), P < O.height && D < 0 && (dg(t, 0, -D, T, A - 1), gg(b, 0, -D), gg(w, 0, -D), D = 0)), F.S.h(S, D), v = Math.max(v, M), m = Math.max(m, x + (0 === N ? 0 : p) + O.width), P = M), C++ } switch (0 < N && (o ? (v += Math.max(0, i), S < m && fg(t, h, m - S, 0, T, a - 1), 0 < g && (l || dg(t, g, 0, 0, a - 1), m += g)) : (m += Math.max(0, i), P < v && fg(t, h, 0, v - P, T, a - 1), 0 < g && (l || dg(t, 0, g, 0, a - 1), v += g))), g = l = 0, h) { case jg: o ? l += m / 2 - t.focus.x - d / 2 : g += v / 2 - t.focus.y - d / 2; break; case Dg: 0 < N ? o ? l += m / 2 - t.focus.x - d / 2 : g += v / 2 - t.focus.y - d / 2 : o ? l += (L = s[0].S.x + s[0].da.x) + (s[a - 1].S.x + s[a - 1].da.x + 2 * s[a - 1].focus.x - L) / 2 - t.focus.x - d / 2 : g += (L = s[0].S.y + s[0].da.y) + (s[a - 1].S.y + s[a - 1].da.y + 2 * s[a - 1].focus.y - L) / 2 - t.focus.y - d / 2; break; case Fg: o ? (l -= d, m += d) : (g -= d, v += d); break; case Og: o ? (l += m - t.width + d, m += d) : (g += v - t.height + d, v += d); break; case Bg: o ? l += 1 < a ? L + f / 2 - t.focus.x : s[0].focus.x - t.focus.x + s[0].da.x : g += 1 < a ? L + f / 2 - t.focus.y : s[0].focus.y - t.focus.y + s[0].da.y; break; case Rg: o ? l += m + f / 2 - t.focus.x : g += v + f / 2 - t.focus.y; break; case Eg: break; default: B("Unhandled alignment value " + h.toString()) }for (d = 0; d < a; d++)L = s[d], o ? L.S.h(L.S.x + L.da.x - l, L.S.y + (135 < n ? (u ? -v : -L.ta.height) + L.da.y - i : y + i + L.da.y)) : L.S.h(L.S.x + (135 < n ? (u ? -m : -L.ta.width) + L.da.x - i : e + i + L.da.x), L.S.y + L.da.y - g); if (a = s = 0, u ? o ? (m = lg(t, m, l), l < 0 && (l = 0), 135 < n && (g += v + i), v += y + i, h === Eg && (s += f / 2 + t.focus.x), a += y + i) : (135 < n && (l += m + i), m += e + i, v = ug(t, v, g), g < 0 && (g = 0), h === Eg && (a += f / 2 + t.focus.y), s += e + i) : o ? (null === t.comments ? m < e && (s = (m = cg(h, e - m, 0)).x, a = m.y, m = e, l = 0) : m = lg(t, m, l), l < 0 && (s -= l, l = 0), 135 < n && (g += v + i), v = Math.max(Math.max(v, y), v + y + i), a += y + i) : (135 < n && (l += m + i), m = Math.max(Math.max(m, e), m + e + i), null === t.comments ? v < y && (s = (v = cg(h, 0, y - v)).x, a = v.y, v = y, g = 0) : v = ug(t, v, g), g < 0 && (a -= g, g = 0), s += e + i), 0 < N) n = mg(this, 4), N = mg(this, 4), o ? (n[2].h(0, y + i), n[3].h(n[2].x, v), N[2].h(m, n[2].y), N[3].h(N[2].x, n[3].y)) : (n[2].h(e + i, 0), n[3].h(m, n[2].y), N[2].h(n[2].x, v), N[3].h(n[3].x, N[2].y)); else { for (n = mg(this, b.length + 2), N = mg(this, w.length + 2), h = 0; h < b.length; h++)u = b[h], n[h + 2].h(u.x + s, u.y + a); for (h = 0; h < w.length; h++)u = w[h], N[h + 2].h(u.x + s, u.y + a) } o ? (n[0].h(l, 0), n[1].h(n[0].x, y), n[2].y < n[1].y && (n[2].x > n[0].x ? n[2].assign(n[1]) : n[1].assign(n[2])), n[3].y < n[2].y && (n[3].x > n[0].x ? n[3].assign(n[2]) : n[2].assign(n[3])), N[0].h(l + e, 0), N[1].h(N[0].x, y), N[2].y < N[1].y && (N[2].x < N[0].x ? N[2].assign(N[1]) : N[1].assign(N[2])), N[3].y < N[2].y && (N[3].x < N[0].x ? N[3].assign(N[2]) : N[2].assign(N[3])), n[2].y -= i / 2, N[2].y -= i / 2) : (n[0].h(0, g), n[1].h(e, n[0].y), n[2].x < n[1].x && (n[2].y > n[0].y ? n[2].assign(n[1]) : n[1].assign(n[2])), n[3].x < n[2].x && (n[3].y > n[0].y ? n[3].assign(n[2]) : n[2].assign(n[3])), N[0].h(0, g + y), N[1].h(e, N[0].y), N[2].x < N[1].x && (N[2].y < N[0].y ? N[2].assign(N[1]) : N[1].assign(N[2])), N[3].x < N[2].x && (N[3].y < N[0].y ? N[3].assign(N[2]) : N[2].assign(N[3])), n[2].x -= i / 2, N[2].x -= i / 2), vg(this, b), vg(this, w), t.wq = n, t.Jq = N, t.da.h(l, g), t.ta.h(m, v) } break; default: B("Unhandled compaction value " + t.compaction.toString()) } } }, Hp.prototype.arrangeTrees = function () { if (this.Bb === Hg) for (var t = this.Ib.iterator; t.next();) { var i, e, n = t.value; n instanceof Qg && (null !== (i = n.node) && (i = (e = i.position).x, e = e.y, isFinite(i) || (i = 0), isFinite(e) || (e = 0), xg(this, n, i, e))) } else { for (t = [], n = this.Ib.iterator; n.next();)(i = n.value) instanceof Qg && t.push(i); switch (this.sorting) { case Cg: break; case Tg: t.reverse(); break; case Lg: t.sort(this.comparer); break; case Ag: t.sort(this.comparer), t.reverse(); break; default: B("Unhandled sorting value " + this.sorting.toString()) }for (n = (i = this.arrangementOrigin).x, i = i.y, e = 0; e < t.length; e++) { var o = t[e]; switch (xg(this, o, n + o.da.x, i + o.da.y), this.Bb) { case Ug: i += o.ta.height + this.Bd.height; break; case Kg: n += o.ta.width + this.Bd.width; break; default: B("Unhandled arrangement value " + this.Bb.toString()) } } } }, Hp.prototype.commitLayout = function () { this.jw(), this.commitNodes(), this.lv(), this.isRouting && this.commitLinks() }, Hp.prototype.commitNodes = function () { for (var t = this.network.vertexes.iterator; t.next();)t.value.commit(); for (t.reset(); t.next();)this.layoutComments(t.value) }, Hp.prototype.lv = function () { if (this.layerStyle === Zg) { for (var t = this.Nw, i = [], e = null, n = this.network.vertexes.iterator; n.next();) { var o = n.value; null === e ? e = o.bounds.copy() : e.Hc(o.bounds); var r = void 0 === (r = i[o.level]) ? kg(o) : Math.max(r, kg(o)); i[o.level] = r } for (n = 0; n < i.length; n++)void 0 === i[n] && (i[n] = 0); if (n = 90 === this.angle || 270 === this.angle ? (e.Wc(this.nodeSpacing / 2, this.layerSpacing), new gi(-this.nodeSpacing / 2, -this.layerSpacing / 2)) : (e.Wc(this.layerSpacing, this.nodeSpacing / 2), new gi(-this.layerSpacing / 2, -this.nodeSpacing / 2)), o = [], e = 90 === this.angle || 270 === this.angle ? e.width : e.height, r = 0, 180 === this.angle || 270 === this.angle) for (var s = 0; s < t.length; s++)r += t[s] + i[s]; for (s = 0; s < t.length; s++) { var a = t[s] + i[s]; 270 === this.angle ? (r -= a, o.push(new yi(0, r, e, a))) : 90 === this.angle ? (o.push(new yi(0, r, e, a)), r += a) : 180 === this.angle ? (r -= a, o.push(new yi(r, 0, a, e))) : (o.push(new yi(r, 0, a, e)), r += a) } this.commitLayers(o, n) } }, Hp.prototype.commitLayers = function () { }, Hp.prototype.commitLinks = function () { for (var t = this.network.edges.iterator; t.next();)t.value.commit() }, Hp.prototype.jw = function () { for (var t = this.Ib.iterator; t.next();) { var i = t.value; i instanceof Qg && bg(this, i) } }, Hp.prototype.setPortSpots = function (t) { var i = t.alignment; if (ig(i)) { var e = this.ad === Pg, n = wg(t); switch (n) { case 0: var o = Ci; break; case 90: o = Ti; break; case 180: o = Ni; break; default: o = Pi }var r = t.children, s = r.length; switch (i) { case Bg: case Ig: for (i = 0; i < s; i++) { var a = r[i]; if (null !== (a = (e ? a.sourceEdges : a.destinationEdges).first()) && null !== (a = a.link)) { var h = 90 === n || 270 === n ? Ni : Pi; if (1 === s || i === s - 1 && 1 == s % 2) switch (n) { case 0: h = Ni; break; case 90: h = Pi; break; case 180: h = Ci; break; default: h = Ti } else 0 == i % 2 && (h = 90 === n || 270 === n ? Ci : Ti); e ? (t.setsPortSpot && (a.fromSpot = o), t.setsChildPortSpot && (a.toSpot = h)) : (t.setsPortSpot && (a.fromSpot = h), t.setsChildPortSpot && (a.toSpot = o)) } } break; case Rg: for (n = 90 === n || 270 === n ? Ci : Ti, r = e ? t.destinationEdges : t.sourceEdges; r.next();)null !== (s = r.value.link) && (e ? (t.setsPortSpot && (s.fromSpot = o), t.setsChildPortSpot && (s.toSpot = n)) : (t.setsPortSpot && (s.fromSpot = n), t.setsChildPortSpot && (s.toSpot = o))); break; case Eg: for (n = 90 === n || 270 === n ? Ni : Pi, r = e ? t.destinationEdges : t.sourceEdges; r.next();)null !== (s = r.value.link) && (e ? (t.setsPortSpot && (s.fromSpot = o), t.setsChildPortSpot && (s.toSpot = n)) : (t.setsPortSpot && (s.fromSpot = n), t.setsChildPortSpot && (s.toSpot = o))) } } else if (e = wg(t), this.ad === Pg) { for (o = t.destinationEdges; o.next();)if (null !== (n = o.value.link)) { if (t.setsPortSpot) if (t.portSpot.Mb()) switch (e) { case 0: n.fromSpot = Ci; break; case 90: n.fromSpot = Ti; break; case 180: n.fromSpot = Ni; break; default: n.fromSpot = Pi } else n.fromSpot = t.portSpot; if (t.setsChildPortSpot) if (t.childPortSpot.Mb()) switch (e) { case 0: n.toSpot = Ni; break; case 90: n.toSpot = Pi; break; case 180: n.toSpot = Ci; break; default: n.toSpot = Ti } else n.toSpot = t.childPortSpot } } else for (o = t.sourceEdges; o.next();)if (null !== (n = o.value.link)) { if (t.setsPortSpot) if (t.portSpot.Mb()) switch (e) { case 0: n.toSpot = Ci; break; case 90: n.toSpot = Ti; break; case 180: n.toSpot = Ni; break; default: n.toSpot = Pi } else n.toSpot = t.portSpot; if (t.setsChildPortSpot) if (t.childPortSpot.Mb()) switch (e) { case 0: n.fromSpot = Ni; break; case 90: n.fromSpot = Pi; break; case 180: n.fromSpot = Ci; break; default: n.fromSpot = Ti } else n.fromSpot = t.childPortSpot } }, l.Object.defineProperties(Hp.prototype, { roots: { get: function () { return this.Ib }, set: function (t) { this.Ib !== t && (this.Ib = t, this.C()) } }, path: { get: function () { return this.bp }, set: function (t) { this.bp !== t && (this.bp = t, this.C()) } }, treeStyle: { get: function () { return this.Yp }, set: function (t) { this.Bb === t || t !== Yg && t !== Xg && t !== Gg && t !== qg || (this.Yp = t, this.C()) } }, layerStyle: { get: function () { return this.Zr }, set: function (t) { this.Bb === t || t !== Wg && t !== Jg && t !== Zg || (this.Zr = t, this.C()) } }, comments: { get: function () { return this.$c }, set: function (t) { this.$c !== t && (this.$c = t, this.C()) } }, arrangement: { get: function () { return this.Bb }, set: function (t) { this.Bb === t || t !== Ug && t !== Kg && t !== Hg || (this.Bb = t, this.C()) } }, arrangementSpacing: { get: function () { return this.Bd }, set: function (t) { this.Bd.w(t) || (this.Bd.assign(t), this.C()) } }, rootDefaults: { get: function () { return this.T }, set: function (t) { this.T !== t && (this.T = t, this.C()) } }, alternateDefaults: { get: function () { return this.U }, set: function (t) { this.U !== t && (this.U = t, this.C()) } }, sorting: { get: function () { return this.T.sorting }, set: function (t) { this.T.sorting === t || t !== Cg && t !== Tg && t !== Lg && !Ag || (this.T.sorting = t, this.C()) } }, comparer: { get: function () { return this.T.comparer }, set: function (t) { this.T.comparer !== t && (this.T.comparer = t, this.C()) } }, angle: { get: function () { return this.T.angle }, set: function (t) { this.T.angle !== t && (0 === t || 90 === t || 180 === t || 270 === t ? (this.T.angle = t, this.C()) : B("TreeLayout.angle must be 0, 90, 180, or 270")) } }, alignment: { get: function () { return this.T.alignment }, set: function (t) { this.T.alignment !== t && (this.T.alignment = t, this.C()) } }, nodeIndent: { get: function () { return this.T.nodeIndent }, set: function (t) { this.T.nodeIndent !== t && 0 <= t && (this.T.nodeIndent = t, this.C()) } }, nodeIndentPastParent: { get: function () { return this.T.nodeIndentPastParent }, set: function (t) { this.T.nodeIndentPastParent !== t && 0 <= t && t <= 1 && (this.T.nodeIndentPastParent = t, this.C()) } }, nodeSpacing: { get: function () { return this.T.nodeSpacing }, set: function (t) { this.T.nodeSpacing !== t && (this.T.nodeSpacing = t, this.C()) } }, layerSpacing: { get: function () { return this.T.layerSpacing }, set: function (t) { this.T.layerSpacing !== t && (this.T.layerSpacing = t, this.C()) } }, layerSpacingParentOverlap: { get: function () { return this.T.layerSpacingParentOverlap }, set: function (t) { this.T.layerSpacingParentOverlap !== t && 0 <= t && t <= 1 && (this.T.layerSpacingParentOverlap = t, this.C()) } }, compaction: { get: function () { return this.T.compaction }, set: function (t) { this.T.compaction === t || t !== zg && t !== Vg || (this.T.compaction = t, this.C()) } }, breadthLimit: { get: function () { return this.T.breadthLimit }, set: function (t) { this.T.breadthLimit !== t && 0 <= t && (this.T.breadthLimit = t, this.C()) } }, rowSpacing: { get: function () { return this.T.rowSpacing }, set: function (t) { this.T.rowSpacing !== t && (this.T.rowSpacing = t, this.C()) } }, rowIndent: { get: function () { return this.T.rowIndent }, set: function (t) { this.T.rowIndent !== t && 0 <= t && (this.T.rowIndent = t, this.C()) } }, commentSpacing: { get: function () { return this.T.commentSpacing }, set: function (t) { this.T.commentSpacing !== t && (this.T.commentSpacing = t, this.C()) } }, commentMargin: { get: function () { return this.T.commentMargin }, set: function (t) { this.T.commentMargin !== t && (this.T.commentMargin = t, this.C()) } }, setsPortSpot: { get: function () { return this.T.setsPortSpot }, set: function (t) { this.T.setsPortSpot !== t && (this.T.setsPortSpot = t, this.C()) } }, portSpot: { get: function () { return this.T.portSpot }, set: function (t) { this.T.portSpot.w(t) || (this.T.portSpot = t, this.C()) } }, setsChildPortSpot: { get: function () { return this.T.setsChildPortSpot }, set: function (t) { this.T.setsChildPortSpot !== t && (this.T.setsChildPortSpot = t, this.C()) } }, childPortSpot: { get: function () { return this.T.childPortSpot }, set: function (t) { this.T.childPortSpot.w(t) || (this.T.childPortSpot = t, this.C()) } }, alternateSorting: { get: function () { return this.U.sorting }, set: function (t) { this.U.sorting === t || t !== Cg && t !== Tg && t !== Lg && !Ag || (this.U.sorting = t, this.C()) } }, alternateComparer: { get: function () { return this.U.comparer }, set: function (t) { this.U.comparer !== t && (this.U.comparer = t, this.C()) } }, alternateAngle: { get: function () { return this.U.angle }, set: function (t) { this.U.angle === t || 0 !== t && 90 !== t && 180 !== t && 270 !== t || (this.U.angle = t, this.C()) } }, alternateAlignment: { get: function () { return this.U.alignment }, set: function (t) { this.U.alignment !== t && (this.U.alignment = t, this.C()) } }, alternateNodeIndent: { get: function () { return this.U.nodeIndent }, set: function (t) { this.U.nodeIndent !== t && 0 <= t && (this.U.nodeIndent = t, this.C()) } }, alternateNodeIndentPastParent: { get: function () { return this.U.nodeIndentPastParent }, set: function (t) { this.U.nodeIndentPastParent !== t && 0 <= t && t <= 1 && (this.U.nodeIndentPastParent = t, this.C()) } }, alternateNodeSpacing: { get: function () { return this.U.nodeSpacing }, set: function (t) { this.U.nodeSpacing !== t && (this.U.nodeSpacing = t, this.C()) } }, alternateLayerSpacing: { get: function () { return this.U.layerSpacing }, set: function (t) { this.U.layerSpacing !== t && (this.U.layerSpacing = t, this.C()) } }, alternateLayerSpacingParentOverlap: { get: function () { return this.U.layerSpacingParentOverlap }, set: function (t) { this.U.layerSpacingParentOverlap !== t && 0 <= t && t <= 1 && (this.U.layerSpacingParentOverlap = t, this.C()) } }, alternateCompaction: { get: function () { return this.U.compaction }, set: function (t) { this.U.compaction === t || t !== zg && t !== Vg || (this.U.compaction = t, this.C()) } }, alternateBreadthLimit: { get: function () { return this.U.breadthLimit }, set: function (t) { this.U.breadthLimit !== t && 0 <= t && (this.U.breadthLimit = t, this.C()) } }, alternateRowSpacing: { get: function () { return this.U.rowSpacing }, set: function (t) { this.U.rowSpacing !== t && (this.U.rowSpacing = t, this.C()) } }, alternateRowIndent: { get: function () { return this.U.rowIndent }, set: function (t) { this.U.rowIndent !== t && 0 <= t && (this.U.rowIndent = t, this.C()) } }, alternateCommentSpacing: { get: function () { return this.U.commentSpacing }, set: function (t) { this.U.commentSpacing !== t && (this.U.commentSpacing = t, this.C()) } }, alternateCommentMargin: { get: function () { return this.U.commentMargin }, set: function (t) { this.U.commentMargin !== t && (this.U.commentMargin = t, this.C()) } }, alternateSetsPortSpot: { get: function () { return this.U.setsPortSpot }, set: function (t) { this.U.setsPortSpot !== t && (this.U.setsPortSpot = t, this.C()) } }, alternatePortSpot: { get: function () { return this.U.portSpot }, set: function (t) { this.U.portSpot.w(t) || (this.U.portSpot = t, this.C()) } }, alternateSetsChildPortSpot: { get: function () { return this.U.setsChildPortSpot }, set: function (t) { this.U.setsChildPortSpot !== t && (this.U.setsChildPortSpot = t, this.C()) } }, alternateChildPortSpot: { get: function () { return this.U.childPortSpot }, set: function (t) { this.U.childPortSpot.w(t) || (this.U.childPortSpot = t, this.C()) } } }); var Sg = new V(Hp, "PathDefault", -1), Pg = new V(Hp, "PathDestination", 0), Ng = new V(Hp, "PathSource", 1), Cg = new V(Hp, "SortingForwards", 10), Tg = new V(Hp, "SortingReverse", 11), Lg = new V(Hp, "SortingAscending", 12), Ag = new V(Hp, "SortingDescending", 13), jg = new V(Hp, "AlignmentCenterSubtrees", 20), Dg = new V(Hp, "AlignmentCenterChildren", 21), Fg = new V(Hp, "AlignmentStart", 22), Og = new V(Hp, "AlignmentEnd", 23), Bg = new V(Hp, "AlignmentBus", 24), Ig = new V(Hp, "AlignmentBusBranching", 25), Rg = new V(Hp, "AlignmentTopLeftBus", 26), Eg = new V(Hp, "AlignmentBottomRightBus", 27), zg = new V(Hp, "CompactionNone", 30), Vg = new V(Hp, "CompactionBlock", 31), Yg = new V(Hp, "StyleLayered", 40), Gg = new V(Hp, "StyleLastParents", 41), Xg = new V(Hp, "StyleAlternating", 42), qg = new V(Hp, "StyleRootOnly", 43), Ug = new V(Hp, "ArrangementVertical", 50), Kg = new V(Hp, "ArrangementHorizontal", 51), Hg = new V(Hp, "ArrangementFixedRoots", 52), Wg = new V(Hp, "LayerIndividual", 60), Jg = new V(Hp, "LayerSiblings", 61), Zg = new V(Hp, "LayerUniform", 62); function $g(t) { zc.call(this, t) } function Qg(t) { qc.call(this, t), this.Ha = !1, this.Ic = null, this.I = [], this.kd = this.ab = this.W = this.Ia = 0, this.$c = null, this.S = new gi(0, 0), this.ta = new Yi(0, 0), this.da = new gi(0, 0), this.Fm = this.Em = this.sA = !1, this.Jq = this.wq = null, this.Qc = Cg, this.Kc = Uc, this.Yb = 0, this.wb = Dg, this.ls = this.ks = 0, this.ms = 20, this.oe = 50, this.Yr = 0, this.kr = Vg, this.cr = 0, this.zs = 25, this.jr = this.ys = 10, this.ir = 20, this.Ms = !0, this.vs = bi, this.Ls = !0, this.fr = bi } function _g(t) { Kc.call(this, t), this.Ou = new gi(0, 0) } Hp.className = "TreeLayout", Hp.PathDefault = Sg, Hp.PathDestination = Pg, Hp.PathSource = Ng, Hp.SortingForwards = Cg, Hp.SortingReverse = Tg, Hp.SortingAscending = Lg, Hp.SortingDescending = Ag, Hp.AlignmentCenterSubtrees = jg, Hp.AlignmentCenterChildren = Dg, Hp.AlignmentStart = Fg, Hp.AlignmentEnd = Og, Hp.AlignmentBus = Bg, Hp.AlignmentBusBranching = Ig, Hp.AlignmentTopLeftBus = Rg, Hp.AlignmentBottomRightBus = Eg, Hp.CompactionNone = zg, Hp.CompactionBlock = Vg, Hp.StyleLayered = Yg, Hp.StyleLastParents = Gg, Hp.StyleAlternating = Xg, Hp.StyleRootOnly = qg, Hp.ArrangementVertical = Ug, Hp.ArrangementHorizontal = Kg, Hp.ArrangementFixedRoots = Hg, Hp.LayerIndividual = Wg, Hp.LayerSiblings = Jg, Hp.LayerUniform = Zg, h($g, zc), $g.prototype.createVertex = function () { return new Qg(this) }, $g.prototype.createEdge = function () { return new _g(this) }, $g.className = "TreeNetwork", h(Qg, qc), Qg.prototype.copyInheritedPropertiesFrom = function (t) { null !== t && (this.Qc = t.sorting, this.Kc = t.comparer, this.Yb = t.angle, this.wb = t.alignment, this.ks = t.nodeIndent, this.ls = t.nodeIndentPastParent, this.ms = t.nodeSpacing, this.oe = t.layerSpacing, this.Yr = t.layerSpacingParentOverlap, this.kr = t.compaction, this.cr = t.breadthLimit, this.zs = t.rowSpacing, this.ys = t.rowIndent, this.jr = t.commentSpacing, this.ir = t.commentMargin, this.Ms = t.setsPortSpot, this.vs = t.portSpot, this.Ls = t.setsChildPortSpot, this.fr = t.childPortSpot) }, l.Object.defineProperties(Qg.prototype, { initialized: { get: function () { return this.Ha }, set: function (t) { this.Ha !== t && (this.Ha = t) } }, parent: { get: function () { return this.Ic }, set: function (t) { this.Ic !== t && (this.Ic = t) } }, children: { get: function () { return this.I }, set: function (t) { if (this.I !== t) { if (null !== t) for (var i = t.length, e = 0; e < i; e++); this.I = t } } }, level: { get: function () { return this.Ia }, set: function (t) { this.Ia !== t && (this.Ia = t) } }, descendantCount: { get: function () { return this.W }, set: function (t) { this.W !== t && (this.W = t) } }, maxChildrenCount: { get: function () { return this.ab }, set: function (t) { this.ab !== t && (this.ab = t) } }, maxGenerationCount: { get: function () { return this.kd }, set: function (t) { this.kd !== t && (this.kd = t) } }, comments: { get: function () { return this.$c }, set: function (t) { if (this.$c !== t) { if (null !== t) for (var i = t.length, e = 0; e < i; e++); this.$c = t } } }, sorting: { get: function () { return this.Qc }, set: function (t) { this.Qc !== t && (this.Qc = t) } }, comparer: { get: function () { return this.Kc }, set: function (t) { this.Kc !== t && (this.Kc = t) } }, angle: { get: function () { return this.Yb }, set: function (t) { this.Yb !== t && (this.Yb = t) } }, alignment: { get: function () { return this.wb }, set: function (t) { this.wb !== t && (this.wb = t) } }, nodeIndent: { get: function () { return this.ks }, set: function (t) { this.ks !== t && (this.ks = t) } }, nodeIndentPastParent: { get: function () { return this.ls }, set: function (t) { this.ls !== t && (this.ls = t) } }, nodeSpacing: { get: function () { return this.ms }, set: function (t) { this.ms !== t && (this.ms = t) } }, layerSpacing: { get: function () { return this.oe }, set: function (t) { this.oe !== t && (this.oe = t) } }, layerSpacingParentOverlap: { get: function () { return this.Yr }, set: function (t) { this.Yr !== t && (this.Yr = t) } }, compaction: { get: function () { return this.kr }, set: function (t) { this.kr !== t && (this.kr = t) } }, breadthLimit: { get: function () { return this.cr }, set: function (t) { this.cr !== t && (this.cr = t) } }, rowSpacing: { get: function () { return this.zs }, set: function (t) { this.zs !== t && (this.zs = t) } }, rowIndent: { get: function () { return this.ys }, set: function (t) { this.ys !== t && (this.ys = t) } }, commentSpacing: { get: function () { return this.jr }, set: function (t) { this.jr !== t && (this.jr = t) } }, commentMargin: { get: function () { return this.ir }, set: function (t) { this.ir !== t && (this.ir = t) } }, setsPortSpot: { get: function () { return this.Ms }, set: function (t) { this.Ms !== t && (this.Ms = t) } }, portSpot: { get: function () { return this.vs }, set: function (t) { this.vs.w(t) || (this.vs = t) } }, setsChildPortSpot: { get: function () { return this.Ls }, set: function (t) { this.Ls !== t && (this.Ls = t) } }, childPortSpot: { get: function () { return this.fr }, set: function (t) { this.fr.w(t) || (this.fr = t) } }, childrenCount: { get: function () { return this.children.length } }, relativePosition: { get: function () { return this.S }, set: function (t) { this.S.set(t) } }, subtreeSize: { get: function () { return this.ta }, set: function (t) { this.ta.set(t) } }, subtreeOffset: { get: function () { return this.da }, set: function (t) { this.da.set(t) } } }), Qg.className = "TreeVertex", h(_g, Kc), _g.prototype.commit = function () { var t = this.link; if (null !== t && !t.isAvoiding) { var i = this.network.layout, e = null, n = null; switch (i.ad) { case Pg: e = this.fromVertex, n = this.toVertex; break; case Ng: e = this.toVertex, n = this.fromVertex; break; default: B("Unhandled path value " + i.ad.toString()) }if (null !== e && null !== n) if (0 !== (i = this.Ou).x || 0 !== i.y || e.sA) { n = e.bounds; var o = wg(e), r = kg(e), s = e.rowSpacing; t.hj(); var a, h = t.curve === nc, l = t.isOrthogonal; if (t.Kh(), l || h) { for (a = 2; 4 < t.pointsCount;)t.aw(2); var u = t.i(1), c = t.i(2) } else { for (a = 1; 3 < t.pointsCount;)t.aw(1); u = t.i(0), c = t.i(t.pointsCount - 1) } var f = t.i(t.pointsCount - 1); 0 === o ? (e.alignment === Og ? (o = n.bottom + i.y, 0 === i.y && u.y > f.y + e.rowIndent && (o = Math.min(o, Math.max(u.y, o - Mg(e))))) : e.alignment === Fg ? (o = n.top + i.y, 0 === i.y && u.y < f.y - e.rowIndent && (o = Math.max(o, Math.min(u.y, o + Mg(e))))) : o = e.Em || e.Fm && 1 === e.maxGenerationCount ? n.top - e.da.y + i.y : n.y + n.height / 2 + i.y, h ? (t.m(a, u.x, o), a++, t.m(a, n.right + r, o), a++, t.m(a, n.right + r + (i.x - s) / 3, o), a++, t.m(a, n.right + r + 2 * (i.x - s) / 3, o), a++, t.m(a, n.right + r + (i.x - s), o), a++, t.m(a, c.x, o)) : (l && (t.m(a, n.right + r / 2, u.y), a++), t.m(a, n.right + r / 2, o), a++, t.m(a, n.right + r + i.x - (l ? s / 2 : s), o), a++, l && t.m(a, t.i(a - 1).x, c.y))) : 90 === o ? (e.alignment === Og ? (o = n.right + i.x, 0 === i.x && u.x > f.x + e.rowIndent && (o = Math.min(o, Math.max(u.x, o - Mg(e))))) : e.alignment === Fg ? (o = n.left + i.x, 0 === i.x && u.x < f.x - e.rowIndent && (o = Math.max(o, Math.min(u.x, o + Mg(e))))) : o = e.Em || e.Fm && 1 === e.maxGenerationCount ? n.left - e.da.x + i.x : n.x + n.width / 2 + i.x, h ? (t.m(a, o, u.y), a++, t.m(a, o, n.bottom + r), a++, t.m(a, o, n.bottom + r + (i.y - s) / 3), a++, t.m(a, o, n.bottom + r + 2 * (i.y - s) / 3), a++, t.m(a, o, n.bottom + r + (i.y - s)), a++, t.m(a, o, c.y)) : (l && (t.m(a, u.x, n.bottom + r / 2), a++), t.m(a, o, n.bottom + r / 2), a++, t.m(a, o, n.bottom + r + i.y - (l ? s / 2 : s)), a++, l && t.m(a, c.x, t.i(a - 1).y))) : 180 === o ? (e.alignment === Og ? (o = n.bottom + i.y, 0 === i.y && u.y > f.y + e.rowIndent && (o = Math.min(o, Math.max(u.y, o - Mg(e))))) : e.alignment === Fg ? (o = n.top + i.y, 0 === i.y && u.y < f.y - e.rowIndent && (o = Math.max(o, Math.min(u.y, o + Mg(e))))) : o = e.Em || e.Fm && 1 === e.maxGenerationCount ? n.top - e.da.y + i.y : n.y + n.height / 2 + i.y, h ? (t.m(a, u.x, o), a++, t.m(a, n.left - r, o), a++, t.m(a, n.left - r + (i.x + s) / 3, o), a++, t.m(a, n.left - r + 2 * (i.x + s) / 3, o), a++, t.m(a, n.left - r + (i.x + s), o), a++, t.m(a, c.x, o)) : (l && (t.m(a, n.left - r / 2, u.y), a++), t.m(a, n.left - r / 2, o), a++, t.m(a, n.left - r + i.x + (l ? s / 2 : s), o), a++, l && t.m(a, t.i(a - 1).x, c.y))) : 270 === o ? (e.alignment === Og ? (o = n.right + i.x, 0 === i.x && u.x > f.x + e.rowIndent && (o = Math.min(o, Math.max(u.x, o - Mg(e))))) : e.alignment === Fg ? (o = n.left + i.x, 0 === i.x && u.x < f.x - e.rowIndent && (o = Math.max(o, Math.min(u.x, o + Mg(e))))) : o = e.Em || e.Fm && 1 === e.maxGenerationCount ? n.left - e.da.x + i.x : n.x + n.width / 2 + i.x, h ? (t.m(a, o, u.y), a++, t.m(a, o, n.top - r), a++, t.m(a, o, n.top - r + (i.y + s) / 3), a++, t.m(a, o, n.top - r + 2 * (i.y + s) / 3), a++, t.m(a, o, n.top - r + (i.y + s)), a++, t.m(a, o, c.y)) : (l && (t.m(a, u.x, n.top - r / 2), a++), t.m(a, o, n.top - r / 2), a++, t.m(a, o, n.top - r + i.y + (l ? s / 2 : s)), a++, l && t.m(a, c.x, t.i(a - 1).y))) : B("Invalid angle " + o), t.rf() } else t = this.link, (r = wg(e)) !== wg(n) && (s = kg(e), h = e.bounds, e = n.bounds, 0 === r && e.left - h.right < s + 1 || 90 === r && e.top - h.bottom < s + 1 || 180 === r && h.left - e.right < s + 1 || 270 === r && h.top - e.bottom < s + 1 || (t.hj(), e = t.curve === nc, i = t.isOrthogonal, n = ig(this.fromVertex.alignment), t.Kh(), 0 === r ? (r = h.right + s / 2, e ? 4 === t.pointsCount && (e = t.i(3).y, t.K(1, r - 20, t.i(1).y), t.m(2, r - 20, e), t.m(3, r, e), t.m(4, r + 20, e), t.K(5, t.i(5).x, e)) : i ? n ? t.K(3, t.i(2).x, t.i(4).y) : 6 === t.pointsCount && (t.K(2, r, t.i(2).y), t.K(3, r, t.i(3).y)) : 4 === t.pointsCount ? t.m(2, r, t.i(2).y) : 3 === t.pointsCount ? t.K(1, r, t.i(2).y) : 2 === t.pointsCount && t.m(1, r, t.i(1).y)) : 90 === r ? (r = h.bottom + s / 2, e ? 4 === t.pointsCount && (e = t.i(3).x, t.K(1, t.i(1).x, r - 20), t.m(2, e, r - 20), t.m(3, e, r), t.m(4, e, r + 20), t.K(5, e, t.i(5).y)) : i ? n ? t.K(3, t.i(2).x, t.i(4).y) : 6 === t.pointsCount && (t.K(2, t.i(2).x, r), t.K(3, t.i(3).x, r)) : 4 === t.pointsCount ? t.m(2, t.i(2).x, r) : 3 === t.pointsCount ? t.K(1, t.i(2).x, r) : 2 === t.pointsCount && t.m(1, t.i(1).x, r)) : 180 === r ? (r = h.left - s / 2, e ? 4 === t.pointsCount && (e = t.i(3).y, t.K(1, r + 20, t.i(1).y), t.m(2, r + 20, e), t.m(3, r, e), t.m(4, r - 20, e), t.K(5, t.i(5).x, e)) : i ? n ? t.K(3, t.i(2).x, t.i(4).y) : 6 === t.pointsCount && (t.K(2, r, t.i(2).y), t.K(3, r, t.i(3).y)) : 4 === t.pointsCount ? t.m(2, r, t.i(2).y) : 3 === t.pointsCount ? t.K(1, r, t.i(2).y) : 2 === t.pointsCount && t.m(1, r, t.i(1).y)) : 270 === r && (r = h.top - s / 2, e ? 4 === t.pointsCount && (e = t.i(3).x, t.K(1, t.i(1).x, r + 20), t.m(2, e, r + 20), t.m(3, e, r), t.m(4, e, r - 20), t.K(5, e, t.i(5).y)) : i ? n ? t.K(3, t.i(2).x, t.i(4).y) : 6 === t.pointsCount && (t.K(2, t.i(2).x, r), t.K(3, t.i(3).x, r)) : 4 === t.pointsCount ? t.m(2, t.i(2).x, r) : 3 === t.pointsCount ? t.K(1, t.i(2).x, r) : 2 === t.pointsCount && t.m(1, t.i(1).x, r)), t.rf())) } }, l.Object.defineProperties(_g.prototype, { relativePoint: { get: function () { return this.Ou }, set: function (t) { this.Ou.set(t) } } }), _g.className = "TreeEdge", Ce.prototype.initializeStandardTools = function () { this.Wa("Action", new wn, this.mouseDownTools), this.Wa("Relinking", new un, this.mouseDownTools), this.Wa("LinkReshaping", new fn, this.mouseDownTools), this.Wa("Rotating", new xn, this.mouseDownTools), this.Wa("Resizing", new vn, this.mouseDownTools), this.Wa("Linking", new sn, this.mouseMoveTools), this.Wa("Dragging", new Be, this.mouseMoveTools), this.Wa("DragSelecting", new Mn, this.mouseMoveTools), this.Wa("Panning", new Sn, this.mouseMoveTools), this.Wa("ContextMenu", new Cn, this.mouseUpTools), this.Wa("TextEditing", new Bn, this.mouseUpTools), this.Wa("ClickCreating", new kn, this.mouseUpTools), this.Wa("ClickSelecting", new bn, this.mouseUpTools) }, Rh("Horizontal", new sh), Rh("Spot", new hh), Rh("Table", new uh), Rh("Viewbox", new dh), Rh("TableRow", new ch), Rh("TableColumn", new fh), Rh("Graduated", new vh), Rh("Grid", new ph), _r.add(_f.type, gf), _r.add(ld.type, xf); var ty = c.go, iy = { get licenseKey() { return Lo.licenseKey }, set licenseKey(t) { Lo.licenseKey = t }, get version() { return Lo.version }, Group: Lu, EnumValue: V, List: J, Set: $, Map: at, Point: gi, Size: Yi, Rect: yi, Margin: Xt, Spot: Oi, Geometry: Ui, PathFigure: se, PathSegment: ae, InputEvent: ye, DiagramEvent: me, ChangedEvent: ve, Model: wf, GraphLinksModel: _f, TreeModel: ld, Binding: Jf, Transaction: Me, UndoManager: Se, CommandHandler: Is, Tool: Ne, DraggingTool: Be, DraggingInfo: Ns, DraggingOptions: Ts, LinkingBaseTool: on, LinkingTool: sn, RelinkingTool: un, LinkReshapingTool: fn, ResizingTool: vn, RotatingTool: xn, ClickSelectingTool: bn, ActionTool: wn, ClickCreatingTool: kn, HTMLInfo: Pn, ContextMenuTool: Cn, DragSelectingTool: Mn, PanningTool: Sn, TextEditingTool: Bn, ToolManager: Ce, Animation: fo, AnimationManager: $n, AnimationTrigger: ko, Layer: No, Diagram: Lo, Palette: Ls, Overview: js, Brush: La, GraphObject: Es, Panel: xh, RowColumnDefinition: Yh, Shape: Kh, TextBlock: el, TextBlockMetrics: Tl, Picture: Ll, Part: Hl, Adornment: du, Node: pu, Link: Fu, Placeholder: Du, Layout: Ic, LayoutNetwork: zc, LayoutVertex: qc, LayoutEdge: Kc, GridLayout: Hc, PanelLayout: oh, CircularLayout: ud, CircularNetwork: Id, CircularVertex: Rd, CircularEdge: zd, ForceDirectedLayout: Vd, ForceDirectedNetwork: Wd, ForceDirectedVertex: Jd, ForceDirectedEdge: Zd, LayeredDigraphLayout: Qd, LayeredDigraphNetwork: qp, LayeredDigraphVertex: Up, LayeredDigraphEdge: Kp, TreeLayout: Hp, TreeNetwork: $g, TreeVertex: Qg, TreeEdge: _g }; ty && ty.version !== iy.version && B("WARNING: a `go` object on the root object is already defined with a version mismatch." + ty.version + ". Replaced with version: " + iy.version), c.go = iy, (void 0 === c || void 0 === c.module || "object" != typeof c.module.exports) && c.define && "function" == typeof c.define && c.define.amd && c.define(iy), "undefined" != typeof module && "object" == typeof module.exports && (module.exports = "undefined" != typeof global ? global.go : self.go) }();